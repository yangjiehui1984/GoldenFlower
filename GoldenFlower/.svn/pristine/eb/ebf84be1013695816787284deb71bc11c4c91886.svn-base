require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ButtonScale":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5a421EEBHBHVa9GjAAkNYhq', 'ButtonScale');
// Script/Tools/ButtonScale.js

'use strict';

//按钮标识
var EbuttonTag = cc.Enum({

    eChip20: 0,
    eChip50: 1,
    eChip100: 2,
    eChip500: 3,
    eChip1000: 4,
    eClear: 5,
    eHistoryList: 6

});

cc.Class({
    extends: cc.Component,

    properties: {
        scaleFlag: true,
        buttonTag: 0,
        parentNode: cc.Node },

    // use this for initialization
    onLoad: function onLoad() {

        // var timeCallback = function (dt)
        {
            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_START, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 0.8;
                    }
                }, this);
            }

            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_END, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 1;
                    }
                    var onFunction = cc.find('Canvas').getComponent('game');
                    onFunction.btnActionCallBack(this.buttonTag);
                }, this);
            }

            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 1;
                    }
                }, this);
            }
        }
    }

});

module.exports = {
    EbuttonTag: EbuttonTag
};

cc._RFpop();
},{}],"DataOper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '370d7GWnVZOL5PlfbPKEsjx', 'DataOper');
// Script/network/DataOper.js

"use strict";

var CryptoJS = require("core");
require("aes");
var NetData = require("NetData");

var KeyValue = cc.Class({
    properties: {
        key: "",
        value: ""
    }
});

var CusMap = cc.Class({
    properties: {
        maps: {
            default: [],
            type: [KeyValue],
            serializable: false
        }
    },

    set: function set(key, value) {
        var s_key = key.toString();
        var flag = false;

        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key === s_key) {
                flag = true;
                this.maps[i].value = value;
                break;
            }
        }

        if (flag === false) {
            var keyValue = new KeyValue();
            keyValue.key = s_key;
            keyValue.value = value;
            this.maps.push(keyValue);
        }
    },

    get: function get(key) {
        var s_key = key.toString();

        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key === s_key) {
                return this.maps[i].value;
            }
        }

        return null;
    },

    clear: function clear(key) {
        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key == key) {
                this.maps.splice(i, 1);
                break;
            }
        }
    }
});

var NetWork = cc.Class({
    send: function send(requestId, requestHeaders, requestData, callfunc) {
        var xhr = cc.loader.getXMLHttpRequest();

        if (!CC_JSB) {
            if (window.aliLotteryCasinoSDK) {
                xhr = window.aliLotteryCasinoSDK.getHttpRequestObject();
            }
        }

        xhr.open("POST", "http://10.0.20.172:8080/gateway/process");
        //xhr.open("POST", "http://172.16.20.161:7080/gateway/process");//"http://172.16.20.175:8080/gateway/process"); //"http://10.0.1.232:7080/new_gateway/process"); 
        xhr.timeout = 15000; //15s超时

        //设置请求头
        for (var i = 0; i < requestHeaders.length; ++i) {
            xhr.setRequestHeader(requestHeaders[i].key, requestHeaders[i].value);
        }

        xhr.send(requestData);

        xhr.onload = function () {
            callfunc(requestId, xhr);
        };

        xhr.onerror = function () {
            callfunc(requestId, xhr);
        };

        xhr.ontimeout = function () {
            callfunc(requestId, xhr);
        };
    }
});

var DataOper = cc.Class({

    statics: {
        g_DataOperInst: null,
        s_index: 0,

        getInst: function getInst() {

            if (DataOper.g_DataOperInst === null) {
                DataOper.g_DataOperInst = new DataOper();
                DataOper.g_DataOperInst.init();
            }
            return DataOper.g_DataOperInst;
        },

        destoryInst: function destoryInst() {

            if (DataOper.g_DataOperInst !== null) {
                DataOper.g_DataOperInst = null;
            }
        }
    },

    properties: {
        //请求data
        requestData: "",
        //请求id
        requestId: 0,
        //aes Key
        aesKey: "817fed95f9e16bed", //秘钥，写死

        //****************请求头信息**********
        //请求头数组
        requestHeaders: {
            default: [],
            type: [KeyValue],
            serializable: false
        },
        //命令号
        headerCmd: 0, //初始化-100  投注-101  结算-103
        //sig
        headerSig: "",
        //版本号
        headerVer: "1.0",
        //会话标识
        headerToken: "3709187189", //"3706201779",
        //游戏渠道实例标识
        gameToken: "ad80db994dabb90b42db00214b8d301d-9-901-1202" },

    init: function init() {
        this.callfuncs = new CusMap();
        this.callnode = new CusMap();
        this.callcmd = new CusMap();
        cc.log("jb=" + CC_JSB);

        if (!CC_JSB) {
            this.gameToken = this.GetQueryString("accessToken");

            if (this.gameToken == null) {
                this.gameToken = "ad80db994dabb90b42db00214b8d301d-9-901-1202"; //"ddd76cd6e9b62dc2259aa772a4501b22-9-951-926";
                var tok = this.GetQueryString("tok");

                if (tok) {
                    this.headerToken = tok;
                    console.log("tok=" + this.headerToken);
                } else {
                    this.headerToken = "";
                }
                //test
                /*var myDate = new Date();
                this.headerToken = myDate.getTime();*/
            }
        } else {}

        console.log("this.gameToken = " + this.gameToken);
    },

    GetQueryString: function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r !== null) return unescape(r[2]);return null;
    },

    setRequestHeader: function setRequestHeader() {
        this.requestHeaders = [];

        var keyValue = new KeyValue();
        keyValue.key = "cmd";
        keyValue.value = this.headerCmd.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "Content-Type";
        keyValue.value = "text/plain";
        this.requestHeaders.push(keyValue);

        /*keyValue = new KeyValue();
        keyValue.key = "cid";
        keyValue.value = this.headerCid.toString();
        this.requestHeaders.push(keyValue);*/

        keyValue = new KeyValue();
        keyValue.key = "sig";
        keyValue.value = this.headerSig.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "ver";
        keyValue.value = this.headerVer.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "tok";
        keyValue.value = this.headerToken.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "gameToken";
        keyValue.value = this.gameToken.toString();
        this.requestHeaders.push(keyValue);

        /*keyValue = new KeyValue();
        keyValue.key = "gid";
        keyValue.value = this.headerGid.toString();
        this.requestHeaders.push(keyValue);*/
    },

    request: function request(callFunc, self) {
        //if(this.headerCmd != 105){
        console.log("request-----------data = " + this.requestData + ";cmd:" + this.headerCmd);
        //}

        this.callfuncs.set(DataOper.s_index, callFunc);
        this.callnode.set(DataOper.s_index, self);
        this.callcmd.set(DataOper.s_index, this.headerCmd);
        //aes加密
        this.requestData = this.AESEncryption(this.requestData, this.aesKey);
        //Base64
        //this.requestData = Base64.encode(this.requestData);
        //gzip
        //this.requestData = this.requestData;
        //md5
        this.headerSig = CryptoJS.MD5(this.requestData);
        //请求头
        this.setRequestHeader();
        //send
        var netWork = new NetWork();
        netWork.send(DataOper.s_index, this.requestHeaders, this.requestData, this.onHttpRequestCompleted);
        DataOper.s_index++;
    },

    /**
     * 联网回调
     * @Param requestId 请求id
     * @param status   联网状态
     * @param responeData 响应data
     */
    onHttpRequestCompleted: function onHttpRequestCompleted(requestId, xhr) {
        console.log("onHttpRequestCompleted.xhr.status=" + xhr.status);
        var callFunc = DataOper.getInst().callfuncs.get(requestId);
        var callNode = DataOper.getInst().callnode.get(requestId);
        var callCmd = DataOper.getInst().callcmd.get(requestId);
        cc.log("callCmd=" + callCmd + "/ln=" + DataOper.getInst().callcmd.maps.length + "'" + DataOper.getInst().callfuncs.maps.length + "'" + DataOper.getInst().callnode.maps.length);
        DataOper.getInst().callfuncs.clear(requestId);
        DataOper.getInst().callnode.clear(requestId);
        DataOper.getInst().callcmd.clear(requestId);

        if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {
            //取http头
            //命令号
            var cmd = xhr.getResponseHeader("cmd");
            cmd = parseInt(cmd);
            //res
            var res = xhr.getResponseHeader("res");
            //msg
            var msg = xhr.getResponseHeader("msg");
            msg = decodeURIComponent(msg);
            //sig
            var sig = xhr.getResponseHeader("sig");
            cc.log("xhr.status=" + xhr.status + "|re=" + res);

            if (res == 0) {
                //取body
                var body = xhr.responseText;
                //md5验证
                var t_sig = CryptoJS.MD5(body);
                var t_sig_str = new String(t_sig);
                var sig_str = new String(sig);
                t_sig_str = t_sig_str.trim();
                sig_str = sig_str.trim();

                if (t_sig_str == sig_str) {
                    console.log("valify right");
                    DataOper.getInst().parserServerData(body, cmd);
                    callFunc(cmd, res, msg, callNode);

                    //更新账户余额
                    //初始化调过了，不调了。
                    if (!CC_JSB) {
                        if (window.aliLotteryCasinoSDK) {
                            switch (cmd) {
                                case 101: //bet
                                case 102: //clear
                                case 103:
                                    //reward
                                    {
                                        window.aliLotteryCasinoSDK.updateUserInfo();
                                    }
                                    break;
                                default:
                                    break;
                            }
                        }
                    }
                } else {
                    callFunc(cmd, -1, "加密验证错误", callNode);
                }
            } else {
                console.log("报错---res:" + res + "----msg:" + msg);

                //纯业务logic
                if (cmd == 100 && res == 999999) {
                    NetData.NetData.getInst().initFlag = 2;
                    NetData.NetData.getInst().stopSellingDesc = msg;
                }
                //end 业务
                callFunc(cmd, res, msg, callNode);
            }
        } else {
            //联网失败
            console.log("http status:" + xhr.status + "|callCmd=" + callCmd);
            callFunc(callCmd, -1, "网络可能不好哦，请重试", callNode);
        }
    },

    /**
     *解析服务器返回数据
     * @param data
     * @param cmd
     */
    parserServerData: function parserServerData(data, cmd) {
        //gzip解压
        //data = data;
        //Base64
        //data = Base64.decode(data);
        //aes解密
        data = this.AESDecrypt(data, this.aesKey);
        var iNum1 = parseInt(cmd);

        if (iNum1 != 105) {
            console.log("data = " + data + ", cmd = " + cmd);
        }

        switch (iNum1) {
            case 100:
                {
                    this.parserInit(data);
                }
                break;
            case 101:
                {
                    this.parserBet(data);
                }
                break;
            case 102:
                {
                    this.parseClear(data);
                }
                break;
            case 103:
                {
                    this.parserReward(data);
                }
                break;
            case 104:
                {
                    this.parseSecondData(data);
                }
                break;
            case 105:
                {
                    this.parseTable(data);
                }
                break;
            case 106:
                {
                    this.parseOrderList(data);
                }
                break;
            case 107:
                {
                    this.parserHistory(data);
                }
                break;
            default:
                break;
        }
    },

    //AES加密
    AESEncryption: function AESEncryption(data, aesKey) {
        var key = CryptoJS.enc.Utf8.parse(aesKey);
        var iv = CryptoJS.enc.Utf8.parse(aesKey);
        var srcs = CryptoJS.enc.Utf8.parse(data);
        var encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: CryptoJS.mode.ECB });
        return encrypted.toString();
    },

    //AES解密
    AESDecrypt: function AESDecrypt(data, aesKey) {
        var key = CryptoJS.enc.Utf8.parse(aesKey);
        var iv = CryptoJS.enc.Utf8.parse(aesKey);
        var decrypt = CryptoJS.AES.decrypt(data, key, { iv: iv, mode: CryptoJS.mode.ECB });
        return CryptoJS.enc.Utf8.stringify(decrypt).toString();
    },

    /**
     * 解析初始化
     * @param data
     */
    parserInit: function parserInit(data) {
        var netData = NetData.NetData.getInst();
        netData.initData = JSON.parse(data);
        cc.log("netData.initData.oddsList ", netData.initData.oddsList);
        netData.session = netData.initData.session;
        netData.periodId = netData.initData.periodId;
        netData.ticketNo = netData.initData.ticketNo;
        netData.betLimit = netData.initData.betLimit;
        netData.totalBetLimit = netData.initData.totalBetLimit;

        var periodEndTime = null;
        if (netData.initData.status == 1 || netData.initData.status == 2) {
            netData.timeFlag = 1;
            periodEndTime = netData.initData.periodEndTime1;
        } else if (netData.initData.status == 3 || netData.initData.status == 4) {
            netData.timeFlag = 2;
            periodEndTime = netData.initData.periodEndTime2;
        }

        if (periodEndTime != null) {
            netData.lotteryId = netData.initData.lotteryId;
            netData.lotteryIndex = netData.initData.lotteryIndex;

            var te = new Date();
            var localTime = te.getTime();
            var severTime = netData.initData.serverTime;
            netData.receiveTime = localTime - severTime;
            netData.secs = Math.floor((periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        //
        netData.initFlag = 1;
    },

    /**
     * 解析投注
     */
    parserBet: function parserBet(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.betLimit = objRoot.betLimit;
        netData.totalBetLimit = objRoot.totalBetLimit;
        netData.ticketNo = objRoot.ticketNo;

        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;

        /*
        if(tmp < netData.receiveTime){
            netData.receiveTime = tmp;
            netData.secs = Math.floor((netData.betData.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        */
    },

    parseClear: function parseClear(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.ticketNo = "";
        netData.betLimit = netData.initData.betLimit;
        netData.totalBetLimit = netData.initData.totalBetLimit;
        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;
        /*
        if(tmp < netData.receiveTime){
            netData.receiveTime = tmp;
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        */
    },

    /**
     * 结算
     */
    parserReward: function parserReward(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.rewardData = objRoot;
        // netData.rewardData = JSON.parse(data);      

        netData.periodId = netData.rewardData.nextPeriodId;
        netData.initData.periodEndTime2 = objRoot.periodEndTime2;

        if (objRoot.periodEndTime1 != undefined) {
            var te = new Date();
            var localTime = te.getTime();
            var severTime = objRoot.serverTime;
            netData.receiveTime = localTime - severTime;
            netData.secs = Math.floor((objRoot.periodEndTime1 - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
    },

    parseTable: function parseTable(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;

        /*
        if(tmp < netData.receiveTime){
            netData.receiveTime = tmp; 
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        */

        //解析list
        netData.tableArray = [];
        netData.tableArray = objRoot.list;
    },

    parseSecondData: function parseSecondData(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.secondData = objRoot;
        netData.timeFlag = 2;
        var severTime = objRoot.serverTime;
        netData.secs = Math.floor((netData.initData.periodEndTime2 - severTime) / 1000 - netData.betThreshold - 3);

        /*
              var te = new Date();
              let localTime = te.getTime();
              let severTime = objRoot.serverTime;
              let tmp = localTime - severTime;
               if(tmp < netData.receiveTime){
                  netData.receiveTime = tmp; 
                  netData.secs = Math.floor((netData.initData.periodEndTime2 - severTime) / 1000 - netData.betThreshold - 3);
                  cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
              }
              */
    },

    parseOrderList: function parseOrderList(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.orderList = [];
        netData.orderList = objRoot.data;
    },

    parserHistory: function parserHistory(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.historyList = [];
        netData.historyList = objRoot.historyList;
    },

    /**
     * 初始化
     * @param
     * 
     */
    getInit: function getInit(session, callFunc, self) {
        if (session == null) {
            this.requestData = "{}";
        } else {
            var obj = new Object();
            obj.session = session;
            this.requestData = JSON.stringify(obj);
        }

        //提前初始化
        NetData.NetData.getInst().initFlag = 0;
        //设置命令号，每个请求都不一样
        this.headerCmd = 100;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 投注
     * @param ticket_no 订单号，首次投注为空
     * @param step 步数
     * @Parma trans_data 数据交互
     */
    getBet: function getBet(callFunc, self) {
        var netData = NetData.NetData.getInst();
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        var te = new Date();
        obj.tid = te.getTime().toString();
        te = null;
        obj.betList = netData.reqBetList;
        obj.periodId = netData.periodId;
        obj.timeFlag = netData.timeFlag;
        obj.session = netData.session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 101;
        //请求网络
        this.request(callFunc, self);
    },

    getClear: function getClear(callFunc, self) {
        var netData = NetData.NetData.getInst();
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = netData.periodId;
        obj.session = netData.session;
        obj.timeFlag = netData.timeFlag;
        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 102;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 结算
     * @param ticket_no 订单号
     */
    getReward: function getReward(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        obj.ticketNo = NetData.NetData.getInst().ticketNo;

        // obj.uids = new Array();
        obj.uids = [12, 123];
        // for(let i = 0; i < NetData.NetData.getInst().tableArray.length(); ++i){
        //     obj.uids.push(NetData.NetData.getInst().tableArray[i].uid);
        // }

        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 103;
        //请求网络
        this.request(callFunc, self);
    },

    getTable: function getTable(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.list = NetData.NetData.getInst().reqTableArray;
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        obj.timeFlag = NetData.NetData.getInst().timeFlag;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 105;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 获取二阶段数据
     */
    getSecondData: function getSecondData(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 104;
        //请求网络
        this.request(callFunc, self);
    },

    getOrderList: function getOrderList(callFunc, self) {
        this.requestData = "";
        this.headerCmd = 106;
        //请求网络
        this.request(callFunc, self);
    },

    getHistory: function getHistory(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.session = NetData.NetData.getInst().session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 107;
        //请求网络
        this.request(callFunc, self);
    }
});

module.exports = {
    DataOper: DataOper
};

cc._RFpop();
},{"NetData":"NetData","aes":"aes","core":"core"}],"HelloWorld":[function(require,module,exports){
"use strict";
cc._RFpush(module, '280c3rsZJJKnZ9RqbALVwtK', 'HelloWorld');
// Script/HelloWorld.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        label: {
            default: null,
            type: cc.Label
        },
        // defaults, set visually when attaching this script to the Canvas
        text: 'Hello, World!'
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.label.string = this.text;
    },

    // called every frame
    update: function update(dt) {}
});

cc._RFpop();
},{}],"Help":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cdd59b7NnNFr59YCYK5OLHf', 'Help');
// Script/Help.js

"use strict";

var NetData = require("NetData");
var Game = require("game");

cc.Class({
    extends: cc.Component,

    properties: {
        //游戏帮助
        uiBlack: cc.Node,
        testNode: cc.Node,
        scrollView: cc.Node,
        content: cc.Node,
        view: cc.Node,
        lock: false,
        gameNode: cc.Node,
        imgArray: [cc.Sprite]
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.netData = NetData.NetData.getInst();
        this.lock = true;
        var oriP1 = this.testNode.convertToWorldSpaceAR(cc.v2(0, 0));
        this.oriY = this.testNode.y - oriP1.y;
        //console.log("oriY=" + this.node.y + "|" + oriP1.y);        

        var callFunc_1 = cc.callFunc(function () {
            this.lock = false;
            var se = cc.director.getWinSize();
            this.scrollView.height = se.height * 0.8;
            this.scrollView.getChildByName("view").height = this.scrollView.height;
            this.node.height = this.scrollView.height;
            this.node.y = this.oriY - this.scrollView.height;
            //console.log("ny=" + this.node.y);
        }, this);

        this.node.runAction(cc.sequence(cc.delayTime(0.1), callFunc_1));

        this.uiBlack.on(cc.Node.EventType.TOUCH_START, function (event) {
            event.stopPropagation();
            this.close();
        }, this);
    },

    close: function close() {
        if (!this.lock) {
            this.uiBlack.active = false;

            var call3 = cc.callFunc(function () {
                this.netData.helpShowFlag = false;
            }, this);

            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.v2(0, this.oriY - this.scrollView.height)), call3));
        }
    },

    downHelp: function downHelp() {
        var self = this;
        var spt = this.gameNode.getComponent(Game);
        spt.showWaitLayer();
        var rh = 0;

        cc.loader.load(this.netData.rulePics, null, function (errors, results) {
            if (errors) {
                for (var i = 0; i < errors.length; i++) {
                    console.log('Error url [' + errors[i] + ']: ' + results.getError(errors[i]));
                }
            }
            // cc.log("results is %% ", results.getContent.length);
            var len = self.netData.rulePics.length;

            for (var _i = 0; _i < len; _i++) {

                var aTex = results.getContent(self.netData.rulePics[_i]);
                console.log(self.netData.rulePics[_i] + "|" + aTex);
                var sf = new cc.SpriteFrame();
                sf.setTexture(aTex);
                self.imgArray[_i].spriteFrame = sf;
                rh += self.imgArray[_i].node.height;
                cc.log("height is $$$ ", self.imgArray[_i].node.height);
                //支持多张图排版（2017-03-27 pm：520）
                if (_i > 0) {

                    var index = _i - 1;
                    var ht = self.imgArray[index].node.height;
                    self.imgArray[_i].node.y = self.imgArray[index].node.y - ht + 1;
                    // cc.log("height is $$$ ", ht);
                }
            }

            // if(len == 2){
            //     let ht = self.imgArray[0].node.height;
            //     self.imgArray[1].node.y = -ht;
            // }

            self.content.height = rh;
            spt.hideWaitLayer();
            self.initHelp();
        });
    },

    initHelp: function initHelp() {
        if (!this.lock) {
            console.log("initHelp");
            this.netData.helpShowFlag = true;
            this.lock = true;
            this.scrollView.getComponent(cc.ScrollView).scrollToOffset(cc.p(0, 0), 0.1);
            var callback = cc.callFunc(this.selectShowCallBack, this);
            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.p(0, this.oriY)), callback));
        }
    },

    selectShowCallBack: function selectShowCallBack() {
        this.uiBlack.active = true;
        this.lock = false;
    }
});

cc._RFpop();
},{"NetData":"NetData","game":"game"}],"Init":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9e257NxGEhC4Z+E/o15ic/D', 'Init');
// Script/Init.js

"use strict";

var DataOper = require("DataOper");
var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    /*ctor: function() {
        
    },*/

    init: function init() {
        var self = this;
        if (!CC_JSB && window.aliLotteryCasinoSDK) {
            document.addEventListener('casino:init', function (e) {

                /************************20170509在1.4.2修改获取gameToken****************************/

                var dataOper = DataOper.DataOper.getInst();
                dataOper.gameToken = e.data.accessToken;

                if (dataOper.gameToken === null) {
                    dataOper.gameToken = "26a09ca052d4c7dcde13449ba1b735df-11-1151-1051";
                    var tok = dataOper.GetQueryString("tok");

                    if (tok) {
                        dataOper.headerToken = tok;
                        console.log("tok=" + dataOper.headerToken);
                    } else {
                        dataOper.headerToken = "0";
                    }
                    //testsssssss
                    /*var myDate = new Date();
                    this.headerToken = myDate.getTime();*/
                }

                console.log("this.gameToken = " + dataOper.gameToken);
                console.log("this.headerToken = " + dataOper.headerToken);

                /************************20170509在1.4.2修改获取gameToken ****************************/

                self.fetch(function (isError) {
                    console.log(isError);
                    if (!isError) {
                        // 合并资源
                        window.aliLotteryCasinoSDK.mergeResources();
                        // 显示 loading
                        window.aliLotteryCasinoSDK.initLoading();
                        // 运行游戏
                        window.aliLotteryCasinoSDK.runGame();
                    } else {
                        window.aliLotteryCasinoSDK.showError();
                    }
                });
            }, false);
        } else {
            self.fetch();
        }
    },

    fetch: function fetch(callback) {
        console.log("VersionN:201705251200");
        cc.log("fetch");
        this.initData = {};
        var self = this;
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getInit(null, function (cmd, res, msg, self) {
            // 判断是否成功并存储初始化
            var isError = false;

            //每日****游戏暂停运营（客户端处理）
            if (res == 100007) {
                isError = false;
            } else if (res != 0) {
                isError = true;
            } else {
                // if(NetData.NetData.getInst().status == 1){
                //     var te = new Date();
                //     self.timeStamp = te.getTime();
                //     cc.log("timeStamp is ", self.timeStamp);
                // } 

                var te = new Date();
                self.timeStamp = te.getTime();
                cc.log("timeStamp is ", self.timeStamp);
            }

            cc.log('fetch init data');
            cc.log(cmd, res, msg);
            self.initData.cmd = cmd;
            self.initData.res = res;
            self.initData.msg = msg;
            callback && callback(isError);
        }, this);
    }
});

cc._RFpop();
},{"DataOper":"DataOper","NetData":"NetData"}],"NetData":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2c0127/qANHkKFLguhv7AkS', 'NetData');
// Script/network/NetData.js

"use strict";

var NetData = cc.Class({
    statics: {
        g_Inst: null,
        s_index: 0,

        getInst: function getInst() {

            if (NetData.g_Inst === null) {
                NetData.g_Inst = new NetData();
                NetData.g_Inst.init();
            }
            return NetData.g_Inst;
        },

        destoryInst: function destoryInst() {

            if (NetData.g_Inst !== null) {
                NetData.g_Inst = null;
            }
        }
    },

    properties: {
        //请求参数
        reqBetList: [], //投注数据
        reqTableArray: [], //请求用同桌人列表


        //响应
        timeFlag: 1, //投注阶段 1-第一阶段  2-第二阶段
        session: null,
        periodId: 1, //期次
        receiveTime: 0, //接收时间差
        secs: 0, //彩期剩余秒数
        betThreshold: 0,
        ticketNo: "", //订单号
        betLimit: 0, //投注限额
        totalBetLimit: 0, //总投注限额

        tableArray: [], //同桌人
        initData: null, //初始化data
        rewardData: null, //结算data
        secondData: null, //第二阶段数据data
        historyList: [], //历史走势
        orderList: [], //订单data

        //sdk        
        initFlag: 0 //提前初始化 0:没好  1:好了 2.停售
    },

    init: function init() {},

    clear: function clear() {}
});

module.exports = {
    NetData: NetData
};

cc._RFpop();
},{}],"Notouch":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b71281epI1FgLCfftSwge5e', 'Notouch');
// Script/Tools/Notouch.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {
            //不再派发事件
            event.stopPropagation();

            if (this.obj != undefined) {
                this.fun(this.obj);
                this.obj = undefined;
                this.fun = undefined;
            }
        }, this);
    },

    init: function init(obj, fun) {
        this.obj = obj;
        this.fun = fun;
    }

});

cc._RFpop();
},{}],"Power":[function(require,module,exports){
"use strict";
cc._RFpush(module, '21c82a03dJILKwxwhzMrsbH', 'Power');
// Script/Power.js

"use strict";

var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    properties: {

        selfChip1SkineNode: {
            default: [],
            type: [cc.Node]
        },

        selfChip2SkineNode: {
            default: [],
            type: [cc.Node]
        },

        pukeHighLightNodeArray: {
            default: [],
            type: [cc.Node]
        },

        betHighLightLayer: cc.Node,

        selfChipNode: {
            default: [],
            type: [cc.Node]
        },

        othersPositionNode: cc.Node,

        pokersNode: {
            default: [],
            type: [cc.Node]
        },

        noPokersNode: {
            default: [],
            type: [cc.Node]
        },

        historysListNode: {
            default: [],
            type: [cc.Node]
        },

        oddsLabel: cc.Node,

        pokerNameNode: cc.Node,

        pokerNoTouchLayer: cc.Node,

        options: "", //选项说明
        //势力
        powerFlag: true, //是否势力
        powerId: 0, //势力id
        pockers: [], //牌型
        historys: [], //胜负走势

        //投注项
        betFlag: true, //是否投注项
        betId: 0, //投注项id
        odds1: 1, //一阶段赔率
        odds2: 1, //二阶段赔率
        oddType: 0, //赔率变化类型  0-降低  1-上升  2-不变
        betStatus: 1, //是否可投注, 1-可投 0-不可投
        betNumTotal1: 0, //第一阶段总投注额
        betNumTotal2: 0, //第二阶段投注总额
        betNum: 0, //单次投注额，用于记录投注批次，失败的要退回来
        betList: [], //最后一次投注列表，用于投注，把所有投注项的这个数组收集起来就是真正的投注列表
        chipColor: 0, //筹码颜色  0-  1-  2-  3-
        ligthFlag: false, //投注项是否高亮

        //结算状态
        win: -1, //-1: 未开奖 1:胜利，0:负，2:平
        type: -1, //-1: 未开奖 0:散牌，1:散牌，2:对子，3：顺子，4:同花，5:同花顺，6:豹子
        pokerLight: [], //扑克高亮 空为全不亮， [0, 1, 2]全亮， [0, 2]亮两个

        //飞筹码
        chipPositions: [], //楼下5个筹码的相对位置
        playerPositions: [], //玩家头像相对位置，包括自己的（自己的筹码飞回）
        currentChipIndex: 0 },

    // use this for initialization
    onLoad: function onLoad() {
        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {}, this);

        this.node.on(cc.Node.EventType.TOUCH_END, function (event) {
            cc.log("TOUCH_END!!!");
            if (this.betFlag && this.betStatus) {
                //投注操作，回调到game去判断登录状态、余额等
                var onFunction = cc.find('Canvas').getComponent('game');

                if (onFunction.clearingFlag) {
                    onFunction.showToast("正在为您撤单，请稍后下单");
                } else {
                    onFunction.powerBet(this.addselfChip, this);
                }
            }
        }, this);
    },

    /**
     * 重置info，下一期开始时调用
     */
    resetInfo: function resetInfo() {
        this.pockers = [];
        this.oddType = 2;
        this.betStatus = 1;
        this.betNumTotal1 = 0;
        this.betNumTotal2 = 0;
        this.betNum = 0;
        this.betList = [];
        this.win = -1;
        this.types = -1;
        this.pokerLight = [];
        this.ligthFlag = false;

        //清空桌面筹码
        if (this.betFlag) {
            this.selfChipNode[0].active = false;
            this.selfChipNode[1].active = false;
        }

        for (var j = 0; j < this.noPokersNode.length; j++) {
            this.noPokersNode[j].active = true;
            this.noPokersNode[j].setScale(1, 1);
        }

        if (this.pokersNode.length) {
            this.pokersNode[2].y = -161;
            this.noPokersNode[2].y = 0;
        }
    },

    /**
     * 更新选项info
     * @param status 100-初始化   101-投注  102-清空投注  103-结算  104-获取二阶段数据
     */
    updataInfo: function updataInfo(status) {
        var netData = NetData.NetData.getInst();

        if (status == 100) {
            var initData = netData.initData;
            if (this.powerFlag) {
                if (initData.pockerList) {
                    for (var i = 0; i < initData.pockerList.length; ++i) {
                        if (this.powerId == initData.pockerList[i].powerId) {
                            //cc.log("this.powerId ", this.powerId);
                            if (initData.pockerList[i].pockers) {
                                this.pockers = initData.pockerList[i].pockers;
                                //cc.log("this.pockers", this.pockers);
                            }

                            this.historys = initData.pockerList[i].historys;
                            break;
                        }
                    }
                }
            }

            if (this.betFlag) {
                for (var _i = 0; _i < initData.oddsList.length; ++_i) {
                    if (this.betId == initData.oddsList[_i].id) {
                        cc.log("odds2 ", initData.oddsList[_i].odds2);
                        this.options = initData.oddsList[_i].option;
                        this.odds1 = initData.oddsList[_i].odds1;

                        if (initData.oddsList[_i].odds2) {
                            this.odds2 = initData.oddsList[_i].odds2;
                        } else {
                            this.odds2 = 0;
                        }

                        this.betStatus = initData.oddsList[_i].status;
                        break;
                    }
                }

                //投注额,用于恢复
                if (initData.bets) {
                    for (var _i2 = 0; _i2 < initData.bets.length; ++_i2) {
                        if (initData.bets[_i2].id == this.betId) {
                            if (initData.bets[_i2].timeFlag == 1) {
                                this.betNumTotal1 = initData.bets[_i2].totalBet;
                            } else {
                                this.betNumTotal2 = initData.bets[_i2].totalBet;
                            }
                        }
                    }
                }
            }
        } else if (status == 101) {} else if (status == 102) {
            if (netData.timeFlag == 1) {
                this.betNumTotal1 = 0;
            } else {
                this.betNumTotal2 = 0;
            }

            // betList = [];
        } else if (status == 103) {
            var rewardData = netData.rewardData;
            if (this.powerFlag) {
                var lottery = rewardData.lottery;
                //var idstring = "power"+ this.powerId;

                // var pockers = lottery.cache.idstring.pockers;
                //this.win = lottery.cache.idstring.win;
                //this.types = lottery.cache.idstring.types;
                //this.historys.pop();
                // this.historys.unshift(this.win);
                //this.pockers.push(pockers);


                for (var _i3 = 0; _i3 < lottery.cache.length; ++_i3) {
                    if (lottery.cache[_i3].powerId == this.powerId) {
                        this.win = lottery.cache[_i3].win;
                        this.historys.pop();
                        this.historys.unshift(this.win);

                        this.type = lottery.cache[_i3].type;
                        this.pockers.push(lottery.cache[_i3].pockers[0]);
                        //cc.log("103 pockers length is ", this.pockers.length);
                        //牌型高亮
                        this.pokerLight = [];
                        if (this.type === 0 || this.type == 1) {
                            //散牌，都不亮
                        } else if (this.type == 2) {
                            //对子
                            if (this.pockers[0].val == this.pockers[1].val) {
                                this.pokerLight = [0, 1];
                            } else if (this.pockers[0].val == this.pockers[2].val) {
                                this.pokerLight = [0, 2];
                            } else if (this.pockers[1].val == this.pockers[2].val) {
                                this.pokerLight = [1, 2];
                            }

                            /*
                            //对子投注项高亮
                            if(this.betId == 5){
                                this.ligthFlag = true;
                            }
                            */
                        } else if (this.type == 6) {
                            this.pokerLight = [0, 1, 2];
                            /*
                            //三同号投注项高亮
                            if(this.betId == 6){
                                this.ligthFlag = true;
                            }
                            */
                        } else {
                            this.pokerLight = [0, 1, 2];
                            /*
                            //其他牌型投注项高亮
                            if(this.betId == 7){
                                this.ligthFlag = true;
                            }
                            */
                        }
                        break;
                    }
                }
            }

            if (this.betFlag) {
                for (var _i4 = 0; _i4 < rewardData.oddsList.length; ++_i4) {
                    if (this.betId == rewardData.oddsList[_i4].id) {
                        //cc.log("odds2 ", rewardData.oddsList[i].odds2);
                        this.options = rewardData.oddsList[_i4].option;
                        this.odds1 = rewardData.oddsList[_i4].odds;
                        //this.odds2 = rewardData.oddsList.oddsMetaDatas[i].odds2;
                        this.betStatus = 1;
                        break;
                    }
                }
            }
        } else if (status == 104) {
            var secondData = netData.secondData;
            if (this.powerFlag) {
                for (var _i5 = 0; _i5 < secondData.pockerList.length; ++_i5) {
                    if (this.powerId == secondData.pockerList[_i5].powerId) {
                        this.pockers = secondData.pockerList[_i5].pockers;
                        break;
                    }
                }
            }

            if (this.betFlag) {
                for (var _i6 = 0; _i6 < secondData.oddsList.length; ++_i6) {
                    if (this.betId == secondData.oddsList[_i6].id) {
                        this.options = secondData.oddsList[_i6].option;
                        //这里判断一下赔率是变大变小
                        this.odds1 = secondData.oddsList[_i6].odds1;
                        if (secondData.oddsList[_i6].odds2) {
                            this.odds2 = secondData.oddsList[_i6].odds2;
                        } else {
                            this.odds2 = 0;
                        }

                        if (this.odds2 > this.odds1) {
                            this.oddType = 1;
                        } else if (this.odds2 < this.odds1) {
                            this.oddType = 0;
                        } else {
                            this.oddType = 2;
                        }

                        this.betStatus = secondData.oddsList[_i6].status;
                        break;
                    }
                }
            }
        }
    },

    //更新UI
    updataUI: function updataUI(status) {
        var _this = this;

        if (this.powerFlag) {
            // for(var j = 0; j < this.noPokersNode.length; j ++)
            // {
            //     this.noPokersNode[j].active = true;
            // }

            var netData = NetData.NetData.getInst();

            var _loop = function _loop(_i7) {
                //this.noPokersNode[i].active = false;
                pokerNum = _this.pokersNode[_i7].getChildByName("num").getComponent(cc.Label);
                num = "";

                if (_this.pockers[_i7].val == 1) {
                    num = "A";
                } else if (_this.pockers[_i7].val == 11) {
                    num = "J";
                } else if (_this.pockers[_i7].val == 12) {
                    num = "Q";
                } else if (_this.pockers[_i7].val == 13) {
                    num = "K";
                } else {
                    num = _this.pockers[_i7].val;
                }
                //cc.log("pocker num is ", num);
                pokerNum.string = num;

                pokerType = _this.pokersNode[_i7].getChildByName("type").getComponent(cc.Label);
                color = "";

                switch (_this.pockers[_i7].color) {
                    case 1:
                        {
                            color = "红桃";
                        }
                        break;
                    case 2:
                        {
                            color = "方片";
                        }
                        break;
                    case 3:
                        {
                            color = "黑桃";
                        }
                        break;
                    case 4:
                        {
                            color = "梅花";
                        }
                        break;
                }
                pokerType.string = color;
                //cc.log("pocker color is ", color);
                self = _this;
                //跑一个翻牌的动画

                if (_i7 <= 1) {

                    if (_this.noPokersNode[_i7].active) {
                        _this.noPokersNode[_i7].runAction(cc.sequence(cc.scaleTo(0.2, 0, 1), cc.callFunc(function () {
                            self.noPokersNode[_i7].active = false;
                        })));
                        _this.pokersNode[_i7].runAction(cc.sequence(cc.scaleTo(0.2, 0, 1), cc.scaleTo(0.2, 1)));
                    }
                } else {
                    //开奖阶段，要一个一个出结果，根据powerid计算时机
                    var delay = (_this.powerId - 1) * 1.0;
                    _this.scheduleOnce(function () {
                        if (self.noPokersNode[_i7].active) {
                            self.noPokersNode[_i7].runAction(cc.sequence(cc.moveTo(0.4, cc.v2(0, -161)), cc.callFunc(function () {
                                self.noPokersNode[_i7].y = 0;
                            })));
                            self.pokersNode[_i7].runAction(cc.sequence(cc.moveTo(0.4, cc.v2(0, 0)), cc.callFunc(self.putStampOnAction, self, self)));
                        }
                    }, delay);
                }
            };

            for (var _i7 = 0; _i7 < this.pockers.length; _i7++) {
                var pokerNum;
                var num;
                var pokerType;
                var color;
                var self;

                _loop(_i7);
            }
        }

        for (var i = 0; i < this.pokerLight.length; i++) {
            var index = this.pokerLight[i];
            //this.pukeHighLightNodeArray[index].active = true;
        }

        if (this.betFlag) {
            var netData = NetData.NetData.getInst();
            if (netData.timeFlag == 1) {
                this.oddsLabel.getComponent(cc.Label).string = this.odds1 + "倍";
                this.oddsLabel.color = new cc.Color(255, 255, 255);
            } else {
                this.oddsLabel.getComponent(cc.Label).string = this.odds2 + "倍";
                if (this.oddType == 0) {
                    this.oddsLabel.color = new cc.Color(255, 0, 0);
                } else if (this.oddType == 1) {
                    this.oddsLabel.color = new cc.Color(45, 67, 100);
                } else {
                    this.oddsLabel.color = new cc.Color(255, 255, 255);
                }
            }
        }

        if (this.powerFlag && this.powerId != 1) {
            for (var i = 0; i < this.historysListNode.length; i++) {
                var historyIconNode = this.historysListNode[i];
                if (this.historys[i] == 1) //胜
                    {
                        historyIconNode.color = new cc.Color(255, 0, 0);
                    } else if (this.historys[i] == 0) //负
                    {
                        historyIconNode.Color = new cc.Color(45, 67, 100);
                    } else //平
                    {
                        historyIconNode.Color = new cc.Color(255, 255, 255);
                    }
            }
        }

        if (this.betFlag && !this.powerFlag) {

            if (this.betStatus == 1) {
                this.pokerNoTouchLayer.active = false;
            } else {
                this.pokerNoTouchLayer.active = true;
            }

            if (this.ligthFlag == true) //中奖结果高亮
                {
                    this.betHighLightLayer.active = true;
                } else {
                this.betHighLightLayer.active = false;
            }
        }
    },

    //飞结果，盖戳
    putStampOnAction: function putStampOnAction(target, self) {
        if (self.powerId == 1) {
            return;
        }
        //cc.log("flyStamp!!!");
        var netData = NetData.NetData.getInst();
        var rewardData = netData.rewardData;
        var convertNode = cc.find("Canvas/convertNode");
        var convertNodeJS = convertNode.getComponent("convertNode");
        convertNodeJS.flyRewardNode(self.win, self.powerId);

        if (self.powerId == 2) {
            //10s收回
            self.scheduleOnce(self.getback, 5);
        }
    },

    getback: function getback() {
        var gameJS = cc.find("Canvas").getComponent("game");
        gameJS.rewardFlyFinishedCallback();
    },

    /**
     * 初始化筹码
     */
    initSelfChip: function initSelfChip(timeFlag, chipNum) {
        this.selfChipNode[timeFlag - 1].active = true;
        this.selfChipNode[timeFlag - 1].zIndex = 500;
        var label = this.selfChipNode[timeFlag - 1].getChildByName("Label").getComponent(cc.Label);
        label.string = chipNum;
    },

    /**
     * 恢复筹码飞回
     * @param chipNum 筹码量
     */
    resumeSelfChip: function resumeSelfChip(chipNum) {
        var netData = NetData.NetData.getInst();
        //计算哪个筹码最接近chipNum
        var chipIndex = 0;
        for (var i = 0; i < netData.initData.betList.length; ++i) {
            if (chipNum >= netData.initData.betList[i]) {
                chipIndex = i;
            }
        }

        //跑动画，目标位置是个固定值，一阶段和二阶段分别固定一个筹码位置
        //跑完动画后，更新投注额的label
        if (this.betFlag) {
            var convertNode = cc.find("Canvas/convertNode");
            var convertNodeJS = convertNode.getComponent("convertNode");
            convertNodeJS.chipFlyAction(chipNum, chipIndex, this.betId - 1, true, self);
        }
    },

    /**
     * 自己投注飞筹码
     * @param chipIndex 楼下筹码的index
     */
    addselfChip: function addselfChip(chipIndex, self) {
        self.currentChipIndex = chipIndex;
        var netData = NetData.NetData.getInst();
        var bet = netData.initData.betList[chipIndex];

        //投注总额变化
        if (netData.timeFlag == 1) {
            self.betNumTotal1 += bet;
        } else {
            self.betNumTotal2 += bet;
        }

        //检查是否已经存在该类型筹码
        var exitFlag = false;
        for (var i = 0; i < self.betList.length; ++i) {
            if (self.betList[i].bet == bet) {
                self.betList[i].num++;
                exitFlag = true;
                break;
            }
        }

        if (!exitFlag) {
            var obj = new Object();
            obj.id = self.betId;
            obj.bet = bet;
            obj.num = 1;
            if (netData.timeFlag == 1) {
                obj.odds = self.odds1;
            } else {
                obj.odds = self.odds2;
            }

            self.betList.push(obj);
        }

        //跑动画，目标位置是个固定值，一阶段和二阶段分别固定一个筹码位置
        //跑完动画后，更新投注额的label
        if (self.betFlag) {
            var convertNode = cc.find("Canvas/convertNode");
            var convertNodeJS = convertNode.getComponent("convertNode");
            convertNodeJS.chipFlyAction(bet, chipIndex, self.betId - 1, true, self);
        }
    },

    flyChipNodeFinished: function flyChipNodeFinished(sender, flag) {
        var flag = flag;
        var self = sender;
        var netData = NetData.NetData.getInst();
        var index = netData.timeFlag - 1;
        if (flag) {
            self.selfChipNode[index].active = flag;
            self.selfChipNode[index].zIndex = 500;
            var label = self.selfChipNode[index].getChildByName("Label").getComponent(cc.Label);
            if (netData.timeFlag == 1) {
                label.string = self.betNumTotal1;
            } else {
                label.string = self.betNumTotal2;
            }

            self.setSkinWithTag(self.currentChipIndex);
        }
    },

    /**
    * 设置筹码皮肤
    * @param tag 对应的筹码编号(20 50 100 500 1000 gray other) eg: 0 1 2 3 4 5 6
    */
    setSkinWithTag: function setSkinWithTag(tag) {
        var netData = NetData.NetData.getInst();
        if (netData.timeFlag == 1) {
            for (var i = 0; i < this.selfChip1SkineNode.length; i++) {
                if (tag == i) {
                    this.selfChip1SkineNode[i].activate = true;
                } else {
                    this.selfChip1SkineNode[i].activate = false;
                }
            }
        } else {
            for (var i = 0; i < this.selfChip1SkineNode.length; i++) {
                if (tag == i) {
                    this.selfChip1SkineNode[i].activate = true;
                } else {
                    this.selfChip1SkineNode[i].activate = false;
                }
            }
        }
    },

    /**
     * 自己筹码飞回
     * @param chipNum  飞回的筹码数额
     */
    reduceSelfChip: function reduceSelfChip() {
        var netData = NetData.NetData.getInst();
        if (netData.timeFlag == 1) {
            this.betNumTotal1 -= this.betNum;
        } else {
            this.betNumTotal2 -= this.betNum;
        }

        var ser = null;
        var totalMoney = "";
        if (netData.timeFlag == 1) {
            ser = this.selfChipNode[0];
            totalMoney = this.betNumTotal1;
        } else {
            ser = this.selfChipNode[1];
            totalMoney = this.betNumTotal2;
        }
        if (ser.active) {
            var flag = false;
            if (totalMoney > 0) {
                flag = true;
            }
            //先隐藏
            ser.active = flag;
            ser.zIndex = 500;
            var label = ser.getChildByName("Label").getComponent(cc.Label);
            label.string = totalMoney;

            //再找筹码飞
            var convertNode = cc.find("Canvas/convertNode");
            var convertNodeJS = convertNode.getComponent("convertNode");
            // var flag = false;
            // if(totalMoney>0)
            // {
            //     flag = true;
            // }
            convertNodeJS.chipFlyAction(this.betNum, this.currentChipIndex, this.betId - 1, flag, this);
        }
    },

    /**
     *  动作飞回来
     */
    flyBack: function flyBack() {
        this.clearSelfChip();
    },

    /**
     * 清空筹码
     */
    clearSelfChip: function clearSelfChip() {
        var netData = NetData.NetData.getInst();
        if (netData.timeFlag == 1) {
            this.betNum = this.betNumTotal1;
        } else {
            this.betNum = this.betNumTotal2;
        }
        this.reduceSelfChip();
    },

    /**
     * 其他玩家飞筹码
     * @param seatIndex 其他玩家座位号
     */
    addOtherChip: function addOtherChip(seatIndex) {}

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{"NetData":"NetData"}],"WaitScript":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f819ds8PopLZZ+dyHaJMjdF', 'WaitScript');
// Script/Tools/WaitScript.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {
        this.angle = 0;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        this.angle += dt * 360;

        if (this.angle > 360) {
            this.angle -= 360;
        }

        this.node.rotation = this.angle;
    }
});

cc._RFpop();
},{}],"aes":[function(require,module,exports){
"use strict";
cc._RFpush(module, '02d8bZs2vRKGJgbl2iiyPN7', 'aes');
// Script/network/aes/aes.js

"use strict";

var CryptoJS = require("./core");require("../aes/md5");require("../aes/enc-base64");require("../aes/evpkdf");require("../aes/cipher-core");require("../aes/mode-ecb");(function () {
  var C = CryptoJS;var C_lib = C.lib;var BlockCipher = C_lib.BlockCipher;var C_algo = C.algo;var SBOX = [];var INV_SBOX = [];var SUB_MIX_0 = [];var SUB_MIX_1 = [];var SUB_MIX_2 = [];var SUB_MIX_3 = [];var INV_SUB_MIX_0 = [];var INV_SUB_MIX_1 = [];var INV_SUB_MIX_2 = [];var INV_SUB_MIX_3 = [];(function () {
    var d = [];for (var i = 0; i < 256; i++) {
      if (i < 128) {
        d[i] = i << 1;
      } else {
        d[i] = i << 1 ^ 283;
      }
    }var x = 0;var xi = 0;for (var i = 0; i < 256; i++) {
      var sx = xi ^ xi << 1 ^ xi << 2 ^ xi << 3 ^ xi << 4;sx = sx >>> 8 ^ sx & 255 ^ 99;SBOX[x] = sx;INV_SBOX[sx] = x;var x2 = d[x];var x4 = d[x2];var x8 = d[x4];var t = d[sx] * 257 ^ sx * 16843008;SUB_MIX_0[x] = t << 24 | t >>> 8;SUB_MIX_1[x] = t << 16 | t >>> 16;SUB_MIX_2[x] = t << 8 | t >>> 24;SUB_MIX_3[x] = t;var t = x8 * 16843009 ^ x4 * 65537 ^ x2 * 257 ^ x * 16843008;INV_SUB_MIX_0[sx] = t << 24 | t >>> 8;INV_SUB_MIX_1[sx] = t << 16 | t >>> 16;INV_SUB_MIX_2[sx] = t << 8 | t >>> 24;INV_SUB_MIX_3[sx] = t;if (!x) {
        x = xi = 1;
      } else {
        x = x2 ^ d[d[d[x8 ^ x2]]];xi ^= d[d[xi]];
      }
    }
  })();var RCON = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54];var AES = C_algo.AES = BlockCipher.extend({ _doReset: function _doReset() {
      var key = this._key;var keyWords = key.words;var keySize = key.sigBytes / 4;var nRounds = this._nRounds = keySize + 6;var ksRows = (nRounds + 1) * 4;var keySchedule = this._keySchedule = [];for (var ksRow = 0; ksRow < ksRows; ksRow++) {
        if (ksRow < keySize) {
          keySchedule[ksRow] = keyWords[ksRow];
        } else {
          var t = keySchedule[ksRow - 1];if (!(ksRow % keySize)) {
            t = t << 8 | t >>> 24;t = SBOX[t >>> 24] << 24 | SBOX[t >>> 16 & 255] << 16 | SBOX[t >>> 8 & 255] << 8 | SBOX[t & 255];t ^= RCON[ksRow / keySize | 0] << 24;
          } else {
            if (keySize > 6 && ksRow % keySize == 4) {
              t = SBOX[t >>> 24] << 24 | SBOX[t >>> 16 & 255] << 16 | SBOX[t >>> 8 & 255] << 8 | SBOX[t & 255];
            }
          }keySchedule[ksRow] = keySchedule[ksRow - keySize] ^ t;
        }
      }var invKeySchedule = this._invKeySchedule = [];for (var invKsRow = 0; invKsRow < ksRows; invKsRow++) {
        var ksRow = ksRows - invKsRow;if (invKsRow % 4) {
          var t = keySchedule[ksRow];
        } else {
          var t = keySchedule[ksRow - 4];
        }if (invKsRow < 4 || ksRow <= 4) {
          invKeySchedule[invKsRow] = t;
        } else {
          invKeySchedule[invKsRow] = INV_SUB_MIX_0[SBOX[t >>> 24]] ^ INV_SUB_MIX_1[SBOX[t >>> 16 & 255]] ^ INV_SUB_MIX_2[SBOX[t >>> 8 & 255]] ^ INV_SUB_MIX_3[SBOX[t & 255]];
        }
      }
    }, encryptBlock: function encryptBlock(M, offset) {
      this._doCryptBlock(M, offset, this._keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX);
    }, decryptBlock: function decryptBlock(M, offset) {
      var t = M[offset + 1];M[offset + 1] = M[offset + 3];M[offset + 3] = t;this._doCryptBlock(M, offset, this._invKeySchedule, INV_SUB_MIX_0, INV_SUB_MIX_1, INV_SUB_MIX_2, INV_SUB_MIX_3, INV_SBOX);var t = M[offset + 1];M[offset + 1] = M[offset + 3];M[offset + 3] = t;
    }, _doCryptBlock: function _doCryptBlock(M, offset, keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX) {
      var nRounds = this._nRounds;var s0 = M[offset] ^ keySchedule[0];var s1 = M[offset + 1] ^ keySchedule[1];var s2 = M[offset + 2] ^ keySchedule[2];var s3 = M[offset + 3] ^ keySchedule[3];var ksRow = 4;for (var round = 1; round < nRounds; round++) {
        var t0 = SUB_MIX_0[s0 >>> 24] ^ SUB_MIX_1[s1 >>> 16 & 255] ^ SUB_MIX_2[s2 >>> 8 & 255] ^ SUB_MIX_3[s3 & 255] ^ keySchedule[ksRow++];var t1 = SUB_MIX_0[s1 >>> 24] ^ SUB_MIX_1[s2 >>> 16 & 255] ^ SUB_MIX_2[s3 >>> 8 & 255] ^ SUB_MIX_3[s0 & 255] ^ keySchedule[ksRow++];var t2 = SUB_MIX_0[s2 >>> 24] ^ SUB_MIX_1[s3 >>> 16 & 255] ^ SUB_MIX_2[s0 >>> 8 & 255] ^ SUB_MIX_3[s1 & 255] ^ keySchedule[ksRow++];var t3 = SUB_MIX_0[s3 >>> 24] ^ SUB_MIX_1[s0 >>> 16 & 255] ^ SUB_MIX_2[s1 >>> 8 & 255] ^ SUB_MIX_3[s2 & 255] ^ keySchedule[ksRow++];s0 = t0;s1 = t1;s2 = t2;s3 = t3;
      }var t0 = (SBOX[s0 >>> 24] << 24 | SBOX[s1 >>> 16 & 255] << 16 | SBOX[s2 >>> 8 & 255] << 8 | SBOX[s3 & 255]) ^ keySchedule[ksRow++];var t1 = (SBOX[s1 >>> 24] << 24 | SBOX[s2 >>> 16 & 255] << 16 | SBOX[s3 >>> 8 & 255] << 8 | SBOX[s0 & 255]) ^ keySchedule[ksRow++];var t2 = (SBOX[s2 >>> 24] << 24 | SBOX[s3 >>> 16 & 255] << 16 | SBOX[s0 >>> 8 & 255] << 8 | SBOX[s1 & 255]) ^ keySchedule[ksRow++];var t3 = (SBOX[s3 >>> 24] << 24 | SBOX[s0 >>> 16 & 255] << 16 | SBOX[s1 >>> 8 & 255] << 8 | SBOX[s2 & 255]) ^ keySchedule[ksRow++];M[offset] = t0;M[offset + 1] = t1;M[offset + 2] = t2;M[offset + 3] = t3;
    }, keySize: 256 / 32 });C.AES = BlockCipher._createHelper(AES);
})();

cc._RFpop();
},{"../aes/cipher-core":"cipher-core","../aes/enc-base64":"enc-base64","../aes/evpkdf":"evpkdf","../aes/md5":"md5","../aes/mode-ecb":"mode-ecb","./core":"core"}],"cipher-core":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7009oc2wJMlbzy3sUEYXQR', 'cipher-core');
// Script/network/aes/cipher-core.js

"use strict";

var CryptoJS = require("./core");CryptoJS.lib.Cipher || function (undefined) {
    var C = CryptoJS;var C_lib = C.lib;var Base = C_lib.Base;var WordArray = C_lib.WordArray;var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm;var C_enc = C.enc;var Utf8 = C_enc.Utf8;var Base64 = C_enc.Base64;var C_algo = C.algo;var EvpKDF = C_algo.EvpKDF;var Cipher = C_lib.Cipher = BufferedBlockAlgorithm.extend({ cfg: Base.extend(), createEncryptor: function createEncryptor(key, cfg) {
            return this.create(this._ENC_XFORM_MODE, key, cfg);
        }, createDecryptor: function createDecryptor(key, cfg) {
            return this.create(this._DEC_XFORM_MODE, key, cfg);
        }, init: function init(xformMode, key, cfg) {
            this.cfg = this.cfg.extend(cfg);this._xformMode = xformMode;this._key = key;this.reset();
        }, reset: function reset() {
            BufferedBlockAlgorithm.reset.call(this);this._doReset();
        }, process: function process(dataUpdate) {
            this._append(dataUpdate);return this._process();
        }, finalize: function finalize(dataUpdate) {
            if (dataUpdate) {
                this._append(dataUpdate);
            }var finalProcessedData = this._doFinalize();return finalProcessedData;
        }, keySize: 128 / 32, ivSize: 128 / 32, _ENC_XFORM_MODE: 1, _DEC_XFORM_MODE: 2, _createHelper: function () {
            function selectCipherStrategy(key) {
                if (typeof key == "string") {
                    return PasswordBasedCipher;
                } else {
                    return SerializableCipher;
                }
            }return function (cipher) {
                return { encrypt: function encrypt(message, key, cfg) {
                        return selectCipherStrategy(key).encrypt(cipher, message, key, cfg);
                    }, decrypt: function decrypt(ciphertext, key, cfg) {
                        return selectCipherStrategy(key).decrypt(cipher, ciphertext, key, cfg);
                    } };
            };
        }() });var StreamCipher = C_lib.StreamCipher = Cipher.extend({ _doFinalize: function _doFinalize() {
            var finalProcessedBlocks = this._process(!!"flush");return finalProcessedBlocks;
        }, blockSize: 1 });var C_mode = C.mode = {};var BlockCipherMode = C_lib.BlockCipherMode = Base.extend({ createEncryptor: function createEncryptor(cipher, iv) {
            return this.Encryptor.create(cipher, iv);
        }, createDecryptor: function createDecryptor(cipher, iv) {
            return this.Decryptor.create(cipher, iv);
        }, init: function init(cipher, iv) {
            this._cipher = cipher;this._iv = iv;
        } });var CBC = C_mode.CBC = function () {
        var CBC = BlockCipherMode.extend();CBC.Encryptor = CBC.extend({ processBlock: function processBlock(words, offset) {
                var cipher = this._cipher;var blockSize = cipher.blockSize;xorBlock.call(this, words, offset, blockSize);cipher.encryptBlock(words, offset);this._prevBlock = words.slice(offset, offset + blockSize);
            } });CBC.Decryptor = CBC.extend({ processBlock: function processBlock(words, offset) {
                var cipher = this._cipher;var blockSize = cipher.blockSize;var thisBlock = words.slice(offset, offset + blockSize);cipher.decryptBlock(words, offset);xorBlock.call(this, words, offset, blockSize);this._prevBlock = thisBlock;
            } });function xorBlock(words, offset, blockSize) {
            var iv = this._iv;if (iv) {
                var block = iv;this._iv = undefined;
            } else {
                var block = this._prevBlock;
            }for (var i = 0; i < blockSize; i++) {
                words[offset + i] ^= block[i];
            }
        }return CBC;
    }();var C_pad = C.pad = {};var Pkcs7 = C_pad.Pkcs7 = { pad: function pad(data, blockSize) {
            var blockSizeBytes = blockSize * 4;var nPaddingBytes = blockSizeBytes - data.sigBytes % blockSizeBytes;var paddingWord = nPaddingBytes << 24 | nPaddingBytes << 16 | nPaddingBytes << 8 | nPaddingBytes;var paddingWords = [];for (var i = 0; i < nPaddingBytes; i += 4) {
                paddingWords.push(paddingWord);
            }var padding = WordArray.create(paddingWords, nPaddingBytes);data.concat(padding);
        }, unpad: function unpad(data) {
            var nPaddingBytes = data.words[data.sigBytes - 1 >>> 2] & 255;data.sigBytes -= nPaddingBytes;
        } };var BlockCipher = C_lib.BlockCipher = Cipher.extend({ cfg: Cipher.cfg.extend({ mode: CBC, padding: Pkcs7 }), reset: function reset() {
            Cipher.reset.call(this);var cfg = this.cfg;var iv = cfg.iv;var mode = cfg.mode;if (this._xformMode == this._ENC_XFORM_MODE) {
                var modeCreator = mode.createEncryptor;
            } else {
                var modeCreator = mode.createDecryptor;this._minBufferSize = 1;
            }this._mode = modeCreator.call(mode, this, iv && iv.words);
        }, _doProcessBlock: function _doProcessBlock(words, offset) {
            this._mode.processBlock(words, offset);
        }, _doFinalize: function _doFinalize() {
            var padding = this.cfg.padding;if (this._xformMode == this._ENC_XFORM_MODE) {
                padding.pad(this._data, this.blockSize);var finalProcessedBlocks = this._process(!!"flush");
            } else {
                var finalProcessedBlocks = this._process(!!"flush");padding.unpad(finalProcessedBlocks);
            }return finalProcessedBlocks;
        }, blockSize: 128 / 32 });var CipherParams = C_lib.CipherParams = Base.extend({ init: function init(cipherParams) {
            this.mixIn(cipherParams);
        }, toString: function toString(formatter) {
            return (formatter || this.formatter).stringify(this);
        } });var C_format = C.format = {};var OpenSSLFormatter = C_format.OpenSSL = { stringify: function stringify(cipherParams) {
            var ciphertext = cipherParams.ciphertext;var salt = cipherParams.salt;if (salt) {
                var wordArray = WordArray.create([1398893684, 1701076831]).concat(salt).concat(ciphertext);
            } else {
                var wordArray = ciphertext;
            }return wordArray.toString(Base64);
        }, parse: function parse(openSSLStr) {
            var ciphertext = Base64.parse(openSSLStr);var ciphertextWords = ciphertext.words;if (ciphertextWords[0] == 1398893684 && ciphertextWords[1] == 1701076831) {
                var salt = WordArray.create(ciphertextWords.slice(2, 4));ciphertextWords.splice(0, 4);ciphertext.sigBytes -= 16;
            }return CipherParams.create({ ciphertext: ciphertext, salt: salt });
        } };var SerializableCipher = C_lib.SerializableCipher = Base.extend({ cfg: Base.extend({ format: OpenSSLFormatter }), encrypt: function encrypt(cipher, message, key, cfg) {
            cfg = this.cfg.extend(cfg);
            var encryptor = cipher.createEncryptor(key, cfg);var ciphertext = encryptor.finalize(message);var cipherCfg = encryptor.cfg;return CipherParams.create({ ciphertext: ciphertext, key: key, iv: cipherCfg.iv, algorithm: cipher, mode: cipherCfg.mode, padding: cipherCfg.padding, blockSize: cipher.blockSize, formatter: cfg.format });
        }, decrypt: function decrypt(cipher, ciphertext, key, cfg) {
            cfg = this.cfg.extend(cfg);ciphertext = this._parse(ciphertext, cfg.format);var plaintext = cipher.createDecryptor(key, cfg).finalize(ciphertext.ciphertext);return plaintext;
        }, _parse: function _parse(ciphertext, format) {
            if (typeof ciphertext == "string") {
                return format.parse(ciphertext, this);
            } else {
                return ciphertext;
            }
        } });var C_kdf = C.kdf = {};var OpenSSLKdf = C_kdf.OpenSSL = { execute: function execute(password, keySize, ivSize, salt) {
            if (!salt) {
                salt = WordArray.random(64 / 8);
            }var key = EvpKDF.create({ keySize: keySize + ivSize }).compute(password, salt);var iv = WordArray.create(key.words.slice(keySize), ivSize * 4);key.sigBytes = keySize * 4;return CipherParams.create({ key: key, iv: iv, salt: salt });
        } };var PasswordBasedCipher = C_lib.PasswordBasedCipher = SerializableCipher.extend({ cfg: SerializableCipher.cfg.extend({ kdf: OpenSSLKdf }), encrypt: function encrypt(cipher, message, password, cfg) {
            cfg = this.cfg.extend(cfg);var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize);cfg.iv = derivedParams.iv;var ciphertext = SerializableCipher.encrypt.call(this, cipher, message, derivedParams.key, cfg);ciphertext.mixIn(derivedParams);return ciphertext;
        }, decrypt: function decrypt(cipher, ciphertext, password, cfg) {
            cfg = this.cfg.extend(cfg);ciphertext = this._parse(ciphertext, cfg.format);var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize, ciphertext.salt);cfg.iv = derivedParams.iv;var plaintext = SerializableCipher.decrypt.call(this, cipher, ciphertext, derivedParams.key, cfg);return plaintext;
        } });
}();

cc._RFpop();
},{"./core":"core"}],"convertNode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '52d79u8vuROVY3yrhoo8aXz', 'convertNode');
// Script/convertNode.js

"use strict";

var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    properties: {

        flyChipNode: cc.Prefab,

        homePosition: {
            default: [],
            type: [cc.Vec2]
        },

        targetLocation1: {
            default: [],
            type: [cc.Vec2]
        },

        targetLocation2: {
            default: [],
            type: [cc.Vec2]
        },

        flyChipNodeArray: {
            default: [],
            type: [cc.Node]
        },

        //rewardFlyNode: cc.Prefab,

        rewardFlyNodeTargetLocation: {
            default: [],
            type: [cc.Vec2]
        },

        rewardFlyNodeHomePosition: cc.Vec2,
        rewardFlyNodeInistantArray: {
            default: [],
            type: cc.Node
        },

        markFlyRewardCnt: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},

    chipFlyAction: function chipFlyAction(chipNum, chipIndex, betId, flag, powerTarget) {
        var netData = NetData.NetData.getInst();
        var homep = this.homePosition[chipIndex];

        var targetP = null;
        if (netData.timeFlag == 1) {
            targetP = this.targetLocation1[betId];
        } else {
            targetP = this.targetLocation2[betId];
        }

        var flyNode = this.getFlyChipNode();
        var flyNodeJS = flyNode.getComponent("flyChipNodePre");

        flyNodeJS.setSkinWithTag(chipIndex);
        flyNodeJS.setMoney(chipNum);
        flyNodeJS.chipFlyAction(homep, targetP, flag, flyNode, powerTarget, this, this.finishedCallback);
    },

    getFlyChipNode: function getFlyChipNode() {
        var flyNode = null;
        if (this.flyChipNodeArray.length > 0) {
            flyNode = this.flyChipNodeArray.shift();
            flyNode.active = true;
            return flyNode;
        }

        flyNode = cc.instantiate(this.flyChipNode);
        this.node.addChild(flyNode);
        flyNode.active = true;
        return flyNode;
    },

    setFlyChipNode: function setFlyChipNode(flynode) {
        this.flyChipNodeArray.push(flynode);
        flynode.active = false;
    },

    finishedCallback: function finishedCallback(target, object) {
        var powerTarget = object.powerTarget;
        var flag = object.flag;
        var self = object.target;
        var flynode = object.flyNode;

        self.setFlyChipNode(flynode);
        powerTarget.flyChipNodeFinished(powerTarget, flag);

        object = null;
    },

    //index: 0负 1胜  2平
    flyRewardNode: function flyRewardNode(index, positionIndex) {
        var flyNode = this.rewardFlyNodeInistantArray[positionIndex - 2];
        // if(this.rewardFlyNodeInistantArray.length)
        // {
        //     flyNode = this.rewardFlyNodeInistantArray.shift();
        // }
        // else
        // {
        //     flyNode = cc.instantiate(rewardFlyNode);
        //     this.node.addChild(flyNode);
        //     this.rewardFlyNodeInistantArray.push(flyNode);
        // }

        flyNode.active = true;
        var flyNodeJS = flyNode.getComponent("flyRewardNodePre");
        flyNodeJS.setSkin(index);
        var p1 = this.rewardFlyNodeHomePosition;
        var p2 = this.rewardFlyNodeTargetLocation[positionIndex - 2];
        flyNodeJS.flyRewardAction(p1, p2);
    },

    flyRewardActionFinished: function flyRewardActionFinished() {
        /*
        this.markFlyRewardCnt ++;
        if(this.markFlyRewardCnt == 4)
        {
            for(var i = 0; i < this.rewardFlyNodeInistantArray.length; i ++)
            {
                this.rewardFlyNodeInistantArray[i].active = false;
            }
        }
        */
        for (var i = 0; i < this.rewardFlyNodeInistantArray.length; i++) {
            this.rewardFlyNodeInistantArray[i].active = false;
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{"NetData":"NetData"}],"core":[function(require,module,exports){
"use strict";
cc._RFpush(module, '572fe/2x+JCKIyUCoP5avyE', 'core');
// Script/network/aes/core.js

"use strict";

var CryptoJS = CryptoJS || function (Math, undefined) {
    var C = {};var C_lib = C.lib = {};var Base = C_lib.Base = function () {
        function F() {}return { extend: function extend(overrides) {
                F.prototype = this;var subtype = new F();if (overrides) {
                    subtype.mixIn(overrides);
                }if (!subtype.hasOwnProperty("init")) {
                    subtype.init = function () {
                        subtype.$super.init.apply(this, arguments);
                    };
                }subtype.init.prototype = subtype;subtype.$super = this;return subtype;
            }, create: function create() {
                var instance = this.extend();instance.init.apply(instance, arguments);return instance;
            }, init: function init() {}, mixIn: function mixIn(properties) {
                for (var propertyName in properties) {
                    if (properties.hasOwnProperty(propertyName)) {
                        this[propertyName] = properties[propertyName];
                    }
                }if (properties.hasOwnProperty("toString")) {
                    this.toString = properties.toString;
                }
            }, clone: function clone() {
                return this.init.prototype.extend(this);
            } };
    }();var WordArray = C_lib.WordArray = Base.extend({ init: function init(words, sigBytes) {
            words = this.words = words || [];if (sigBytes != undefined) {
                this.sigBytes = sigBytes;
            } else {
                this.sigBytes = words.length * 4;
            }
        }, toString: function toString(encoder) {
            return (encoder || Hex).stringify(this);
        }, concat: function concat(wordArray) {
            var thisWords = this.words;var thatWords = wordArray.words;var thisSigBytes = this.sigBytes;var thatSigBytes = wordArray.sigBytes;this.clamp();if (thisSigBytes % 4) {
                for (var i = 0; i < thatSigBytes; i++) {
                    var thatByte = thatWords[i >>> 2] >>> 24 - i % 4 * 8 & 255;thisWords[thisSigBytes + i >>> 2] |= thatByte << 24 - (thisSigBytes + i) % 4 * 8;
                }
            } else {
                for (var i = 0; i < thatSigBytes; i += 4) {
                    thisWords[thisSigBytes + i >>> 2] = thatWords[i >>> 2];
                }
            }this.sigBytes += thatSigBytes;return this;
        }, clamp: function clamp() {
            var words = this.words;var sigBytes = this.sigBytes;words[sigBytes >>> 2] &= 4294967295 << 32 - sigBytes % 4 * 8;words.length = Math.ceil(sigBytes / 4);
        }, clone: function clone() {
            var clone = Base.clone.call(this);clone.words = this.words.slice(0);return clone;
        }, random: function random(nBytes) {
            var words = [];var r = function r(m_w) {
                var m_w = m_w;var m_z = 987654321;var mask = 4294967295;return function () {
                    m_z = 36969 * (m_z & 65535) + (m_z >> 16) & mask;m_w = 18000 * (m_w & 65535) + (m_w >> 16) & mask;var result = (m_z << 16) + m_w & mask;result /= 4294967296;result += 0.5;return result * (Math.random() > 0.5 ? 1 : -1);
                };
            };for (var i = 0, rcache; i < nBytes; i += 4) {
                var _r = r((rcache || Math.random()) * 4294967296);rcache = _r() * 987654071;words.push(_r() * 4294967296 | 0);
            }return new WordArray.init(words, nBytes);
        } });var C_enc = C.enc = {};var Hex = C_enc.Hex = { stringify: function stringify(wordArray) {
            var words = wordArray.words;var sigBytes = wordArray.sigBytes;var hexChars = [];for (var i = 0; i < sigBytes; i++) {
                var bite = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;hexChars.push((bite >>> 4).toString(16));hexChars.push((bite & 15).toString(16));
            }return hexChars.join("");
        }, parse: function parse(hexStr) {
            var hexStrLength = hexStr.length;var words = [];for (var i = 0; i < hexStrLength; i += 2) {
                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << 24 - i % 8 * 4;
            }return new WordArray.init(words, hexStrLength / 2);
        } };var Latin1 = C_enc.Latin1 = { stringify: function stringify(wordArray) {
            var words = wordArray.words;var sigBytes = wordArray.sigBytes;var latin1Chars = [];for (var i = 0; i < sigBytes; i++) {
                var bite = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;latin1Chars.push(String.fromCharCode(bite));
            }return latin1Chars.join("");
        }, parse: function parse(latin1Str) {
            var latin1StrLength = latin1Str.length;var words = [];for (var i = 0; i < latin1StrLength; i++) {
                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 255) << 24 - i % 4 * 8;
            }return new WordArray.init(words, latin1StrLength);
        } };var Utf8 = C_enc.Utf8 = { stringify: function stringify(wordArray) {
            try {
                return decodeURIComponent(escape(Latin1.stringify(wordArray)));
            } catch (e) {
                throw new Error("Malformed UTF-8 data");
            }
        }, parse: function parse(utf8Str) {
            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));
        } };var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({ reset: function reset() {
            this._data = new WordArray.init();this._nDataBytes = 0;
        }, _append: function _append(data) {
            if (typeof data == "string") {
                data = Utf8.parse(data);
            }this._data.concat(data);this._nDataBytes += data.sigBytes;
        }, _process: function _process(doFlush) {
            var data = this._data;var dataWords = data.words;var dataSigBytes = data.sigBytes;var blockSize = this.blockSize;var blockSizeBytes = blockSize * 4;var nBlocksReady = dataSigBytes / blockSizeBytes;if (doFlush) {
                nBlocksReady = Math.ceil(nBlocksReady);
            } else {
                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);
            }var nWordsReady = nBlocksReady * blockSize;var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);if (nWordsReady) {
                for (var offset = 0; offset < nWordsReady; offset += blockSize) {
                    this._doProcessBlock(dataWords, offset);
                }var processedWords = dataWords.splice(0, nWordsReady);data.sigBytes -= nBytesReady;
            }return new WordArray.init(processedWords, nBytesReady);
        }, clone: function clone() {
            var clone = Base.clone.call(this);clone._data = this._data.clone();return clone;
        }, _minBufferSize: 0 });var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({ cfg: Base.extend(), init: function init(cfg) {
            this.cfg = this.cfg.extend(cfg);this.reset();
        }, reset: function reset() {
            BufferedBlockAlgorithm.reset.call(this);this._doReset();
        }, update: function update(messageUpdate) {
            this._append(messageUpdate);this._process();return this;
        }, finalize: function finalize(messageUpdate) {
            if (messageUpdate) {
                this._append(messageUpdate);
            }var hash = this._doFinalize();
            return hash;
        }, blockSize: 512 / 32, _createHelper: function _createHelper(hasher) {
            return function (message, cfg) {
                return new hasher.init(cfg).finalize(message);
            };
        }, _createHmacHelper: function _createHmacHelper(hasher) {
            return function (message, key) {
                return new C_algo.HMAC.init(hasher, key).finalize(message);
            };
        } });var C_algo = C.algo = {};return C;
}(Math);module.exports = CryptoJS;

cc._RFpop();
},{}],"enc-base64":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0f5e3DWxj5ADaF0mRNcqcyU', 'enc-base64');
// Script/network/aes/enc-base64.js

"use strict";

var CryptoJS = require("./core");(function () {
  var C = CryptoJS;var C_lib = C.lib;var WordArray = C_lib.WordArray;var C_enc = C.enc;var Base64 = C_enc.Base64 = { stringify: function stringify(wordArray) {
      var words = wordArray.words;var sigBytes = wordArray.sigBytes;var map = this._map;wordArray.clamp();var base64Chars = [];for (var i = 0; i < sigBytes; i += 3) {
        var byte1 = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;var byte2 = words[i + 1 >>> 2] >>> 24 - (i + 1) % 4 * 8 & 255;var byte3 = words[i + 2 >>> 2] >>> 24 - (i + 2) % 4 * 8 & 255;var triplet = byte1 << 16 | byte2 << 8 | byte3;for (var j = 0; j < 4 && i + j * 0.75 < sigBytes; j++) {
          base64Chars.push(map.charAt(triplet >>> 6 * (3 - j) & 63));
        }
      }var paddingChar = map.charAt(64);if (paddingChar) {
        while (base64Chars.length % 4) {
          base64Chars.push(paddingChar);
        }
      }return base64Chars.join("");
    }, parse: function parse(base64Str) {
      var base64StrLength = base64Str.length;var map = this._map;var paddingChar = map.charAt(64);if (paddingChar) {
        var paddingIndex = base64Str.indexOf(paddingChar);if (paddingIndex != -1) {
          base64StrLength = paddingIndex;
        }
      }var words = [];var nBytes = 0;for (var i = 0; i < base64StrLength; i++) {
        if (i % 4) {
          var bits1 = map.indexOf(base64Str.charAt(i - 1)) << i % 4 * 2;var bits2 = map.indexOf(base64Str.charAt(i)) >>> 6 - i % 4 * 2;var bitsCombined = bits1 | bits2;words[nBytes >>> 2] |= bitsCombined << 24 - nBytes % 4 * 8;nBytes++;
        }
      }return WordArray.create(words, nBytes);
    }, _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=" };
})();

cc._RFpop();
},{"./core":"core"}],"errorDialog":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a5cchPFopKmrHUbPd5bRLY', 'errorDialog');
// Script/Tools/errorDialog.js

'use strict';

var EbuttonTag = cc.Enum({

    eSkinFresh: 0,
    eSkinOK: 1,
    eSkinCannel: 2,
    eSkin3: 3,
    eSkin4: 4,
    eSkin5: 5,
    eSkin6: 6

});
cc.Class({
    extends: cc.Component,

    properties: {
        leftButton: cc.Node,
        rightButton: cc.Node,
        title: cc.Label,
        leftSkinArray: {
            default: [],
            type: [cc.Node]
        },
        leftTitle: cc.Label,
        rightSkinArray: {
            default: [],
            type: [cc.Node]
        },
        rightTitle: cc.Label,
        typeAction: 0

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.leftButton.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.leftButton.scale = 0.8;
        }, this);

        this.leftButton.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.leftButton.scale = 1;
            var gameFun = cc.find('Canvas').getComponent('game');
            gameFun.errorDialogCallback(this.typeAction, 1);
        }, this);

        this.leftButton.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            this.leftButton.scale = 1;
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.rightButton.scale = 0.8;
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.rightButton.scale = 1;
            var onFunction = cc.find('Canvas').getComponent('game');
            onFunction.errorDialogCallback(this.typeAction, 2);
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            this.rightButton.scale = 1;
        }, this);
    },

    showDialog: function showDialog(title, buttonType) {
        this.typeAction = buttonType;
        this.node.active = true;
        this.resetzIndexZreo();
        this.title.string = title;

        if (buttonType === 0) //刷新
            {
                this.leftButton.x = 0;
                this.leftButton.y = 0;
                this.rightButton.active = false;
                this.leftSkinArray[0].zIndex = 20;
                this.leftIndex = 0;
                this.rightIndex = -1;
            } else if (buttonType == 1) //等等再走 不玩了
            {
                this.leftButton.x = -160;
                this.leftButton.y = -100;
                this.rightButton.active = true;
                this.leftSkinArray[1].zIndex = 20;
                this.rightSkinArray[1].zIndex = 20;
            } else if (buttonType == 2) //
            {
                this.leftButton.x = -160;
                this.leftButton.y = -100;
                this.rightButton.active = true;
                this.leftSkinArray[2].zIndex = 20;
                this.rightSkinArray[2].zIndex = 20;
            }
    },

    hideDialog: function hideDialog() {
        this.node.active = false;
    },

    resetzIndexZreo: function resetzIndexZreo() {
        for (var i = 0; i < this.leftSkinArray.length; i++) {
            this.leftSkinArray[i].zIndex = 0;
        }

        for (var j = 0; j < this.rightSkinArray.length; j++) {
            this.rightSkinArray[j].zIndex = 0;
        }
    }

});

cc._RFpop();
},{}],"evpkdf":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'aa885BKH39D3pF0VusgBsiO', 'evpkdf');
// Script/network/aes/evpkdf.js

"use strict";

var CryptoJS = require("./core");(function () {
  var C = CryptoJS;var C_lib = C.lib;var Base = C_lib.Base;var WordArray = C_lib.WordArray;var C_algo = C.algo;var MD5 = C_algo.MD5;var EvpKDF = C_algo.EvpKDF = Base.extend({ cfg: Base.extend({ keySize: 128 / 32, hasher: MD5, iterations: 1 }), init: function init(cfg) {
      this.cfg = this.cfg.extend(cfg);
    }, compute: function compute(password, salt) {
      var cfg = this.cfg;var hasher = cfg.hasher.create();var derivedKey = WordArray.create();var derivedKeyWords = derivedKey.words;var keySize = cfg.keySize;var iterations = cfg.iterations;while (derivedKeyWords.length < keySize) {
        if (block) {
          hasher.update(block);
        }var block = hasher.update(password).finalize(salt);hasher.reset();for (var i = 1; i < iterations; i++) {
          block = hasher.finalize(block);hasher.reset();
        }derivedKey.concat(block);
      }derivedKey.sigBytes = keySize * 4;return derivedKey;
    } });C.EvpKDF = function (password, salt, cfg) {
    return EvpKDF.create(cfg).compute(password, salt);
  };
})();

cc._RFpop();
},{"./core":"core"}],"flyChipNodePre":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a48faS/teNMq5rWcxyKMFdi', 'flyChipNodePre');
// Script/flyChipNodePre.js

"use strict";

var ESkinTag = cc.Enum({

    eChip20: 0,
    eChip50: 1,
    eChip100: 2,
    eChip500: 3,
    eChip1000: 4,
    eGaryChip: 5,
    eOtherChip: 6

});

cc.Class({
    extends: cc.Component,

    properties: {
        //20 50 100 500 1000 gray other
        chipSkinNodeArray: {
            default: [],
            type: [cc.Node]
        },
        moneyLabel: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {},

    /**
     * 设置筹码皮肤
     * @param tag 对应的筹码编号(20 50 100 500 1000 gray other) eg: 0 1 2 3 4 5 6
     */
    setSkinWithTag: function setSkinWithTag(tag) {

        for (var i = 0; i < this.chipSkinNodeArray.length; i++) {
            if (tag == i) {
                this.chipSkinNodeArray[i].activate = true;
            } else {
                this.chipSkinNodeArray[i].activate = false;
            }
        }
    },

    /**
     * 设置投注金额
     * @param chipMoney 对应的金额
     */
    setMoney: function setMoney(chipMoney) {
        if (chipMoney > 0) {
            this.moneyLabel.getComponent(cc.Label).string = chipMoney;
        } else {
            this.moneyLabel.getComponent(cc.Label).string = "";
        }
    },

    /**
     * 动画飞
     * @param position1 源位置
     * @param position2 目标位置
     * @param flag  飞回来还是飞回去
     * @param flyNode 飞过程的筹码对象
     * @param self 飞到的目标对象
     * @param callFun 回调的指针
     */
    chipFlyAction: function chipFlyAction(position1, position2, flag, flyNode, powerTarget, self, callFun) {
        var moveto = void 0;
        var dt = 0.2;
        this.node.stopAllActions();
        if (flag) {
            this.node.setPosition(position1);
            moveto = cc.moveTo(dt, position2);
        } else {
            this.node.setPosition(position2);
            moveto = cc.moveTo(dt, position1);
        }

        var ac1 = cc.scaleTo(dt, 1.0, 1.0);

        var obj = new Object();
        obj.powerTarget = powerTarget;
        obj.flyNode = flyNode;
        obj.target = self;
        obj.flag = flag;

        this.node.runAction(cc.sequence(moveto, cc.callFunc(callFun, self, obj)));
    }

});

module.exports = {
    ESkinTag: ESkinTag
};

cc._RFpop();
},{}],"flyRewardNodePre":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'edcb84oyLtPR4yixmZKo0vu', 'flyRewardNodePre');
// Script/flyRewardNodePre.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {

        rewardFlyNodeSkinArray: {
            default: [],
            type: [cc.Node]
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setSkin: function setSkin(index) {
        for (var i = 0; i < this.rewardFlyNodeSkinArray.length; i++) {
            if (index == i) {
                this.rewardFlyNodeSkinArray[i].active = true;
            } else {
                this.rewardFlyNodeSkinArray[i].active = false;
            }
        }
    },

    flyRewardAction: function flyRewardAction(position1, position2) {
        /*
        let moveto;
        let dt = 0.2;
        this.node.stopAllActions();
        this.node.setPosition(position1);
        moveto = cc.moveTo(dt,position2);
        //let ac1 = cc.scaleTo(dt, 1.0, 1.0);
            
        //var obj = new Object();
        //obj.target = self;
             
        this.node.runAction(cc.sequence(moveto));
        */
        this.node.stopAllActions();
        this.node.setPosition(position1);
        this.node.runAction(cc.moveTo(0.2, position2));
    }
});

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '96ad77uxvBOBKqKlCOn0FKD', 'game');
// Script/game.js

"use strict";

var NetData = require("NetData");
var DataOper = require("DataOper");
var ButtonScale = require("ButtonScale");
var Init = require("Init");
var init = new Init();
init.init();

cc.Class({
    extends: cc.Component,

    properties: {
        rewardNode: cc.Node,

        blackLayer: {
            default: null,
            type: cc.Node
        },

        waitLayer: {
            default: null,
            type: cc.Node
        },

        cdtimeIcon: cc.Node,
        //倒计时看区域
        cdBgYellow: {
            default: null,
            type: cc.Node
        },
        cdBgRed: {
            default: null,
            type: cc.Node
        },
        cdLabel: {
            default: null,
            type: cc.Label
        },
        cdJieduanLabel: {
            default: null,
            type: cc.Label
        },

        //筹码区
        chipNodeArray: {
            default: [],
            type: [cc.Node]
        },

        //清除
        clearOnNode: {
            default: null,
            type: cc.Node
        },
        clearOffNode: {
            default: null,
            type: cc.Node
        },

        //toast
        toastNode: {
            default: null,
            type: cc.Node
        },

        chooseAreaNodeArray: {
            default: [],
            type: [cc.Node]
        },

        chipAreaNoTouchNode: {
            default: null,
            type: cc.Node
        },

        betAreaNoTouchNode: {
            default: null,
            type: cc.Node
        },

        stageStopDialog: cc.Node, //第一回合结束提示框label
        sumLimit: 0, //判断投注和值； 是否超过limit;
        needClearFlag: false, //需要清理;要在投注成功后调;
        chipIndex: 0, //筹码node 的 index
        clearingFlag: false, //清理中

        canBetFlag: true, //当前是否可以投注
        cunCmd: 100, //默认100

        errorDialog: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {

        this.netData = NetData.NetData.getInst();

        if (this.netData.initFlag == 1) {
            cc.log("正常初始化进入UI");
            //直接初始化
            this.frontInit();
            this.gameStart();
        } else if (this.netData.initFlag == 2) {
            // this.midNode.active = false;
            // this.stopHint(this, this.netData.stopSellingDesc);
        } else {
            cc.log("fei正常初始化进入UI");
            this.schedule(this.initWait, 0.1);
        }

        // //测试
        // this.netData.timeFlag = 1;
        // this.netData.secs = 25;

        // var obj = new Object();
        // obj.status = 1;
        // obj.betList = [10, 20, 30, 40, 50];
        // var oddsListObj = new Object();
        // oddsListObj.option = "群雄";
        // oddsListObj.id = 1;
        // oddsListObj.powerId = 2;
        // oddsListObj.odds1 = 0.2;
        // oddsListObj.odds2 = 0.8;
        // oddsListObj.status = 1;
        // obj.oddsList = oddsListObj;
        // this.netData.initData = obj;
        // this.gameStart();
    },

    initWait: function initWait(dt) {
        if (this.netData.initFlag == 1) {
            //直接初始化
            this.frontInit();
            this.gameStart();
            this.unschedule(this.initWait);
        } else if (this.netData.initFlag == 2) {
            // this.midNode.active = false;
            // this.stopHint(this, this.netData.stopSellingDesc);
        }
    },

    frontInit: function frontInit() {
        // if(this.netData.initData.status == 1){
        var te = new Date();
        var localTime = te.getTime();
        var offset = Math.round((localTime - init.timeStamp) / 1000);
        this.netData.secs -= offset;
        console.log("offset= " + offset + "sec= " + this.netData.secs);

        if (this.netData.secs < 0) {
            this.netData.initData.status = 3;
        }
        // }
    },

    resumeTick: function resumeTick(dt) {
        this.resumFlag = true;
    },

    start: function start() {
        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
            cc.renderer.enableDirtyRegion(false);
        }
    },

    isCanBet: function isCanBet(callback) {
        var flag = false;

        if (!CC_JSB) {
            var self = this;
            var sdk = window.aliLotteryCasinoSDK;
            if (sdk) {

                sdk.isLogin(function (isLogin) {

                    if (!isLogin) //没登录去登录
                        {
                            self.goLogin();
                        } else //登录了 判断是否获取豆成功
                        {

                            sdk.setCache('chip', self.netData.betList[self.chipIndex]);

                            //在判断是否足额（淘宝相关）
                            var price = self.netdata.betList[self.chipIndex];

                            flag = self.judgeBalance(price);
                            if (flag) {
                                callback();
                            }
                        }
                });
            } else {
                callback();
            }
        } else {
            callback();
        }
    },

    goLogin: function goLogin() {
        if (!CC_JSB) {
            var self = this;
            var sdk = window.aliLotteryCasinoSDK;

            if (sdk) {
                sdk.login(function () {
                    //需要调初始化;
                    // login 后执行
                    sdk.updateUserInfo();
                    /*sdk.getUserInfo(function(info) {
                        if (info) {
                            self.netData.sdkBalance = info.fee;
                            var uid = info.uid;
                            var nick = info.nick;
                            self.showUserIcon(uid, nick);
                        }
                    });*/
                    self.fresh();
                });
            } else {
                this.fresh();
            }
        } else {
            this.fresh();
        }
    },

    exitJudge: function exitJudge() {
        /*
        let fg = false;
        let unfinish = false;
         if(!this.canBetFlag || unfinish){
            this.errDialogTag = 3;
             if(this.clearingFlag){
                this.showErrorLayer("正在帮你撤单，请稍等", true);
            }
            else{
                this.showErrorLayer("正在帮你下单，请稍等", true);
            }
             fg = true;                        
        }
         return fg;
        */
    },

    fresh: function fresh() {
        this.setStageText();
    },

    exitGame: function exitGame() {
        if (!CC_JSB) {
            if (window.aliLotteryCasinoSDK) {
                window.aliLotteryCasinoSDK.popWindow();
            }
        } else {
            cc.director.loadScene('game');
        }
    },

    gameStart: function gameStart() {
        cc.log("gamestart");
        this.setStageText();
        this.getChipIndex();
        this.showChipNum();
        this.swiftSec();
        this.showPowerInfo();
        this.resumeBetChip();
        this.getTable();
    },

    /**
     * 获取同桌人
     */
    getTable: function getTable() {
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getTable(this.netCallback, this);
    },

    reGo: function reGo() {},
    //初始化恢复数据
    resumeBetChip: function resumeBetChip() {
        var netData = NetData.NetData.getInst();
        if (netData.initData.bets) {
            for (var i = 0; i < netData.initData.bets.length; ++i) {
                for (var j = 0; j < this.chooseAreaNodeArray.length; j++) {
                    var chooseArea = this.chooseAreaNodeArray[j];
                    var powerJS = chooseArea.getComponent("Power");
                    if (powerJS.betId == netData.initData.bets[i].id) {

                        powerJS.initSelfChip(netData.initData.bets[i].timeFlag, netData.initData.bets[i].totalBet);
                    }
                }
            }
        }
    },

    showPowerInfo: function showPowerInfo() {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            powerJS.updataInfo(this.cunCmd);
            powerJS.updataUI();
        }
    },

    setSelfChipSkinGray: function setSelfChipSkinGray(tag) {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            powerJS.setSkinWithTag(tag);
        }
    },

    setStageText: function setStageText() {
        this.cdJieduanLabel.node.active = true;
        this.cdtimeIcon.active = true;
        this.cdLabel.node.x = -54;

        var jieduan = this.cdJieduanLabel.getComponent(cc.Label);
        if (this.netData.timeFlag == 1) //盲选阶段
            {
                jieduan.string = "盲选";
            } else if (this.netData.timeFlag == 2) //明选阶段
            {
                jieduan.string = "明选";
            }
    },

    swiftSec: function swiftSec() {
        //1：暗牌正在投注，2：暗牌阶段已截止，3：明牌正在投注，4:明牌截至投注，5：正在开奖，7:停售
        cc.log("this.netData.initData.status ", this.netData.initData.status);
        cc.log("time is ", this.netData.secs);
        switch (this.netData.initData.status) {
            case 1:
            case 3:
                {

                    if (this.netData.secs >= 0) {
                        this.cdLabel.string = this.netData.secs + "″";
                    } else {
                        this.cdLabel.string = "0″";
                    }

                    var pt = this.cdBgRed.parent;
                    pt.stopAllActions();
                    pt.runAction(cc.show());

                    if (this.netData.secs <= 3) {

                        this.cdBgRed.active = true;
                        this.cdBgYellow.active = false;
                        var dt = 0.38; //3 / 8;
                        pt.runAction(cc.repeat(cc.sequence(cc.delayTime(dt), cc.hide(), cc.delayTime(dt), cc.show()), 4));
                    } else {
                        this.cdBgYellow.active = true;
                        this.cdBgRed.active = false;
                    }

                    this.schedule(this.showSec, 1);
                    this.grayLight(false);
                    this.setChipGray(false);
                }
                break;
            case 2:
            case 4:
                {
                    this.doStopBet();
                }
                break;
            case 5:
                {
                    //正在开奖
                    this.getReward();
                    this.grayLight(true);
                    this.setChipGray(true);
                }
                break;
            case 7:
                {
                    //停售

                }
                break;
            default:
                break;
        }
    },

    secCd: function secCd(dt) {
        this.netData.secs--;
    },

    showSec: function showSec(dt) {
        // cc.log("showSec：this.netData.secs ",this.netData.secs);

        this.netData.secs--;

        //获取同桌人，5s的倍数时获取
        if (this.netData.secs >= 5 && this.netData.secs % 5 == 0) {
            this.getTable();
        }

        if (this.netData.secs >= 0) {
            this.cdLabel.string = this.netData.secs + "″";
        } else {
            this.cdLabel.string = "0″";
        }

        if (this.netData.secs <= 3) {
            var pt = this.cdBgRed.parent;
            cc.log("sec<3");
            this.cdBgRed.active = true;
            this.cdBgYellow.active = false;
            var _dt = 0.38; //3 / 8;
            pt.runAction(cc.repeat(cc.sequence(cc.delayTime(_dt), cc.hide(), cc.delayTime(_dt), cc.show()), 4));
        }

        if (this.netData.secs <= 0) {
            this.setSelfChipSkinGray(5);
            cc.log("sec== 0");
            this.doStopBet();
        }
    },

    doStopBet: function doStopBet() {
        cc.log("this.netData.timeFlag", this.netData.timeFlag);
        //this.canBetFlag = false;
        // this.unschedule(this.turnTableLogic);
        this.cdBgRed.parent.stopAllActions();
        this.cdBgRed.parent.runAction(cc.show());
        this.cdBgYellow.active = true;
        this.cdBgRed.active = false;
        this.cdLabel.node.x = -54;
        // this.cdLabel.w = 220;
        this.cdLabel.string = "已截止";
        this.unschedule(this.showSec);
        //变灰;
        this.grayLight(true);
        this.setChipGray(true);
        //筹码便会的变灰

        if (this.netData.timeFlag == 1) //提示框的弹出获取结果开奖就然后获取第二回合数据
            {
                this.stageStopDialog.active = true;

                var self = this;
                var callback = function callback(dt) {
                    this.getSecondData(); //获取第二阶段
                };
                this.scheduleOnce(callback, 3 + this.netData.initData.deadSecs1); //一阶段停止时间+3s
            } else //获取开奖结果
            {
                var callback = function callback(dt) {
                    this.getReward();
                };
                this.scheduleOnce(callback, 3 + this.netData.initData.deadSecs2); //二阶段停止时间+3s
            }
    },

    grayLight: function grayLight(flag) {
        this.clearOnNode.parent.active = !flag;
        this.clearOffNode.parent.active = flag;
        this.betAreaNoTouchNode.active = flag;
    },

    getReward: function getReward() {
        this.cdBgRed.parent.stopAllActions();
        this.cdBgRed.parent.runAction(cc.show());
        this.cdBgYellow.active = true;
        this.cdBgRed.active = false;
        this.cdJieduanLabel.node.active = false;
        this.cdtimeIcon.active = false;
        this.cdLabel.node.x = -100;
        this.cdLabel.string = "正在开奖";
        this.scheduleOnce(this.doReward, 2); //给服务器预留的2秒;
    },

    getSecondData: function getSecondData() //获取第二阶段的数据
    {
        //this.showWaitLayer();
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getSecondData(this.netCallback, this);
    },

    doReward: function doReward(dt) {
        //this.showWaitLayer();
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getReward(this.netCallback, this);
    },

    showWaitLayer: function showWaitLayer() {
        this.blackLayer.active = true;
        this.waitLayer.active = true;
    },

    hideWaitLayer: function hideWaitLayer() {
        this.blackLayer.active = false;
        this.waitLayer.active = false;
    },

    judgeBalance: function judgeBalance(amount) {
        var fg = true;

        if (this.sdkBalance == -1) {
            // this.errDialogTag = 5;
            // this.blackLayer.active = true;
            // this.refreshNode.getChildByName("word").getComponent(cc.Label).string = "获取" + this.netData.currency + "失败，请刷新页面";
            // this.refreshNode.runAction(cc.scaleTo(0.2, 1.0, 1.0));
            fg = false;
        } else {

            if (amount > this.sdkBalance) {
                //提示余额不足，跳转到充值
                if (!CC_JSB) {
                    if (window.aliLotteryCasinoSDK) {
                        window.aliLotteryCasinoSDK.recharge(true);
                    }
                }

                fg = false;
                console.log("no balance");
            }
        }

        return fg;
    },

    getChipIndex: function getChipIndex() {
        var sdk = window.aliLotteryCasinoSDK;

        if (sdk) {
            var self = this;
            var len = this.netData.betList.length;

            window.aliLotteryCasinoSDK.getCache('chip', function (result) {
                if (result) {
                    for (var i = 0; i < len; i++) {
                        if (self.netData.betList[i] == result) {
                            self.chipIndex = i;
                            break;
                        }
                    }
                } else {
                    for (var _i = 0; _i < len; _i++) {
                        if (self.netData.betList[_i] == self.netData.preBet) {
                            self.chipIndex = _i;
                            break;
                        }
                    }
                }
            });
        }
    },

    /******************netCallback********************/
    netCallback: function netCallback(cmd, res, msg, self) {
        cc.log("netCallback cmd=" + cmd);
        self.cunCmd = cmd;
        var netData = NetData.NetData.getInst();
        self.hideWaitLayer();
        res = parseInt(res);
        console.log("res=" + res + "/mg=" + msg + "/cmd=" + self.cunCmd);
        switch (res) {
            case 0:
                {
                    switch (cmd) {
                        case 100:
                            //init
                            {
                                self.gameStart();
                            }
                            break;
                        case 101:
                            //bet
                            {
                                self.clearWithFlag(true);
                                self.canBetFlag = true;
                                self.showPowerInfo();
                                //投注成功后清零
                                for (var i = 0; i < self.chooseAreaNodeArray.length; i++) {
                                    var chooseArea = self.chooseAreaNodeArray[i];
                                    var powerJS = chooseArea.getComponent("Power");
                                    if (powerJS.betFlag) {
                                        powerJS.betNum = 0;
                                    }
                                }
                            }
                            break;
                        case 102:
                            //clear
                            {
                                self.clearingFlag = false;
                                self.showPowerInfo();
                            }
                            break;
                        case 103:
                            //reward
                            {
                                self.clearWithFlag(false);
                                self.showPowerInfo();

                                self.schedule(self.secCd, 1);
                                self.scheduleOnce(self.nextPeriod, 10.0);
                            }
                            break;
                        case 104:
                            //twostemp
                            {
                                self.stageStopDialog.active = false;
                                self.schedule(self.showSec, 1);
                                self.grayLight(false);
                                self.setChipGray(false);
                                self.clearWithFlag(false);
                                self.setStageText();
                                self.showPowerInfo();
                            }
                            break;
                        case 105:
                            //同桌人
                            {
                                self.updataTable();
                            }
                            break;
                        case 106:
                            //订单列表
                            {}
                            break;
                        case 107:
                            //历史走势
                            {}
                    }
                }
                break;
            case 100019:
                //筹码飞筹码飞回
                {
                    for (var i = 0; i < self.chooseAreaNodeArray.length; i++) {
                        var chooseArea = self.chooseAreaNodeArray[i];
                        var powerJS = chooseArea.getComponent("Power");
                        for (var j = 0; j < netData.reqBetList.length; j++) {
                            if (powerJS.betId == netData.reqBetList[j].id) {
                                powerJS.reduceSelfChip();
                                break;
                            }
                        }
                    }
                }
                break;
            case 100028:
                //明牌阶段未开始，那就1s后再调下
                {
                    if (cmd == 104) {
                        setTimeout(function () {
                            //self.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getSecondData(self.netCallback, self);
                        }, 1000);
                    }
                }
                break;
            case 100011:
                //结算尚未开始，那就1s后再调下
                {
                    if (cmd == 103) {
                        setTimeout(function () {
                            //self.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getReward(self.netCallback, self);
                        }, 1000);
                    }
                }
                break;
            default:
                {
                    cc.log("res default!");
                    switch (cmd) {
                        case 101:
                            //投注失败回收筹码
                            {
                                // self.showToast(msg);
                                if (res == 200009) {//余额不足，跳转到充值

                                }

                                self.canBetFlag = true;
                                for (var i = 0; i < self.chooseAreaNodeArray.length; i++) {
                                    var chooseArea = self.chooseAreaNodeArray[i];
                                    var powerJS = chooseArea.getComponent("Power");
                                    for (var j = 0; j < netData.reqBetList.length; j++) {
                                        if (powerJS.betId == netData.reqBetList[j].id) {
                                            powerJS.reduceSelfChip();
                                            break;
                                        }
                                    }
                                }
                            }
                            break;
                        case 102:
                            {
                                //清空投注
                                self.clearWithFlag(false);
                                self.clearingFlag = false;
                                self.showToast(msg);
                            }
                            break;
                        default:
                            {
                                /*
                                self.stageStopDialog.active  = false;
                                //通常的错误提示
                                var errorDialogJs = self.errorDialog.getComponent("errorDialog");
                                errorDialogJs.showDialog(msg, 0);
                                */
                                self.showToast(msg);
                            }
                            break;
                    }
                }
                break;
        }
    },
    /******************netCallback********************/

    /**
     * 检查同桌人，每局结束时检查，把没有投注的清掉，把有投注的subId清掉
     */
    checkTable: function checkTable() {
        var netData = NetData.NetData.getInst();
        for (var i = 0; i < netData.reqTableArray.length; ++i) {
            if (netData.reqTableArray[i].subIds.length == 0) {
                netData.reqTableArray.splice(i, 1);
                --i;
            }
        }
    },

    /**
     * 更新同桌人，每次请求回来后调用，包含新的投注信息
     */
    updataTable: function updataTable() {
        var netData = NetData.NetData.getInst();
        for (var i = 0; i < netData.tableArray.length; ++i) {
            var flag = false;
            for (var j = 0; j < netData.reqTableArray.length; ++j) {
                if (netData.reqTableArray[j].uid == netData.tableArray[i].uid) {
                    flag = true;
                    for (var k = 0; k < netData.tableArray[i].subIds.length; ++k) {
                        netData.reqTableArray[j].subIds.push(netData.tableArray[i].subIds[k]);
                    }
                    break;
                }
            }

            if (!flag) {
                netData.reqTableArray.push(netData.tableArray[i]);
            }
        }
    },

    //结算飞戳结束
    rewardFlyFinishedCallback: function rewardFlyFinishedCallback() {
        //提示再来一局103
        cc.log("该提示结算页面了");
        this.betAreaNoTouchNode.active = false;
        var netData = NetData.NetData.getInst();
        var status = netData.rewardData.status;
        this.rewardNode.active = true;
        var num = 0;
        if (status == 1) //sheng
            {
                num = netData.rewardData.amount;
            } else if (status == 2) //fu
            {
                num = netData.rewardData.allNum;
            } else if (status == 3) //ping
            {
                num = netData.rewardData.amount;
            }

        this.rewardNode.getComponent("rewardNode").setContent(status, num);
    },

    nextPeriod: function nextPeriod(dt) {
        this.unschedule(this.nextPeriod);
        this.unschedule(this.secCd);
        this.netData.timeFlag = 1;

        this.rewardNode.active = false;

        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            powerJS.resetInfo();
            powerJS.updataUI();
        }
        this.schedule(this.showSec, 1);
        this.grayLight(false);
        this.setChipGray(false);
        this.setStageText();
        this.cdLabel.string = this.netData.secs + "″";

        var convertNode = cc.find("Canvas/convertNode");
        var convertNodeJS = convertNode.getComponent("convertNode");
        convertNodeJS.flyRewardActionFinished();

        //同桌人
        this.checkTable();
    },

    clearWithFlag: function clearWithFlag(flag) {
        this.clearOnNode.parent.active = flag;
        this.clearOffNode.parent.active = !flag;
    },

    //所有按钮的回调等等事件
    btnActionCallBack: function btnActionCallBack(btnTag) {
        switch (btnTag) {
            // case ButtonScale.EbuttonTag.eCleare:
            case 5:
                {
                    cc.log("clear clear!!!");

                    if (this.canBetFlag) {
                        this.clearingFlag = true;
                        this.clearWithFlag(false);

                        //this.showWaitLayer();
                        var dataOper = DataOper.DataOper.getInst();
                        dataOper.getClear(this.netCallback, this);

                        this.flyBack();
                        this.sumLimit = 0;
                        this.netData.betLimit = this.netData.totalBetLimit;
                    } else {
                        //正在下单，不让清
                        this.showToast("正在为您下单，请稍后撤单");
                        /*
                        this.needClearFlag = true;
                        this.flyBack();
                        this.sumLimit = 0;
                        this.netData.betLimit = this.netData.totalBetLimit;
                        */
                    }
                }
                break;
            case ButtonScale.EbuttonTag.eChip20:
            case ButtonScale.EbuttonTag.eChip50:
            case ButtonScale.EbuttonTag.eChip100:
            case ButtonScale.EbuttonTag.eChip500:
            case ButtonScale.EbuttonTag.eChip1000:
                {
                    //cc.log("");
                    this.chipIndex = btnTag;
                    this.resetChip();
                    //cc.log("chipIndex is = ", this.chipIndex);
                }
                break;

            default:
                break;
        }
    },

    errorDialogCallback: function errorDialogCallback(typeaction, positon) //1 左边按钮 2 右边按钮
    {
        var errorDialogJs = this.errorDialog.getComponent("errorDialog");
        errorDialogJs.hideDialog();

        if (positon == 1) {
            switch (typeaction) {
                case 0:
                    {
                        //只有一个按钮刷新刷新的
                        if (this.cunCmd == 100) {
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getInit(this.netCallback, this);
                        } else if (this.cunCmd == 101) {} else if (this.cunCmd == 102) {} else if (this.cunCmd == 103) {
                            //this.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getReward(this.netCallback, this);
                        } else if (this.cunCmd == 104) {
                            //this.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getSecondData(this.netCallback, this);
                        } else if (this.cunCmd == 105) {} else if (this.cunCmd == 106) {}
                    }
                    break;
                case 1:
                    {}
                    break;
                case 2:
                    {}
                    break;
            }
        } else {
            switch (typeaction) {
                case 0:
                    {}
                    break;
                case 1:
                    {}
                    break;
                case 2:
                    {}
                    break;
            }
        }
    },

    showChipNum: function showChipNum() {
        var netData = NetData.NetData.getInst();

        for (var i = 0; i < this.chipNodeArray.length; i++) {
            var le = this.chipNodeArray[i].getChildByName("Label").getComponent(cc.Label);
            this.adjustFontsize(le, netData.initData.betList[i]);
            le.string = netData.initData.betList[i];
        }

        for (var j = 0; j < netData.initData.betList.length; j++) {
            if (netData.initData.betList[j] == netData.initData.preBet) {
                this.chipIndex = j;
            }
        }
        this.resetChip();
    },

    adjustFontsize: function adjustFontsize(label, num) {
        var se = 71;

        if (num < 100) {} else if (num < 1000) {
            label.fontSize = se * 0.8;
        } else {
            label.fontSize = se * 0.56;
        }
    },

    resetChip: function resetChip() {
        this.setChipGray(false);
        for (var i = 0; i < this.chipNodeArray.length; i++) {
            if (this.chipIndex == i) {
                this.chipNodeArray[i].getChildByName("chouma").scale = 1;
                this.chipNodeArray[i].getChildByName("noTouch").scale = 1;
            } else {

                this.chipNodeArray[i].getChildByName("chouma").scale = 0.8;
                this.chipNodeArray[i].getChildByName("noTouch").scale = 0.8;
            }
        }
    },

    setChipGray: function setChipGray(flag) {
        for (var i = 0; i < this.chipNodeArray.length; i++) {
            this.chipNodeArray[i].getChildByName("noTouch").active = flag;
        }
    },

    showToast: function showToast(msg) {
        this.toastNode.stopAllActions();
        this.toastNode.scale = 0;
        var le = this.toastNode.getChildByName("word").getComponent(cc.Label);
        le.string = msg;
        var len = le.node.width + 20;
        this.toastNode.width = len;
        var dt = 0.2;
        var ac1 = cc.scaleTo(dt, 1.0, 1.0);
        var ac2 = cc.scaleTo(dt, 0, 0);
        this.toastNode.runAction(cc.sequence(ac1, cc.delayTime(2), ac2));
    },

    flyBack: function flyBack() {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            if (powerJS.betFlag) {
                powerJS.betList = [];
                powerJS.flyBack();
            }
        }
    },

    powerBet: function powerBet(callFunc, power) {
        //判断登录、余额TODO
        var self = this;
        var callback = function callback() {
            //if(self.netData.initData.status == 1 || self.netData.initData.status == 3)
            {
                //self.canBetFlag = true;
                self.clearWithFlag(true);
                callFunc(self.chipIndex, power);
                self.unschedule(self.dealBet);
                self.scheduleOnce(self.dealBet, 0.5);
            }
        };
        self.isCanBet(callback);
    },

    /**
     * 真实投注
     */
    dealBet: function dealBet(dt) {
        //this.showWaitLayer();
        var netData = NetData.NetData.getInst();
        var dataOper = DataOper.DataOper.getInst();
        //首先检查当前是否有没有回来的投注请求
        if (this.canBetFlag) {
            this.canBetFlag = false;

            netData.reqBetList = [];

            for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
                var chooseArea = this.chooseAreaNodeArray[i];
                var powerJS = chooseArea.getComponent("Power");
                if (powerJS.betFlag) {
                    powerJS.betNum = 0;
                    for (var j = 0; j < powerJS.betList.length; ++j) {
                        netData.reqBetList.push(powerJS.betList[j]);
                        powerJS.betNum += powerJS.betList[j].bet * powerJS.betList[j].num;
                    }
                    powerJS.betList = [];
                }
            }

            dataOper.getBet(this.netCallback, this);
        } else {
            this.scheduleOnce(this.dealBet, 0.5);
        }
    }

});

cc._RFpop();
},{"ButtonScale":"ButtonScale","DataOper":"DataOper","Init":"Init","NetData":"NetData"}],"md5":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2ceb3709r9Ml6wPLEEyiUfd', 'md5');
// Script/network/aes/md5.js

"use strict";

var CryptoJS = require("./core");(function (Math) {
  var C = CryptoJS;var C_lib = C.lib;var WordArray = C_lib.WordArray;var Hasher = C_lib.Hasher;var C_algo = C.algo;var T = [];(function () {
    for (var i = 0; i < 64; i++) {
      T[i] = Math.abs(Math.sin(i + 1)) * 4294967296 | 0;
    }
  })();var MD5 = C_algo.MD5 = Hasher.extend({ _doReset: function _doReset() {
      this._hash = new WordArray.init([1732584193, 4023233417, 2562383102, 271733878]);
    }, _doProcessBlock: function _doProcessBlock(M, offset) {
      for (var i = 0; i < 16; i++) {
        var offset_i = offset + i;var M_offset_i = M[offset_i];M[offset_i] = (M_offset_i << 8 | M_offset_i >>> 24) & 16711935 | (M_offset_i << 24 | M_offset_i >>> 8) & 4278255360;
      }var H = this._hash.words;var M_offset_0 = M[offset + 0];var M_offset_1 = M[offset + 1];var M_offset_2 = M[offset + 2];var M_offset_3 = M[offset + 3];var M_offset_4 = M[offset + 4];var M_offset_5 = M[offset + 5];var M_offset_6 = M[offset + 6];var M_offset_7 = M[offset + 7];var M_offset_8 = M[offset + 8];var M_offset_9 = M[offset + 9];var M_offset_10 = M[offset + 10];var M_offset_11 = M[offset + 11];var M_offset_12 = M[offset + 12];var M_offset_13 = M[offset + 13];var M_offset_14 = M[offset + 14];var M_offset_15 = M[offset + 15];var a = H[0];var b = H[1];var c = H[2];var d = H[3];a = FF(a, b, c, d, M_offset_0, 7, T[0]);d = FF(d, a, b, c, M_offset_1, 12, T[1]);c = FF(c, d, a, b, M_offset_2, 17, T[2]);b = FF(b, c, d, a, M_offset_3, 22, T[3]);a = FF(a, b, c, d, M_offset_4, 7, T[4]);d = FF(d, a, b, c, M_offset_5, 12, T[5]);c = FF(c, d, a, b, M_offset_6, 17, T[6]);b = FF(b, c, d, a, M_offset_7, 22, T[7]);a = FF(a, b, c, d, M_offset_8, 7, T[8]);d = FF(d, a, b, c, M_offset_9, 12, T[9]);c = FF(c, d, a, b, M_offset_10, 17, T[10]);b = FF(b, c, d, a, M_offset_11, 22, T[11]);a = FF(a, b, c, d, M_offset_12, 7, T[12]);d = FF(d, a, b, c, M_offset_13, 12, T[13]);c = FF(c, d, a, b, M_offset_14, 17, T[14]);b = FF(b, c, d, a, M_offset_15, 22, T[15]);a = GG(a, b, c, d, M_offset_1, 5, T[16]);d = GG(d, a, b, c, M_offset_6, 9, T[17]);c = GG(c, d, a, b, M_offset_11, 14, T[18]);b = GG(b, c, d, a, M_offset_0, 20, T[19]);a = GG(a, b, c, d, M_offset_5, 5, T[20]);d = GG(d, a, b, c, M_offset_10, 9, T[21]);c = GG(c, d, a, b, M_offset_15, 14, T[22]);b = GG(b, c, d, a, M_offset_4, 20, T[23]);a = GG(a, b, c, d, M_offset_9, 5, T[24]);d = GG(d, a, b, c, M_offset_14, 9, T[25]);c = GG(c, d, a, b, M_offset_3, 14, T[26]);b = GG(b, c, d, a, M_offset_8, 20, T[27]);a = GG(a, b, c, d, M_offset_13, 5, T[28]);d = GG(d, a, b, c, M_offset_2, 9, T[29]);c = GG(c, d, a, b, M_offset_7, 14, T[30]);b = GG(b, c, d, a, M_offset_12, 20, T[31]);a = HH(a, b, c, d, M_offset_5, 4, T[32]);d = HH(d, a, b, c, M_offset_8, 11, T[33]);c = HH(c, d, a, b, M_offset_11, 16, T[34]);b = HH(b, c, d, a, M_offset_14, 23, T[35]);a = HH(a, b, c, d, M_offset_1, 4, T[36]);d = HH(d, a, b, c, M_offset_4, 11, T[37]);c = HH(c, d, a, b, M_offset_7, 16, T[38]);b = HH(b, c, d, a, M_offset_10, 23, T[39]);a = HH(a, b, c, d, M_offset_13, 4, T[40]);d = HH(d, a, b, c, M_offset_0, 11, T[41]);c = HH(c, d, a, b, M_offset_3, 16, T[42]);b = HH(b, c, d, a, M_offset_6, 23, T[43]);a = HH(a, b, c, d, M_offset_9, 4, T[44]);d = HH(d, a, b, c, M_offset_12, 11, T[45]);c = HH(c, d, a, b, M_offset_15, 16, T[46]);b = HH(b, c, d, a, M_offset_2, 23, T[47]);a = II(a, b, c, d, M_offset_0, 6, T[48]);d = II(d, a, b, c, M_offset_7, 10, T[49]);c = II(c, d, a, b, M_offset_14, 15, T[50]);b = II(b, c, d, a, M_offset_5, 21, T[51]);a = II(a, b, c, d, M_offset_12, 6, T[52]);d = II(d, a, b, c, M_offset_3, 10, T[53]);c = II(c, d, a, b, M_offset_10, 15, T[54]);b = II(b, c, d, a, M_offset_1, 21, T[55]);a = II(a, b, c, d, M_offset_8, 6, T[56]);d = II(d, a, b, c, M_offset_15, 10, T[57]);c = II(c, d, a, b, M_offset_6, 15, T[58]);b = II(b, c, d, a, M_offset_13, 21, T[59]);a = II(a, b, c, d, M_offset_4, 6, T[60]);d = II(d, a, b, c, M_offset_11, 10, T[61]);c = II(c, d, a, b, M_offset_2, 15, T[62]);b = II(b, c, d, a, M_offset_9, 21, T[63]);H[0] = H[0] + a | 0;H[1] = H[1] + b | 0;H[2] = H[2] + c | 0;H[3] = H[3] + d | 0;
    }, _doFinalize: function _doFinalize() {
      var data = this._data;var dataWords = data.words;var nBitsTotal = this._nDataBytes * 8;var nBitsLeft = data.sigBytes * 8;dataWords[nBitsLeft >>> 5] |= 128 << 24 - nBitsLeft % 32;var nBitsTotalH = Math.floor(nBitsTotal / 4294967296);var nBitsTotalL = nBitsTotal;dataWords[(nBitsLeft + 64 >>> 9 << 4) + 15] = (nBitsTotalH << 8 | nBitsTotalH >>> 24) & 16711935 | (nBitsTotalH << 24 | nBitsTotalH >>> 8) & 4278255360;dataWords[(nBitsLeft + 64 >>> 9 << 4) + 14] = (nBitsTotalL << 8 | nBitsTotalL >>> 24) & 16711935 | (nBitsTotalL << 24 | nBitsTotalL >>> 8) & 4278255360;data.sigBytes = (dataWords.length + 1) * 4;this._process();var hash = this._hash;var H = hash.words;for (var i = 0; i < 4; i++) {
        var H_i = H[i];H[i] = (H_i << 8 | H_i >>> 24) & 16711935 | (H_i << 24 | H_i >>> 8) & 4278255360;
      }return hash;
    }, clone: function clone() {
      var clone = Hasher.clone.call(this);clone._hash = this._hash.clone();return clone;
    } });function FF(a, b, c, d, x, s, t) {
    var n = a + (b & c | ~b & d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function GG(a, b, c, d, x, s, t) {
    var n = a + (b & d | c & ~d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function HH(a, b, c, d, x, s, t) {
    var n = a + (b ^ c ^ d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function II(a, b, c, d, x, s, t) {
    var n = a + (c ^ (b | ~d)) + x + t;return (n << s | n >>> 32 - s) + b;
  }C.MD5 = Hasher._createHelper(MD5);C.HmacMD5 = Hasher._createHmacHelper(MD5);
})(Math);

cc._RFpop();
},{"./core":"core"}],"mode-ecb":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e11dbyI/bFD/4JfK0/gf6re', 'mode-ecb');
// Script/network/aes/mode-ecb.js

"use strict";

var CryptoJS = require("./core");CryptoJS.mode.ECB = function () {
  var ECB = CryptoJS.lib.BlockCipherMode.extend();ECB.Encryptor = ECB.extend({ processBlock: function processBlock(words, offset) {
      this._cipher.encryptBlock(words, offset);
    } });ECB.Decryptor = ECB.extend({ processBlock: function processBlock(words, offset) {
      this._cipher.decryptBlock(words, offset);
    } });return ECB;
}();

cc._RFpop();
},{"./core":"core"}],"rewardNode":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b717b2HbwlOla7ieO9oW8vk', 'rewardNode');
// Script/rewardNode.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        imgArray: [cc.Node],
        btnImg: cc.Node,
        btnText: cc.Label,
        text: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        cc.log("rewardNode");
        this.btnImg.parent.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.btnImg.scale = 0.8;
        }, this);

        this.btnImg.parent.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.btnImg.scale = 1;
            this.node.active = false;
            cc.log("rewardColse");
            var onFunction = cc.find('Canvas').getComponent('game');
            onFunction.nextPeriod();
        }, this);

        this.btnImg.parent.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {

            this.btnImg.scale = 1;
        }, this);
    },

    setContent: function setContent(status, num) {
        this.node.active = true;
        var text = "";
        if (status === 0) //未开奖
            {} else if (status == 1) //sheng
            {
                text = "中" + num + "豆";
            } else if (status == 2) //fu
            {
                text = "今日已有" + num + "人猜中!";
            } else if (status == 3) //ping
            {
                text = "返还" + num + "豆";
            } else if (status == 4) //未投注
            {} else {}
        this.text.getComponent(cc.Label).string = text;
        if (status >= 1 && status <= 3) //sheng
            {
                for (var i = 0; i < this.imgArray.length; i++) {
                    if (status - 1 == i) {
                        this.imgArray[i].active = true;
                    } else {
                        this.imgArray[i].active = false;
                    }
                }
            }
    }

});

cc._RFpop();
},{}]},{},["HelloWorld","Help","Init","Power","ButtonScale","Notouch","WaitScript","errorDialog","convertNode","flyChipNodePre","flyRewardNodePre","game","DataOper","NetData","aes","cipher-core","core","enc-base64","evpkdf","md5","mode-ecb","rewardNode"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvVG9vbHMvQnV0dG9uU2NhbGUuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvRGF0YU9wZXIuanMiLCJhc3NldHMvU2NyaXB0L0hlbGxvV29ybGQuanMiLCJhc3NldHMvU2NyaXB0L0hlbHAuanMiLCJhc3NldHMvU2NyaXB0L0luaXQuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvTmV0RGF0YS5qcyIsImFzc2V0cy9TY3JpcHQvVG9vbHMvTm90b3VjaC5qcyIsImFzc2V0cy9TY3JpcHQvUG93ZXIuanMiLCJhc3NldHMvU2NyaXB0L1Rvb2xzL1dhaXRTY3JpcHQuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvYWVzL2Flcy5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvY2lwaGVyLWNvcmUuanMiLCJhc3NldHMvU2NyaXB0L2NvbnZlcnROb2RlLmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9jb3JlLmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9lbmMtYmFzZTY0LmpzIiwiYXNzZXRzL1NjcmlwdC9Ub29scy9lcnJvckRpYWxvZy5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvZXZwa2RmLmpzIiwiYXNzZXRzL1NjcmlwdC9mbHlDaGlwTm9kZVByZS5qcyIsImFzc2V0cy9TY3JpcHQvZmx5UmV3YXJkTm9kZVByZS5qcyIsImFzc2V0cy9TY3JpcHQvZ2FtZS5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvbWQ1LmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9tb2RlLWVjYi5qcyIsImFzc2V0cy9TY3JpcHQvcmV3YXJkTm9kZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7QUFDQTs7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFSdUI7O0FBY3pCO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7O0FBS0o7QUFDQTs7QUFFSTtBQUNBO0FBQ0k7QUFFSTtBQUNBO0FBRUc7QUFDRjtBQUVBO0FBQ0o7O0FBR0w7QUFFSTtBQUNBO0FBRUk7QUFDSDtBQUNEO0FBQ0E7QUFHQztBQUNKOztBQUVEO0FBRUk7QUFDQTtBQUVJO0FBQ0g7QUFFQTtBQUNKO0FBR0E7QUFFSjs7QUF4REk7O0FBNkRUO0FBQ0k7QUFEYTs7Ozs7Ozs7OztBQzVFakI7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDSTtBQUNBO0FBRlE7QUFEUTs7QUFPeEI7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBSEc7QUFEQTs7QUFRWDtBQUNJO0FBQ0E7O0FBRUE7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTs7QUFFQTtBQUNJO0FBQ0k7QUFDSDtBQUNKOztBQUVEO0FBQ0g7O0FBRUQ7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQWhEaUI7O0FBbUR0QjtBQUNJO0FBQ0k7O0FBRUE7QUFDSTtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7O0FBRUE7QUFDSTtBQUNIOztBQUVEO0FBQ0k7QUFDSDs7QUFFRDtBQUNJO0FBQ0g7QUFDSjtBQWhDa0I7O0FBbUN2Qjs7QUFFSTtBQUNJO0FBQ0E7O0FBRUE7O0FBRUk7QUFFSTtBQUNBO0FBQ0g7QUFDRDtBQUVIOztBQUVEOztBQUVJO0FBQ0k7QUFDSDtBQUNKO0FBcEJLOztBQXVCVjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFIYTtBQUtqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFLSjtBQUNJO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7O0FBRUE7QUFDSTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNIO0FBRUc7QUFDSDtBQUNEO0FBQ0E7O0FBRUg7QUFDSjs7QUFLRDtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7OztBQUlIOztBQUVEO0FBQ0k7QUFDSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7Ozs7O0FBTUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFUSjtBQVdIO0FBQ0o7QUFDSjtBQUVHO0FBQ0g7QUFDSjtBQUNHOztBQUVBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDSjtBQUNHO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7Ozs7O0FBS0M7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDSTtBQUFTO0FBQ0w7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNMO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDTDtBQUNIO0FBQ0Q7QUFDQTtBQUFTO0FBQ0w7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNMO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDTDtBQUNIO0FBQ0Q7QUFDQTtBQUFTO0FBQ047QUFDRjtBQUNEO0FBQ0E7QUFBVztBQUNSO0FBQ0Y7QUFDRDtBQUNBO0FBQ0E7QUFsQ0o7QUFvQ0g7O0FBRUY7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7OztBQUlBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBR0c7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDs7QUFFRDs7O0FBR0M7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7O0FBT0Y7O0FBRUQ7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9GOztBQUVEOzs7QUFHRDtBQUNJO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVOOzs7Ozs7Ozs7OztBQVlHOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7Ozs7O0FBS0E7QUFDSTtBQUNJO0FBQ0g7QUFFRztBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7Ozs7O0FBTUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEOzs7O0FBSUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEOzs7QUFHQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUE3bUJtQjs7QUFnbkJ4QjtBQUNJO0FBRGE7Ozs7Ozs7Ozs7QUNsdEJqQjtBQUNJOztBQUVBO0FBQ0k7QUFDSTtBQUNBO0FBRkc7QUFJUDtBQUNBO0FBTlE7O0FBU1o7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDQTtBQWxCSzs7Ozs7Ozs7OztBQ0FUO0FBQ0E7O0FBRUE7QUFDSTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRROztBQVlaO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7QUFFQTtBQUNJO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDSTs7QUFFQTtBQUVJO0FBQ0g7O0FBRUQ7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNKO0FBQ0Q7QUFDQTs7QUFFQTs7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDUDtBQUNBOztBQUVEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFFSTtBQUNBO0FBQ0g7QUFuSEk7Ozs7Ozs7Ozs7QUNIVDtBQUNBOztBQUVBO0FBQ0k7O0FBRUE7Ozs7QUFJQTtBQUNJO0FBQ0E7QUFDSTs7QUFHSTs7QUFFQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTs7QUFFQTtBQUNJO0FBQ0E7QUFDSDtBQUVHO0FBQ0g7QUFDRDtBQUNBOztBQUVIOztBQUdEO0FBQ0E7O0FBRUE7O0FBRUE7QUFDSTtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0w7QUFDRztBQUNIO0FBQ0o7QUFDRjtBQUNOO0FBQ0c7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTs7QUFFQTtBQUNBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7QUFFRztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVJO0FBQ0E7QUFDQTtBQUNQOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUEvRkk7Ozs7Ozs7Ozs7QUNGVDtBQUNJO0FBQ0k7QUFDQTs7QUFFQTs7QUFFSTtBQUVJO0FBQ0E7QUFDSDtBQUNEO0FBRUg7O0FBRUQ7O0FBRUk7QUFDSTtBQUNIO0FBQ0o7QUFwQks7O0FBdUJWO0FBQ0k7QUFDQTtBQUNBOzs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQTFCUTs7QUE2Qlo7O0FBSUE7QUF6RG1COztBQTZEdkI7QUFDSTtBQURhOzs7Ozs7Ozs7O0FDOURqQjtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVFE7O0FBWVo7QUFDQTtBQUNHO0FBQ0s7QUFDQTs7QUFFQTtBQUVJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDSDs7QUFqQ0k7Ozs7Ozs7Ozs7QUNBVDs7QUFFQTtBQUNJOztBQUVBOztBQUVJO0FBQ0k7QUFDQTtBQUZlOztBQUtuQjtBQUNJO0FBQ0E7QUFGZTs7QUFLbkI7QUFDSTtBQUNBO0FBRm9COztBQUt4Qjs7QUFHQTtBQUNJO0FBQ0E7QUFGUzs7QUFLYjs7QUFFQTtBQUNJO0FBQ0E7QUFGTzs7QUFLWDtBQUNJO0FBQ0E7QUFGUzs7QUFLYjtBQUNJO0FBQ0E7QUFGYTs7QUFLakI7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUdKO0FBQ0E7QUFDSTs7QUFJQTtBQUNJO0FBQ0E7QUFDSTtBQUNDOztBQUVBO0FBQ0c7QUFDRjtBQUVFO0FBQ0Y7QUFFTDtBQUNKO0FBQ0o7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0k7QUFDQTtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNIO0FBRUo7O0FBRUQ7Ozs7QUFJQTtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7O0FBRUQ7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKOztBQUVEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0g7QUFFRztBQUNIOztBQUVEO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7QUFLRztBQUNJO0FBQ0g7QUFFRztBQUNIOztBQUVEO0FBQ0g7QUFFRztBQUNBO0FBQ0k7QUFDQTs7QUFFRDtBQUNDO0FBQ0E7QUFDQTtBQUNEO0FBQ0M7OztBQUtBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUVHO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7Ozs7OztBQU1IO0FBRUc7QUFDQTs7Ozs7O0FBTUg7QUFFRztBQUNBOzs7Ozs7QUFNSDtBQUNEO0FBQ0g7QUFDSjtBQUNKOztBQUdEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUVKO0FBRUc7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKOztBQUVEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7O0FBRUQ7QUFDQTtBQUNBOztBQUNJO0FBRVE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBTlI7QUFVb0I7QUFDSTtBQUNBOztBQUNKO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFHRztBQUNIO0FBR0c7QUFDSDtBQUdHO0FBQ0g7QUFDRDtBQUNBOztBQUVJO0FBQ0E7O0FBQ0o7QUFFSTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBckJKO0FBdUJBO0FBQ0E7QUFDSTtBQUNKOztBQUNBOztBQUVJO0FBQ0k7QUFBeUY7QUFBcUM7QUFDOUg7QUFDSDtBQUVKO0FBRUc7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUFrRztBQUE0QjtBQUM5SDtBQUNIO0FBQ0o7QUFDSjtBQWxGckI7O0FBUVk7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBMEVIO0FBR1I7O0FBRUc7QUFFSTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBR0c7QUFDQTtBQUVJO0FBQ0g7QUFHRztBQUNIO0FBR0c7QUFDSDtBQUdKO0FBQ0o7O0FBRUQ7QUFFSTtBQUVJO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFDSjtBQUNKOztBQUdMOztBQUVRO0FBRUk7QUFDSDtBQUdHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNJO0FBQ0g7QUFHRztBQUNIO0FBRUo7QUFFUjs7QUFFRDtBQUNBO0FBRUk7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFFSTtBQUNBO0FBQ0g7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7OztBQUlBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEOzs7O0FBSUE7QUFDSTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0g7QUFFRztBQUNIOztBQUdEO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDs7QUFFRDtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUVIO0FBRUo7O0FBRUQ7QUFFSTtBQUNBO0FBQ0M7QUFDQTtBQUNBO0FBRUc7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNIO0FBR0c7QUFDSDs7QUFFRDtBQUNGO0FBRUw7O0FBRUc7Ozs7QUFJSjtBQUVJO0FBQ0E7QUFFSTtBQUVJO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFDSjtBQUNKO0FBR0c7QUFFSTtBQUVJO0FBQ0g7QUFHRztBQUNIO0FBQ0o7QUFDSjtBQUlKOztBQUdEOzs7O0FBSUE7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBR0c7QUFDQTtBQUNIO0FBQ0Q7QUFFSTtBQUNBO0FBRUk7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUg7QUFFSjs7QUFFRDs7O0FBR0E7QUFFSTtBQUNIOztBQUVEOzs7QUFHQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUNEO0FBQ0g7O0FBRUQ7Ozs7QUFJQTs7QUFJQTtBQUNBOztBQUVBO0FBNXdCSzs7Ozs7Ozs7OztBQ0ZUO0FBQ0k7O0FBRUE7O0FBR0E7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDQztBQUNJOztBQUVBO0FBRUk7QUFDSDs7QUFFRDtBQUNIO0FBckJHOzs7Ozs7Ozs7O0FDQVQ7QUFBZ0w7QUFBbVI7QUFBZ0M7QUFBVTtBQUFVO0FBQUs7QUFBZ0I7QUFBQztBQUF3QztBQUFnYztBQUFPO0FBQUs7QUFBaUM7QUFBQztBQUFDO0FBQXVHO0FBQTRNO0FBQWtCO0FBQW1DO0FBQUs7QUFBZ0Q7QUFBa0k7QUFBSztBQUFnQztBQUFpRjtBQUFDO0FBQWdEO0FBQUM7QUFBMEY7QUFBeUM7QUFBeUI7QUFBSztBQUEyQjtBQUF5QjtBQUEyQjtBQUFLO0FBQW1KO0FBQUM7QUFBQztBQUFpQztBQUE0RjtBQUFpQztBQUFtTztBQUEyRjtBQUFtTjtBQUFnZTtBQUE4ZjtBQUF1RDs7Ozs7Ozs7OztBQ0F6ekg7QUFBeUU7QUFBMlY7QUFBaUQ7QUFBbUM7QUFBaUQ7QUFBa0M7QUFBbUY7QUFBa0I7QUFBd0Q7QUFBOEI7QUFBZ0Q7QUFBK0I7QUFBZTtBQUF5QjtBQUFvRTtBQUE0RjtBQUFtQztBQUF5QjtBQUEyQjtBQUFLO0FBQTBCO0FBQUM7QUFBd0I7QUFBeUM7QUFBaUU7QUFBc0M7QUFBb0U7QUFBRTtBQUFDO0FBQWdGO0FBQThFO0FBQStIO0FBQXdDO0FBQXFDO0FBQXdDO0FBQTBCO0FBQWdDO0FBQWtDO0FBQStGO0FBQXlMO0FBQWlFO0FBQWlOO0FBQTZDO0FBQXVCO0FBQWdDO0FBQUs7QUFBMEI7QUFBNkI7QUFBMEI7QUFBQztBQUFXO0FBQTJFO0FBQTRPO0FBQStCO0FBQThFO0FBQXNCO0FBQXFGO0FBQW9IO0FBQW1IO0FBQXFDO0FBQUs7QUFBMkQ7QUFBb0Q7QUFBd0M7QUFBc0M7QUFBd0I7QUFBdUU7QUFBeUY7QUFBSztBQUFzRjtBQUE0QjtBQUFpRztBQUF5QjtBQUE4QjtBQUFrRDtBQUFvRztBQUEyRTtBQUF3RjtBQUFLO0FBQXlCO0FBQWtDO0FBQTRCO0FBQWdKO0FBQTBHO0FBQThEO0FBQW1KO0FBQ2oySjtBQUFnVDtBQUE2QztBQUFzSztBQUFvQztBQUFnQztBQUFxQztBQUFLO0FBQWtCO0FBQUM7QUFBbUc7QUFBVTtBQUE0QjtBQUErTTtBQUFpTDtBQUFzUTtBQUFrRDtBQUFxUztBQUFHOzs7Ozs7Ozs7O0FDQWp2RDs7QUFFQTtBQUNJOztBQUVBOztBQUVJOztBQUVBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBQ0k7QUFDQTtBQUZhOztBQUtqQjs7QUFFQTtBQUVJO0FBQ0E7QUFGSjs7QUFLQTtBQUNBO0FBQ0k7QUFDQTtBQUZ1Qjs7QUFLM0I7QUF6Q1E7O0FBNkNaO0FBQ0E7O0FBSUE7QUFFSTtBQUNDOztBQUVHO0FBQ0E7QUFFSTtBQUNIO0FBR0c7QUFDSDs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVQOztBQUVEO0FBRUk7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBRUg7O0FBRUQ7QUFFSTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBRUg7O0FBRUQ7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBR0Q7QUFFSTs7Ozs7Ozs7OztBQVVBO0FBRUk7QUFDSDtBQUVKOztBQUdEO0FBQ0E7O0FBRUE7QUFqS0s7Ozs7Ozs7Ozs7QUNIVDtBQUFpRDtBQUE0RDtBQUFnRDtBQUFtRDtBQUF5QjtBQUFvQztBQUF3QjtBQUEwQztBQUFDO0FBQWtFO0FBQW1CO0FBQW1GO0FBQThDO0FBQW9DO0FBQTRDO0FBQTRDO0FBQUM7QUFBMEM7QUFBa0M7QUFBQztBQUFrQjtBQUF3QztBQUFFO0FBQTZFO0FBQW1EO0FBQXVCO0FBQUs7QUFBNkI7QUFBQztBQUE0QjtBQUFxQztBQUE0QjtBQUEwSjtBQUFnQztBQUEwSDtBQUFDO0FBQUs7QUFBaUM7QUFBaUQ7QUFBQztBQUF3QztBQUFrQjtBQUF3STtBQUFrQjtBQUE2RTtBQUF5QjtBQUFrQztBQUFvRTtBQUFvTDtBQUFDO0FBQW9DO0FBQW1HO0FBQXdDO0FBQXVFO0FBQXNHO0FBQXdIO0FBQXlCO0FBQXdCO0FBQTZFO0FBQTREO0FBQWdEO0FBQXlEO0FBQXlHO0FBQXVGO0FBQTRCO0FBQTJCO0FBQXFGO0FBQTBEO0FBQWlEO0FBQXFEO0FBQUk7QUFBK0Q7QUFBUztBQUF3QztBQUFDO0FBQXlCO0FBQTJEO0FBQXdGO0FBQW1EO0FBQXdCO0FBQTBCO0FBQXNCO0FBQXdEO0FBQTRCO0FBQWlNO0FBQXFDO0FBQUs7QUFBOEQ7QUFBNEc7QUFBdUQ7QUFBdUM7QUFBOEU7QUFBc0Q7QUFBa0I7QUFBNEU7QUFBZ0g7QUFBMkM7QUFBa0I7QUFBd0Q7QUFBZ0M7QUFBd0Q7QUFBa0M7QUFBa0I7QUFBNEI7QUFDdDFKO0FBQVk7QUFBaUQ7QUFBNkI7QUFBOEM7QUFBQztBQUFvQztBQUE2QjtBQUEwRDtBQUFDO0FBQWlDOzs7Ozs7Ozs7O0FDRDFTO0FBQTJDO0FBQW9JO0FBQThJO0FBQXlPO0FBQXVEO0FBQUM7QUFBK0M7QUFBNEI7QUFBOEI7QUFBQztBQUE0QjtBQUEyQjtBQUFzRztBQUFxRTtBQUE2QjtBQUFDO0FBQTZEO0FBQVE7QUFBNE07QUFBQztBQUFzQztBQUEyRTs7Ozs7Ozs7OztBQ0MzMEM7O0FBRUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBUnVCO0FBV3pCO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGVztBQUlmO0FBQ0E7QUFDSTtBQUNBO0FBRlk7QUFJaEI7QUFDQTs7QUFkUTs7QUFrQlo7QUFDQTtBQUNJO0FBQ0s7QUFDSjs7QUFFRDtBQUNLO0FBQ0Q7QUFDQTtBQUVIOztBQUVEO0FBQ0s7QUFDSjs7QUFFRDtBQUNLO0FBQ0o7O0FBRUQ7QUFDSztBQUNEO0FBQ0E7QUFFSDs7QUFFRDtBQUNLO0FBQ0o7QUFFSjs7QUFFRDtBQUVJO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSDtBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUVJO0FBQ0g7O0FBRUQ7QUFFSTtBQUVJO0FBQ0g7O0FBRUQ7QUFFSTtBQUNIO0FBQ0o7O0FBMUdJOzs7Ozs7Ozs7O0FDWlQ7QUFBMkM7QUFBeU87QUFBOEI7QUFBaUM7QUFBbU47QUFBVTtBQUFxQjtBQUE4RjtBQUE0QztBQUF5QjtBQUFnRDtBQUF3QztBQUFpRDtBQUFDOzs7Ozs7Ozs7O0FDQ2wzQjs7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFScUI7O0FBYXZCO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUZlO0FBSW5CO0FBTlE7O0FBU1o7QUFDQTs7QUFJQTs7OztBQUlBOztBQUdJO0FBRUk7QUFFSTtBQUNIO0FBR0c7QUFDSDtBQUNKO0FBR0o7O0FBRUQ7Ozs7QUFJQTtBQUVJO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFDSjs7QUFFRDs7Ozs7Ozs7O0FBU0E7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDSDtBQUdHO0FBQ0E7QUFDSDs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0g7O0FBekZJOztBQWlHVDtBQUNJO0FBRGE7Ozs7Ozs7Ozs7QUMvR2pCO0FBQ0k7O0FBRUE7O0FBRUk7QUFFSTtBQUNBO0FBRko7QUFIUTs7QUFTWjtBQUNBOztBQUlBO0FBRUk7QUFFSTtBQUVJO0FBQ0g7QUFHRztBQUNIO0FBRUo7QUFDSjs7QUFFRDtBQUVJOzs7Ozs7Ozs7Ozs7O0FBY0E7QUFDQTtBQUNBO0FBQ0g7QUFwREk7Ozs7Ozs7Ozs7QUNFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFDSTs7QUFFQTtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUZROztBQUtaO0FBQ0k7QUFDQTtBQUZPOztBQUtYO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFGUTtBQUlaO0FBQ0k7QUFDQTtBQUZLO0FBSVQ7QUFDSTtBQUNBO0FBRks7QUFJVDtBQUNFO0FBQ0E7QUFGYTs7QUFLZjtBQUNBO0FBQ0k7QUFDQTtBQUZXOztBQUtmO0FBQ0E7QUFDSTtBQUNBO0FBRlM7QUFJYjtBQUNJO0FBQ0E7QUFGVTs7QUFLZDtBQUNBO0FBQ0k7QUFDQTtBQUZPOztBQUtYO0FBQ0k7QUFDQTtBQUZpQjs7QUFLckI7QUFDSTtBQUNBO0FBRmlCOztBQUtyQjtBQUNJO0FBQ0E7QUFGZ0I7O0FBS3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUE5RVE7O0FBa0ZaO0FBQ0E7O0FBRUk7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBRUc7QUFDQTtBQUNIO0FBRUc7QUFDQTtBQUNIOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVIOztBQUdEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBRUc7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDSTtBQUNIO0FBQ0w7QUFDSDs7QUFFRDtBQUNJO0FBQ0g7O0FBRUQ7QUFDSTtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUVLOztBQUVEO0FBRUk7QUFDSDtBQUNHOztBQUdJOztBQUdFO0FBQ0E7QUFDSTtBQUNIO0FBRUQ7O0FBRUU7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBRUk7QUFDSDtBQUNGO0FBQ0Y7QUFDSjtBQUdHO0FBQ0g7QUFDSjtBQUdFO0FBQ0Y7QUFFSDs7QUFFRjtBQUNJO0FBQ0k7QUFDQTs7QUFFQTtBQUNJO0FBQXNCO0FBQ2xCO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNIO0FBQ0o7QUFFRztBQUNIO0FBQ0o7QUFFRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTs7Ozs7Ozs7Ozs7Ozs7O0FBbUJIOztBQUVEO0FBRUk7QUFDSDs7QUFFRDtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFFRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNIOztBQUVEO0FBRUE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBOztBQUVJO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSjs7QUFFRDtBQUVJO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBRUk7QUFFSTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBRUk7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJOztBQUVBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNBOztBQUVBOztBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFFRztBQUNBO0FBQ0g7O0FBRUQ7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQU87QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUFPO0FBQ0g7O0FBRUg7QUFDRDtBQUNBO0FBQ0E7QUFwREo7QUFzREg7O0FBRUQ7QUFDSTtBQUNIOztBQUVEO0FBQ0k7O0FBRUE7O0FBRUE7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDSTtBQUNIO0FBRUc7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0k7O0FBRUE7QUFDQTtBQUVJO0FBQ0g7QUFDRDtBQUNIO0FBRUQ7QUFDSTtBQUNJO0FBQ0g7QUFDRDtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNIOztBQUVEO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNIOztBQUVEO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBR0c7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7O0FBRUQ7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSDs7QUFFRDtBQUNJOztBQUVBO0FBQ0k7QUFDQTs7QUFFQTtBQUNJO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDRztBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7QUFDSjs7QUFFRDtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFPO0FBQ0g7QUFFSTtBQUFTO0FBQ1Q7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUFTO0FBQ1Q7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNUO0FBQ0k7QUFDQTs7QUFFQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNBO0FBQ0E7QUFBUztBQUNUO0FBM0RKO0FBNkRIO0FBQ0Q7QUFDQTtBQUFZO0FBQ1I7QUFDUTtBQUVRO0FBQ0E7QUFDQTtBQUVJO0FBRUk7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNaO0FBQ0Q7QUFDSjtBQUFZO0FBQ1o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUFZO0FBQ1o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUVJO0FBQVM7QUFDTDtBQUNJO0FBQ0E7O0FBRUM7O0FBRUQ7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUVJO0FBRUk7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUFTO0FBQUM7QUFDTjtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJOzs7Ozs7QUFNQTtBQUNIO0FBQ0Q7QUF6Q1I7QUEyQ0g7QUFDRDtBQXhKQTtBQTJKSDtBQUNEOztBQUVBOzs7QUFHQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7O0FBRUQ7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7O0FBRUQ7QUFFSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUNBO0FBQ0g7O0FBRUQ7QUFDQTtBQUVJO0FBRUk7QUFDQTtBQUNBO0FBQ0k7O0FBSUE7QUFDSTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFHQztBQUNBO0FBQ0E7QUFHSjtBQUNJO0FBQ0Q7QUFDQTs7Ozs7O0FBTUg7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEOztBQUVBO0FBQ0k7QUFqRFI7QUFvREg7O0FBRUQ7QUFDQTtBQUNJO0FBQ0E7O0FBRUE7QUFFSTtBQUVJO0FBQ0k7QUFDSTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBV0c7QUFDQTtBQUNBO0FBQ0g7QUFHRztBQUNBO0FBQ0E7QUFDSDtBQVNKO0FBQ0Q7QUFDSjtBQUNJO0FBR0E7QUFDSjtBQUNJO0FBQ0E7QUEvQ1I7QUFpREg7QUFHRztBQUVJO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQVZSO0FBWUg7QUFDSjs7QUFFRDtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUVJO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTtBQUdJO0FBQ0g7QUFFRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7O0FBR0c7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFFRDtBQUNJO0FBQ0k7QUFFSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFHRDtBQUNJO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBRUg7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJOztBQUVBOztBQUVBO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNJO0FBQ0E7QUFDSDtBQUNEO0FBQ0g7QUFDSjs7QUFFRDtBQUNIO0FBRUc7QUFDSDtBQUNKOztBQXJsQ0k7Ozs7Ozs7Ozs7QUNWVDtBQUErQztBQUE0SDtBQUFzQjtBQUE0QztBQUFDO0FBQTBEO0FBQTRFO0FBQW9DO0FBQXNCO0FBQStKO0FBQXlyRjtBQUF3QjtBQUFzbkI7QUFBc0Y7QUFBWTtBQUFrQjtBQUE4RTtBQUE4QjtBQUF5RDtBQUEyQjtBQUF5RDtBQUEyQjtBQUFrRDtBQUEyQjtBQUFxRDtBQUF3RTs7Ozs7Ozs7OztBQ0F0K0k7QUFBNkQ7QUFBNEc7QUFBd0M7QUFBaUU7QUFBd0M7QUFBYzs7Ozs7Ozs7OztBQ0F4VTtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKUTs7QUFPWjtBQUNBO0FBQ0k7QUFDQTtBQUNLO0FBQ0o7O0FBRUQ7QUFDSztBQUNBO0FBQ0E7QUFDRDtBQUNBO0FBRUg7O0FBRUQ7O0FBRUk7QUFHQztBQUNSOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFFRDtBQUtBO0FBQ0E7QUFDQTtBQUNJO0FBRUk7QUFFSTtBQUNIO0FBR0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjs7QUF6RUkiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8v5oyJ6ZKu5qCH6K+GXG52YXIgRWJ1dHRvblRhZyA9IGNjLkVudW0oe1xuXG4gIGVDaGlwMjA6IDAsXG4gIGVDaGlwNTA6IDEsICAgXG4gIGVDaGlwMTAwOiAyLCAgICAgIFxuICBlQ2hpcDUwMDozLCBcbiAgZUNoaXAxMDAwOjQsIFxuICBlQ2xlYXIgOiA1LCAgXG4gIGVIaXN0b3J5TGlzdDogNixcblxufSk7XG5cblxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzY2FsZUZsYWc6dHJ1ZSxcbiAgICAgICAgYnV0dG9uVGFnOjAsXG4gICAgICAgIHBhcmVudE5vZGU6IGNjLk5vZGUsLy/niLboioLngrko5Li65LqG57uT5bGA54K55Ye75Yy65Z+f57yp5ZCOIOS6i+S7tuS4jeWTjeW6lCDnu5/nu5/liqDkuobniLboioLngrnmnaXlpITnkIbkuovku7bvvIzlr7nlrZDoioLngrnnvKnmlL4gMjAxNy0wNC0xMCBQTTozNDApXG4gICAgICAgIFxuICAgIH0sXG5cblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vIHZhciB0aW1lQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZHQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKHRoaXMucGFyZW50Tm9kZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2NhbGVGbGFnKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGUuc2NhbGUgPSAwLjg7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSx0aGlzKTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgXG4gICAgICAgIGlmKHRoaXMucGFyZW50Tm9kZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICBpZih0aGlzLnNjYWxlRmxhZylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuc2NhbGUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9uRnVuY3Rpb24gPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dhbWUnKTtcbiAgICAgICAgICAgIG9uRnVuY3Rpb24uYnRuQWN0aW9uQ2FsbEJhY2sodGhpcy5idXR0b25UYWcpO1xuXG4gICAgICAgICAgIFxuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMucGFyZW50Tm9kZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICBpZih0aGlzLnNjYWxlRmxhZylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuc2NhbGUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB9LHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG5cblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIEVidXR0b25UYWcgOiBFYnV0dG9uVGFnLFxufTtcblxuXG5cbiIsIlxudmFyIENyeXB0b0pTID0gcmVxdWlyZShcImNvcmVcIik7XG5yZXF1aXJlKFwiYWVzXCIpO1xudmFyIE5ldERhdGEgPSByZXF1aXJlKFwiTmV0RGF0YVwiKTtcblxudmFyIEtleVZhbHVlID0gY2MuQ2xhc3Moe1xuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAga2V5IDogXCJcIixcbiAgICAgICAgdmFsdWUgOiBcIlwiXG4gICAgfVxufSk7XG5cbnZhciBDdXNNYXAgPSBjYy5DbGFzcyh7XG4gICAgcHJvcGVydGllczp7XG4gICAgICAgIG1hcHMgOiB7XG4gICAgICAgICAgICBkZWZhdWx0IDogW10sXG4gICAgICAgICAgICB0eXBlIDogW0tleVZhbHVlXSxcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogZmFsc2VcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgc2V0IDogZnVuY3Rpb24oa2V5LCB2YWx1ZSl7XG4gICAgICAgIHZhciBzX2tleSA9IGtleS50b1N0cmluZygpO1xuICAgICAgICB2YXIgZmxhZyA9IGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubWFwcy5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICBpZih0aGlzLm1hcHNbaV0ua2V5ID09PSBzX2tleSl7XG4gICAgICAgICAgICAgICAgZmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXBzW2ldLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmKGZsYWcgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIHZhciBrZXlWYWx1ZSA9IG5ldyBLZXlWYWx1ZSgpO1xuICAgICAgICAgICAga2V5VmFsdWUua2V5ID0gc19rZXk7XG4gICAgICAgICAgICBrZXlWYWx1ZS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5tYXBzLnB1c2goa2V5VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBnZXQgOiBmdW5jdGlvbihrZXkpe1xuICAgICAgICB2YXIgc19rZXkgPSBrZXkudG9TdHJpbmcoKTtcbiAgICAgICAgXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm1hcHMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgaWYodGhpcy5tYXBzW2ldLmtleSA9PT0gc19rZXkpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcHNbaV0udmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBjbGVhciA6IGZ1bmN0aW9uKGtleSl7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm1hcHMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgaWYodGhpcy5tYXBzW2ldLmtleSA9PSBrZXkpe1xuICAgICAgICAgICAgICAgIHRoaXMubWFwcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxudmFyIE5ldFdvcmsgPSBjYy5DbGFzcyh7XG4gICAgc2VuZCA6IGZ1bmN0aW9uKHJlcXVlc3RJZCwgcmVxdWVzdEhlYWRlcnMsIHJlcXVlc3REYXRhLCBjYWxsZnVuYyl7XG4gICAgICAgIHZhciB4aHIgPSBjYy5sb2FkZXIuZ2V0WE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICBpZiAoIUNDX0pTQil7XG4gICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICB4aHIgPSB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5nZXRIdHRwUmVxdWVzdE9iamVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgeGhyLm9wZW4oXCJQT1NUXCIsIFwiaHR0cDovLzEwLjAuMjAuMTcyOjgwODAvZ2F0ZXdheS9wcm9jZXNzXCIpO1xuICAgICAgICAvL3hoci5vcGVuKFwiUE9TVFwiLCBcImh0dHA6Ly8xNzIuMTYuMjAuMTYxOjcwODAvZ2F0ZXdheS9wcm9jZXNzXCIpOy8vXCJodHRwOi8vMTcyLjE2LjIwLjE3NTo4MDgwL2dhdGV3YXkvcHJvY2Vzc1wiKTsgLy9cImh0dHA6Ly8xMC4wLjEuMjMyOjcwODAvbmV3X2dhdGV3YXkvcHJvY2Vzc1wiKTsgXG4gICAgICAgIHhoci50aW1lb3V0ID0gMTUwMDA7Ly8xNXPotoXml7ZcbiAgICAgICAgXG4gICAgICAgIC8v6K6+572u6K+35rGC5aS0XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByZXF1ZXN0SGVhZGVycy5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihyZXF1ZXN0SGVhZGVyc1tpXS5rZXksIHJlcXVlc3RIZWFkZXJzW2ldLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgeGhyLnNlbmQocmVxdWVzdERhdGEpO1xuICAgIFxuICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2FsbGZ1bmMocmVxdWVzdElkLCB4aHIpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgY2FsbGZ1bmMocmVxdWVzdElkLCB4aHIpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgeGhyLm9udGltZW91dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjYWxsZnVuYyhyZXF1ZXN0SWQsIHhocik7XG4gICAgICAgIH07XG4gICAgfVxufSk7XG5cbnZhciBEYXRhT3BlciA9IGNjLkNsYXNzKHtcbiAgICBcbiAgICBzdGF0aWNzIDoge1xuICAgICAgICBnX0RhdGFPcGVySW5zdCA6IG51bGwsXG4gICAgICAgIHNfaW5kZXggOiAwLFxuICAgICAgICBcbiAgICAgICAgZ2V0SW5zdDpmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihEYXRhT3Blci5nX0RhdGFPcGVySW5zdCA9PT0gbnVsbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBEYXRhT3Blci5nX0RhdGFPcGVySW5zdCA9IG5ldyBEYXRhT3BlcigpO1xuICAgICAgICAgICAgICAgIERhdGFPcGVyLmdfRGF0YU9wZXJJbnN0LmluaXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBEYXRhT3Blci5nX0RhdGFPcGVySW5zdDtcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuXG4gICAgICAgIGRlc3RvcnlJbnN0OmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKERhdGFPcGVyLmdfRGF0YU9wZXJJbnN0ICE9PSBudWxsKXtcbiAgICAgICAgICAgICAgICBEYXRhT3Blci5nX0RhdGFPcGVySW5zdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcHJvcGVydGllcyA6IHtcbiAgICAgICAgLy/or7fmsYJkYXRhXG4gICAgICAgIHJlcXVlc3REYXRhIDogXCJcIixcbiAgICAgICAgLy/or7fmsYJpZFxuICAgICAgICByZXF1ZXN0SWQgOiAwLFxuICAgICAgICAvL2FlcyBLZXlcbiAgICAgICAgYWVzS2V5IDogXCI4MTdmZWQ5NWY5ZTE2YmVkXCIsLy/np5jpkqXvvIzlhpnmrbtcbiAgICAgICAgXG4gICAgICAgIC8vKioqKioqKioqKioqKioqKuivt+axguWktOS/oeaBryoqKioqKioqKipcbiAgICAgICAgLy/or7fmsYLlpLTmlbDnu4RcbiAgICAgICAgcmVxdWVzdEhlYWRlcnMgOiB7XG4gICAgICAgICAgICBkZWZhdWx0IDogW10sXG4gICAgICAgICAgICB0eXBlIDogW0tleVZhbHVlXSxcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgLy/lkb3ku6Tlj7dcbiAgICAgICAgaGVhZGVyQ21kIDogMCwgLy/liJ3lp4vljJYtMTAwICDmipXms6gtMTAxICDnu5PnrpctMTAzXG4gICAgICAgIC8vc2lnXG4gICAgICAgIGhlYWRlclNpZyA6IFwiXCIsXG4gICAgICAgIC8v54mI5pys5Y+3XG4gICAgICAgIGhlYWRlclZlciA6IFwiMS4wXCIsXG4gICAgICAgIC8v5Lya6K+d5qCH6K+GXG4gICAgICAgIGhlYWRlclRva2VuIDogXCIzNzA5MTg3MTg5XCIsLy9cIjM3MDYyMDE3NzlcIixcbiAgICAgICAgLy/muLjmiI/muKDpgZPlrp7kvovmoIfor4ZcbiAgICAgICAgZ2FtZVRva2VuIDogXCJhZDgwZGI5OTRkYWJiOTBiNDJkYjAwMjE0YjhkMzAxZC05LTkwMS0xMjAyXCIsLy9cImRkZDc2Y2Q2ZTliNjJkYzIyNTlhYTc3MmE0NTAxYjIyLTktOTUxLTkyNlwiLFxuICAgICAgICAvL+a4uOaIj+agh+ivhlxuICAgICAgICAvL2hlYWRlckdpZCA6IFwiMTAwMDRcIiAgLy/mr4/kuKrmuLjmiI/lnKjov5nph4zlhpnmrbsgIOWQjOiKsemhui0xMDAwMCAg5bCP5oCq6IGU55ufLTEwMDAxICDml5flvIDlvpfog5wtMTAwMDIg5aWH5bm75a6d55+zLTEwMDAzIOiAgeiZjuacui0xMDAwNCDlnLDkuqflpKfkuqgtMTAwMDVcbiAgICB9LFxuICAgIFxuICAgIGluaXQgOiBmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLmNhbGxmdW5jcyA9IG5ldyBDdXNNYXAoKTtcbiAgICAgICAgdGhpcy5jYWxsbm9kZSA9IG5ldyBDdXNNYXAoKTtcbiAgICAgICAgdGhpcy5jYWxsY21kID0gbmV3IEN1c01hcCgpO1xuICAgICAgICBjYy5sb2coXCJqYj1cIiArIENDX0pTQik7XG4gICAgICAgIFxuICAgICAgICBpZiAoIUNDX0pTQil7XG4gICAgICAgICAgICB0aGlzLmdhbWVUb2tlbiA9IHRoaXMuR2V0UXVlcnlTdHJpbmcoXCJhY2Nlc3NUb2tlblwiKTtcbiAgICAgICAgXG4gICAgICAgICAgICBpZih0aGlzLmdhbWVUb2tlbiA9PSBudWxsKXsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lVG9rZW4gPSBcImFkODBkYjk5NGRhYmI5MGI0MmRiMDAyMTRiOGQzMDFkLTktOTAxLTEyMDJcIjsvL1wiZGRkNzZjZDZlOWI2MmRjMjI1OWFhNzcyYTQ1MDFiMjItOS05NTEtOTI2XCI7XG4gICAgICAgICAgICAgICAgbGV0IHRvayA9IHRoaXMuR2V0UXVlcnlTdHJpbmcoXCJ0b2tcIik7XG5cbiAgICAgICAgICAgICAgICBpZih0b2spe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlclRva2VuID0gdG9rO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvaz1cIiArIHRoaXMuaGVhZGVyVG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlclRva2VuID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy90ZXN0XG4gICAgICAgICAgICAgICAgLyp2YXIgbXlEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhlYWRlclRva2VuID0gbXlEYXRlLmdldFRpbWUoKTsqL1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG5cbiAgICAgICAgfSAgICAgICAgXG5cbiAgICAgICAgY29uc29sZS5sb2coXCJ0aGlzLmdhbWVUb2tlbiA9IFwiICsgdGhpcy5nYW1lVG9rZW4pO1xuICAgIH0sXG5cbiAgICBHZXRRdWVyeVN0cmluZyA6IGZ1bmN0aW9uKG5hbWUpXG4gICAge1xuICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cChcIihefCYpXCIrIG5hbWUgK1wiPShbXiZdKikoJnwkKVwiKTtcbiAgICAgICAgdmFyIHIgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5tYXRjaChyZWcpO1xuICAgICAgICBpZihyIT09bnVsbClyZXR1cm4gIHVuZXNjYXBlKHJbMl0pOyByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIFxuICAgIHNldFJlcXVlc3RIZWFkZXIgOiBmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzID0gW107XG5cbiAgICAgICAgdmFyIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwiY21kXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5oZWFkZXJDbWQudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycy5wdXNoKGtleVZhbHVlKTtcbiAgICAgICAgXG4gICAgICAgIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwiQ29udGVudC1UeXBlXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gXCJ0ZXh0L3BsYWluXCI7XG4gICAgICAgIHRoaXMucmVxdWVzdEhlYWRlcnMucHVzaChrZXlWYWx1ZSk7XG4gICAgICAgIFxuICAgICAgICAvKmtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwiY2lkXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5oZWFkZXJDaWQudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycy5wdXNoKGtleVZhbHVlKTsqL1xuICAgICAgICBcbiAgICAgICAga2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAga2V5VmFsdWUua2V5ID0gXCJzaWdcIjtcbiAgICAgICAga2V5VmFsdWUudmFsdWUgPSB0aGlzLmhlYWRlclNpZy50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpO1xuICAgICAgICBcbiAgICAgICAga2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAga2V5VmFsdWUua2V5ID0gXCJ2ZXJcIjtcbiAgICAgICAga2V5VmFsdWUudmFsdWUgPSB0aGlzLmhlYWRlclZlci50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpO1xuICAgICAgICBcbiAgICAgICAga2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAga2V5VmFsdWUua2V5ID0gXCJ0b2tcIjtcbiAgICAgICAga2V5VmFsdWUudmFsdWUgPSB0aGlzLmhlYWRlclRva2VuLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucmVxdWVzdEhlYWRlcnMucHVzaChrZXlWYWx1ZSk7XG5cbiAgICAgICAga2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAga2V5VmFsdWUua2V5ID0gXCJnYW1lVG9rZW5cIjtcbiAgICAgICAga2V5VmFsdWUudmFsdWUgPSB0aGlzLmdhbWVUb2tlbi50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpO1xuICAgICAgICBcbiAgICAgICAgLyprZXlWYWx1ZSA9IG5ldyBLZXlWYWx1ZSgpO1xuICAgICAgICBrZXlWYWx1ZS5rZXkgPSBcImdpZFwiO1xuICAgICAgICBrZXlWYWx1ZS52YWx1ZSA9IHRoaXMuaGVhZGVyR2lkLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucmVxdWVzdEhlYWRlcnMucHVzaChrZXlWYWx1ZSk7Ki9cbiAgICB9LFxuICAgIFxuICAgIHJlcXVlc3QgOiBmdW5jdGlvbihjYWxsRnVuYywgc2VsZil7XG4gICAgICAgIC8vaWYodGhpcy5oZWFkZXJDbWQgIT0gMTA1KXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVxdWVzdC0tLS0tLS0tLS0tZGF0YSA9IFwiICsgdGhpcy5yZXF1ZXN0RGF0YSArIFwiO2NtZDpcIiArIHRoaXMuaGVhZGVyQ21kKTtcbiAgICAgICAgLy99XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNhbGxmdW5jcy5zZXQoRGF0YU9wZXIuc19pbmRleCwgY2FsbEZ1bmMpO1xuICAgICAgICB0aGlzLmNhbGxub2RlLnNldChEYXRhT3Blci5zX2luZGV4LCBzZWxmKTtcbiAgICAgICAgdGhpcy5jYWxsY21kLnNldChEYXRhT3Blci5zX2luZGV4LCB0aGlzLmhlYWRlckNtZCk7XG4gICAgICAgIC8vYWVz5Yqg5a+GXG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSB0aGlzLkFFU0VuY3J5cHRpb24odGhpcy5yZXF1ZXN0RGF0YSwgdGhpcy5hZXNLZXkpO1xuICAgICAgICAvL0Jhc2U2NFxuICAgICAgICAvL3RoaXMucmVxdWVzdERhdGEgPSBCYXNlNjQuZW5jb2RlKHRoaXMucmVxdWVzdERhdGEpO1xuICAgICAgICAvL2d6aXBcbiAgICAgICAgLy90aGlzLnJlcXVlc3REYXRhID0gdGhpcy5yZXF1ZXN0RGF0YTtcbiAgICAgICAgLy9tZDVcbiAgICAgICAgdGhpcy5oZWFkZXJTaWcgPSBDcnlwdG9KUy5NRDUodGhpcy5yZXF1ZXN0RGF0YSk7XG4gICAgICAgIC8v6K+35rGC5aS0XG4gICAgICAgIHRoaXMuc2V0UmVxdWVzdEhlYWRlcigpO1xuICAgICAgICAvL3NlbmRcbiAgICAgICAgdmFyIG5ldFdvcmsgPSBuZXcgTmV0V29yaygpO1xuICAgICAgICBuZXRXb3JrLnNlbmQoRGF0YU9wZXIuc19pbmRleCwgdGhpcy5yZXF1ZXN0SGVhZGVycywgdGhpcy5yZXF1ZXN0RGF0YSwgdGhpcy5vbkh0dHBSZXF1ZXN0Q29tcGxldGVkKTtcbiAgICAgICAgRGF0YU9wZXIuc19pbmRleCsrO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog6IGU572R5Zue6LCDXG4gICAgICogQFBhcmFtIHJlcXVlc3RJZCDor7fmsYJpZFxuICAgICAqIEBwYXJhbSBzdGF0dXMgICDogZTnvZHnirbmgIFcbiAgICAgKiBAcGFyYW0gcmVzcG9uZURhdGEg5ZON5bqUZGF0YVxuICAgICAqL1xuICAgIG9uSHR0cFJlcXVlc3RDb21wbGV0ZWQgOiBmdW5jdGlvbihyZXF1ZXN0SWQsIHhocil7XG4gICAgICAgIGNvbnNvbGUubG9nKFwib25IdHRwUmVxdWVzdENvbXBsZXRlZC54aHIuc3RhdHVzPVwiICsgeGhyLnN0YXR1cyk7XG4gICAgICAgIHZhciBjYWxsRnVuYyA9IERhdGFPcGVyLmdldEluc3QoKS5jYWxsZnVuY3MuZ2V0KHJlcXVlc3RJZCk7XG4gICAgICAgIHZhciBjYWxsTm9kZSA9IERhdGFPcGVyLmdldEluc3QoKS5jYWxsbm9kZS5nZXQocmVxdWVzdElkKTtcbiAgICAgICAgdmFyIGNhbGxDbWQgPSBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGNtZC5nZXQocmVxdWVzdElkKTtcbiAgICAgICAgY2MubG9nKFwiY2FsbENtZD1cIiArIGNhbGxDbWQgKyBcIi9sbj1cIiArIERhdGFPcGVyLmdldEluc3QoKS5jYWxsY21kLm1hcHMubGVuZ3RoICsgXCInXCIgKyBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGZ1bmNzLm1hcHMubGVuZ3RoICsgXCInXCIgKyBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbG5vZGUubWFwcy5sZW5ndGgpO1xuICAgICAgICBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGZ1bmNzLmNsZWFyKHJlcXVlc3RJZCk7XG4gICAgICAgIERhdGFPcGVyLmdldEluc3QoKS5jYWxsbm9kZS5jbGVhcihyZXF1ZXN0SWQpO1xuICAgICAgICBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGNtZC5jbGVhcihyZXF1ZXN0SWQpO1xuXG4gICAgICAgIGlmKCh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzAwKSB8fCB4aHIuc3RhdHVzID09PSAzMDQpe1xuICAgICAgICAgICAgLy/lj5ZodHRw5aS0XG4gICAgICAgICAgICAvL+WRveS7pOWPt1xuICAgICAgICAgICAgdmFyIGNtZCA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcImNtZFwiKTtcbiAgICAgICAgICAgIGNtZCA9IHBhcnNlSW50KGNtZCk7XG4gICAgICAgICAgICAvL3Jlc1xuICAgICAgICAgICAgdmFyIHJlcyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcInJlc1wiKTtcbiAgICAgICAgICAgIC8vbXNnXG4gICAgICAgICAgICB2YXIgbXNnID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKFwibXNnXCIpO1xuICAgICAgICAgICAgbXNnID0gZGVjb2RlVVJJQ29tcG9uZW50KG1zZyk7XG4gICAgICAgICAgICAvL3NpZ1xuICAgICAgICAgICAgdmFyIHNpZyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcInNpZ1wiKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInhoci5zdGF0dXM9XCIgKyB4aHIuc3RhdHVzICsgXCJ8cmU9XCIgKyByZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihyZXMgPT0gMCl7XG4gICAgICAgICAgICAgICAgLy/lj5Zib2R5XG4gICAgICAgICAgICAgICAgdmFyIGJvZHkgPSB4aHIucmVzcG9uc2VUZXh0O1xuICAgICAgICAgICAgICAgIC8vbWQ16aqM6K+BXG4gICAgICAgICAgICAgICAgdmFyIHRfc2lnID0gQ3J5cHRvSlMuTUQ1KGJvZHkpO1xuICAgICAgICAgICAgICAgIGxldCB0X3NpZ19zdHIgPSBuZXcgU3RyaW5nKHRfc2lnKTtcbiAgICAgICAgICAgICAgICBsZXQgc2lnX3N0ciA9IG5ldyBTdHJpbmcoc2lnKTtcbiAgICAgICAgICAgICAgICB0X3NpZ19zdHIgPSB0X3NpZ19zdHIudHJpbSgpO1xuICAgICAgICAgICAgICAgIHNpZ19zdHIgPSBzaWdfc3RyLnRyaW0oKTtcblxuICAgICAgICAgICAgICAgIGlmKHRfc2lnX3N0ciA9PSBzaWdfc3RyKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2YWxpZnkgcmlnaHRcIik7XG4gICAgICAgICAgICAgICAgICAgIERhdGFPcGVyLmdldEluc3QoKS5wYXJzZXJTZXJ2ZXJEYXRhKGJvZHksIGNtZCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxGdW5jKGNtZCwgcmVzLCBtc2csIGNhbGxOb2RlKTtcblxuICAgICAgICAgICAgICAgICAgICAvL+abtOaWsOi0puaIt+S9meminVxuICAgICAgICAgICAgICAgICAgICAvL+WIneWni+WMluiwg+i/h+S6hu+8jOS4jeiwg+S6huOAglxuICAgICAgICAgICAgICAgICAgICBpZiAoIUNDX0pTQil7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goY21kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDE6Ly9iZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDI6Ly9jbGVhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwMzovL3Jld2FyZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy51cGRhdGVVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxGdW5jKGNtZCwgLTEsIFwi5Yqg5a+G6aqM6K+B6ZSZ6K+vXCIsIGNhbGxOb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaKpemUmS0tLXJlczpcIiArIHJlcyArIFwiLS0tLW1zZzpcIiArIG1zZyk7XG5cbiAgICAgICAgICAgICAgICAvL+e6r+S4muWKoWxvZ2ljXG4gICAgICAgICAgICAgICAgaWYoKGNtZCA9PSAxMDApICYmIChyZXMgPT0gOTk5OTk5KSl7XG4gICAgICAgICAgICAgICAgICAgIE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuaW5pdEZsYWcgPSAyO1xuICAgICAgICAgICAgICAgICAgICBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnN0b3BTZWxsaW5nRGVzYyA9IG1zZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9lbmQg5Lia5YqhXG4gICAgICAgICAgICAgICAgY2FsbEZ1bmMoY21kLCByZXMsIG1zZywgY2FsbE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8v6IGU572R5aSx6LSlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImh0dHAgc3RhdHVzOlwiICsgeGhyLnN0YXR1cyArIFwifGNhbGxDbWQ9XCIgKyBjYWxsQ21kKTtcbiAgICAgICAgICAgIGNhbGxGdW5jKGNhbGxDbWQsIC0xLCBcIue9kee7nOWPr+iDveS4jeWlveWTpu+8jOivt+mHjeivlVwiLCBjYWxsTm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAq6Kej5p6Q5pyN5Yqh5Zmo6L+U5Zue5pWw5o2uXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcGFyYW0gY21kXG4gICAgICovXG4gICAgIHBhcnNlclNlcnZlckRhdGEgOiBmdW5jdGlvbihkYXRhLCBjbWQpe1xuICAgICAgICAgLy9nemlw6Kej5Y6LXG4gICAgICAgICAvL2RhdGEgPSBkYXRhO1xuICAgICAgICAgLy9CYXNlNjRcbiAgICAgICAgIC8vZGF0YSA9IEJhc2U2NC5kZWNvZGUoZGF0YSk7XG4gICAgICAgICAvL2Flc+ino+WvhlxuICAgICAgICAgZGF0YSA9IHRoaXMuQUVTRGVjcnlwdChkYXRhLCB0aGlzLmFlc0tleSk7XG4gICAgICAgICB2YXIgaU51bTEgPSBwYXJzZUludChjbWQpO1xuXG4gICAgICAgICBpZihpTnVtMSAhPSAxMDUpe1xuICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGF0YSA9IFwiICsgZGF0YSArIFwiLCBjbWQgPSBcIiArIGNtZCk7XG4gICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgIHN3aXRjaChpTnVtMSl7XG4gICAgICAgICAgICAgY2FzZSAxMDA6e1xuICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlckluaXQoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTAxOntcbiAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZXJCZXQoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTAyOntcbiAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZUNsZWFyKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwMzp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VyUmV3YXJkKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwNDp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VTZWNvbmREYXRhKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwNTp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VUYWJsZShkYXRhKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgY2FzZSAxMDY6e1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VPcmRlckxpc3QoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTA3IDoge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VySGlzdG9yeShkYXRhKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgIH1cbiAgICAgfSxcbiAgICAgXG4gICAgLy9BRVPliqDlr4ZcbiAgICBBRVNFbmNyeXB0aW9uIDogZnVuY3Rpb24gKGRhdGEsIGFlc0tleSkge1xuICAgICAgICB2YXIga2V5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoYWVzS2V5KTtcbiAgICAgICAgdmFyIGl2ICA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKGFlc0tleSk7XG4gICAgICAgIHZhciBzcmNzID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoZGF0YSk7XG4gICAgICAgIHZhciBlbmNyeXB0ZWQgPSBDcnlwdG9KUy5BRVMuZW5jcnlwdChzcmNzLCBrZXksIHsgaXY6IGl2LG1vZGU6Q3J5cHRvSlMubW9kZS5FQ0J9KTtcbiAgICAgICAgcmV0dXJuIGVuY3J5cHRlZC50b1N0cmluZygpO1xuICAgIH0sXG4gICAgXG4gICAgLy9BRVPop6Plr4ZcbiAgICBBRVNEZWNyeXB0IDogZnVuY3Rpb24gKGRhdGEsIGFlc0tleSkge1xuICAgICAgICB2YXIga2V5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoYWVzS2V5KTtcbiAgICAgICAgdmFyIGl2ICA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKGFlc0tleSk7XG4gICAgICAgIHZhciBkZWNyeXB0ID0gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoZGF0YSwga2V5LCB7IGl2OiBpdixtb2RlOkNyeXB0b0pTLm1vZGUuRUNCfSk7XG4gICAgICAgIHJldHVybiBDcnlwdG9KUy5lbmMuVXRmOC5zdHJpbmdpZnkoZGVjcnlwdCkudG9TdHJpbmcoKTtcbiAgICB9LFxuICAgICBcbiAgICAvKipcbiAgICAgKiDop6PmnpDliJ3lp4vljJZcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqL1xuICAgIHBhcnNlckluaXQgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBuZXREYXRhLmluaXREYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgY2MubG9nKFwibmV0RGF0YS5pbml0RGF0YS5vZGRzTGlzdCBcIiwgbmV0RGF0YS5pbml0RGF0YS5vZGRzTGlzdCk7XG4gICAgICAgIG5ldERhdGEuc2Vzc2lvbiA9IG5ldERhdGEuaW5pdERhdGEuc2Vzc2lvbjtcbiAgICAgICAgbmV0RGF0YS5wZXJpb2RJZCA9IG5ldERhdGEuaW5pdERhdGEucGVyaW9kSWQ7XG4gICAgICAgIG5ldERhdGEudGlja2V0Tm8gPSBuZXREYXRhLmluaXREYXRhLnRpY2tldE5vO1xuICAgICAgICBuZXREYXRhLmJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaW1pdDtcbiAgICAgICAgbmV0RGF0YS50b3RhbEJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS50b3RhbEJldExpbWl0O1xuXG4gICAgICAgIHZhciBwZXJpb2RFbmRUaW1lID0gbnVsbDtcbiAgICAgICAgaWYobmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMSB8fFxuICAgICAgICAgICAgbmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMil7XG4gICAgICAgICAgICBuZXREYXRhLnRpbWVGbGFnID0gMTtcbiAgICAgICAgICAgIHBlcmlvZEVuZFRpbWUgPSBuZXREYXRhLmluaXREYXRhLnBlcmlvZEVuZFRpbWUxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYobmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMyB8fFxuICAgICAgICAgICAgICAgIG5ldERhdGEuaW5pdERhdGEuc3RhdHVzID09IDQpe1xuICAgICAgICAgICAgbmV0RGF0YS50aW1lRmxhZyA9IDI7XG4gICAgICAgICAgICBwZXJpb2RFbmRUaW1lID0gbmV0RGF0YS5pbml0RGF0YS5wZXJpb2RFbmRUaW1lMjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHBlcmlvZEVuZFRpbWUgIT0gbnVsbCl7XG4gICAgICAgICAgICBuZXREYXRhLmxvdHRlcnlJZCA9IG5ldERhdGEuaW5pdERhdGEubG90dGVyeUlkO1xuICAgICAgICAgICAgbmV0RGF0YS5sb3R0ZXJ5SW5kZXggPSBuZXREYXRhLmluaXREYXRhLmxvdHRlcnlJbmRleDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGxldCBsb2NhbFRpbWUgPSB0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBsZXQgc2V2ZXJUaW1lID0gbmV0RGF0YS5pbml0RGF0YS5zZXJ2ZXJUaW1lO1xuICAgICAgICAgICAgbmV0RGF0YS5yZWNlaXZlVGltZSA9IGxvY2FsVGltZSAtIHNldmVyVGltZTtcbiAgICAgICAgICAgIG5ldERhdGEuc2VjcyA9IE1hdGguZmxvb3IoKHBlcmlvZEVuZFRpbWUgLSBzZXZlclRpbWUpIC8gMTAwMCAtIG5ldERhdGEuYmV0VGhyZXNob2xkIC0gMyk7XG4gICAgICAgICAgICBjYy5sb2coXCJyZWNlaXZlVGltZT1cIiArIG5ldERhdGEucmVjZWl2ZVRpbWUgKyBcInxcIiArIG5ldERhdGEuc2Vjcyk7XG4gICAgICAgIH0gICAgICAgIFxuICAgICAgICAvL1xuICAgICAgICBuZXREYXRhLmluaXRGbGFnID0gMTtcbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIOino+aekOaKleazqFxuICAgICAqL1xuICAgICBwYXJzZXJCZXQgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEuYmV0TGltaXQgPSBvYmpSb290LmJldExpbWl0O1xuICAgICAgICBuZXREYXRhLnRvdGFsQmV0TGltaXQgPSBvYmpSb290LnRvdGFsQmV0TGltaXQ7XG4gICAgICAgIG5ldERhdGEudGlja2V0Tm8gPSBvYmpSb290LnRpY2tldE5vO1xuXG5cbiAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IGxvY2FsVGltZSA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgbGV0IHRtcCA9IGxvY2FsVGltZSAtIHNldmVyVGltZTtcblxuICAgICAgICAvKlxuICAgICAgICBpZih0bXAgPCBuZXREYXRhLnJlY2VpdmVUaW1lKXtcbiAgICAgICAgICAgIG5ldERhdGEucmVjZWl2ZVRpbWUgPSB0bXA7XG4gICAgICAgICAgICBuZXREYXRhLnNlY3MgPSBNYXRoLmZsb29yKChuZXREYXRhLmJldERhdGEucGVyaW9kRW5kVGltZSAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlY2VpdmVUaW1lPVwiICsgbmV0RGF0YS5yZWNlaXZlVGltZSArIFwifFwiICsgbmV0RGF0YS5zZWNzKTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgICB9LFxuXG4gICAgIHBhcnNlQ2xlYXIgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpOyBcbiAgICAgICAgdmFyIG9ialJvb3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBuZXREYXRhLnRpY2tldE5vID0gXCJcIjtcbiAgICAgICAgbmV0RGF0YS5iZXRMaW1pdCA9IG5ldERhdGEuaW5pdERhdGEuYmV0TGltaXQ7XG4gICAgICAgIG5ldERhdGEudG90YWxCZXRMaW1pdCA9IG5ldERhdGEuaW5pdERhdGEudG90YWxCZXRMaW1pdDtcbiAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IGxvY2FsVGltZSA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgbGV0IHRtcCA9IGxvY2FsVGltZSAtIHNldmVyVGltZTtcbiAgICAgICAgLypcbiAgICAgICAgaWYodG1wIDwgbmV0RGF0YS5yZWNlaXZlVGltZSl7XG4gICAgICAgICAgICBuZXREYXRhLnJlY2VpdmVUaW1lID0gdG1wO1xuICAgICAgICAgICAgbmV0RGF0YS5zZWNzID0gTWF0aC5mbG9vcigob2JqUm9vdC5wZXJpb2RFbmRUaW1lIC0gc2V2ZXJUaW1lKSAvIDEwMDAgLSBuZXREYXRhLmJldFRocmVzaG9sZCAtIDMpO1xuICAgICAgICAgICAgY2MubG9nKFwicmVjZWl2ZVRpbWU9XCIgKyBuZXREYXRhLnJlY2VpdmVUaW1lICsgXCJ8XCIgKyBuZXREYXRhLnNlY3MpO1xuICAgICAgICB9XG4gICAgICAgICovXG4gICAgIH0sXG4gICAgIFxuICAgICAvKipcbiAgICAgICog57uT566XXG4gICAgICAqL1xuICAgIHBhcnNlclJld2FyZCA6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7IFxuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEucmV3YXJkRGF0YSA9IG9ialJvb3Q7XG4gICAgICAgIC8vIG5ldERhdGEucmV3YXJkRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7ICAgICAgXG5cbiAgICAgICAgbmV0RGF0YS5wZXJpb2RJZCA9IG5ldERhdGEucmV3YXJkRGF0YS5uZXh0UGVyaW9kSWQ7XG4gICAgICAgIG5ldERhdGEuaW5pdERhdGEucGVyaW9kRW5kVGltZTIgPSBvYmpSb290LnBlcmlvZEVuZFRpbWUyO1xuXG4gICAgICAgIGlmKG9ialJvb3QucGVyaW9kRW5kVGltZTEgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIHZhciB0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgICAgIG5ldERhdGEucmVjZWl2ZVRpbWUgPSBsb2NhbFRpbWUgLSBzZXZlclRpbWU7XG4gICAgICAgICAgICBuZXREYXRhLnNlY3MgPSBNYXRoLmZsb29yKChvYmpSb290LnBlcmlvZEVuZFRpbWUxIC0gc2V2ZXJUaW1lKSAvIDEwMDAgLSBuZXREYXRhLmJldFRocmVzaG9sZCAtIDMpO1xuICAgICAgICAgICAgY2MubG9nKFwicmVjZWl2ZVRpbWU9XCIgKyBuZXREYXRhLnJlY2VpdmVUaW1lICsgXCJ8XCIgKyBuZXREYXRhLnNlY3MpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBhcnNlVGFibGUgOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdmFyIG9ialJvb3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICBsZXQgc2V2ZXJUaW1lID0gb2JqUm9vdC5zZXJ2ZXJUaW1lO1xuICAgICAgICBsZXQgdG1wID0gbG9jYWxUaW1lIC0gc2V2ZXJUaW1lO1xuXG4gICAgICAgIC8qXG4gICAgICAgIGlmKHRtcCA8IG5ldERhdGEucmVjZWl2ZVRpbWUpe1xuICAgICAgICAgICAgbmV0RGF0YS5yZWNlaXZlVGltZSA9IHRtcDsgXG4gICAgICAgICAgICBuZXREYXRhLnNlY3MgPSBNYXRoLmZsb29yKChvYmpSb290LnBlcmlvZEVuZFRpbWUgLSBzZXZlclRpbWUpIC8gMTAwMCAtIG5ldERhdGEuYmV0VGhyZXNob2xkIC0gMyk7XG4gICAgICAgICAgICBjYy5sb2coXCJyZWNlaXZlVGltZT1cIiArIG5ldERhdGEucmVjZWl2ZVRpbWUgKyBcInxcIiArIG5ldERhdGEuc2Vjcyk7XG4gICAgICAgIH1cbiAgICAgICAgKi9cblxuICAgICAgICAvL+ino+aekGxpc3RcbiAgICAgICAgbmV0RGF0YS50YWJsZUFycmF5ID0gW107XG4gICAgICAgIG5ldERhdGEudGFibGVBcnJheSA9IG9ialJvb3QubGlzdDtcbiAgICB9LFxuXG4gICAgcGFyc2VTZWNvbmREYXRhIDogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdmFyIG9ialJvb3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBuZXREYXRhLnNlY29uZERhdGEgPSBvYmpSb290O1xuICAgICAgICBuZXREYXRhLnRpbWVGbGFnID0gMjtcbiAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgbmV0RGF0YS5zZWNzID0gTWF0aC5mbG9vcigobmV0RGF0YS5pbml0RGF0YS5wZXJpb2RFbmRUaW1lMiAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICBcbiAgLypcbiAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IGxvY2FsVGltZSA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgbGV0IHRtcCA9IGxvY2FsVGltZSAtIHNldmVyVGltZTtcblxuICAgICAgICBpZih0bXAgPCBuZXREYXRhLnJlY2VpdmVUaW1lKXtcbiAgICAgICAgICAgIG5ldERhdGEucmVjZWl2ZVRpbWUgPSB0bXA7IFxuICAgICAgICAgICAgbmV0RGF0YS5zZWNzID0gTWF0aC5mbG9vcigobmV0RGF0YS5pbml0RGF0YS5wZXJpb2RFbmRUaW1lMiAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlY2VpdmVUaW1lPVwiICsgbmV0RGF0YS5yZWNlaXZlVGltZSArIFwifFwiICsgbmV0RGF0YS5zZWNzKTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgIH0sXG5cbiAgICBwYXJzZU9yZGVyTGlzdCA6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHZhciBvYmpSb290ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgbmV0RGF0YS5vcmRlckxpc3QgPSBbXTtcbiAgICAgICAgbmV0RGF0YS5vcmRlckxpc3QgPSBvYmpSb290LmRhdGE7XG4gICAgfSxcblxuICAgIHBhcnNlckhpc3RvcnkgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEuaGlzdG9yeUxpc3QgPSBbXTtcbiAgICAgICAgbmV0RGF0YS5oaXN0b3J5TGlzdCA9IG9ialJvb3QuaGlzdG9yeUxpc3Q7XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiDliJ3lp4vljJZcbiAgICAgKiBAcGFyYW1cbiAgICAgKiBcbiAgICAgKi9cbiAgICBnZXRJbml0IDogZnVuY3Rpb24oc2Vzc2lvbiwgY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICBpZihzZXNzaW9uID09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwie31cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgICAgIG9iai5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICB9XG5cbiAgICAgICAgLy/mj5DliY3liJ3lp4vljJZcbiAgICAgICAgTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5pbml0RmxhZyA9IDA7XG4gICAgICAgIC8v6K6+572u5ZG95Luk5Y+377yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTAwO1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog5oqV5rOoXG4gICAgICogQHBhcmFtIHRpY2tldF9ubyDorqLljZXlj7fvvIzpppbmrKHmipXms6jkuLrnqbpcbiAgICAgKiBAcGFyYW0gc3RlcCDmraXmlbBcbiAgICAgKiBAUGFybWEgdHJhbnNfZGF0YSDmlbDmja7kuqTkupJcbiAgICAgKi9cbiAgICBnZXRCZXQgOiBmdW5jdGlvbihjYWxsRnVuYywgc2VsZil7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIC8v5ou85oiQanNvbuS4su+8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBvYmoudGlkID0gdGUuZ2V0VGltZSgpLnRvU3RyaW5nKCk7XG4gICAgICAgIHRlID0gbnVsbDtcbiAgICAgICAgb2JqLmJldExpc3QgPSBuZXREYXRhLnJlcUJldExpc3Q7XG4gICAgICAgIG9iai5wZXJpb2RJZCA9IG5ldERhdGEucGVyaW9kSWQ7XG4gICAgICAgIG9iai50aW1lRmxhZyA9IG5ldERhdGEudGltZUZsYWc7XG4gICAgICAgIG9iai5zZXNzaW9uID0gbmV0RGF0YS5zZXNzaW9uO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgb2JqID0gbnVsbDtcbiAgICAgICAgLy/orr7nva7lkb3ku6Tlj7fvvIzmr4/kuKror7fmsYLpg73kuI3kuIDmoLdcbiAgICAgICAgdGhpcy5oZWFkZXJDbWQgPSAxMDE7XG4gICAgICAgIC8v6K+35rGC572R57ucXG4gICAgICAgIHRoaXMucmVxdWVzdChjYWxsRnVuYywgc2VsZik7XG4gICAgfSxcblxuICAgIGdldENsZWFyIDogZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpIHtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gXCJcIjtcbiAgICAgICAgLy/mi7zmiJBqc29u5Liy77yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIG9iai5wZXJpb2RJZCA9IG5ldERhdGEucGVyaW9kSWQ7XG4gICAgICAgIG9iai5zZXNzaW9uID0gbmV0RGF0YS5zZXNzaW9uO1xuICAgICAgICBvYmoudGltZUZsYWcgPSBuZXREYXRhLnRpbWVGbGFnO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTsgXG4gICAgICAgIG9iaiA9IG51bGw7XG4gICAgICAgIC8v6K6+572u5ZG95Luk5Y+377yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTAyO1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH0sXG4gICAgIFxuICAgIC8qKlxuICAgICAqIOe7k+eul1xuICAgICAqIEBwYXJhbSB0aWNrZXRfbm8g6K6i5Y2V5Y+3XG4gICAgICovXG4gICAgZ2V0UmV3YXJkIDogZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gXCJcIjtcbiAgICAgICAgLy/mi7zmiJBqc29u5Liy77yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIG9iai5wZXJpb2RJZCA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkucGVyaW9kSWQ7XG4gICAgICAgIG9iai5zZXNzaW9uID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5zZXNzaW9uO1xuICAgICAgICBvYmoudGlja2V0Tm8gPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnRpY2tldE5vO1xuXG4gICAgICAgIC8vIG9iai51aWRzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIG9iai51aWRzID0gWzEyLCAxMjNdO1xuICAgICAgICAvLyBmb3IobGV0IGkgPSAwOyBpIDwgTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS50YWJsZUFycmF5Lmxlbmd0aCgpOyArK2kpe1xuICAgICAgICAvLyAgICAgb2JqLnVpZHMucHVzaChOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnRhYmxlQXJyYXlbaV0udWlkKTtcbiAgICAgICAgLy8gfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7IFxuICAgICAgICBvYmogPSBudWxsO1xuICAgICAgICAvL+iuvue9ruWRveS7pOWPt++8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB0aGlzLmhlYWRlckNtZCA9IDEwMztcbiAgICAgICAgLy/or7fmsYLnvZHnu5xcbiAgICAgICAgdGhpcy5yZXF1ZXN0KGNhbGxGdW5jLCBzZWxmKTtcbiAgICB9LFxuXG4gICAgZ2V0VGFibGUgOiBmdW5jdGlvbiggY2FsbEZ1bmMsIHNlbGYpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIC8v5ou85oiQanNvbuS4su+8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBvYmoubGlzdCA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkucmVxVGFibGVBcnJheTtcbiAgICAgICAgb2JqLnBlcmlvZElkID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5wZXJpb2RJZDsgXG4gICAgICAgIG9iai5zZXNzaW9uID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5zZXNzaW9uO1xuICAgICAgICBvYmoudGltZUZsYWcgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnRpbWVGbGFnO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgb2JqID0gbnVsbDtcbiAgICAgICAgdGhpcy5oZWFkZXJDbWQgPSAxMDU7XG4gICAgICAgIC8v6K+35rGC572R57ucXG4gICAgICAgIHRoaXMucmVxdWVzdChjYWxsRnVuYywgc2VsZik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOiOt+WPluS6jOmYtuauteaVsOaNrlxuICAgICAqL1xuICAgIGdldFNlY29uZERhdGEgIDpmdW5jdGlvbihjYWxsRnVuYywgc2VsZil7XG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBcIlwiO1xuICAgICAgICAvL+aLvOaIkGpzb27kuLLvvIzmr4/kuKror7fmsYLpg73kuI3kuIDmoLdcbiAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgb2JqLnBlcmlvZElkID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5wZXJpb2RJZDsgXG4gICAgICAgIG9iai5zZXNzaW9uID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5zZXNzaW9uO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgb2JqID0gbnVsbDtcbiAgICAgICAgdGhpcy5oZWFkZXJDbWQgPSAxMDQ7XG4gICAgICAgIC8v6K+35rGC572R57ucXG4gICAgICAgIHRoaXMucmVxdWVzdChjYWxsRnVuYywgc2VsZik7XG4gICAgfSxcblxuICAgIGdldE9yZGVyTGlzdCA6IGZ1bmN0aW9uKGNhbGxGdW5jLCBzZWxmKXtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTA2O1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpOyAgICAgICAgXG4gICAgfSxcblxuICAgIGdldEhpc3RvcnkgIDogZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gXCJcIjtcbiAgICAgICAgLy/mi7zmiJBqc29u5Liy77yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIG9iai5zZXNzaW9uID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS5zZXNzaW9uO1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgb2JqID0gbnVsbDtcbiAgICAgICAgdGhpcy5oZWFkZXJDbWQgPSAxMDc7XG4gICAgICAgIC8v6K+35rGC572R57ucXG4gICAgICAgIHRoaXMucmVxdWVzdChjYWxsRnVuYywgc2VsZik7XG4gICAgfVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIERhdGFPcGVyIDogRGF0YU9wZXJcbn07IiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWw6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxuICAgICAgICB9LFxuICAgICAgICAvLyBkZWZhdWx0cywgc2V0IHZpc3VhbGx5IHdoZW4gYXR0YWNoaW5nIHRoaXMgc2NyaXB0IHRvIHRoZSBDYW52YXNcbiAgICAgICAgdGV4dDogJ0hlbGxvLCBXb3JsZCEnXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IHRoaXMudGV4dDtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIH0sXG59KTtcbiIsInZhciBOZXREYXRhID0gcmVxdWlyZShcIk5ldERhdGFcIik7XG52YXIgR2FtZSA9IHJlcXVpcmUoXCJnYW1lXCIpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL+a4uOaIj+W4ruWKqVxuICAgICAgICB1aUJsYWNrIDogY2MuTm9kZSxcbiAgICAgICAgdGVzdE5vZGUgOiBjYy5Ob2RlLFxuICAgICAgICBzY3JvbGxWaWV3OiBjYy5Ob2RlLFxuICAgICAgICBjb250ZW50OiBjYy5Ob2RlLFxuICAgICAgICB2aWV3OiBjYy5Ob2RlLFxuICAgICAgICBsb2NrIDogZmFsc2UsXG4gICAgICAgIGdhbWVOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBpbWdBcnJheSA6IFtjYy5TcHJpdGVdLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdGhpcy5sb2NrID0gdHJ1ZTtcbiAgICAgICAgbGV0IG9yaVAxID0gdGhpcy50ZXN0Tm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MudjIoMCwgMCkpO1xuICAgICAgICB0aGlzLm9yaVkgPSB0aGlzLnRlc3ROb2RlLnkgLSBvcmlQMS55O1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwib3JpWT1cIiArIHRoaXMubm9kZS55ICsgXCJ8XCIgKyBvcmlQMS55KTsgICAgICAgIFxuXG4gICAgICAgIHZhciBjYWxsRnVuY18xID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmxvY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZSA9IGNjLmRpcmVjdG9yLmdldFdpblNpemUoKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlldy5oZWlnaHQgPSBzZS5oZWlnaHQgKiAwLjg7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuZ2V0Q2hpbGRCeU5hbWUoXCJ2aWV3XCIpLmhlaWdodCA9IHRoaXMuc2Nyb2xsVmlldy5oZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLm5vZGUuaGVpZ2h0ID0gdGhpcy5zY3JvbGxWaWV3LmhlaWdodDtcbiAgICAgICAgICAgIHRoaXMubm9kZS55ID0gdGhpcy5vcmlZIC0gdGhpcy5zY3JvbGxWaWV3LmhlaWdodDsgICAgXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibnk9XCIgKyB0aGlzLm5vZGUueSk7XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MuZGVsYXlUaW1lKDAuMSksIGNhbGxGdW5jXzEpKTtcblxuICAgICAgICB0aGlzLnVpQmxhY2sub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIGZ1bmN0aW9uIChldmVudCl7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGNsb3NlOiBmdW5jdGlvbigpe1xuICAgICAgICBpZighdGhpcy5sb2NrKXtcbiAgICAgICAgICAgIHRoaXMudWlCbGFjay5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgbGV0IGNhbGwzID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24oKVxuICAgICAgICAgICAgeyAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMubmV0RGF0YS5oZWxwU2hvd0ZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLm1vdmVUbygwLjMsIGNjLnYyKDAsIHRoaXMub3JpWSAtIHRoaXMuc2Nyb2xsVmlldy5oZWlnaHQpKSwgY2FsbDMpKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBkb3duSGVscDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBsZXQgc3B0ID0gdGhpcy5nYW1lTm9kZS5nZXRDb21wb25lbnQoR2FtZSk7XG4gICAgICAgIHNwdC5zaG93V2FpdExheWVyKCk7XG4gICAgICAgIGxldCByaCA9IDA7XG4gICAgICAgIFxuICAgICAgICBjYy5sb2FkZXIubG9hZCh0aGlzLm5ldERhdGEucnVsZVBpY3MsIG51bGwsIGZ1bmN0aW9uIChlcnJvcnMsIHJlc3VsdHMpIHtcbiAgICAgICAgICAgIGlmIChlcnJvcnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVycm9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgdXJsIFsnICsgZXJyb3JzW2ldICsgJ106ICcgKyByZXN1bHRzLmdldEVycm9yKGVycm9yc1tpXSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNjLmxvZyhcInJlc3VsdHMgaXMgJSUgXCIsIHJlc3VsdHMuZ2V0Q29udGVudC5sZW5ndGgpO1xuICAgICAgICAgICAgbGV0IGxlbiA9IHNlbGYubmV0RGF0YS5ydWxlUGljcy5sZW5ndGg7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW47IGkrKyl7ICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFUZXggPSByZXN1bHRzLmdldENvbnRlbnQoc2VsZi5uZXREYXRhLnJ1bGVQaWNzW2ldKTsgXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5uZXREYXRhLnJ1bGVQaWNzW2ldICsgXCJ8XCIgKyBhVGV4KTtcbiAgICAgICAgICAgICAgICBsZXQgc2YgPSBuZXcgY2MuU3ByaXRlRnJhbWUoKTtcbiAgICAgICAgICAgICAgICBzZi5zZXRUZXh0dXJlKGFUZXgpO1xuICAgICAgICAgICAgICAgIHNlbGYuaW1nQXJyYXlbaV0uc3ByaXRlRnJhbWUgPSBzZjtcbiAgICAgICAgICAgICAgICByaCArPSBzZWxmLmltZ0FycmF5W2ldLm5vZGUuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIGNjLmxvZyhcImhlaWdodCBpcyAkJCQgXCIsIHNlbGYuaW1nQXJyYXlbaV0ubm9kZS5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIC8v5pSv5oyB5aSa5byg5Zu+5o6S54mI77yIMjAxNy0wMy0yNyBwbe+8mjUyMO+8iVxuICAgICAgICAgICAgICAgIGlmKGkgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGkgLSAxO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaHQgPSBzZWxmLmltZ0FycmF5W2luZGV4XS5ub2RlLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbWdBcnJheVtpXS5ub2RlLnkgID0gc2VsZi5pbWdBcnJheVtpbmRleF0ubm9kZS55IC0gaHQgKyAxO1xuICAgICAgICAgICAgICAgICAgICAvLyBjYy5sb2coXCJoZWlnaHQgaXMgJCQkIFwiLCBodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGlmKGxlbiA9PSAyKXtcbiAgICAgICAgICAgIC8vICAgICBsZXQgaHQgPSBzZWxmLmltZ0FycmF5WzBdLm5vZGUuaGVpZ2h0O1xuICAgICAgICAgICAgLy8gICAgIHNlbGYuaW1nQXJyYXlbMV0ubm9kZS55ID0gLWh0O1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICBzZWxmLmNvbnRlbnQuaGVpZ2h0ID0gcmg7XG4gICAgICAgICAgICBzcHQuaGlkZVdhaXRMYXllcigpO1xuICAgICAgICAgICAgc2VsZi5pbml0SGVscCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgaW5pdEhlbHA6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCF0aGlzLmxvY2spe1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbml0SGVscFwiKTtcbiAgICAgICAgICAgIHRoaXMubmV0RGF0YS5oZWxwU2hvd0ZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5sb2NrID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuc2Nyb2xsVG9PZmZzZXQoY2MucCgwLDApLCAwLjEpO1xuICAgICAgICAgICAgbGV0IGNhbGxiYWNrID0gY2MuY2FsbEZ1bmModGhpcy5zZWxlY3RTaG93Q2FsbEJhY2ssIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLCBjYy5wKDAsIHRoaXMub3JpWSkpLCBjYWxsYmFjaykpO1xuICAgICAgICB9ICAgICAgICBcbiAgICB9LFxuXG4gICAgc2VsZWN0U2hvd0NhbGxCYWNrOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHRoaXMudWlCbGFjay5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmxvY2sgPSBmYWxzZTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgRGF0YU9wZXIgPSByZXF1aXJlKFwiRGF0YU9wZXJcIik7XG52YXIgTmV0RGF0YSA9IHJlcXVpcmUoXCJOZXREYXRhXCIpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgLypjdG9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgXG4gICAgfSwqL1xuXG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgaWYgKCFDQ19KU0IgJiYgd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Nhc2lubzppbml0JywgZnVuY3Rpb24oZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqMjAxNzA1MDnlnKgxLjQuMuS/ruaUueiOt+WPlmdhbWVUb2tlbioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFPcGVyID0gRGF0YU9wZXIuRGF0YU9wZXIuZ2V0SW5zdCgpO1xuICAgICAgICAgICAgICAgIGRhdGFPcGVyLmdhbWVUb2tlbiA9IGUuZGF0YS5hY2Nlc3NUb2tlbjtcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoZGF0YU9wZXIuZ2FtZVRva2VuID09PSBudWxsKXsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGRhdGFPcGVyLmdhbWVUb2tlbiA9IFwiMjZhMDljYTA1MmQ0YzdkY2RlMTM0NDliYTFiNzM1ZGYtMTEtMTE1MS0xMDUxXCI7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0b2sgPSBkYXRhT3Blci5HZXRRdWVyeVN0cmluZyhcInRva1wiKTtcblxuICAgICAgICAgICAgICAgICAgICBpZih0b2spe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuaGVhZGVyVG9rZW4gPSB0b2s7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRvaz1cIiArIGRhdGFPcGVyLmhlYWRlclRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuaGVhZGVyVG9rZW4gPSBcIjBcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL3Rlc3Rzc3Nzc3NzXG4gICAgICAgICAgICAgICAgICAgIC8qdmFyIG15RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyVG9rZW4gPSBteURhdGUuZ2V0VGltZSgpOyovXG4gICAgICAgICAgICAgICAgfVxuICAgICBcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGhpcy5nYW1lVG9rZW4gPSBcIiArIGRhdGFPcGVyLmdhbWVUb2tlbik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0aGlzLmhlYWRlclRva2VuID0gXCIgKyBkYXRhT3Blci5oZWFkZXJUb2tlbik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKjIwMTcwNTA55ZyoMS40LjLkv67mlLnojrflj5ZnYW1lVG9rZW4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgXG4gICAgICAgICAgICAgICAgc2VsZi5mZXRjaChmdW5jdGlvbihpc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlzRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5ZCI5bm26LWE5rqQXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLLm1lcmdlUmVzb3VyY2VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaYvuekuiBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLLmluaXRMb2FkaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOi/kOihjOa4uOaIj1xuICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5ydW5HYW1lKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5zaG93RXJyb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9LCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmZldGNoKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZmV0Y2g6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVmVyc2lvbk46MjAxNzA1MjUxMjAwXCIpO1xuICAgICAgICBjYy5sb2coXCJmZXRjaFwiKTtcbiAgICAgICAgdGhpcy5pbml0RGF0YSA9IHt9O1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgZGF0YU9wZXIuZ2V0SW5pdChudWxsLCBmdW5jdGlvbihjbWQsIHJlcywgbXNnLCBzZWxmKSB7XG4gICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbmiJDlip/lubblrZjlgqjliJ3lp4vljJZcbiAgICAgICAgICAgIHZhciBpc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8v5q+P5pelKioqKua4uOaIj+aaguWBnOi/kOiQpe+8iOWuouaIt+err+WkhOeQhu+8iVxuICAgICAgICAgICAgaWYocmVzID09IDEwMDAwNyl7XG4gICAgICAgICAgICAgICAgaXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihyZXMgIT0gMCl7XG4gICAgICAgICAgICAgICAgaXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIC8vIGlmKE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuc3RhdHVzID09IDEpe1xuICAgICAgICAgICAgICAgIC8vICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIC8vICAgICBzZWxmLnRpbWVTdGFtcCA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgY2MubG9nKFwidGltZVN0YW1wIGlzIFwiLCBzZWxmLnRpbWVTdGFtcCk7XG4gICAgICAgICAgICAgICAgLy8gfSBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi50aW1lU3RhbXAgPSB0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInRpbWVTdGFtcCBpcyBcIiwgc2VsZi50aW1lU3RhbXApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjYy5sb2coJ2ZldGNoIGluaXQgZGF0YScpO1xuICAgICAgICAgICAgY2MubG9nKGNtZCwgcmVzLCBtc2cpO1xuICAgICAgICAgICAgc2VsZi5pbml0RGF0YS5jbWQgPSBjbWQ7XG4gICAgICAgICAgICBzZWxmLmluaXREYXRhLnJlcyA9IHJlcztcbiAgICAgICAgICAgIHNlbGYuaW5pdERhdGEubXNnID0gbXNnO1xuICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soaXNFcnJvcik7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG59KTtcbiIsIlxudmFyIE5ldERhdGEgPSBjYy5DbGFzcyh7XG4gICAgc3RhdGljcyA6IHtcbiAgICAgICAgZ19JbnN0IDogbnVsbCxcbiAgICAgICAgc19pbmRleCA6IDAsXG4gICAgICAgIFxuICAgICAgICBnZXRJbnN0OmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKE5ldERhdGEuZ19JbnN0ID09PSBudWxsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIE5ldERhdGEuZ19JbnN0ID0gbmV3IE5ldERhdGEoKTtcbiAgICAgICAgICAgICAgICBOZXREYXRhLmdfSW5zdC5pbml0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTmV0RGF0YS5nX0luc3Q7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcblxuICAgICAgICBkZXN0b3J5SW5zdDpmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihOZXREYXRhLmdfSW5zdCAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgTmV0RGF0YS5nX0luc3QgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8v6K+35rGC5Y+C5pWwXG4gICAgICAgIHJlcUJldExpc3QgOiBbXSwvL+aKleazqOaVsOaNrlxuICAgICAgICByZXFUYWJsZUFycmF5IDogW10sLy/or7fmsYLnlKjlkIzmoYzkurrliJfooahcblxuXG5cbiAgICAgICAgLy/lk43lupRcbiAgICAgICAgdGltZUZsYWcgOiAxLC8v5oqV5rOo6Zi25q61IDEt56ys5LiA6Zi25q61ICAyLeesrOS6jOmYtuautVxuICAgICAgICBzZXNzaW9uIDogbnVsbCxcbiAgICAgICAgcGVyaW9kSWQgOiAxLC8v5pyf5qyhXG4gICAgICAgIHJlY2VpdmVUaW1lIDogMCwvL+aOpeaUtuaXtumXtOW3rlxuICAgICAgICBzZWNzIDogMCwvL+W9qeacn+WJqeS9meenkuaVsFxuICAgICAgICBiZXRUaHJlc2hvbGQgOiAwLFxuICAgICAgICB0aWNrZXRObyA6IFwiXCIsLy/orqLljZXlj7dcbiAgICAgICAgYmV0TGltaXQgOiAwLC8v5oqV5rOo6ZmQ6aKdXG4gICAgICAgIHRvdGFsQmV0TGltaXQgOiAwLC8v5oC75oqV5rOo6ZmQ6aKdXG5cbiAgICAgICAgdGFibGVBcnJheSA6IFtdLC8v5ZCM5qGM5Lq6XG4gICAgICAgIGluaXREYXRhIDogbnVsbCwvL+WIneWni+WMlmRhdGFcbiAgICAgICAgcmV3YXJkRGF0YSA6IG51bGwsLy/nu5PnrpdkYXRhXG4gICAgICAgIHNlY29uZERhdGEgOiBudWxsLC8v56ys5LqM6Zi25q615pWw5o2uZGF0YVxuICAgICAgICBoaXN0b3J5TGlzdCA6IFtdLC8v5Y6G5Y+y6LWw5Yq/XG4gICAgICAgIG9yZGVyTGlzdCA6IFtdLC8v6K6i5Y2VZGF0YVxuXG4gICAgICAgIC8vc2RrICAgICAgICBcbiAgICAgICAgaW5pdEZsYWcgOiAwIC8v5o+Q5YmN5Yid5aeL5YyWIDA65rKh5aW9ICAxOuWlveS6hiAyLuWBnOWUrlxuICAgIH0sXG4gICAgXG4gICAgaW5pdCA6IGZ1bmN0aW9uKCl7XG5cbiAgICB9LFxuXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCl7XG4gICAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBOZXREYXRhIDogTmV0RGF0YVxufTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgLy/kuI3lho3mtL7lj5Hkuovku7ZcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICBpZih0aGlzLm9iaiAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5mdW4odGhpcy5vYmopO1xuICAgICAgICAgICAgICAgIHRoaXMub2JqID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHRoaXMuZnVuID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LHRoaXMpO1xuICAgIH0sXG5cbiAgICBpbml0OiBmdW5jdGlvbihvYmosIGZ1bil7XG4gICAgICAgIHRoaXMub2JqID0gb2JqO1xuICAgICAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB9LFxuICAgIFxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsInZhciBOZXREYXRhID0gcmVxdWlyZShcIk5ldERhdGFcIik7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFxuICAgICAgICBzZWxmQ2hpcDFTa2luZU5vZGU6e1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHNlbGZDaGlwMlNraW5lTm9kZTp7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgcHVrZUhpZ2hMaWdodE5vZGVBcnJheToge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGJldEhpZ2hMaWdodExheWVyOmNjLk5vZGUsXG5cbiAgICAgICAgXG4gICAgICAgIHNlbGZDaGlwTm9kZTp7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgb3RoZXJzUG9zaXRpb25Ob2RlOmNjLk5vZGUsXG4gICAgICAgIFxuICAgICAgICBwb2tlcnNOb2RlOntcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBub1Bva2Vyc05vZGU6e1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGhpc3RvcnlzTGlzdE5vZGU6e1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV0gXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvZGRzTGFiZWw6Y2MuTm9kZSxcbiAgICAgICAgXG4gICAgICAgIHBva2VyTmFtZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgXG4gICAgICAgIHBva2VyTm9Ub3VjaExheWVyOmNjLk5vZGUsXG4gICAgICAgIFxuICAgICAgICBvcHRpb25zIDogXCJcIiwvL+mAiemhueivtOaYjlxuICAgICAgICAvL+WKv+WKm1xuICAgICAgICBwb3dlckZsYWcgOiB0cnVlLC8v5piv5ZCm5Yq/5YqbXG4gICAgICAgIHBvd2VySWQgOiAwLC8v5Yq/5YqbaWRcbiAgICAgICAgcG9ja2VycyA6IFtdLC8v54mM5Z6LXG4gICAgICAgIGhpc3RvcnlzIDogW10sLy/og5zotJ/otbDlir9cblxuICAgICAgICAvL+aKleazqOmhuVxuICAgICAgICBiZXRGbGFnIDogdHJ1ZSwvL+aYr+WQpuaKleazqOmhuVxuICAgICAgICBiZXRJZCA6IDAsLy/mipXms6jpoblpZFxuICAgICAgICBvZGRzMSA6IDEsLy/kuIDpmLbmrrXotZTnjodcbiAgICAgICAgb2RkczIgOiAxLC8v5LqM6Zi25q616LWU546HXG4gICAgICAgIG9kZFR5cGUgOiAwLC8v6LWU546H5Y+Y5YyW57G75Z6LICAwLemZjeS9jiAgMS3kuIrljYcgIDIt5LiN5Y+YXG4gICAgICAgIGJldFN0YXR1cyA6IDEsLy/mmK/lkKblj6/mipXms6gsIDEt5Y+v5oqVIDAt5LiN5Y+v5oqVXG4gICAgICAgIGJldE51bVRvdGFsMSA6IDAsLy/nrKzkuIDpmLbmrrXmgLvmipXms6jpop1cbiAgICAgICAgYmV0TnVtVG90YWwyIDogMCwvL+esrOS6jOmYtuauteaKleazqOaAu+minVxuICAgICAgICBiZXROdW0gIDogMCwvL+WNleasoeaKleazqOmine+8jOeUqOS6juiusOW9leaKleazqOaJueasoe+8jOWksei0peeahOimgemAgOWbnuadpVxuICAgICAgICBiZXRMaXN0IDogW10sLy/mnIDlkI7kuIDmrKHmipXms6jliJfooajvvIznlKjkuo7mipXms6jvvIzmiormiYDmnInmipXms6jpobnnmoTov5nkuKrmlbDnu4TmlLbpm4botbfmnaXlsLHmmK/nnJ/mraPnmoTmipXms6jliJfooahcbiAgICAgICAgY2hpcENvbG9yIDogMCwvL+etueeggeminOiJsiAgMC0gIDEtICAyLSAgMy1cbiAgICAgICAgbGlndGhGbGFnIDogZmFsc2UsLy/mipXms6jpobnmmK/lkKbpq5jkuq5cblxuICAgICAgICAvL+e7k+eul+eKtuaAgVxuICAgICAgICB3aW4gOiAtMSwgLy8tMTog5pyq5byA5aWWIDE66IOc5Yip77yMMDrotJ/vvIwyOuW5s1xuICAgICAgICB0eXBlIDogLTEsLy8tMTog5pyq5byA5aWWIDA65pWj54mM77yMMTrmlaPniYzvvIwyOuWvueWtkO+8jDPvvJrpobrlrZDvvIw0OuWQjOiKse+8jDU65ZCM6Iqx6aG677yMNjrosbnlrZBcbiAgICAgICAgcG9rZXJMaWdodCA6IFtdLC8v5omR5YWL6auY5LquIOepuuS4uuWFqOS4jeS6ru+8jCBbMCwgMSwgMl3lhajkuq7vvIwgWzAsIDJd5Lqu5Lik5LiqXG5cbiAgICAgICAgLy/po57nrbnnoIFcbiAgICAgICAgY2hpcFBvc2l0aW9ucyA6IFtdLC8v5qW85LiLNeS4quetueeggeeahOebuOWvueS9jee9rlxuICAgICAgICBwbGF5ZXJQb3NpdGlvbnMgOiBbXSwvL+eOqeWutuWktOWDj+ebuOWvueS9jee9ru+8jOWMheaLrOiHquW3seeahO+8iOiHquW3seeahOetueeggemjnuWbnu+8iVxuICAgICAgICBjdXJyZW50Q2hpcEluZGV4OiAwLC8v6K6w5b2V5b2T5YmN5oqV5rOo6aKd55qEaW5kZXhcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKGV2ZW50KXtcblxuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgY2MubG9nKFwiVE9VQ0hfRU5EISEhXCIpO1xuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnICYmIHRoaXMuYmV0U3RhdHVzKXtcbiAgICAgICAgICAgICAgICAvL+aKleazqOaTjeS9nO+8jOWbnuiwg+WIsGdhbWXljrvliKTmlq3nmbvlvZXnirbmgIHjgIHkvZnpop3nrYlcbiAgICAgICAgICAgICAgICAgdmFyIG9uRnVuY3Rpb24gPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dhbWUnKTtcblxuICAgICAgICAgICAgICAgICBpZihvbkZ1bmN0aW9uLmNsZWFyaW5nRmxhZyl7XG4gICAgICAgICAgICAgICAgICAgIG9uRnVuY3Rpb24uc2hvd1RvYXN0KFwi5q2j5Zyo5Li65oKo5pKk5Y2V77yM6K+356iN5ZCO5LiL5Y2VXCIpO1xuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIG9uRnVuY3Rpb24ucG93ZXJCZXQodGhpcy5hZGRzZWxmQ2hpcCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDph43nva5pbmZv77yM5LiL5LiA5pyf5byA5aeL5pe26LCD55SoXG4gICAgICovXG4gICAgcmVzZXRJbmZvIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5wb2NrZXJzID0gW107XG4gICAgICAgIHRoaXMub2RkVHlwZSA9IDI7XG4gICAgICAgIHRoaXMuYmV0U3RhdHVzID0gMTtcbiAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDEgPSAwO1xuICAgICAgICB0aGlzLmJldE51bVRvdGFsMiA9IDA7XG4gICAgICAgIHRoaXMuYmV0TnVtID0gMDtcbiAgICAgICAgdGhpcy5iZXRMaXN0ID0gW107XG4gICAgICAgIHRoaXMud2luID0gLTE7XG4gICAgICAgIHRoaXMudHlwZXMgPSAtMTtcbiAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gW107XG4gICAgICAgIHRoaXMubGlndGhGbGFnID0gZmFsc2U7XG5cbiAgICAgICAgLy/muIXnqbrmoYzpnaLnrbnnoIFcbiAgICAgICAgaWYodGhpcy5iZXRGbGFnKXtcbiAgICAgICAgICAgIHRoaXMuc2VsZkNoaXBOb2RlWzBdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zZWxmQ2hpcE5vZGVbMV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgdGhpcy5ub1Bva2Vyc05vZGUubGVuZ3RoOyBqICsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm5vUG9rZXJzTm9kZVtqXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5ub1Bva2Vyc05vZGVbal0uc2V0U2NhbGUoMSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmKHRoaXMucG9rZXJzTm9kZS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucG9rZXJzTm9kZVsyXS55ID0gLTE2MTtcbiAgICAgICAgICAgIHRoaXMubm9Qb2tlcnNOb2RlWzJdLnkgPSAwOyBcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOabtOaWsOmAiemhuWluZm9cbiAgICAgKiBAcGFyYW0gc3RhdHVzIDEwMC3liJ3lp4vljJYgICAxMDEt5oqV5rOoICAxMDIt5riF56m65oqV5rOoICAxMDMt57uT566XICAxMDQt6I635Y+W5LqM6Zi25q615pWw5o2uXG4gICAgICovXG4gICAgdXBkYXRhSW5mbyA6IGZ1bmN0aW9uKHN0YXR1cyl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgXG4gICAgICAgIGlmKHN0YXR1cyA9PSAxMDApe1xuICAgICAgICAgICAgdmFyIGluaXREYXRhID0gbmV0RGF0YS5pbml0RGF0YTtcbiAgICAgICAgICAgIGlmKHRoaXMucG93ZXJGbGFnKXtcbiAgICAgICAgICAgICAgICBpZihpbml0RGF0YS5wb2NrZXJMaXN0KXtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGluaXREYXRhLnBvY2tlckxpc3QubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5wb3dlcklkID09IGluaXREYXRhLnBvY2tlckxpc3RbaV0ucG93ZXJJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYy5sb2coXCJ0aGlzLnBvd2VySWQgXCIsIHRoaXMucG93ZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5pdERhdGEucG9ja2VyTGlzdFtpXS5wb2NrZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2NrZXJzID0gaW5pdERhdGEucG9ja2VyTGlzdFtpXS5wb2NrZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NjLmxvZyhcInRoaXMucG9ja2Vyc1wiLCB0aGlzLnBvY2tlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlzID0gaW5pdERhdGEucG9ja2VyTGlzdFtpXS5oaXN0b3J5cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnKXtcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgaW5pdERhdGEub2Rkc0xpc3QubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmJldElkID09IGluaXREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcIm9kZHMyIFwiLCBpbml0RGF0YS5vZGRzTGlzdFtpXS5vZGRzMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBpbml0RGF0YS5vZGRzTGlzdFtpXS5vcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMxID0gaW5pdERhdGEub2Rkc0xpc3RbaV0ub2RkczE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluaXREYXRhLm9kZHNMaXN0W2ldLm9kZHMyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMyID0gaW5pdERhdGEub2Rkc0xpc3RbaV0ub2RkczI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkczIgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJldFN0YXR1cyA9IGluaXREYXRhLm9kZHNMaXN0W2ldLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy/mipXms6jpop0s55So5LqO5oGi5aSNXG4gICAgICAgICAgICAgICAgaWYoaW5pdERhdGEuYmV0cyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBpbml0RGF0YS5iZXRzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluaXREYXRhLmJldHNbaV0uaWQgPT0gdGhpcy5iZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5pdERhdGEuYmV0c1tpXS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDEgPSBpbml0RGF0YS5iZXRzW2ldLnRvdGFsQmV0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJldE51bVRvdGFsMiA9IGluaXREYXRhLmJldHNbaV0udG90YWxCZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEwMSl7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAxMDIpe1xuICAgICAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgICAgICB0aGlzLmJldE51bVRvdGFsMSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuYmV0TnVtVG90YWwyID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmV0TGlzdCA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEwMyl7XG4gICAgICAgICAgICB2YXIgcmV3YXJkRGF0YSA9IG5ldERhdGEucmV3YXJkRGF0YTtcbiAgICAgICAgICAgIGlmKHRoaXMucG93ZXJGbGFnKXtcbiAgICAgICAgICAgICAgICB2YXIgbG90dGVyeSA9IHJld2FyZERhdGEubG90dGVyeTtcbiAgICAgICAgICAgICAgICAvL3ZhciBpZHN0cmluZyA9IFwicG93ZXJcIisgdGhpcy5wb3dlcklkO1xuXG4gICAgICAgICAgICAgICAvLyB2YXIgcG9ja2VycyA9IGxvdHRlcnkuY2FjaGUuaWRzdHJpbmcucG9ja2VycztcbiAgICAgICAgICAgICAgICAvL3RoaXMud2luID0gbG90dGVyeS5jYWNoZS5pZHN0cmluZy53aW47XG4gICAgICAgICAgICAgICAgLy90aGlzLnR5cGVzID0gbG90dGVyeS5jYWNoZS5pZHN0cmluZy50eXBlcztcbiAgICAgICAgICAgICAgICAvL3RoaXMuaGlzdG9yeXMucG9wKCk7XG4gICAgICAgICAgICAgICAvLyB0aGlzLmhpc3RvcnlzLnVuc2hpZnQodGhpcy53aW4pO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5wb2NrZXJzLnB1c2gocG9ja2Vycyk7XG5cblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsb3R0ZXJ5LmNhY2hlLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgaWYobG90dGVyeS5jYWNoZVtpXS5wb3dlcklkID09IHRoaXMucG93ZXJJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpbiA9IGxvdHRlcnkuY2FjaGVbaV0ud2luO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeXMudW5zaGlmdCh0aGlzLndpbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IGxvdHRlcnkuY2FjaGVbaV0udHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9ja2Vycy5wdXNoKGxvdHRlcnkuY2FjaGVbaV0ucG9ja2Vyc1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NjLmxvZyhcIjEwMyBwb2NrZXJzIGxlbmd0aCBpcyBcIiwgdGhpcy5wb2NrZXJzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+eJjOWei+mrmOS6rlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnR5cGUgPT09IDAgfHwgdGhpcy50eXBlID09IDEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5pWj54mM77yM6YO95LiN5LquXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMudHlwZSA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WvueWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG9ja2Vyc1swXS52YWwgPT0gdGhpcy5wb2NrZXJzWzFdLnZhbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9rZXJMaWdodCA9IFswLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLnBvY2tlcnNbMF0udmFsID09IHRoaXMucG9ja2Vyc1syXS52YWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBva2VyTGlnaHQgPSBbMCwgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5wb2NrZXJzWzFdLnZhbCA9PSB0aGlzLnBvY2tlcnNbMl0udmFsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gWzEsIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lr7nlrZDmipXms6jpobnpq5jkuq5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmJldElkID09IDUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZ3RoRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMudHlwZSA9PSA2KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBva2VyTGlnaHQgPSBbMCwgMSwgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+S4ieWQjOWPt+aKleazqOmhuemrmOS6rlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuYmV0SWQgPT0gNil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlndGhGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gWzAsIDEsIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lhbbku5bniYzlnovmipXms6jpobnpq5jkuq5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmJldElkID09IDcpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZ3RoRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZih0aGlzLmJldEZsYWcpe1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCByZXdhcmREYXRhLm9kZHNMaXN0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5iZXRJZCA9PSByZXdhcmREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY2MubG9nKFwib2RkczIgXCIsIHJld2FyZERhdGEub2Rkc0xpc3RbaV0ub2RkczIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gcmV3YXJkRGF0YS5vZGRzTGlzdFtpXS5vcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMxID0gcmV3YXJkRGF0YS5vZGRzTGlzdFtpXS5vZGRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLm9kZHMyID0gcmV3YXJkRGF0YS5vZGRzTGlzdC5vZGRzTWV0YURhdGFzW2ldLm9kZHMyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXRTdGF0dXMgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAxMDQpe1xuICAgICAgICAgICAgdmFyIHNlY29uZERhdGEgPSBuZXREYXRhLnNlY29uZERhdGE7XG4gICAgICAgICAgICBpZih0aGlzLnBvd2VyRmxhZyl7XG4gICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHNlY29uZERhdGEucG9ja2VyTGlzdC5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG93ZXJJZCA9PSBzZWNvbmREYXRhLnBvY2tlckxpc3RbaV0ucG93ZXJJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvY2tlcnMgPSBzZWNvbmREYXRhLnBvY2tlckxpc3RbaV0ucG9ja2VycztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZih0aGlzLmJldEZsYWcpe1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzZWNvbmREYXRhLm9kZHNMaXN0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5iZXRJZCA9PSBzZWNvbmREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHNlY29uZERhdGEub2Rkc0xpc3RbaV0ub3B0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/ov5nph4zliKTmlq3kuIDkuIvotZTnjofmmK/lj5jlpKflj5jlsI9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkczEgPSBzZWNvbmREYXRhLm9kZHNMaXN0W2ldLm9kZHMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2Vjb25kRGF0YS5vZGRzTGlzdFtpXS5vZGRzMil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzMiA9IHNlY29uZERhdGEub2Rkc0xpc3RbaV0ub2RkczI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkczIgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm9kZHMyID4gdGhpcy5vZGRzMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRUeXBlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5vZGRzMiA8IHRoaXMub2RkczEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkVHlwZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkVHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmV0U3RhdHVzID0gc2Vjb25kRGF0YS5vZGRzTGlzdFtpXS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgLy/mm7TmlrBVSVxuICAgIHVwZGF0YVVJOmZ1bmN0aW9uKHN0YXR1cylcbiAgICB7XG4gICAgICAgIGlmKHRoaXMucG93ZXJGbGFnKVxuICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gZm9yKHZhciBqID0gMDsgaiA8IHRoaXMubm9Qb2tlcnNOb2RlLmxlbmd0aDsgaiArKylcbiAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMubm9Qb2tlcnNOb2RlW2pdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnBvY2tlcnMubGVuZ3RoOyBpICsrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLm5vUG9rZXJzTm9kZVtpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9rZXJOdW0gPSB0aGlzLnBva2Vyc05vZGVbaV0uZ2V0Q2hpbGRCeU5hbWUoXCJudW1cIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbnVtID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnBvY2tlcnNbaV0udmFsID09IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSBcIkFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLnBvY2tlcnNbaV0udmFsID09IDExKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gXCJKXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5wb2NrZXJzW2ldLnZhbCA9PSAxMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IFwiUVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMucG9ja2Vyc1tpXS52YWwgPT0gMTMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSBcIktcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gdGhpcy5wb2NrZXJzW2ldLnZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYy5sb2coXCJwb2NrZXIgbnVtIGlzIFwiLCBudW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBva2VyTnVtLnN0cmluZyA9IG51bTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9rZXJUeXBlID0gdGhpcy5wb2tlcnNOb2RlW2ldLmdldENoaWxkQnlOYW1lKFwidHlwZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKHRoaXMucG9ja2Vyc1tpXS5jb2xvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBcIue6ouahg1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gXCLmlrnniYdcIjsgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwi6buR5qGDXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBcIuaiheiKsVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2tlclR5cGUuc3RyaW5nID0gY29sb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYy5sb2coXCJwb2NrZXIgY29sb3IgaXMgXCIsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ot5HkuIDkuKrnv7vniYznmoTliqjnlLtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpIDw9IDEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5ub1Bva2Vyc05vZGVbaV0uYWN0aXZlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm9Qb2tlcnNOb2RlW2ldLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5zY2FsZVRvKDAuMiwgMCwgMSksIGNjLmNhbGxGdW5jKGZ1bmN0aW9uKCl7c2VsZi5ub1Bva2Vyc05vZGVbaV0uYWN0aXZlID0gZmFsc2U7fSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9rZXJzTm9kZVtpXS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2Muc2NhbGVUbygwLjIsIDAsIDEpLCBjYy5zY2FsZVRvKDAuMiwgMSkpKTsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+W8gOWllumYtuaute+8jOimgeS4gOS4quS4gOS4quWHuue7k+aenO+8jOagueaNrnBvd2VyaWTorqHnrpfml7bmnLpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlbGF5ID0gKHRoaXMucG93ZXJJZCAtIDEpICogMS4wO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi5ub1Bva2Vyc05vZGVbaV0uYWN0aXZlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm5vUG9rZXJzTm9kZVtpXS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuNCwgY2MudjIoMCwgLTE2MSkpLCBjYy5jYWxsRnVuYyhmdW5jdGlvbigpe3NlbGYubm9Qb2tlcnNOb2RlW2ldLnkgPSAwO30pKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wb2tlcnNOb2RlW2ldLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC40LCBjYy52MigwLCAwKSksIGNjLmNhbGxGdW5jKHNlbGYucHV0U3RhbXBPbkFjdGlvbiwgc2VsZiwgc2VsZikpKTsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBkZWxheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gXG5cblxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMucG9rZXJMaWdodC5sZW5ndGg7IGkgKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5wb2tlckxpZ2h0W2ldO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5wdWtlSGlnaExpZ2h0Tm9kZUFycmF5W2luZGV4XS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZih0aGlzLmJldEZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICAgICAgICAgIGlmKG5ldERhdGEudGltZUZsYWcgPT0gMSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2Rkc0xhYmVsLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5vZGRzMSArIFwi5YCNXCI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2Rkc0xhYmVsLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwgMjU1LCAyNTUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHNMYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMub2RkczIgKyBcIuWAjVwiO1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm9kZFR5cGUgPT0gMClcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzTGFiZWwuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAwLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMub2RkVHlwZSA9PSAxKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHNMYWJlbC5jb2xvciA9IG5ldyBjYy5Db2xvcig0NSwgNjcsIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHNMYWJlbC5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZih0aGlzLnBvd2VyRmxhZyAmJiB0aGlzLnBvd2VySWQgIT0gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5oaXN0b3J5c0xpc3ROb2RlLmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5SWNvbk5vZGUgPSB0aGlzLmhpc3RvcnlzTGlzdE5vZGVbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuaGlzdG9yeXNbaV0gPT0gMSkvL+iDnFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5SWNvbk5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAwLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuaGlzdG9yeXNbaV0gPT0gMCkvL+i0n1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5SWNvbk5vZGUuQ29sb3IgPSBuZXcgY2MuQ29sb3IoNDUsIDY3LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UvL+W5s1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5SWNvbk5vZGUuQ29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICBcbiAgICAgICAgaWYodGhpcy5iZXRGbGFnICYmICF0aGlzLnBvd2VyRmxhZyl7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLmJldFN0YXR1cyA9PSAxKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2tlck5vVG91Y2hMYXllci5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2tlck5vVG91Y2hMYXllci5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZih0aGlzLmxpZ3RoRmxhZyA9PSB0cnVlKS8v5Lit5aWW57uT5p6c6auY5LquXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJldEhpZ2hMaWdodExheWVyLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmV0SGlnaExpZ2h0TGF5ZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG4gICAgXG4gICAgLy/po57nu5PmnpzvvIznm5bmiLNcbiAgICBwdXRTdGFtcE9uQWN0aW9uOiBmdW5jdGlvbih0YXJnZXQsIHNlbGYpXG4gICAge1xuICAgICAgICBpZihzZWxmLnBvd2VySWQgPT0gMSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy9jYy5sb2coXCJmbHlTdGFtcCEhIVwiKTtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgcmV3YXJkRGF0YSA9IG5ldERhdGEucmV3YXJkRGF0YTtcbiAgICAgICAgdmFyIGNvbnZlcnROb2RlID0gY2MuZmluZChcIkNhbnZhcy9jb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgdmFyIGNvbnZlcnROb2RlSlMgPSBjb252ZXJ0Tm9kZS5nZXRDb21wb25lbnQoXCJjb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgY29udmVydE5vZGVKUy5mbHlSZXdhcmROb2RlKHNlbGYud2luLCBzZWxmLnBvd2VySWQpO1xuXG4gICAgICAgIGlmKHNlbGYucG93ZXJJZCA9PSAyKXtcbiAgICAgICAgICAgIC8vMTBz5pS25ZueXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShzZWxmLmdldGJhY2ssIDUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBnZXRiYWNrOiBmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB2YXIgZ2FtZUpTID0gY2MuZmluZChcIkNhbnZhc1wiKS5nZXRDb21wb25lbnQoXCJnYW1lXCIpO1xuICAgICAgICBnYW1lSlMucmV3YXJkRmx5RmluaXNoZWRDYWxsYmFjaygpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDliJ3lp4vljJbnrbnnoIFcbiAgICAgKi9cbiAgICBpbml0U2VsZkNoaXAgOiBmdW5jdGlvbih0aW1lRmxhZywgY2hpcE51bSl7XG4gICAgICAgIHRoaXMuc2VsZkNoaXBOb2RlW3RpbWVGbGFnIC0gMV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZWxmQ2hpcE5vZGVbdGltZUZsYWcgLSAxXS56SW5kZXggPSA1MDA7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMuc2VsZkNoaXBOb2RlW3RpbWVGbGFnIC0gMV0uZ2V0Q2hpbGRCeU5hbWUoXCJMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBjaGlwTnVtO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDmgaLlpI3nrbnnoIHpo57lm55cbiAgICAgKiBAcGFyYW0gY2hpcE51bSDnrbnnoIHph49cbiAgICAgKi9cbiAgICByZXN1bWVTZWxmQ2hpcCA6IGZ1bmN0aW9uKGNoaXBOdW0pe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIC8v6K6h566X5ZOq5Liq562556CB5pyA5o6l6L+RY2hpcE51bVxuICAgICAgICBsZXQgY2hpcEluZGV4ID0gMDtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IG5ldERhdGEuaW5pdERhdGEuYmV0TGlzdC5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICBpZihjaGlwTnVtID49IG5ldERhdGEuaW5pdERhdGEuYmV0TGlzdFtpXSl7XG4gICAgICAgICAgICAgICAgY2hpcEluZGV4ID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8v6LeR5Yqo55S777yM55uu5qCH5L2N572u5piv5Liq5Zu65a6a5YC877yM5LiA6Zi25q615ZKM5LqM6Zi25q615YiG5Yir5Zu65a6a5LiA5Liq562556CB5L2N572uXG4gICAgICAgIC8v6LeR5a6M5Yqo55S75ZCO77yM5pu05paw5oqV5rOo6aKd55qEbGFiZWxcbiAgICAgICAgaWYodGhpcy5iZXRGbGFnKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY29udmVydE5vZGUgPSBjYy5maW5kKFwiQ2FudmFzL2NvbnZlcnROb2RlXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnZlcnROb2RlSlMgPSBjb252ZXJ0Tm9kZS5nZXRDb21wb25lbnQoXCJjb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgICAgIGNvbnZlcnROb2RlSlMuY2hpcEZseUFjdGlvbihjaGlwTnVtLCBjaGlwSW5kZXgsIHRoaXMuYmV0SWQtMSwgdHJ1ZSwgc2VsZik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIOiHquW3seaKleazqOmjnuetueeggVxuICAgICAqIEBwYXJhbSBjaGlwSW5kZXgg5qW85LiL562556CB55qEaW5kZXhcbiAgICAgKi9cbiAgICBhZGRzZWxmQ2hpcCA6IGZ1bmN0aW9uKGNoaXBJbmRleCwgc2VsZil7XG4gICAgICAgIHNlbGYuY3VycmVudENoaXBJbmRleCA9IGNoaXBJbmRleDtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgYmV0ID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0W2NoaXBJbmRleF07XG5cbiAgICAgICAgLy/mipXms6jmgLvpop3lj5jljJZcbiAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgIHNlbGYuYmV0TnVtVG90YWwxICs9IGJldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgc2VsZi5iZXROdW1Ub3RhbDIgKz0gYmV0O1xuICAgICAgICB9XG4gICAgICAgIFxuXG4gICAgICAgIC8v5qOA5p+l5piv5ZCm5bey57uP5a2Y5Zyo6K+l57G75Z6L562556CBXG4gICAgICAgIHZhciBleGl0RmxhZyA9IGZhbHNlO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2VsZi5iZXRMaXN0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGlmKHNlbGYuYmV0TGlzdFtpXS5iZXQgPT0gYmV0KXtcbiAgICAgICAgICAgICAgICBzZWxmLmJldExpc3RbaV0ubnVtKys7XG4gICAgICAgICAgICAgICAgZXhpdEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYoIWV4aXRGbGFnKXtcbiAgICAgICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgICAgICBvYmouaWQgPSBzZWxmLmJldElkO1xuICAgICAgICAgICAgb2JqLmJldCA9IGJldDtcbiAgICAgICAgICAgIG9iai5udW0gPSAxO1xuICAgICAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgICAgICBvYmoub2RkcyA9IHNlbGYub2RkczE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIG9iai5vZGRzID0gc2VsZi5vZGRzMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc2VsZi5iZXRMaXN0LnB1c2gob2JqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v6LeR5Yqo55S777yM55uu5qCH5L2N572u5piv5Liq5Zu65a6a5YC877yM5LiA6Zi25q615ZKM5LqM6Zi25q615YiG5Yir5Zu65a6a5LiA5Liq562556CB5L2N572uXG4gICAgICAgIC8v6LeR5a6M5Yqo55S75ZCO77yM5pu05paw5oqV5rOo6aKd55qEbGFiZWxcbiAgICAgICAgaWYoc2VsZi5iZXRGbGFnKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY29udmVydE5vZGUgPSBjYy5maW5kKFwiQ2FudmFzL2NvbnZlcnROb2RlXCIpO1xuICAgICAgICAgICAgdmFyIGNvbnZlcnROb2RlSlMgPSBjb252ZXJ0Tm9kZS5nZXRDb21wb25lbnQoXCJjb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgICAgIGNvbnZlcnROb2RlSlMuY2hpcEZseUFjdGlvbihiZXQsIGNoaXBJbmRleCwgc2VsZi5iZXRJZC0xLCB0cnVlLCBzZWxmKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICB9LFxuICAgIFxuICAgIGZseUNoaXBOb2RlRmluaXNoZWQ6IGZ1bmN0aW9uKHNlbmRlciwgZmxhZylcbiAgICB7XG4gICAgICAgIHZhciBmbGFnID0gZmxhZztcbiAgICAgICAgdmFyIHNlbGYgPSBzZW5kZXI7XG4gICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgICB2YXIgaW5kZXggPSBuZXREYXRhLnRpbWVGbGFnIC0gMTtcbiAgICAgICAgIGlmKGZsYWcpXG4gICAgICAgICB7XG4gICAgICAgICAgICBzZWxmLnNlbGZDaGlwTm9kZVtpbmRleF0uYWN0aXZlID0gZmxhZztcbiAgICAgICAgICAgIHNlbGYuc2VsZkNoaXBOb2RlW2luZGV4XS56SW5kZXggPSA1MDA7XG4gICAgICAgICAgICB2YXIgbGFiZWwgPSBzZWxmLnNlbGZDaGlwTm9kZVtpbmRleF0uZ2V0Q2hpbGRCeU5hbWUoXCJMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHNlbGYuYmV0TnVtVG90YWwxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHNlbGYuYmV0TnVtVG90YWwyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZWxmLnNldFNraW5XaXRoVGFnKHNlbGYuY3VycmVudENoaXBJbmRleCk7XG4gICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAqIOiuvue9ruetueeggeearuiCpFxuICAgICAqIEBwYXJhbSB0YWcg5a+55bqU55qE562556CB57yW5Y+3KDIwIDUwIDEwMCA1MDAgMTAwMCBncmF5IG90aGVyKSBlZzogMCAxIDIgMyA0IDUgNlxuICAgICAqL1xuICAgIHNldFNraW5XaXRoVGFnOiBmdW5jdGlvbih0YWcpXG4gICAge1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIGlmKG5ldERhdGEudGltZUZsYWcgPT0gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuc2VsZkNoaXAxU2tpbmVOb2RlLmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZih0YWcgPT0gaSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZkNoaXAxU2tpbmVOb2RlW2ldLmFjdGl2YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxmQ2hpcDFTa2luZU5vZGVbaV0uYWN0aXZhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnNlbGZDaGlwMVNraW5lTm9kZS5sZW5ndGg7IGkgKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYodGFnID09IGkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGZDaGlwMVNraW5lTm9kZVtpXS5hY3RpdmF0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZkNoaXAxU2tpbmVOb2RlW2ldLmFjdGl2YXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBcblxuICAgIH0sXG5cbiAgICBcbiAgICAvKipcbiAgICAgKiDoh6rlt7HnrbnnoIHpo57lm55cbiAgICAgKiBAcGFyYW0gY2hpcE51bSAg6aOe5Zue55qE562556CB5pWw6aKdXG4gICAgICovXG4gICAgcmVkdWNlU2VsZkNoaXAgOiBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIGlmKG5ldERhdGEudGltZUZsYWcgPT0gMSl7XG4gICAgICAgICAgICB0aGlzLmJldE51bVRvdGFsMSAtPSB0aGlzLmJldE51bTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDIgLT0gdGhpcy5iZXROdW07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBzZXIgPSBudWxsO1xuICAgICAgICB2YXIgdG90YWxNb25leSA9IFwiXCI7XG4gICAgICAgIGlmKG5ldERhdGEudGltZUZsYWcgPT0gMSlcbiAgICAgICAge1xuICAgICAgICAgICAgc2VyID0gdGhpcy5zZWxmQ2hpcE5vZGVbMF07XG4gICAgICAgICAgICB0b3RhbE1vbmV5ID0gdGhpcy5iZXROdW1Ub3RhbDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBzZXIgPSB0aGlzLnNlbGZDaGlwTm9kZVsxXTtcbiAgICAgICAgICAgIHRvdGFsTW9uZXkgPSB0aGlzLmJldE51bVRvdGFsMjtcbiAgICAgICAgfVxuICAgICAgICBpZihzZXIuYWN0aXZlKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgaWYodG90YWxNb25leT4wKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/lhYjpmpDol49cbiAgICAgICAgICAgIHNlci5hY3RpdmUgPSBmbGFnO1xuICAgICAgICAgICAgc2VyLnpJbmRleCA9IDUwMDtcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IHNlci5nZXRDaGlsZEJ5TmFtZShcIkxhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICBsYWJlbC5zdHJpbmcgPSB0b3RhbE1vbmV5O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvL+WGjeaJvuetueeggemjnlxuICAgICAgICAgICAgdmFyIGNvbnZlcnROb2RlID0gY2MuZmluZChcIkNhbnZhcy9jb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgICAgIHZhciBjb252ZXJ0Tm9kZUpTID0gY29udmVydE5vZGUuZ2V0Q29tcG9uZW50KFwiY29udmVydE5vZGVcIik7XG4gICAgICAgICAgICAvLyB2YXIgZmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gaWYodG90YWxNb25leT4wKVxuICAgICAgICAgICAgLy8ge1xuICAgICAgICAgICAgLy8gICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgY29udmVydE5vZGVKUy5jaGlwRmx5QWN0aW9uKHRoaXMuYmV0TnVtLCB0aGlzLmN1cnJlbnRDaGlwSW5kZXgsIHRoaXMuYmV0SWQtMSwgZmxhZywgdGhpcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiAg5Yqo5L2c6aOe5Zue5p2lXG4gICAgICovXG4gICAgZmx5QmFjazogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5jbGVhclNlbGZDaGlwKCk7XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiDmuIXnqbrnrbnnoIFcbiAgICAgKi9cbiAgICBjbGVhclNlbGZDaGlwIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpe1xuICAgICAgICAgICAgdGhpcy5iZXROdW0gPSB0aGlzLmJldE51bVRvdGFsMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5iZXROdW0gPSB0aGlzLmJldE51bVRvdGFsMjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZHVjZVNlbGZDaGlwKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOWFtuS7lueOqeWutumjnuetueeggVxuICAgICAqIEBwYXJhbSBzZWF0SW5kZXgg5YW25LuW546p5a625bqn5L2N5Y+3XG4gICAgICovXG4gICAgYWRkT3RoZXJDaGlwIDogZnVuY3Rpb24oc2VhdEluZGV4KXtcblxuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFuZ2xlID0gMDtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAgdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgIHRoaXMuYW5nbGUgKz0gZHQgKiAzNjA7XG4gICAgICAgICBcbiAgICAgICAgIGlmKHRoaXMuYW5nbGUgPiAzNjApXG4gICAgICAgICB7XG4gICAgICAgICAgICAgdGhpcy5hbmdsZSAtPSAzNjA7XG4gICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgIHRoaXMubm9kZS5yb3RhdGlvbiA9ICB0aGlzLmFuZ2xlO1xuICAgICB9LFxufSk7XG4iLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTtyZXF1aXJlKFwiLi4vYWVzL21kNVwiKTtyZXF1aXJlKFwiLi4vYWVzL2VuYy1iYXNlNjRcIik7cmVxdWlyZShcIi4uL2Flcy9ldnBrZGZcIik7cmVxdWlyZShcIi4uL2Flcy9jaXBoZXItY29yZVwiKTtyZXF1aXJlKFwiLi4vYWVzL21vZGUtZWNiXCIpOyhmdW5jdGlvbigpe3ZhciBDPUNyeXB0b0pTO3ZhciBDX2xpYj1DLmxpYjt2YXIgQmxvY2tDaXBoZXI9Q19saWIuQmxvY2tDaXBoZXI7dmFyIENfYWxnbz1DLmFsZ287dmFyIFNCT1g9W107dmFyIElOVl9TQk9YPVtdO3ZhciBTVUJfTUlYXzA9W107dmFyIFNVQl9NSVhfMT1bXTt2YXIgU1VCX01JWF8yPVtdO3ZhciBTVUJfTUlYXzM9W107dmFyIElOVl9TVUJfTUlYXzA9W107dmFyIElOVl9TVUJfTUlYXzE9W107dmFyIElOVl9TVUJfTUlYXzI9W107dmFyIElOVl9TVUJfTUlYXzM9W107KGZ1bmN0aW9uKCl7dmFyIGQ9W107Zm9yKHZhciBpPTA7aTwyNTY7aSsrKXtpZihpPDEyOCl7ZFtpXT1pPDwxfWVsc2V7ZFtpXT0oaTw8MSleMjgzfX12YXIgeD0wO3ZhciB4aT0wO2Zvcih2YXIgaT0wO2k8MjU2O2krKyl7dmFyIHN4PXhpXih4aTw8MSleKHhpPDwyKV4oeGk8PDMpXih4aTw8NCk7c3g9KHN4Pj4+OCleKHN4JjI1NSleOTk7U0JPWFt4XT1zeDtJTlZfU0JPWFtzeF09eDt2YXIgeDI9ZFt4XTt2YXIgeDQ9ZFt4Ml07dmFyIHg4PWRbeDRdO3ZhciB0PShkW3N4XSoyNTcpXihzeCoxNjg0MzAwOCk7U1VCX01JWF8wW3hdPSh0PDwyNCl8KHQ+Pj44KTtTVUJfTUlYXzFbeF09KHQ8PDE2KXwodD4+PjE2KTtTVUJfTUlYXzJbeF09KHQ8PDgpfCh0Pj4+MjQpO1NVQl9NSVhfM1t4XT10O3ZhciB0PSh4OCoxNjg0MzAwOSleKHg0KjY1NTM3KV4oeDIqMjU3KV4oeCoxNjg0MzAwOCk7SU5WX1NVQl9NSVhfMFtzeF09KHQ8PDI0KXwodD4+PjgpO0lOVl9TVUJfTUlYXzFbc3hdPSh0PDwxNil8KHQ+Pj4xNik7SU5WX1NVQl9NSVhfMltzeF09KHQ8PDgpfCh0Pj4+MjQpO0lOVl9TVUJfTUlYXzNbc3hdPXQ7aWYoIXgpe3g9eGk9MX1lbHNle3g9eDJeZFtkW2RbeDheeDJdXV07eGlePWRbZFt4aV1dfX19KCkpO3ZhciBSQ09OPVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XTt2YXIgQUVTPUNfYWxnby5BRVM9QmxvY2tDaXBoZXIuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3ZhciBrZXk9dGhpcy5fa2V5O3ZhciBrZXlXb3Jkcz1rZXkud29yZHM7dmFyIGtleVNpemU9a2V5LnNpZ0J5dGVzLzQ7dmFyIG5Sb3VuZHM9dGhpcy5fblJvdW5kcz1rZXlTaXplKzY7dmFyIGtzUm93cz0oblJvdW5kcysxKSo0O3ZhciBrZXlTY2hlZHVsZT10aGlzLl9rZXlTY2hlZHVsZT1bXTtmb3IodmFyIGtzUm93PTA7a3NSb3c8a3NSb3dzO2tzUm93Kyspe2lmKGtzUm93PGtleVNpemUpe2tleVNjaGVkdWxlW2tzUm93XT1rZXlXb3Jkc1trc1Jvd119ZWxzZXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvdy0xXTtpZighKGtzUm93JWtleVNpemUpKXt0PSh0PDw4KXwodD4+PjI0KTt0PShTQk9YW3Q+Pj4yNF08PDI0KXwoU0JPWFsodD4+PjE2KSYyNTVdPDwxNil8KFNCT1hbKHQ+Pj44KSYyNTVdPDw4KXxTQk9YW3QmMjU1XTt0Xj1SQ09OWyhrc1Jvdy9rZXlTaXplKXwwXTw8MjR9ZWxzZXtpZihrZXlTaXplPjYmJmtzUm93JWtleVNpemU9PTQpe3Q9KFNCT1hbdD4+PjI0XTw8MjQpfChTQk9YWyh0Pj4+MTYpJjI1NV08PDE2KXwoU0JPWFsodD4+PjgpJjI1NV08PDgpfFNCT1hbdCYyNTVdfX1rZXlTY2hlZHVsZVtrc1Jvd109a2V5U2NoZWR1bGVba3NSb3cta2V5U2l6ZV1edH19dmFyIGludktleVNjaGVkdWxlPXRoaXMuX2ludktleVNjaGVkdWxlPVtdO2Zvcih2YXIgaW52S3NSb3c9MDtpbnZLc1Jvdzxrc1Jvd3M7aW52S3NSb3crKyl7dmFyIGtzUm93PWtzUm93cy1pbnZLc1JvdztpZihpbnZLc1JvdyU0KXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvd119ZWxzZXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvdy00XX1pZihpbnZLc1Jvdzw0fHxrc1Jvdzw9NCl7aW52S2V5U2NoZWR1bGVbaW52S3NSb3ddPXR9ZWxzZXtpbnZLZXlTY2hlZHVsZVtpbnZLc1Jvd109SU5WX1NVQl9NSVhfMFtTQk9YW3Q+Pj4yNF1dXklOVl9TVUJfTUlYXzFbU0JPWFsodD4+PjE2KSYyNTVdXV5JTlZfU1VCX01JWF8yW1NCT1hbKHQ+Pj44KSYyNTVdXV5JTlZfU1VCX01JWF8zW1NCT1hbdCYyNTVdXX19fSxlbmNyeXB0QmxvY2s6ZnVuY3Rpb24oTSxvZmZzZXQpe3RoaXMuX2RvQ3J5cHRCbG9jayhNLG9mZnNldCx0aGlzLl9rZXlTY2hlZHVsZSxTVUJfTUlYXzAsU1VCX01JWF8xLFNVQl9NSVhfMixTVUJfTUlYXzMsU0JPWCl9LGRlY3J5cHRCbG9jazpmdW5jdGlvbihNLG9mZnNldCl7dmFyIHQ9TVtvZmZzZXQrMV07TVtvZmZzZXQrMV09TVtvZmZzZXQrM107TVtvZmZzZXQrM109dDt0aGlzLl9kb0NyeXB0QmxvY2soTSxvZmZzZXQsdGhpcy5faW52S2V5U2NoZWR1bGUsSU5WX1NVQl9NSVhfMCxJTlZfU1VCX01JWF8xLElOVl9TVUJfTUlYXzIsSU5WX1NVQl9NSVhfMyxJTlZfU0JPWCk7dmFyIHQ9TVtvZmZzZXQrMV07TVtvZmZzZXQrMV09TVtvZmZzZXQrM107TVtvZmZzZXQrM109dH0sX2RvQ3J5cHRCbG9jazpmdW5jdGlvbihNLG9mZnNldCxrZXlTY2hlZHVsZSxTVUJfTUlYXzAsU1VCX01JWF8xLFNVQl9NSVhfMixTVUJfTUlYXzMsU0JPWCl7dmFyIG5Sb3VuZHM9dGhpcy5fblJvdW5kczt2YXIgczA9TVtvZmZzZXRdXmtleVNjaGVkdWxlWzBdO3ZhciBzMT1NW29mZnNldCsxXV5rZXlTY2hlZHVsZVsxXTt2YXIgczI9TVtvZmZzZXQrMl1ea2V5U2NoZWR1bGVbMl07dmFyIHMzPU1bb2Zmc2V0KzNdXmtleVNjaGVkdWxlWzNdO3ZhciBrc1Jvdz00O2Zvcih2YXIgcm91bmQ9MTtyb3VuZDxuUm91bmRzO3JvdW5kKyspe3ZhciB0MD1TVUJfTUlYXzBbczA+Pj4yNF1eU1VCX01JWF8xWyhzMT4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczI+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMyYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0MT1TVUJfTUlYXzBbczE+Pj4yNF1eU1VCX01JWF8xWyhzMj4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczM+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMCYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mj1TVUJfTUlYXzBbczI+Pj4yNF1eU1VCX01JWF8xWyhzMz4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczA+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMSYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mz1TVUJfTUlYXzBbczM+Pj4yNF1eU1VCX01JWF8xWyhzMD4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczE+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMiYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3MwPXQwO3MxPXQxO3MyPXQyO3MzPXQzfXZhciB0MD0oKFNCT1hbczA+Pj4yNF08PDI0KXwoU0JPWFsoczE+Pj4xNikmMjU1XTw8MTYpfChTQk9YWyhzMj4+PjgpJjI1NV08PDgpfFNCT1hbczMmMjU1XSlea2V5U2NoZWR1bGVba3NSb3crK107dmFyIHQxPSgoU0JPWFtzMT4+PjI0XTw8MjQpfChTQk9YWyhzMj4+PjE2KSYyNTVdPDwxNil8KFNCT1hbKHMzPj4+OCkmMjU1XTw8OCl8U0JPWFtzMCYyNTVdKV5rZXlTY2hlZHVsZVtrc1JvdysrXTt2YXIgdDI9KChTQk9YW3MyPj4+MjRdPDwyNCl8KFNCT1hbKHMzPj4+MTYpJjI1NV08PDE2KXwoU0JPWFsoczA+Pj44KSYyNTVdPDw4KXxTQk9YW3MxJjI1NV0pXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mz0oKFNCT1hbczM+Pj4yNF08PDI0KXwoU0JPWFsoczA+Pj4xNikmMjU1XTw8MTYpfChTQk9YWyhzMT4+PjgpJjI1NV08PDgpfFNCT1hbczImMjU1XSlea2V5U2NoZWR1bGVba3NSb3crK107TVtvZmZzZXRdPXQwO01bb2Zmc2V0KzFdPXQxO01bb2Zmc2V0KzJdPXQyO01bb2Zmc2V0KzNdPXQzfSxrZXlTaXplOjI1Ni8zMn0pO0MuQUVTPUJsb2NrQ2lwaGVyLl9jcmVhdGVIZWxwZXIoQUVTKX0oKSkiLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTtDcnlwdG9KUy5saWIuQ2lwaGVyfHwoZnVuY3Rpb24odW5kZWZpbmVkKXt2YXIgQz1DcnlwdG9KUzt2YXIgQ19saWI9Qy5saWI7dmFyIEJhc2U9Q19saWIuQmFzZTt2YXIgV29yZEFycmF5PUNfbGliLldvcmRBcnJheTt2YXIgQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1DX2xpYi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtO3ZhciBDX2VuYz1DLmVuYzt2YXIgVXRmOD1DX2VuYy5VdGY4O3ZhciBCYXNlNjQ9Q19lbmMuQmFzZTY0O3ZhciBDX2FsZ289Qy5hbGdvO3ZhciBFdnBLREY9Q19hbGdvLkV2cEtERjt2YXIgQ2lwaGVyPUNfbGliLkNpcGhlcj1CdWZmZXJlZEJsb2NrQWxnb3JpdGhtLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKCksY3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGtleSxjZmcpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9FTkNfWEZPUk1fTU9ERSxrZXksY2ZnKX0sY3JlYXRlRGVjcnlwdG9yOmZ1bmN0aW9uKGtleSxjZmcpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9ERUNfWEZPUk1fTU9ERSxrZXksY2ZnKX0saW5pdDpmdW5jdGlvbih4Zm9ybU1vZGUsa2V5LGNmZyl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGNmZyk7dGhpcy5feGZvcm1Nb2RlPXhmb3JtTW9kZTt0aGlzLl9rZXk9a2V5O3RoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtCdWZmZXJlZEJsb2NrQWxnb3JpdGhtLnJlc2V0LmNhbGwodGhpcyk7dGhpcy5fZG9SZXNldCgpfSxwcm9jZXNzOmZ1bmN0aW9uKGRhdGFVcGRhdGUpe3RoaXMuX2FwcGVuZChkYXRhVXBkYXRlKTtyZXR1cm4gdGhpcy5fcHJvY2VzcygpfSxmaW5hbGl6ZTpmdW5jdGlvbihkYXRhVXBkYXRlKXtpZihkYXRhVXBkYXRlKXt0aGlzLl9hcHBlbmQoZGF0YVVwZGF0ZSl9dmFyIGZpbmFsUHJvY2Vzc2VkRGF0YT10aGlzLl9kb0ZpbmFsaXplKCk7cmV0dXJuIGZpbmFsUHJvY2Vzc2VkRGF0YX0sa2V5U2l6ZToxMjgvMzIsaXZTaXplOjEyOC8zMixfRU5DX1hGT1JNX01PREU6MSxfREVDX1hGT1JNX01PREU6MixfY3JlYXRlSGVscGVyOihmdW5jdGlvbigpe2Z1bmN0aW9uIHNlbGVjdENpcGhlclN0cmF0ZWd5KGtleSl7aWYodHlwZW9mIGtleT09XCJzdHJpbmdcIil7cmV0dXJuIFBhc3N3b3JkQmFzZWRDaXBoZXJ9ZWxzZXtyZXR1cm4gU2VyaWFsaXphYmxlQ2lwaGVyfX1yZXR1cm4gZnVuY3Rpb24oY2lwaGVyKXtyZXR1cm57ZW5jcnlwdDpmdW5jdGlvbihtZXNzYWdlLGtleSxjZmcpe3JldHVybiBzZWxlY3RDaXBoZXJTdHJhdGVneShrZXkpLmVuY3J5cHQoY2lwaGVyLG1lc3NhZ2Usa2V5LGNmZyl9LGRlY3J5cHQ6ZnVuY3Rpb24oY2lwaGVydGV4dCxrZXksY2ZnKXtyZXR1cm4gc2VsZWN0Q2lwaGVyU3RyYXRlZ3koa2V5KS5kZWNyeXB0KGNpcGhlcixjaXBoZXJ0ZXh0LGtleSxjZmcpfX19fSgpKX0pO3ZhciBTdHJlYW1DaXBoZXI9Q19saWIuU3RyZWFtQ2lwaGVyPUNpcGhlci5leHRlbmQoe19kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGZpbmFsUHJvY2Vzc2VkQmxvY2tzPXRoaXMuX3Byb2Nlc3MoISFcImZsdXNoXCIpO3JldHVybiBmaW5hbFByb2Nlc3NlZEJsb2Nrc30sYmxvY2tTaXplOjF9KTt2YXIgQ19tb2RlPUMubW9kZT17fTt2YXIgQmxvY2tDaXBoZXJNb2RlPUNfbGliLkJsb2NrQ2lwaGVyTW9kZT1CYXNlLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGNpcGhlcixpdil7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZShjaXBoZXIsaXYpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24oY2lwaGVyLGl2KXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKGNpcGhlcixpdil9LGluaXQ6ZnVuY3Rpb24oY2lwaGVyLGl2KXt0aGlzLl9jaXBoZXI9Y2lwaGVyO3RoaXMuX2l2PWl2fX0pO3ZhciBDQkM9Q19tb2RlLkNCQz0oZnVuY3Rpb24oKXt2YXIgQ0JDPUJsb2NrQ2lwaGVyTW9kZS5leHRlbmQoKTtDQkMuRW5jcnlwdG9yPUNCQy5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih3b3JkcyxvZmZzZXQpe3ZhciBjaXBoZXI9dGhpcy5fY2lwaGVyO3ZhciBibG9ja1NpemU9Y2lwaGVyLmJsb2NrU2l6ZTt4b3JCbG9jay5jYWxsKHRoaXMsd29yZHMsb2Zmc2V0LGJsb2NrU2l6ZSk7Y2lwaGVyLmVuY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpO3RoaXMuX3ByZXZCbG9jaz13b3Jkcy5zbGljZShvZmZzZXQsb2Zmc2V0K2Jsb2NrU2l6ZSl9fSk7Q0JDLkRlY3J5cHRvcj1DQkMuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24od29yZHMsb2Zmc2V0KXt2YXIgY2lwaGVyPXRoaXMuX2NpcGhlcjt2YXIgYmxvY2tTaXplPWNpcGhlci5ibG9ja1NpemU7dmFyIHRoaXNCbG9jaz13b3Jkcy5zbGljZShvZmZzZXQsb2Zmc2V0K2Jsb2NrU2l6ZSk7Y2lwaGVyLmRlY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpO3hvckJsb2NrLmNhbGwodGhpcyx3b3JkcyxvZmZzZXQsYmxvY2tTaXplKTt0aGlzLl9wcmV2QmxvY2s9dGhpc0Jsb2NrfX0pO2Z1bmN0aW9uIHhvckJsb2NrKHdvcmRzLG9mZnNldCxibG9ja1NpemUpe3ZhciBpdj10aGlzLl9pdjtpZihpdil7dmFyIGJsb2NrPWl2O3RoaXMuX2l2PXVuZGVmaW5lZH1lbHNle3ZhciBibG9jaz10aGlzLl9wcmV2QmxvY2t9Zm9yKHZhciBpPTA7aTxibG9ja1NpemU7aSsrKXt3b3Jkc1tvZmZzZXQraV1ePWJsb2NrW2ldfX1yZXR1cm4gQ0JDfSgpKTt2YXIgQ19wYWQ9Qy5wYWQ9e307dmFyIFBrY3M3PUNfcGFkLlBrY3M3PXtwYWQ6ZnVuY3Rpb24oZGF0YSxibG9ja1NpemUpe3ZhciBibG9ja1NpemVCeXRlcz1ibG9ja1NpemUqNDt2YXIgblBhZGRpbmdCeXRlcz1ibG9ja1NpemVCeXRlcy1kYXRhLnNpZ0J5dGVzJWJsb2NrU2l6ZUJ5dGVzO3ZhciBwYWRkaW5nV29yZD0oblBhZGRpbmdCeXRlczw8MjQpfChuUGFkZGluZ0J5dGVzPDwxNil8KG5QYWRkaW5nQnl0ZXM8PDgpfG5QYWRkaW5nQnl0ZXM7dmFyIHBhZGRpbmdXb3Jkcz1bXTtmb3IodmFyIGk9MDtpPG5QYWRkaW5nQnl0ZXM7aSs9NCl7cGFkZGluZ1dvcmRzLnB1c2gocGFkZGluZ1dvcmQpfXZhciBwYWRkaW5nPVdvcmRBcnJheS5jcmVhdGUocGFkZGluZ1dvcmRzLG5QYWRkaW5nQnl0ZXMpO2RhdGEuY29uY2F0KHBhZGRpbmcpfSx1bnBhZDpmdW5jdGlvbihkYXRhKXt2YXIgblBhZGRpbmdCeXRlcz1kYXRhLndvcmRzWyhkYXRhLnNpZ0J5dGVzLTEpPj4+Ml0mMjU1O2RhdGEuc2lnQnl0ZXMtPW5QYWRkaW5nQnl0ZXN9fTt2YXIgQmxvY2tDaXBoZXI9Q19saWIuQmxvY2tDaXBoZXI9Q2lwaGVyLmV4dGVuZCh7Y2ZnOkNpcGhlci5jZmcuZXh0ZW5kKHttb2RlOkNCQyxwYWRkaW5nOlBrY3M3fSkscmVzZXQ6ZnVuY3Rpb24oKXtDaXBoZXIucmVzZXQuY2FsbCh0aGlzKTt2YXIgY2ZnPXRoaXMuY2ZnO3ZhciBpdj1jZmcuaXY7dmFyIG1vZGU9Y2ZnLm1vZGU7aWYodGhpcy5feGZvcm1Nb2RlPT10aGlzLl9FTkNfWEZPUk1fTU9ERSl7dmFyIG1vZGVDcmVhdG9yPW1vZGUuY3JlYXRlRW5jcnlwdG9yfWVsc2V7dmFyIG1vZGVDcmVhdG9yPW1vZGUuY3JlYXRlRGVjcnlwdG9yO3RoaXMuX21pbkJ1ZmZlclNpemU9MX10aGlzLl9tb2RlPW1vZGVDcmVhdG9yLmNhbGwobW9kZSx0aGlzLGl2JiZpdi53b3Jkcyl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih3b3JkcyxvZmZzZXQpe3RoaXMuX21vZGUucHJvY2Vzc0Jsb2NrKHdvcmRzLG9mZnNldCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHBhZGRpbmc9dGhpcy5jZmcucGFkZGluZztpZih0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFKXtwYWRkaW5nLnBhZCh0aGlzLl9kYXRhLHRoaXMuYmxvY2tTaXplKTt2YXIgZmluYWxQcm9jZXNzZWRCbG9ja3M9dGhpcy5fcHJvY2VzcyghIVwiZmx1c2hcIil9ZWxzZXt2YXIgZmluYWxQcm9jZXNzZWRCbG9ja3M9dGhpcy5fcHJvY2VzcyghIVwiZmx1c2hcIik7cGFkZGluZy51bnBhZChmaW5hbFByb2Nlc3NlZEJsb2Nrcyl9cmV0dXJuIGZpbmFsUHJvY2Vzc2VkQmxvY2tzfSxibG9ja1NpemU6MTI4LzMyfSk7dmFyIENpcGhlclBhcmFtcz1DX2xpYi5DaXBoZXJQYXJhbXM9QmFzZS5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oY2lwaGVyUGFyYW1zKXt0aGlzLm1peEluKGNpcGhlclBhcmFtcyl9LHRvU3RyaW5nOmZ1bmN0aW9uKGZvcm1hdHRlcil7cmV0dXJuKGZvcm1hdHRlcnx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19KTt2YXIgQ19mb3JtYXQ9Qy5mb3JtYXQ9e307dmFyIE9wZW5TU0xGb3JtYXR0ZXI9Q19mb3JtYXQuT3BlblNTTD17c3RyaW5naWZ5OmZ1bmN0aW9uKGNpcGhlclBhcmFtcyl7dmFyIGNpcGhlcnRleHQ9Y2lwaGVyUGFyYW1zLmNpcGhlcnRleHQ7dmFyIHNhbHQ9Y2lwaGVyUGFyYW1zLnNhbHQ7aWYoc2FsdCl7dmFyIHdvcmRBcnJheT1Xb3JkQXJyYXkuY3JlYXRlKFsxMzk4ODkzNjg0LDE3MDEwNzY4MzFdKS5jb25jYXQoc2FsdCkuY29uY2F0KGNpcGhlcnRleHQpfWVsc2V7dmFyIHdvcmRBcnJheT1jaXBoZXJ0ZXh0fXJldHVybiB3b3JkQXJyYXkudG9TdHJpbmcoQmFzZTY0KX0scGFyc2U6ZnVuY3Rpb24ob3BlblNTTFN0cil7dmFyIGNpcGhlcnRleHQ9QmFzZTY0LnBhcnNlKG9wZW5TU0xTdHIpO3ZhciBjaXBoZXJ0ZXh0V29yZHM9Y2lwaGVydGV4dC53b3JkcztpZihjaXBoZXJ0ZXh0V29yZHNbMF09PTEzOTg4OTM2ODQmJmNpcGhlcnRleHRXb3Jkc1sxXT09MTcwMTA3NjgzMSl7dmFyIHNhbHQ9V29yZEFycmF5LmNyZWF0ZShjaXBoZXJ0ZXh0V29yZHMuc2xpY2UoMiw0KSk7Y2lwaGVydGV4dFdvcmRzLnNwbGljZSgwLDQpO2NpcGhlcnRleHQuc2lnQnl0ZXMtPTE2fXJldHVybiBDaXBoZXJQYXJhbXMuY3JlYXRlKHtjaXBoZXJ0ZXh0OmNpcGhlcnRleHQsc2FsdDpzYWx0fSl9fTt2YXIgU2VyaWFsaXphYmxlQ2lwaGVyPUNfbGliLlNlcmlhbGl6YWJsZUNpcGhlcj1CYXNlLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKHtmb3JtYXQ6T3BlblNTTEZvcm1hdHRlcn0pLGVuY3J5cHQ6ZnVuY3Rpb24oY2lwaGVyLG1lc3NhZ2Usa2V5LGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO1xyXG4gICAgdmFyIGVuY3J5cHRvcj1jaXBoZXIuY3JlYXRlRW5jcnlwdG9yKGtleSxjZmcpO3ZhciBjaXBoZXJ0ZXh0PWVuY3J5cHRvci5maW5hbGl6ZShtZXNzYWdlKTt2YXIgY2lwaGVyQ2ZnPWVuY3J5cHRvci5jZmc7cmV0dXJuIENpcGhlclBhcmFtcy5jcmVhdGUoe2NpcGhlcnRleHQ6Y2lwaGVydGV4dCxrZXk6a2V5LGl2OmNpcGhlckNmZy5pdixhbGdvcml0aG06Y2lwaGVyLG1vZGU6Y2lwaGVyQ2ZnLm1vZGUscGFkZGluZzpjaXBoZXJDZmcucGFkZGluZyxibG9ja1NpemU6Y2lwaGVyLmJsb2NrU2l6ZSxmb3JtYXR0ZXI6Y2ZnLmZvcm1hdH0pfSxkZWNyeXB0OmZ1bmN0aW9uKGNpcGhlcixjaXBoZXJ0ZXh0LGtleSxjZmcpe2NmZz10aGlzLmNmZy5leHRlbmQoY2ZnKTtjaXBoZXJ0ZXh0PXRoaXMuX3BhcnNlKGNpcGhlcnRleHQsY2ZnLmZvcm1hdCk7dmFyIHBsYWludGV4dD1jaXBoZXIuY3JlYXRlRGVjcnlwdG9yKGtleSxjZmcpLmZpbmFsaXplKGNpcGhlcnRleHQuY2lwaGVydGV4dCk7cmV0dXJuIHBsYWludGV4dH0sX3BhcnNlOmZ1bmN0aW9uKGNpcGhlcnRleHQsZm9ybWF0KXtpZih0eXBlb2YgY2lwaGVydGV4dD09XCJzdHJpbmdcIil7cmV0dXJuIGZvcm1hdC5wYXJzZShjaXBoZXJ0ZXh0LHRoaXMpfWVsc2V7cmV0dXJuIGNpcGhlcnRleHR9fX0pO3ZhciBDX2tkZj1DLmtkZj17fTt2YXIgT3BlblNTTEtkZj1DX2tkZi5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKHBhc3N3b3JkLGtleVNpemUsaXZTaXplLHNhbHQpe2lmKCFzYWx0KXtzYWx0PVdvcmRBcnJheS5yYW5kb20oNjQvOCl9dmFyIGtleT1FdnBLREYuY3JlYXRlKHtrZXlTaXplOmtleVNpemUraXZTaXplfSkuY29tcHV0ZShwYXNzd29yZCxzYWx0KTt2YXIgaXY9V29yZEFycmF5LmNyZWF0ZShrZXkud29yZHMuc2xpY2Uoa2V5U2l6ZSksaXZTaXplKjQpO2tleS5zaWdCeXRlcz1rZXlTaXplKjQ7cmV0dXJuIENpcGhlclBhcmFtcy5jcmVhdGUoe2tleTprZXksaXY6aXYsc2FsdDpzYWx0fSl9fTt2YXIgUGFzc3dvcmRCYXNlZENpcGhlcj1DX2xpYi5QYXNzd29yZEJhc2VkQ2lwaGVyPVNlcmlhbGl6YWJsZUNpcGhlci5leHRlbmQoe2NmZzpTZXJpYWxpemFibGVDaXBoZXIuY2ZnLmV4dGVuZCh7a2RmOk9wZW5TU0xLZGZ9KSxlbmNyeXB0OmZ1bmN0aW9uKGNpcGhlcixtZXNzYWdlLHBhc3N3b3JkLGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO3ZhciBkZXJpdmVkUGFyYW1zPWNmZy5rZGYuZXhlY3V0ZShwYXNzd29yZCxjaXBoZXIua2V5U2l6ZSxjaXBoZXIuaXZTaXplKTtjZmcuaXY9ZGVyaXZlZFBhcmFtcy5pdjt2YXIgY2lwaGVydGV4dD1TZXJpYWxpemFibGVDaXBoZXIuZW5jcnlwdC5jYWxsKHRoaXMsY2lwaGVyLG1lc3NhZ2UsZGVyaXZlZFBhcmFtcy5rZXksY2ZnKTtjaXBoZXJ0ZXh0Lm1peEluKGRlcml2ZWRQYXJhbXMpO3JldHVybiBjaXBoZXJ0ZXh0fSxkZWNyeXB0OmZ1bmN0aW9uKGNpcGhlcixjaXBoZXJ0ZXh0LHBhc3N3b3JkLGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO2NpcGhlcnRleHQ9dGhpcy5fcGFyc2UoY2lwaGVydGV4dCxjZmcuZm9ybWF0KTt2YXIgZGVyaXZlZFBhcmFtcz1jZmcua2RmLmV4ZWN1dGUocGFzc3dvcmQsY2lwaGVyLmtleVNpemUsY2lwaGVyLml2U2l6ZSxjaXBoZXJ0ZXh0LnNhbHQpO2NmZy5pdj1kZXJpdmVkUGFyYW1zLml2O3ZhciBwbGFpbnRleHQ9U2VyaWFsaXphYmxlQ2lwaGVyLmRlY3J5cHQuY2FsbCh0aGlzLGNpcGhlcixjaXBoZXJ0ZXh0LGRlcml2ZWRQYXJhbXMua2V5LGNmZyk7cmV0dXJuIHBsYWludGV4dH19KX0oKSkiLCJcbnZhciBOZXREYXRhID0gcmVxdWlyZShcIk5ldERhdGFcIik7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFxuICAgICAgICBmbHlDaGlwTm9kZTogY2MuUHJlZmFiLFxuICAgICAgICBcbiAgICAgICAgaG9tZVBvc2l0aW9uOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5WZWMyXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgdGFyZ2V0TG9jYXRpb24xOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5WZWMyXSxcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHRhcmdldExvY2F0aW9uMjpcbiAgICAgICAge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuVmVjMl0sXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBmbHlDaGlwTm9kZUFycmF5OntcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvL3Jld2FyZEZseU5vZGU6IGNjLlByZWZhYixcbiAgICAgICAgXG4gICAgICAgIHJld2FyZEZseU5vZGVUYXJnZXRMb2NhdGlvbjpcbiAgICAgICAge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuVmVjMl0sXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICByZXdhcmRGbHlOb2RlSG9tZVBvc2l0aW9uOiBjYy5WZWMyLFxuICAgICAgICByZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheTp7XG4gICAgICAgICAgICBkZWZhdWx0IDogW10sXG4gICAgICAgICAgICB0eXBlIDogY2MuTm9kZVxuICAgICAgICB9LFxuXG4gICAgICAgIG1hcmtGbHlSZXdhcmRDbnQ6IDAsXG4gICAgfSxcbiAgICBcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcbiAgICBcbiAgICBjaGlwRmx5QWN0aW9uOiBmdW5jdGlvbihjaGlwTnVtLCBjaGlwSW5kZXgsIGJldElkLCBmbGFnLCBwb3dlclRhcmdldClcbiAgICB7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgIHZhciBob21lcCA9IHRoaXMuaG9tZVBvc2l0aW9uW2NoaXBJbmRleF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciB0YXJnZXRQID0gbnVsbDtcbiAgICAgICAgICAgIGlmKG5ldERhdGEudGltZUZsYWcgPT0gMSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRQID0gdGhpcy50YXJnZXRMb2NhdGlvbjFbYmV0SWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRhcmdldFAgPSB0aGlzLnRhcmdldExvY2F0aW9uMltiZXRJZF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBmbHlOb2RlID0gdGhpcy5nZXRGbHlDaGlwTm9kZSgpO1xuICAgICAgICAgICAgdmFyIGZseU5vZGVKUyA9IGZseU5vZGUuZ2V0Q29tcG9uZW50KFwiZmx5Q2hpcE5vZGVQcmVcIik7XG5cbiAgICAgICAgICAgIGZseU5vZGVKUy5zZXRTa2luV2l0aFRhZyhjaGlwSW5kZXgpO1xuICAgICAgICAgICAgZmx5Tm9kZUpTLnNldE1vbmV5KGNoaXBOdW0pO1xuICAgICAgICAgICAgZmx5Tm9kZUpTLmNoaXBGbHlBY3Rpb24oaG9tZXAsIHRhcmdldFAsIGZsYWcsIGZseU5vZGUsIHBvd2VyVGFyZ2V0LCB0aGlzLCB0aGlzLmZpbmlzaGVkQ2FsbGJhY2spO1xuICAgICAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBnZXRGbHlDaGlwTm9kZTogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdmFyIGZseU5vZGUgPSBudWxsO1xuICAgICAgICBpZih0aGlzLmZseUNoaXBOb2RlQXJyYXkubGVuZ3RoID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgZmx5Tm9kZSA9IHRoaXMuZmx5Q2hpcE5vZGVBcnJheS5zaGlmdCgpO1xuICAgICAgICAgICAgZmx5Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGZseU5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGZseU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmZseUNoaXBOb2RlKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKGZseU5vZGUpO1xuICAgICAgICBmbHlOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHJldHVybiBmbHlOb2RlO1xuICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIHNldEZseUNoaXBOb2RlOiBmdW5jdGlvbihmbHlub2RlKVxuICAgIHtcbiAgICAgICAgdGhpcy5mbHlDaGlwTm9kZUFycmF5LnB1c2goZmx5bm9kZSk7XG4gICAgICAgIGZseW5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBcbiAgICBmaW5pc2hlZENhbGxiYWNrOiBmdW5jdGlvbih0YXJnZXQsIG9iamVjdClcbiAgICB7XG4gICAgICAgIHZhciBwb3dlclRhcmdldCA9IG9iamVjdC5wb3dlclRhcmdldDtcbiAgICAgICAgdmFyIGZsYWcgPSBvYmplY3QuZmxhZztcbiAgICAgICAgdmFyIHNlbGYgPSBvYmplY3QudGFyZ2V0O1xuICAgICAgICB2YXIgZmx5bm9kZSA9IG9iamVjdC5mbHlOb2RlO1xuICAgICAgICBcbiAgICAgICAgc2VsZi5zZXRGbHlDaGlwTm9kZShmbHlub2RlKTtcbiAgICAgICAgcG93ZXJUYXJnZXQuZmx5Q2hpcE5vZGVGaW5pc2hlZChwb3dlclRhcmdldCwgZmxhZyk7XG4gICAgICAgIFxuICAgICAgICBvYmplY3QgPSBudWxsO1xuICBcbiAgICB9LFxuICAgIFxuICAgIC8vaW5kZXg6IDDotJ8gMeiDnCAgMuW5s1xuICAgIGZseVJld2FyZE5vZGU6ZnVuY3Rpb24gKGluZGV4LCBwb3NpdGlvbkluZGV4KVxuICAgIHtcbiAgICAgICAgdmFyIGZseU5vZGUgPSB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5W3Bvc2l0aW9uSW5kZXggLSAyXTtcbiAgICAgICAgLy8gaWYodGhpcy5yZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheS5sZW5ndGgpXG4gICAgICAgIC8vIHtcbiAgICAgICAgLy8gICAgIGZseU5vZGUgPSB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5LnNoaWZ0KCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gZWxzZVxuICAgICAgICAvLyB7XG4gICAgICAgIC8vICAgICBmbHlOb2RlID0gY2MuaW5zdGFudGlhdGUocmV3YXJkRmx5Tm9kZSk7XG4gICAgICAgIC8vICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQoZmx5Tm9kZSk7XG4gICAgICAgIC8vICAgICB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5LnB1c2goZmx5Tm9kZSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgICAgIFxuICAgICAgICBmbHlOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBmbHlOb2RlSlMgPSBmbHlOb2RlLmdldENvbXBvbmVudChcImZseVJld2FyZE5vZGVQcmVcIik7XG4gICAgICAgIGZseU5vZGVKUy5zZXRTa2luKGluZGV4KTtcbiAgICAgICAgdmFyIHAxID0gdGhpcy5yZXdhcmRGbHlOb2RlSG9tZVBvc2l0aW9uO1xuICAgICAgICB2YXIgcDIgPSB0aGlzLnJld2FyZEZseU5vZGVUYXJnZXRMb2NhdGlvbltwb3NpdGlvbkluZGV4IC0gMl07XG4gICAgICAgIGZseU5vZGVKUy5mbHlSZXdhcmRBY3Rpb24ocDEsIHAyKTtcbiAgICB9LFxuICAgIFxuICAgIFxuICAgIGZseVJld2FyZEFjdGlvbkZpbmlzaGVkOiBmdW5jdGlvbigpXG4gICAge1xuICAgICAgICAvKlxuICAgICAgICB0aGlzLm1hcmtGbHlSZXdhcmRDbnQgKys7XG4gICAgICAgIGlmKHRoaXMubWFya0ZseVJld2FyZENudCA9PSA0KVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5yZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheS5sZW5ndGg7IGkgKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheVtpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5yZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheS5sZW5ndGg7IGkgKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmV3YXJkRmx5Tm9kZUluaXN0YW50QXJyYXlbaV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBcbiAgICBcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJ2YXIgQ3J5cHRvSlM9Q3J5cHRvSlN8fChmdW5jdGlvbihNYXRoLHVuZGVmaW5lZCl7dmFyIEM9e307dmFyIENfbGliPUMubGliPXt9O3ZhciBCYXNlPUNfbGliLkJhc2U9KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gRigpe31yZXR1cm57ZXh0ZW5kOmZ1bmN0aW9uKG92ZXJyaWRlcyl7Ri5wcm90b3R5cGU9dGhpczt2YXIgc3VidHlwZT1uZXcgRigpO2lmKG92ZXJyaWRlcyl7c3VidHlwZS5taXhJbihvdmVycmlkZXMpfWlmKCFzdWJ0eXBlLmhhc093blByb3BlcnR5KFwiaW5pdFwiKSl7c3VidHlwZS5pbml0PWZ1bmN0aW9uKCl7c3VidHlwZS4kc3VwZXIuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fXN1YnR5cGUuaW5pdC5wcm90b3R5cGU9c3VidHlwZTtzdWJ0eXBlLiRzdXBlcj10aGlzO3JldHVybiBzdWJ0eXBlfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgaW5zdGFuY2U9dGhpcy5leHRlbmQoKTtpbnN0YW5jZS5pbml0LmFwcGx5KGluc3RhbmNlLGFyZ3VtZW50cyk7cmV0dXJuIGluc3RhbmNlfSxpbml0OmZ1bmN0aW9uKCl7fSxtaXhJbjpmdW5jdGlvbihwcm9wZXJ0aWVzKXtmb3IodmFyIHByb3BlcnR5TmFtZSBpbiBwcm9wZXJ0aWVzKXtpZihwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpe3RoaXNbcHJvcGVydHlOYW1lXT1wcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV19fWlmKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkoXCJ0b1N0cmluZ1wiKSl7dGhpcy50b1N0cmluZz1wcm9wZXJ0aWVzLnRvU3RyaW5nfX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbml0LnByb3RvdHlwZS5leHRlbmQodGhpcyl9fX0oKSk7dmFyIFdvcmRBcnJheT1DX2xpYi5Xb3JkQXJyYXk9QmFzZS5leHRlbmQoe2luaXQ6ZnVuY3Rpb24od29yZHMsc2lnQnl0ZXMpe3dvcmRzPXRoaXMud29yZHM9d29yZHN8fFtdO2lmKHNpZ0J5dGVzIT11bmRlZmluZWQpe3RoaXMuc2lnQnl0ZXM9c2lnQnl0ZXN9ZWxzZXt0aGlzLnNpZ0J5dGVzPXdvcmRzLmxlbmd0aCo0fX0sdG9TdHJpbmc6ZnVuY3Rpb24oZW5jb2Rlcil7cmV0dXJuKGVuY29kZXJ8fEhleCkuc3RyaW5naWZ5KHRoaXMpfSxjb25jYXQ6ZnVuY3Rpb24od29yZEFycmF5KXt2YXIgdGhpc1dvcmRzPXRoaXMud29yZHM7dmFyIHRoYXRXb3Jkcz13b3JkQXJyYXkud29yZHM7dmFyIHRoaXNTaWdCeXRlcz10aGlzLnNpZ0J5dGVzO3ZhciB0aGF0U2lnQnl0ZXM9d29yZEFycmF5LnNpZ0J5dGVzO3RoaXMuY2xhbXAoKTtpZih0aGlzU2lnQnl0ZXMlNCl7Zm9yKHZhciBpPTA7aTx0aGF0U2lnQnl0ZXM7aSsrKXt2YXIgdGhhdEJ5dGU9KHRoYXRXb3Jkc1tpPj4+Ml0+Pj4oMjQtKGklNCkqOCkpJjI1NTt0aGlzV29yZHNbKHRoaXNTaWdCeXRlcytpKT4+PjJdfD10aGF0Qnl0ZTw8KDI0LSgodGhpc1NpZ0J5dGVzK2kpJTQpKjgpfX1lbHNle2Zvcih2YXIgaT0wO2k8dGhhdFNpZ0J5dGVzO2krPTQpe3RoaXNXb3Jkc1sodGhpc1NpZ0J5dGVzK2kpPj4+Ml09dGhhdFdvcmRzW2k+Pj4yXX19dGhpcy5zaWdCeXRlcys9dGhhdFNpZ0J5dGVzO3JldHVybiB0aGlzfSxjbGFtcDpmdW5jdGlvbigpe3ZhciB3b3Jkcz10aGlzLndvcmRzO3ZhciBzaWdCeXRlcz10aGlzLnNpZ0J5dGVzO3dvcmRzW3NpZ0J5dGVzPj4+Ml0mPTQyOTQ5NjcyOTU8PCgzMi0oc2lnQnl0ZXMlNCkqOCk7d29yZHMubGVuZ3RoPU1hdGguY2VpbChzaWdCeXRlcy80KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgY2xvbmU9QmFzZS5jbG9uZS5jYWxsKHRoaXMpO2Nsb25lLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCk7cmV0dXJuIGNsb25lfSxyYW5kb206ZnVuY3Rpb24obkJ5dGVzKXt2YXIgd29yZHM9W107dmFyIHI9KGZ1bmN0aW9uKG1fdyl7dmFyIG1fdz1tX3c7dmFyIG1fej05ODc2NTQzMjE7dmFyIG1hc2s9NDI5NDk2NzI5NTtyZXR1cm4gZnVuY3Rpb24oKXttX3o9KDM2OTY5KihtX3omNjU1MzUpKyhtX3o+PjE2KSkmbWFzazttX3c9KDE4MDAwKihtX3cmNjU1MzUpKyhtX3c+PjE2KSkmbWFzazt2YXIgcmVzdWx0PSgobV96PDwxNikrbV93KSZtYXNrO3Jlc3VsdC89NDI5NDk2NzI5NjtyZXN1bHQrPTAuNTtyZXR1cm4gcmVzdWx0KihNYXRoLnJhbmRvbSgpPjAuNT8xOi0xKX19KTtmb3IodmFyIGk9MCxyY2FjaGU7aTxuQnl0ZXM7aSs9NCl7dmFyIF9yPXIoKHJjYWNoZXx8TWF0aC5yYW5kb20oKSkqNDI5NDk2NzI5Nik7cmNhY2hlPV9yKCkqOTg3NjU0MDcxO3dvcmRzLnB1c2goKF9yKCkqNDI5NDk2NzI5Nil8MCl9cmV0dXJuIG5ldyBXb3JkQXJyYXkuaW5pdCh3b3JkcyxuQnl0ZXMpfX0pO3ZhciBDX2VuYz1DLmVuYz17fTt2YXIgSGV4PUNfZW5jLkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKHdvcmRBcnJheSl7dmFyIHdvcmRzPXdvcmRBcnJheS53b3Jkczt2YXIgc2lnQnl0ZXM9d29yZEFycmF5LnNpZ0J5dGVzO3ZhciBoZXhDaGFycz1bXTtmb3IodmFyIGk9MDtpPHNpZ0J5dGVzO2krKyl7dmFyIGJpdGU9KHdvcmRzW2k+Pj4yXT4+PigyNC0oaSU0KSo4KSkmMjU1O2hleENoYXJzLnB1c2goKGJpdGU+Pj40KS50b1N0cmluZygxNikpO2hleENoYXJzLnB1c2goKGJpdGUmMTUpLnRvU3RyaW5nKDE2KSl9cmV0dXJuIGhleENoYXJzLmpvaW4oXCJcIil9LHBhcnNlOmZ1bmN0aW9uKGhleFN0cil7dmFyIGhleFN0ckxlbmd0aD1oZXhTdHIubGVuZ3RoO3ZhciB3b3Jkcz1bXTtmb3IodmFyIGk9MDtpPGhleFN0ckxlbmd0aDtpKz0yKXt3b3Jkc1tpPj4+M118PXBhcnNlSW50KGhleFN0ci5zdWJzdHIoaSwyKSwxNik8PCgyNC0oaSU4KSo0KX1yZXR1cm4gbmV3IFdvcmRBcnJheS5pbml0KHdvcmRzLGhleFN0ckxlbmd0aC8yKX19O3ZhciBMYXRpbjE9Q19lbmMuTGF0aW4xPXtzdHJpbmdpZnk6ZnVuY3Rpb24od29yZEFycmF5KXt2YXIgd29yZHM9d29yZEFycmF5LndvcmRzO3ZhciBzaWdCeXRlcz13b3JkQXJyYXkuc2lnQnl0ZXM7dmFyIGxhdGluMUNoYXJzPVtdO2Zvcih2YXIgaT0wO2k8c2lnQnl0ZXM7aSsrKXt2YXIgYml0ZT0od29yZHNbaT4+PjJdPj4+KDI0LShpJTQpKjgpKSYyNTU7bGF0aW4xQ2hhcnMucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGJpdGUpKX1yZXR1cm4gbGF0aW4xQ2hhcnMuam9pbihcIlwiKX0scGFyc2U6ZnVuY3Rpb24obGF0aW4xU3RyKXt2YXIgbGF0aW4xU3RyTGVuZ3RoPWxhdGluMVN0ci5sZW5ndGg7dmFyIHdvcmRzPVtdO2Zvcih2YXIgaT0wO2k8bGF0aW4xU3RyTGVuZ3RoO2krKyl7d29yZHNbaT4+PjJdfD0obGF0aW4xU3RyLmNoYXJDb2RlQXQoaSkmMjU1KTw8KDI0LShpJTQpKjgpfXJldHVybiBuZXcgV29yZEFycmF5LmluaXQod29yZHMsbGF0aW4xU3RyTGVuZ3RoKX19O3ZhciBVdGY4PUNfZW5jLlV0Zjg9e3N0cmluZ2lmeTpmdW5jdGlvbih3b3JkQXJyYXkpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShMYXRpbjEuc3RyaW5naWZ5KHdvcmRBcnJheSkpKX1jYXRjaChlKXt0aHJvdyBuZXcgRXJyb3IoXCJNYWxmb3JtZWQgVVRGLTggZGF0YVwiKX19LHBhcnNlOmZ1bmN0aW9uKHV0ZjhTdHIpe3JldHVybiBMYXRpbjEucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHV0ZjhTdHIpKSl9fTt2YXIgQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1DX2xpYi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtPUJhc2UuZXh0ZW5kKHtyZXNldDpmdW5jdGlvbigpe3RoaXMuX2RhdGE9bmV3IFdvcmRBcnJheS5pbml0KCk7dGhpcy5fbkRhdGFCeXRlcz0wfSxfYXBwZW5kOmZ1bmN0aW9uKGRhdGEpe2lmKHR5cGVvZiBkYXRhPT1cInN0cmluZ1wiKXtkYXRhPVV0ZjgucGFyc2UoZGF0YSl9dGhpcy5fZGF0YS5jb25jYXQoZGF0YSk7dGhpcy5fbkRhdGFCeXRlcys9ZGF0YS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24oZG9GbHVzaCl7dmFyIGRhdGE9dGhpcy5fZGF0YTt2YXIgZGF0YVdvcmRzPWRhdGEud29yZHM7dmFyIGRhdGFTaWdCeXRlcz1kYXRhLnNpZ0J5dGVzO3ZhciBibG9ja1NpemU9dGhpcy5ibG9ja1NpemU7dmFyIGJsb2NrU2l6ZUJ5dGVzPWJsb2NrU2l6ZSo0O3ZhciBuQmxvY2tzUmVhZHk9ZGF0YVNpZ0J5dGVzL2Jsb2NrU2l6ZUJ5dGVzO2lmKGRvRmx1c2gpe25CbG9ja3NSZWFkeT1NYXRoLmNlaWwobkJsb2Nrc1JlYWR5KX1lbHNle25CbG9ja3NSZWFkeT1NYXRoLm1heCgobkJsb2Nrc1JlYWR5fDApLXRoaXMuX21pbkJ1ZmZlclNpemUsMCl9dmFyIG5Xb3Jkc1JlYWR5PW5CbG9ja3NSZWFkeSpibG9ja1NpemU7dmFyIG5CeXRlc1JlYWR5PU1hdGgubWluKG5Xb3Jkc1JlYWR5KjQsZGF0YVNpZ0J5dGVzKTtpZihuV29yZHNSZWFkeSl7Zm9yKHZhciBvZmZzZXQ9MDtvZmZzZXQ8bldvcmRzUmVhZHk7b2Zmc2V0Kz1ibG9ja1NpemUpe3RoaXMuX2RvUHJvY2Vzc0Jsb2NrKGRhdGFXb3JkcyxvZmZzZXQpfXZhciBwcm9jZXNzZWRXb3Jkcz1kYXRhV29yZHMuc3BsaWNlKDAsbldvcmRzUmVhZHkpO2RhdGEuc2lnQnl0ZXMtPW5CeXRlc1JlYWR5fXJldHVybiBuZXcgV29yZEFycmF5LmluaXQocHJvY2Vzc2VkV29yZHMsbkJ5dGVzUmVhZHkpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciBjbG9uZT1CYXNlLmNsb25lLmNhbGwodGhpcyk7Y2xvbmUuX2RhdGE9dGhpcy5fZGF0YS5jbG9uZSgpO3JldHVybiBjbG9uZX0sX21pbkJ1ZmZlclNpemU6MH0pO3ZhciBIYXNoZXI9Q19saWIuSGFzaGVyPUJ1ZmZlcmVkQmxvY2tBbGdvcml0aG0uZXh0ZW5kKHtjZmc6QmFzZS5leHRlbmQoKSxpbml0OmZ1bmN0aW9uKGNmZyl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGNmZyk7dGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe0J1ZmZlcmVkQmxvY2tBbGdvcml0aG0ucmVzZXQuY2FsbCh0aGlzKTt0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbihtZXNzYWdlVXBkYXRlKXt0aGlzLl9hcHBlbmQobWVzc2FnZVVwZGF0ZSk7dGhpcy5fcHJvY2VzcygpO3JldHVybiB0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihtZXNzYWdlVXBkYXRlKXtpZihtZXNzYWdlVXBkYXRlKXt0aGlzLl9hcHBlbmQobWVzc2FnZVVwZGF0ZSl9dmFyIGhhc2g9dGhpcy5fZG9GaW5hbGl6ZSgpO1xyXG4gICAgcmV0dXJuIGhhc2h9LGJsb2NrU2l6ZTo1MTIvMzIsX2NyZWF0ZUhlbHBlcjpmdW5jdGlvbihoYXNoZXIpe3JldHVybiBmdW5jdGlvbihtZXNzYWdlLGNmZyl7cmV0dXJuIG5ldyBoYXNoZXIuaW5pdChjZmcpLmZpbmFsaXplKG1lc3NhZ2UpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oaGFzaGVyKXtyZXR1cm4gZnVuY3Rpb24obWVzc2FnZSxrZXkpe3JldHVybiBuZXcgQ19hbGdvLkhNQUMuaW5pdChoYXNoZXIsa2V5KS5maW5hbGl6ZShtZXNzYWdlKX19fSk7dmFyIENfYWxnbz1DLmFsZ289e307cmV0dXJuIEN9KE1hdGgpKTttb2R1bGUuZXhwb3J0cz1DcnlwdG9KUyIsInZhciBDcnlwdG9KUz1yZXF1aXJlKFwiLi9jb3JlXCIpOyhmdW5jdGlvbigpe3ZhciBDPUNyeXB0b0pTO3ZhciBDX2xpYj1DLmxpYjt2YXIgV29yZEFycmF5PUNfbGliLldvcmRBcnJheTt2YXIgQ19lbmM9Qy5lbmM7dmFyIEJhc2U2ND1DX2VuYy5CYXNlNjQ9e3N0cmluZ2lmeTpmdW5jdGlvbih3b3JkQXJyYXkpe3ZhciB3b3Jkcz13b3JkQXJyYXkud29yZHM7dmFyIHNpZ0J5dGVzPXdvcmRBcnJheS5zaWdCeXRlczt2YXIgbWFwPXRoaXMuX21hcDt3b3JkQXJyYXkuY2xhbXAoKTt2YXIgYmFzZTY0Q2hhcnM9W107Zm9yKHZhciBpPTA7aTxzaWdCeXRlcztpKz0zKXt2YXIgYnl0ZTE9KHdvcmRzW2k+Pj4yXT4+PigyNC0oaSU0KSo4KSkmMjU1O3ZhciBieXRlMj0od29yZHNbKGkrMSk+Pj4yXT4+PigyNC0oKGkrMSklNCkqOCkpJjI1NTt2YXIgYnl0ZTM9KHdvcmRzWyhpKzIpPj4+Ml0+Pj4oMjQtKChpKzIpJTQpKjgpKSYyNTU7dmFyIHRyaXBsZXQ9KGJ5dGUxPDwxNil8KGJ5dGUyPDw4KXxieXRlMztmb3IodmFyIGo9MDsoajw0KSYmKGkraiowLjc1PHNpZ0J5dGVzKTtqKyspe2Jhc2U2NENoYXJzLnB1c2gobWFwLmNoYXJBdCgodHJpcGxldD4+Pig2KigzLWopKSkmNjMpKX19dmFyIHBhZGRpbmdDaGFyPW1hcC5jaGFyQXQoNjQpO2lmKHBhZGRpbmdDaGFyKXt3aGlsZShiYXNlNjRDaGFycy5sZW5ndGglNCl7YmFzZTY0Q2hhcnMucHVzaChwYWRkaW5nQ2hhcil9fXJldHVybiBiYXNlNjRDaGFycy5qb2luKFwiXCIpfSxwYXJzZTpmdW5jdGlvbihiYXNlNjRTdHIpe3ZhciBiYXNlNjRTdHJMZW5ndGg9YmFzZTY0U3RyLmxlbmd0aDt2YXIgbWFwPXRoaXMuX21hcDt2YXIgcGFkZGluZ0NoYXI9bWFwLmNoYXJBdCg2NCk7aWYocGFkZGluZ0NoYXIpe3ZhciBwYWRkaW5nSW5kZXg9YmFzZTY0U3RyLmluZGV4T2YocGFkZGluZ0NoYXIpO2lmKHBhZGRpbmdJbmRleCE9LTEpe2Jhc2U2NFN0ckxlbmd0aD1wYWRkaW5nSW5kZXh9fXZhciB3b3Jkcz1bXTt2YXIgbkJ5dGVzPTA7Zm9yKHZhciBpPTA7aTxiYXNlNjRTdHJMZW5ndGg7aSsrKXtpZihpJTQpe3ZhciBiaXRzMT1tYXAuaW5kZXhPZihiYXNlNjRTdHIuY2hhckF0KGktMSkpPDwoKGklNCkqMik7dmFyIGJpdHMyPW1hcC5pbmRleE9mKGJhc2U2NFN0ci5jaGFyQXQoaSkpPj4+KDYtKGklNCkqMik7dmFyIGJpdHNDb21iaW5lZD1iaXRzMXxiaXRzMjt3b3Jkc1tuQnl0ZXM+Pj4yXXw9KGJpdHNDb21iaW5lZCk8PCgyNC0obkJ5dGVzJTQpKjgpO25CeXRlcysrfX1yZXR1cm4gV29yZEFycmF5LmNyZWF0ZSh3b3JkcyxuQnl0ZXMpfSxfbWFwOlwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz1cIn19KCkpIiwiXG52YXIgRWJ1dHRvblRhZyA9IGNjLkVudW0oe1xuXG4gIGVTa2luRnJlc2g6IDAsXG4gIGVTa2luT0s6IDEsICAgXG4gIGVTa2luQ2FubmVsOiAyLCAgICAgIFxuICBlU2tpbjM6MywgXG4gIGVTa2luNDo0LCBcbiAgZVNraW41IDogNSwgIFxuICBlU2tpbjY6IDYsXG5cbn0pO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGVmdEJ1dHRvbjogY2MuTm9kZSxcbiAgICAgICAgcmlnaHRCdXR0b246IGNjLk5vZGUsXG4gICAgICAgIHRpdGxlOiBjYy5MYWJlbCxcbiAgICAgICAgbGVmdFNraW5BcnJheToge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgbGVmdFRpdGxlOiBjYy5MYWJlbCxcbiAgICAgICAgcmlnaHRTa2luQXJyYXk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIHJpZ2h0VGl0bGU6IGNjLkxhYmVsLFxuICAgICAgICB0eXBlQWN0aW9uOjAsXG5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubGVmdEJ1dHRvbi5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKGV2ZW50KXtcbiAgICAgICAgICAgICB0aGlzLmxlZnRCdXR0b24uc2NhbGUgPSAwLjg7XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMubGVmdEJ1dHRvbi5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uIChldmVudCl7XG4gICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnNjYWxlID0gMTtcbiAgICAgICAgICAgIHZhciBnYW1lRnVuID0gY2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnYW1lJyk7XG4gICAgICAgICAgICBnYW1lRnVuLmVycm9yRGlhbG9nQ2FsbGJhY2sodGhpcy50eXBlQWN0aW9uLCAxKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMubGVmdEJ1dHRvbi5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsIGZ1bmN0aW9uIChldmVudCl7XG4gICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnNjYWxlID0gMTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJpZ2h0QnV0dG9uLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uc2NhbGUgPSAwLjg7XG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMucmlnaHRCdXR0b24ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uc2NhbGUgPSAxO1xuICAgICAgICAgICAgdmFyIG9uRnVuY3Rpb24gPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dhbWUnKTtcbiAgICAgICAgICAgIG9uRnVuY3Rpb24uZXJyb3JEaWFsb2dDYWxsYmFjayh0aGlzLnR5cGVBY3Rpb24sIDIpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yaWdodEJ1dHRvbi5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsIGZ1bmN0aW9uIChldmVudCl7XG4gICAgICAgICAgICAgdGhpcy5yaWdodEJ1dHRvbi5zY2FsZSA9IDE7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIHNob3dEaWFsb2c6ZnVuY3Rpb24odGl0bGUsIGJ1dHRvblR5cGUpXG4gICAge1xuICAgICAgICB0aGlzLnR5cGVBY3Rpb24gPSBidXR0b25UeXBlO1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZXNldHpJbmRleFpyZW8oKTtcbiAgICAgICAgdGhpcy50aXRsZS5zdHJpbmcgPSB0aXRsZTtcbiAgICAgICAgXG4gICAgICAgIGlmKGJ1dHRvblR5cGUgPT09IDApLy/liLfmlrBcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnggPSAwO1xuICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnkgPSAwO1xuICAgICAgICAgICAgdGhpcy5yaWdodEJ1dHRvbi5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMubGVmdFNraW5BcnJheVswXS56SW5kZXggPSAyMDtcbiAgICAgICAgICAgIHRoaXMubGVmdEluZGV4ID0gMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRJbmRleCA9IC0xO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihidXR0b25UeXBlID09IDEpLy/nrYnnrYnlho3otbAg5LiN546p5LqGXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi54ID0gLTE2MDtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi55ID0gLTEwMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubGVmdFNraW5BcnJheVsxXS56SW5kZXggPSAyMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRTa2luQXJyYXlbMV0uekluZGV4ID0gMjA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihidXR0b25UeXBlID09IDIpLy9cbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnggPSAtMTYwO1xuICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnkgPSAtMTAwO1xuICAgICAgICAgICAgdGhpcy5yaWdodEJ1dHRvbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5sZWZ0U2tpbkFycmF5WzJdLnpJbmRleCA9IDIwO1xuICAgICAgICAgICAgdGhpcy5yaWdodFNraW5BcnJheVsyXS56SW5kZXggPSAyMDtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgaGlkZURpYWxvZzpmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBcbiAgICByZXNldHpJbmRleFpyZW86ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVmdFNraW5BcnJheS5sZW5ndGg7IGkgKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubGVmdFNraW5BcnJheVtpXS56SW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgdGhpcy5yaWdodFNraW5BcnJheS5sZW5ndGg7IGogKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucmlnaHRTa2luQXJyYXlbal0uekluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwidmFyIENyeXB0b0pTPXJlcXVpcmUoXCIuL2NvcmVcIik7KGZ1bmN0aW9uKCl7dmFyIEM9Q3J5cHRvSlM7dmFyIENfbGliPUMubGliO3ZhciBCYXNlPUNfbGliLkJhc2U7dmFyIFdvcmRBcnJheT1DX2xpYi5Xb3JkQXJyYXk7dmFyIENfYWxnbz1DLmFsZ287dmFyIE1ENT1DX2FsZ28uTUQ1O3ZhciBFdnBLREY9Q19hbGdvLkV2cEtERj1CYXNlLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKHtrZXlTaXplOjEyOC8zMixoYXNoZXI6TUQ1LGl0ZXJhdGlvbnM6MX0pLGluaXQ6ZnVuY3Rpb24oY2ZnKXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQoY2ZnKX0sY29tcHV0ZTpmdW5jdGlvbihwYXNzd29yZCxzYWx0KXt2YXIgY2ZnPXRoaXMuY2ZnO3ZhciBoYXNoZXI9Y2ZnLmhhc2hlci5jcmVhdGUoKTt2YXIgZGVyaXZlZEtleT1Xb3JkQXJyYXkuY3JlYXRlKCk7dmFyIGRlcml2ZWRLZXlXb3Jkcz1kZXJpdmVkS2V5LndvcmRzO3ZhciBrZXlTaXplPWNmZy5rZXlTaXplO3ZhciBpdGVyYXRpb25zPWNmZy5pdGVyYXRpb25zO3doaWxlKGRlcml2ZWRLZXlXb3Jkcy5sZW5ndGg8a2V5U2l6ZSl7aWYoYmxvY2spe2hhc2hlci51cGRhdGUoYmxvY2spfXZhciBibG9jaz1oYXNoZXIudXBkYXRlKHBhc3N3b3JkKS5maW5hbGl6ZShzYWx0KTtoYXNoZXIucmVzZXQoKTtmb3IodmFyIGk9MTtpPGl0ZXJhdGlvbnM7aSsrKXtibG9jaz1oYXNoZXIuZmluYWxpemUoYmxvY2spO2hhc2hlci5yZXNldCgpfWRlcml2ZWRLZXkuY29uY2F0KGJsb2NrKX1kZXJpdmVkS2V5LnNpZ0J5dGVzPWtleVNpemUqNDtyZXR1cm4gZGVyaXZlZEtleX19KTtDLkV2cEtERj1mdW5jdGlvbihwYXNzd29yZCxzYWx0LGNmZyl7cmV0dXJuIEV2cEtERi5jcmVhdGUoY2ZnKS5jb21wdXRlKHBhc3N3b3JkLHNhbHQpfX0oKSkiLCJcbnZhciBFU2tpblRhZyA9IGNjLkVudW0oe1xuXG4gIGVDaGlwMjA6IDAsXG4gIGVDaGlwNTA6IDEsICAgXG4gIGVDaGlwMTAwOiAyLCAgICAgIFxuICBlQ2hpcDUwMDozLCBcbiAgZUNoaXAxMDAwOjQsIFxuICBlR2FyeUNoaXAgOiA1LCAgXG4gIGVPdGhlckNoaXA6IDYsXG5cbn0pO1xuXG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vMjAgNTAgMTAwIDUwMCAxMDAwIGdyYXkgb3RoZXJcbiAgICAgICAgY2hpcFNraW5Ob2RlQXJyYXk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIG1vbmV5TGFiZWw6Y2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIOiuvue9ruetueeggeearuiCpFxuICAgICAqIEBwYXJhbSB0YWcg5a+55bqU55qE562556CB57yW5Y+3KDIwIDUwIDEwMCA1MDAgMTAwMCBncmF5IG90aGVyKSBlZzogMCAxIDIgMyA0IDUgNlxuICAgICAqL1xuICAgIHNldFNraW5XaXRoVGFnOiBmdW5jdGlvbih0YWcpXG4gICAge1xuICAgICAgICBcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuY2hpcFNraW5Ob2RlQXJyYXkubGVuZ3RoOyBpICsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih0YWcgPT0gaSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaXBTa2luTm9kZUFycmF5W2ldLmFjdGl2YXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaXBTa2luTm9kZUFycmF5W2ldLmFjdGl2YXRlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgICAgICAgICBcblxuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog6K6+572u5oqV5rOo6YeR6aKdXG4gICAgICogQHBhcmFtIGNoaXBNb25leSDlr7nlupTnmoTph5Hpop1cbiAgICAgKi9cbiAgICBzZXRNb25leTogZnVuY3Rpb24oY2hpcE1vbmV5KVxuICAgIHtcbiAgICAgICAgaWYoY2hpcE1vbmV5PjApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubW9uZXlMYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGNoaXBNb25leTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubW9uZXlMYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiXCI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog5Yqo55S76aOeXG4gICAgICogQHBhcmFtIHBvc2l0aW9uMSDmupDkvY3nva5cbiAgICAgKiBAcGFyYW0gcG9zaXRpb24yIOebruagh+S9jee9rlxuICAgICAqIEBwYXJhbSBmbGFnICDpo57lm57mnaXov5jmmK/po57lm57ljrtcbiAgICAgKiBAcGFyYW0gZmx5Tm9kZSDpo57ov4fnqIvnmoTnrbnnoIHlr7nosaFcbiAgICAgKiBAcGFyYW0gc2VsZiDpo57liLDnmoTnm67moIflr7nosaFcbiAgICAgKiBAcGFyYW0gY2FsbEZ1biDlm57osIPnmoTmjIfpkohcbiAgICAgKi9cbiAgICBjaGlwRmx5QWN0aW9uOiBmdW5jdGlvbihwb3NpdGlvbjEsIHBvc2l0aW9uMiwgZmxhZywgZmx5Tm9kZSwgcG93ZXJUYXJnZXQsIHNlbGYsY2FsbEZ1bilcbiAgICB7XG4gICAgICAgIGxldCBtb3ZldG87XG4gICAgICAgIGxldCBkdCA9IDAuMjtcbiAgICAgICAgdGhpcy5ub2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICAgIGlmKGZsYWcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5zZXRQb3NpdGlvbihwb3NpdGlvbjEpO1xuICAgICAgICAgICAgbW92ZXRvID0gY2MubW92ZVRvKGR0LHBvc2l0aW9uMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24ocG9zaXRpb24yKTtcbiAgICAgICAgICAgIG1vdmV0byA9IGNjLm1vdmVUbyhkdCxwb3NpdGlvbjEpO1xuICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgbGV0IGFjMSA9IGNjLnNjYWxlVG8oZHQsIDEuMCwgMS4wKTtcbiAgICAgICAgICAgIFxuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBvYmoucG93ZXJUYXJnZXQgPSBwb3dlclRhcmdldDtcbiAgICAgICAgb2JqLmZseU5vZGUgPSBmbHlOb2RlO1xuICAgICAgICBvYmoudGFyZ2V0ID0gc2VsZjtcbiAgICAgICAgb2JqLmZsYWcgPSBmbGFnO1xuICAgICAgICAgICAgXG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UobW92ZXRvLCBjYy5jYWxsRnVuYyhjYWxsRnVuLCBzZWxmLCBvYmopKSk7XG4gICAgfSxcbiAgICBcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIEVTa2luVGFnIDogRVNraW5UYWcsXG59O1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgXG4gICAgICAgIHJld2FyZEZseU5vZGVTa2luQXJyYXk6XG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcbiAgICBcbiAgICBzZXRTa2luOmZ1bmN0aW9uKGluZGV4KVxuICAgIHtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMucmV3YXJkRmx5Tm9kZVNraW5BcnJheS5sZW5ndGg7IGkgKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKGluZGV4ID09IGkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXdhcmRGbHlOb2RlU2tpbkFycmF5W2ldLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXdhcmRGbHlOb2RlU2tpbkFycmF5W2ldLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIGZseVJld2FyZEFjdGlvbjogZnVuY3Rpb24ocG9zaXRpb24xLCBwb3NpdGlvbjIpXG4gICAge1xuICAgICAgICAvKlxuICAgICAgICBsZXQgbW92ZXRvO1xuICAgICAgICBsZXQgZHQgPSAwLjI7XG4gICAgICAgIHRoaXMubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xuICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24ocG9zaXRpb24xKTtcbiAgICAgICAgbW92ZXRvID0gY2MubW92ZVRvKGR0LHBvc2l0aW9uMik7XG4gICAgICAgIC8vbGV0IGFjMSA9IGNjLnNjYWxlVG8oZHQsIDEuMCwgMS4wKTtcbiAgICAgICAgICAgIFxuICAgICAgICAvL3ZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIC8vb2JqLnRhcmdldCA9IHNlbGY7XG5cbiAgICAgICAgICAgIFxuICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKG1vdmV0bykpO1xuICAgICAgICAqL1xuICAgICAgICB0aGlzLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKHBvc2l0aW9uMSk7XG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2MubW92ZVRvKDAuMiwgcG9zaXRpb24yKSk7XG4gICAgfSxcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJcblxudmFyIE5ldERhdGEgPSByZXF1aXJlKFwiTmV0RGF0YVwiKTtcbnZhciBEYXRhT3BlciA9IHJlcXVpcmUoXCJEYXRhT3BlclwiKTtcbnZhciBCdXR0b25TY2FsZSA9IHJlcXVpcmUoXCJCdXR0b25TY2FsZVwiKTtcbnZhciBJbml0ID0gcmVxdWlyZShcIkluaXRcIik7XG52YXIgaW5pdCA9IG5ldyBJbml0KCk7XG5pbml0LmluaXQoKTtcblxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICByZXdhcmROb2RlOiBjYy5Ob2RlLFxuICAgICAgICBcbiAgICAgICAgYmxhY2tMYXllcjoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHdhaXRMYXllcjoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGNkdGltZUljb246IGNjLk5vZGUsXG4gICAgICAgIC8v5YCS6K6h5pe255yL5Yy65Z+fXG4gICAgICAgIGNkQmdZZWxsb3c6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIGNkQmdSZWQ6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIGNkTGFiZWw6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxuICAgICAgICB9LFxuICAgICAgICBjZEppZWR1YW5MYWJlbDp7XG4gICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy/nrbnnoIHljLpcbiAgICAgICAgY2hpcE5vZGVBcnJheToge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8v5riF6ZmkXG4gICAgICAgIGNsZWFyT25Ob2RlOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBjbGVhck9mZk5vZGU6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvL3RvYXN0XG4gICAgICAgIHRvYXN0Tm9kZToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGNob29zZUFyZWFOb2RlQXJyYXk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBjaGlwQXJlYU5vVG91Y2hOb2RlOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgYmV0QXJlYU5vVG91Y2hOb2RlOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgc3RhZ2VTdG9wRGlhbG9nOmNjLk5vZGUsIC8v56ys5LiA5Zue5ZCI57uT5p2f5o+Q56S65qGGbGFiZWxcbiAgICAgICAgc3VtTGltaXQ6IDAsIC8v5Yik5pat5oqV5rOo5ZKM5YC877ybIOaYr+WQpui2hei/h2xpbWl0O1xuICAgICAgICBuZWVkQ2xlYXJGbGFnOiBmYWxzZSwgLy/pnIDopoHmuIXnkIY76KaB5Zyo5oqV5rOo5oiQ5Yqf5ZCO6LCDO1xuICAgICAgICBjaGlwSW5kZXg6MCwvL+etueeggW5vZGUg55qEIGluZGV4XG4gICAgICAgIGNsZWFyaW5nRmxhZzogZmFsc2UsIC8v5riF55CG5LitXG5cbiAgICAgICAgY2FuQmV0RmxhZyA6IHRydWUsLy/lvZPliY3mmK/lkKblj6/ku6XmipXms6hcbiAgICAgICAgY3VuQ21kIDoxMDAsLy/pu5jorqQxMDBcbiAgICAgICAgXG4gICAgICAgIGVycm9yRGlhbG9nOiBjYy5Ob2RlLFxuICAgICAgICBcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdGhpcy5uZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcblxuICAgICAgICBpZih0aGlzLm5ldERhdGEuaW5pdEZsYWcgPT0gMSl7XG4gICAgICAgICAgICBjYy5sb2coXCLmraPluLjliJ3lp4vljJbov5vlhaVVSVwiKTtcbiAgICAgICAgICAgIC8v55u05o6l5Yid5aeL5YyWXG4gICAgICAgICAgICB0aGlzLmZyb250SW5pdCgpO1xuICAgICAgICAgICAgdGhpcy5nYW1lU3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMubmV0RGF0YS5pbml0RmxhZyA9PSAyKXtcbiAgICAgICAgICAgIC8vIHRoaXMubWlkTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIHRoaXMuc3RvcEhpbnQodGhpcywgdGhpcy5uZXREYXRhLnN0b3BTZWxsaW5nRGVzYyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGNjLmxvZyhcImZlaeato+W4uOWIneWni+WMlui/m+WFpVVJXCIpO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLmluaXRXYWl0LCAwLjEpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyAvL+a1i+ivlVxuICAgICAgICAvLyB0aGlzLm5ldERhdGEudGltZUZsYWcgPSAxO1xuICAgICAgICAvLyB0aGlzLm5ldERhdGEuc2VjcyA9IDI1O1xuICAgICAgICBcbiAgICAgICAgLy8gdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgLy8gb2JqLnN0YXR1cyA9IDE7XG4gICAgICAgIC8vIG9iai5iZXRMaXN0ID0gWzEwLCAyMCwgMzAsIDQwLCA1MF07XG4gICAgICAgIC8vIHZhciBvZGRzTGlzdE9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgLy8gb2Rkc0xpc3RPYmoub3B0aW9uID0gXCLnvqTpm4RcIjtcbiAgICAgICAgLy8gb2Rkc0xpc3RPYmouaWQgPSAxO1xuICAgICAgICAvLyBvZGRzTGlzdE9iai5wb3dlcklkID0gMjtcbiAgICAgICAgLy8gb2Rkc0xpc3RPYmoub2RkczEgPSAwLjI7XG4gICAgICAgIC8vIG9kZHNMaXN0T2JqLm9kZHMyID0gMC44O1xuICAgICAgICAvLyBvZGRzTGlzdE9iai5zdGF0dXMgPSAxO1xuICAgICAgICAvLyBvYmoub2Rkc0xpc3QgPSBvZGRzTGlzdE9iajtcbiAgICAgICAgLy8gdGhpcy5uZXREYXRhLmluaXREYXRhID0gb2JqO1xuICAgICAgICAvLyB0aGlzLmdhbWVTdGFydCgpO1xuXG4gICAgfSxcbiAgICBcbiAgICBcbiAgICBpbml0V2FpdDogZnVuY3Rpb24oZHQpe1xuICAgICAgICBpZih0aGlzLm5ldERhdGEuaW5pdEZsYWcgPT0gMSl7XG4gICAgICAgICAgICAvL+ebtOaOpeWIneWni+WMllxuICAgICAgICAgICAgdGhpcy5mcm9udEluaXQoKTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5pbml0V2FpdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLm5ldERhdGEuaW5pdEZsYWcgPT0gMil7XG4gICAgICAgICAgICAvLyB0aGlzLm1pZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAvLyB0aGlzLnN0b3BIaW50KHRoaXMsIHRoaXMubmV0RGF0YS5zdG9wU2VsbGluZ0Rlc2MpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGZyb250SW5pdDogZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gaWYodGhpcy5uZXREYXRhLmluaXREYXRhLnN0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgIHZhciB0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgbGV0IG9mZnNldCA9IE1hdGgucm91bmQoKGxvY2FsVGltZSAtIGluaXQudGltZVN0YW1wKSAvIDEwMDApOyBcbiAgICAgICAgICAgIHRoaXMubmV0RGF0YS5zZWNzIC09IG9mZnNldDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib2Zmc2V0PSBcIiArIG9mZnNldCArIFwic2VjPSBcIiArIHRoaXMubmV0RGF0YS5zZWNzKTtcblxuICAgICAgICAgICAgaWYodGhpcy5uZXREYXRhLnNlY3MgPCAwKXtcbiAgICAgICAgICAgICAgICB0aGlzLm5ldERhdGEuaW5pdERhdGEuc3RhdHVzID0gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy8gfVxuICAgIH0sXG5cbiAgICByZXN1bWVUaWNrOiBmdW5jdGlvbihkdCl7XG4gICAgICAgIHRoaXMucmVzdW1GbGFnID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmIChjYy5fcmVuZGVyVHlwZSA9PT0gY2MuZ2FtZS5SRU5ERVJfVFlQRV9DQU5WQVMpIHtcbiAgICAgICAgICAgIGNjLnJlbmRlcmVyLmVuYWJsZURpcnR5UmVnaW9uKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgaXNDYW5CZXQ6ZnVuY3Rpb24oY2FsbGJhY2spXG4gICAgIHtcbiAgICAgICAgIHZhciBmbGFnID0gZmFsc2U7XG4gICAgICAgICBcbiAgICAgICAgaWYgKCFDQ19KU0IpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgIHZhciBzZGsgPSB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESztcbiAgICAgICAgICAgIGlmIChzZGspIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHNkay5pc0xvZ2luKGZ1bmN0aW9uKGlzTG9naW4pIFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICBpZighaXNMb2dpbikvL+ayoeeZu+W9leWOu+eZu+W9lVxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZ29Mb2dpbigpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZS8v55m75b2V5LqGIOWIpOaWreaYr+WQpuiOt+WPluixhuaIkOWKn1xuICAgICAgICAgICAgICAgICAge1xuXG4gICAgICAgICAgICAgICAgICAgIHNkay5zZXRDYWNoZSgnY2hpcCcsIHNlbGYubmV0RGF0YS5iZXRMaXN0W3NlbGYuY2hpcEluZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvL+WcqOWIpOaWreaYr+WQpui2s+mine+8iOa3mOWuneebuOWFs++8iVxuICAgICAgICAgICAgICAgICAgICB2YXIgIHByaWNlID0gc2VsZi5uZXRkYXRhLmJldExpc3Rbc2VsZi5jaGlwSW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZmxhZyA9IHNlbGYuanVkZ2VCYWxhbmNlKHByaWNlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYoZmxhZylcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cblxuICAgICB9LFxuICAgICBcbiAgICBnb0xvZ2luOiBmdW5jdGlvbigpe1xuICAgICAgICBpZighQ0NfSlNCKXtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBzZGsgPSB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESztcblxuICAgICAgICAgICAgaWYoc2RrKXtcbiAgICAgICAgICAgICAgICBzZGsubG9naW4oZnVuY3Rpb24oKSB7Ly/pnIDopoHosIPliJ3lp4vljJY7XG4gICAgICAgICAgICAgICAgICAgIC8vIGxvZ2luIOWQjuaJp+ihjFxuICAgICAgICAgICAgICAgICAgICBzZGsudXBkYXRlVXNlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgLypzZGsuZ2V0VXNlckluZm8oZnVuY3Rpb24oaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm5ldERhdGEuc2RrQmFsYW5jZSA9IGluZm8uZmVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1aWQgPSBpbmZvLnVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmljayA9IGluZm8ubmljaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dVc2VySWNvbih1aWQsIG5pY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTsqL1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmZyZXNoKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuZnJlc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5mcmVzaCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGV4aXRKdWRnZTogZnVuY3Rpb24oKXtcbiAgICAgICAgLypcbiAgICAgICAgbGV0IGZnID0gZmFsc2U7XG4gICAgICAgIGxldCB1bmZpbmlzaCA9IGZhbHNlO1xuXG4gICAgICAgIGlmKCF0aGlzLmNhbkJldEZsYWcgfHwgdW5maW5pc2gpe1xuICAgICAgICAgICAgdGhpcy5lcnJEaWFsb2dUYWcgPSAzO1xuXG4gICAgICAgICAgICBpZih0aGlzLmNsZWFyaW5nRmxhZyl7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93RXJyb3JMYXllcihcIuato+WcqOW4ruS9oOaSpOWNle+8jOivt+eojeetiVwiLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93RXJyb3JMYXllcihcIuato+WcqOW4ruS9oOS4i+WNle+8jOivt+eojeetiVwiLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmcgPSB0cnVlOyAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZnO1xuICAgICAgICAqL1xuICAgIH0sXG4gICAgXG4gICAgZnJlc2g6ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5zZXRTdGFnZVRleHQoKTtcbiAgICB9LFxuICAgIFxuICAgIGV4aXRHYW1lOiBmdW5jdGlvbigpe1xuICAgICAgICBpZiAoIUNDX0pTQil7XG4gICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5wb3BXaW5kb3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdnYW1lJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2FtZVN0YXJ0OiBmdW5jdGlvbigpe1xuICAgICAgICBjYy5sb2coXCJnYW1lc3RhcnRcIik7XG4gICAgICAgIHRoaXMuc2V0U3RhZ2VUZXh0KCk7XG4gICAgICAgIHRoaXMuZ2V0Q2hpcEluZGV4KCk7XG4gICAgICAgIHRoaXMuc2hvd0NoaXBOdW0oKTtcbiAgICAgICAgdGhpcy5zd2lmdFNlYygpO1xuICAgICAgICB0aGlzLnNob3dQb3dlckluZm8oKTtcbiAgICAgICAgdGhpcy5yZXN1bWVCZXRDaGlwKCk7XG4gICAgICAgIHRoaXMuZ2V0VGFibGUoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog6I635Y+W5ZCM5qGM5Lq6XG4gICAgICovXG4gICAgZ2V0VGFibGUgOiBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgIGRhdGFPcGVyLmdldFRhYmxlKHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpO1xuICAgIH0sXG4gICAgXG4gICAgcmVHbzogZnVuY3Rpb24oKVxuICAgIHt9LFxuICAgIC8v5Yid5aeL5YyW5oGi5aSN5pWw5o2uXG4gICAgcmVzdW1lQmV0Q2hpcCA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgaWYobmV0RGF0YS5pbml0RGF0YS5iZXRzKXtcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBuZXREYXRhLmluaXREYXRhLmJldHMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaj0wOyBqPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gdGhpcy5jaG9vc2VBcmVhTm9kZUFycmF5W2pdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBvd2VySlMuYmV0SWQgPT0gbmV0RGF0YS5pbml0RGF0YS5iZXRzW2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgcG93ZXJKUy5pbml0U2VsZkNoaXAobmV0RGF0YS5pbml0RGF0YS5iZXRzW2ldLnRpbWVGbGFnLCBuZXREYXRhLmluaXREYXRhLmJldHNbaV0udG90YWxCZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzaG93UG93ZXJJbmZvOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGNob29zZUFyZWEgPSB0aGlzLmNob29zZUFyZWFOb2RlQXJyYXlbaV07XG4gICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICBwb3dlckpTLnVwZGF0YUluZm8odGhpcy5jdW5DbWQpO1xuICAgICAgICAgICAgcG93ZXJKUy51cGRhdGFVSSgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzZXRTZWxmQ2hpcFNraW5HcmF5OiBmdW5jdGlvbih0YWcpXG4gICAge1xuICAgICAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmNob29zZUFyZWFOb2RlQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gdGhpcy5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgdmFyIHBvd2VySlMgPSBjaG9vc2VBcmVhLmdldENvbXBvbmVudChcIlBvd2VyXCIpO1xuICAgICAgICAgICAgcG93ZXJKUy5zZXRTa2luV2l0aFRhZyh0YWcpO1xuICAgICAgICB9IFxuICAgIH0sXG4gICAgXG4gICAgc2V0U3RhZ2VUZXh0OmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHRoaXMuY2RKaWVkdWFuTGFiZWwubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmNkdGltZUljb24uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jZExhYmVsLm5vZGUueCA9IC01NDtcbiAgICAgICAgXG4gICAgICAgIHZhciBqaWVkdWFuID0gdGhpcy5jZEppZWR1YW5MYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICBpZih0aGlzLm5ldERhdGEudGltZUZsYWcgPT0gMSkvL+ebsumAiemYtuautVxuICAgICAgICB7XG4gICAgICAgICAgICBqaWVkdWFuLnN0cmluZyA9IFwi55uy6YCJXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLm5ldERhdGEudGltZUZsYWcgPT0gMikvL+aYjumAiemYtuautVxuICAgICAgICB7XG4gICAgICAgICAgICBqaWVkdWFuLnN0cmluZyA9IFwi5piO6YCJXCI7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIHN3aWZ0U2VjOiBmdW5jdGlvbigpe1xuICAgICAgICAvLzHvvJrmmpfniYzmraPlnKjmipXms6jvvIwy77ya5pqX54mM6Zi25q615bey5oiq5q2i77yMM++8muaYjueJjOato+WcqOaKleazqO+8jDQ65piO54mM5oiq6Iez5oqV5rOo77yMNe+8muato+WcqOW8gOWllu+8jDc65YGc5ZSuXG4gICAgICAgIGNjLmxvZyhcInRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgXCIsIHRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMpO1xuICAgICAgICBjYy5sb2coXCJ0aW1lIGlzIFwiLCB0aGlzLm5ldERhdGEuc2Vjcyk7XG4gICAgICAgIHN3aXRjaCh0aGlzLm5ldERhdGEuaW5pdERhdGEuc3RhdHVzKXtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLm5ldERhdGEuc2VjcyA+PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IHRoaXMubmV0RGF0YS5zZWNzICsgXCLigLNcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwiMOKAs1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgcHQgPSB0aGlzLmNkQmdSZWQucGFyZW50O1xuICAgICAgICAgICAgICAgIHB0LnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgcHQucnVuQWN0aW9uKGNjLnNob3coKSk7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLm5ldERhdGEuc2VjcyA8PSAzKXsgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2RCZ1JlZC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkdCAgPSAwLjM4Oy8vMyAvIDg7XG4gICAgICAgICAgICAgICAgICAgIHB0LnJ1bkFjdGlvbihjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MuZGVsYXlUaW1lKGR0KSwgY2MuaGlkZSgpLCBjYy5kZWxheVRpbWUoZHQpLCBjYy5zaG93KCkpLCA0KSk7IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZEJnUmVkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5zaG93U2VjLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXlMaWdodChmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDaGlwR3JheShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kb1N0b3BCZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1OntcbiAgICAgICAgICAgICAgICAvL+ato+WcqOW8gOWlllxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmV3YXJkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5ncmF5TGlnaHQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDaGlwR3JheSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA3OntcbiAgICAgICAgICAgICAgICAvL+WBnOWUrlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2VjQ2Q6IGZ1bmN0aW9uKGR0KXtcbiAgICAgICAgdGhpcy5uZXREYXRhLnNlY3MtLTtcbiAgICB9LFxuXG4gICAgc2hvd1NlYyA6IGZ1bmN0aW9uKGR0KXtcbiAgICAgICAgLy8gY2MubG9nKFwic2hvd1NlY++8mnRoaXMubmV0RGF0YS5zZWNzIFwiLHRoaXMubmV0RGF0YS5zZWNzKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMubmV0RGF0YS5zZWNzLS07XG5cbiAgICAgICAgLy/ojrflj5blkIzmoYzkurrvvIw1c+eahOWAjeaVsOaXtuiOt+WPllxuICAgICAgICBpZih0aGlzLm5ldERhdGEuc2VjcyA+PSA1ICYmIHRoaXMubmV0RGF0YS5zZWNzICUgNSA9PSAwKXtcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFibGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMubmV0RGF0YS5zZWNzID49IDApe1xuICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IHRoaXMubmV0RGF0YS5zZWNzICsgXCLigLNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwiMOKAs1wiO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5uZXREYXRhLnNlY3MgPD0gMyl7XG4gICAgICAgICAgICBsZXQgcHQgPSB0aGlzLmNkQmdSZWQucGFyZW50O1xuICAgICAgICAgICAgY2MubG9nKFwic2VjPDNcIik7XG4gICAgICAgICAgICB0aGlzLmNkQmdSZWQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY2RCZ1llbGxvdy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBkdCAgPSAwLjM4Oy8vMyAvIDg7XG4gICAgICAgICAgICBwdC5ydW5BY3Rpb24oY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLmRlbGF5VGltZShkdCksIGNjLmhpZGUoKSwgY2MuZGVsYXlUaW1lKGR0KSwgY2Muc2hvdygpKSwgNCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5uZXREYXRhLnNlY3MgPD0gMCl7XG4gICAgICAgICAgICB0aGlzLnNldFNlbGZDaGlwU2tpbkdyYXkoNSk7XG4gICAgICAgICAgICBjYy5sb2coXCJzZWM9PSAwXCIpO1xuICAgICAgICAgICAgdGhpcy5kb1N0b3BCZXQoKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgZG9TdG9wQmV0IDogZnVuY3Rpb24oKXtcbiAgICAgICAgY2MubG9nKFwidGhpcy5uZXREYXRhLnRpbWVGbGFnXCIsIHRoaXMubmV0RGF0YS50aW1lRmxhZyk7XG4gICAgICAgIC8vdGhpcy5jYW5CZXRGbGFnID0gZmFsc2U7XG4gICAgICAgIC8vIHRoaXMudW5zY2hlZHVsZSh0aGlzLnR1cm5UYWJsZUxvZ2ljKTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLnBhcmVudC5zdG9wQWxsQWN0aW9ucygpO1xuICAgICAgICB0aGlzLmNkQmdSZWQucGFyZW50LnJ1bkFjdGlvbihjYy5zaG93KCkpO1xuICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNkTGFiZWwubm9kZS54ID0gLTU0O1xuICAgICAgICAvLyB0aGlzLmNkTGFiZWwudyA9IDIyMDtcbiAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwi5bey5oiq5q2iXCI7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLnNob3dTZWMpOyAgICAgICAgXG4gICAgICAgIC8v5Y+Y54GwO1xuICAgICAgICB0aGlzLmdyYXlMaWdodCh0cnVlKTtcbiAgICAgICAgdGhpcy5zZXRDaGlwR3JheSh0cnVlKTtcbiAgICAgICAgLy/nrbnnoIHkvr/kvJrnmoTlj5jngbBcbiAgICAgICAgXG4gICAgICAgIGlmKHRoaXMubmV0RGF0YS50aW1lRmxhZyA9PSAxKS8v5o+Q56S65qGG55qE5by55Ye66I635Y+W57uT5p6c5byA5aWW5bCx54S25ZCO6I635Y+W56ys5LqM5Zue5ZCI5pWw5o2uXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuc3RhZ2VTdG9wRGlhbG9nLmFjdGl2ZSAgPSB0cnVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZHQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTZWNvbmREYXRhKCk7Ly/ojrflj5bnrKzkuozpmLbmrrVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGNhbGxiYWNrLCAzICsgdGhpcy5uZXREYXRhLmluaXREYXRhLmRlYWRTZWNzMSk7Ly/kuIDpmLbmrrXlgZzmraLml7bpl7QrM3NcbiAgICAgICAgfVxuICAgICAgICBlbHNlLy/ojrflj5blvIDlpZbnu5PmnpxcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oZHQpe1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmV3YXJkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShjYWxsYmFjaywgMyArIHRoaXMubmV0RGF0YS5pbml0RGF0YS5kZWFkU2VjczIpOy8v5LqM6Zi25q615YGc5q2i5pe26Ze0KzNzXG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIGdyYXlMaWdodDogZnVuY3Rpb24oZmxhZyl7XG4gICAgICAgIHRoaXMuY2xlYXJPbk5vZGUucGFyZW50LmFjdGl2ZSA9ICFmbGFnO1xuICAgICAgICB0aGlzLmNsZWFyT2ZmTm9kZS5wYXJlbnQuYWN0aXZlID0gZmxhZztcbiAgICAgICAgdGhpcy5iZXRBcmVhTm9Ub3VjaE5vZGUuYWN0aXZlID0gZmxhZztcbiAgICB9LFxuICAgIFxuICAgIGdldFJld2FyZDogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5jZEJnUmVkLnBhcmVudC5zdG9wQWxsQWN0aW9ucygpO1xuICAgICAgICB0aGlzLmNkQmdSZWQucGFyZW50LnJ1bkFjdGlvbihjYy5zaG93KCkpO1xuICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNkSmllZHVhbkxhYmVsLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICB0aGlzLmNkdGltZUljb24uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICB0aGlzLmNkTGFiZWwubm9kZS54ID0gLTEwMDtcbiAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwi5q2j5Zyo5byA5aWWXCI7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKHRoaXMuZG9SZXdhcmQsIDIpOyAvL+e7meacjeWKoeWZqOmihOeVmeeahDLnp5I7XG4gICAgfSxcbiAgICBcbiAgICBnZXRTZWNvbmREYXRhOiBmdW5jdGlvbigpLy/ojrflj5bnrKzkuozpmLbmrrXnmoTmlbDmja5cbiAgICB7XG4gICAgICAgIC8vdGhpcy5zaG93V2FpdExheWVyKCk7XG4gICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgZGF0YU9wZXIuZ2V0U2Vjb25kRGF0YSh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICB9LFxuICAgIFxuICAgIGRvUmV3YXJkIDogZnVuY3Rpb24oZHQpe1xuICAgICAgICAvL3RoaXMuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgIGRhdGFPcGVyLmdldFJld2FyZCh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgc2hvd1dhaXRMYXllcjogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5ibGFja0xheWVyLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2FpdExheWVyLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGhpZGVXYWl0TGF5ZXI6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYmxhY2tMYXllci5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy53YWl0TGF5ZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBcbiAgICBqdWRnZUJhbGFuY2U6IGZ1bmN0aW9uKGFtb3VudCl7XG4gICAgICAgIGxldCBmZyA9IHRydWU7XG5cbiAgICAgICAgaWYodGhpcy5zZGtCYWxhbmNlID09IC0xKXtcbiAgICAgICAgICAgIC8vIHRoaXMuZXJyRGlhbG9nVGFnID0gNTtcbiAgICAgICAgICAgIC8vIHRoaXMuYmxhY2tMYXllci5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgLy8gdGhpcy5yZWZyZXNoTm9kZS5nZXRDaGlsZEJ5TmFtZShcIndvcmRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuiOt+WPllwiICsgdGhpcy5uZXREYXRhLmN1cnJlbmN5ICsgXCLlpLHotKXvvIzor7fliLfmlrDpobXpnaJcIjtcbiAgICAgICAgICAgIC8vIHRoaXMucmVmcmVzaE5vZGUucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLCAxLjAsIDEuMCkpO1xuICAgICAgICAgICAgZmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuXG4gICAgICAgICAgICBpZihhbW91bnQgPiB0aGlzLnNka0JhbGFuY2Upe1xuICAgICAgICAgICAgICAgIC8v5o+Q56S65L2Z6aKd5LiN6Laz77yM6Lez6L2s5Yiw5YWF5YC8XG4gICAgICAgICAgICAgICAgaWYgKCFDQ19KU0Ipe1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLLnJlY2hhcmdlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vIGJhbGFuY2VcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmc7XG4gICAgfSxcbiAgICBcbiAgICBnZXRDaGlwSW5kZXg6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBzZGsgPSB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESztcbiAgICAgICAgXG4gICAgICAgIGlmKHNkayl7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBsZXQgbGVuID0gdGhpcy5uZXREYXRhLmJldExpc3QubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5nZXRDYWNoZSgnY2hpcCcsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGYubmV0RGF0YS5iZXRMaXN0W2ldID09IHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGlwSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGYubmV0RGF0YS5iZXRMaXN0W2ldID09IHNlbGYubmV0RGF0YS5wcmVCZXQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hpcEluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9ICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIC8qKioqKioqKioqKioqKioqKipuZXRDYWxsYmFjayoqKioqKioqKioqKioqKioqKioqL1xuICAgIG5ldENhbGxiYWNrOiBmdW5jdGlvbihjbWQsIHJlcywgbXNnLCBzZWxmKVxuICAgIHtcbiAgICAgICAgY2MubG9nKFwibmV0Q2FsbGJhY2sgY21kPVwiICsgY21kKTtcbiAgICAgICAgc2VsZi5jdW5DbWQgPSBjbWQ7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgc2VsZi5oaWRlV2FpdExheWVyKCk7XG4gICAgICAgIHJlcyA9IHBhcnNlSW50KHJlcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzPVwiICsgcmVzICsgXCIvbWc9XCIgKyBtc2cgK1wiL2NtZD1cIiArIHNlbGYuY3VuQ21kKTtcbiAgICAgICAgc3dpdGNoKHJlcylcbiAgICAgICAge1xuICAgICAgICBjYXNlIDA6eyAgICAgICAgICAgIFxuICAgICAgICAgICAgc3dpdGNoKGNtZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDovL2luaXRcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ2FtZVN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAxOi8vYmV0XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyV2l0aEZsYWcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FuQmV0RmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1Bvd2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAvL+aKleazqOaIkOWKn+WQjua4hembtlxuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaTxzZWxmLmNob29zZUFyZWFOb2RlQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gc2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvd2VySlMgPSBjaG9vc2VBcmVhLmdldENvbXBvbmVudChcIlBvd2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYocG93ZXJKUy5iZXRGbGFnKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VySlMuYmV0TnVtID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMjovL2NsZWFyXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyaW5nRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dQb3dlckluZm8oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDM6Ly9yZXdhcmRcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2xlYXJXaXRoRmxhZyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1Bvd2VySW5mbygpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGUoc2VsZi5zZWNDZCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKHNlbGYubmV4dFBlcmlvZCwgMTAuMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA0Oi8vdHdvc3RlbXBcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc3RhZ2VTdG9wRGlhbG9nLmFjdGl2ZSAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZShzZWxmLnNob3dTZWMsIDEpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYXlMaWdodChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0Q2hpcEdyYXkoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyV2l0aEZsYWcoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldFN0YWdlVGV4dCgpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dQb3dlckluZm8oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDU6Ly/lkIzmoYzkurpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudXBkYXRhVGFibGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDY6Ly/orqLljZXliJfooahcbiAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA3Oi8v5Y6G5Y+y6LWw5Yq/XG4gICAgICAgICAgICAgICAge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxMDAwMTk6Ly/nrbnnoIHpo57nrbnnoIHpo57lm55cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8c2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5Lmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gc2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3dlckpTID0gY2hvb3NlQXJlYS5nZXRDb21wb25lbnQoXCJQb3dlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgbmV0RGF0YS5yZXFCZXRMaXN0Lmxlbmd0aDsgaiArKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBvd2VySlMuYmV0SWQgPT0gbmV0RGF0YS5yZXFCZXRMaXN0W2pdLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3dlckpTLnJlZHVjZVNlbGZDaGlwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDEwMDAyODovL+aYjueJjOmYtuauteacquW8gOWni++8jOmCo+WwsTFz5ZCO5YaN6LCD5LiLXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKGNtZCA9PSAxMDQpe1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2VsZi5zaG93V2FpdExheWVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuZ2V0U2Vjb25kRGF0YShzZWxmLm5ldENhbGxiYWNrLCBzZWxmKTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxMDAwMTE6Ly/nu5PnrpflsJrmnKrlvIDlp4vvvIzpgqPlsLExc+WQjuWGjeiwg+S4i1xuICAgICAgICB7XG4gICAgICAgICAgICBpZihjbWQgPT0gMTAzKXtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAvL3NlbGYuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFPcGVyLmdldFJld2FyZChzZWxmLm5ldENhbGxiYWNrLCBzZWxmKTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAge1xuICAgICAgICAgICAgY2MubG9nKFwicmVzIGRlZmF1bHQhXCIpO1xuICAgICAgICAgICAgc3dpdGNoKGNtZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYXNlIDEwMTovL+aKleazqOWksei0peWbnuaUtuetueeggVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxmLnNob3dUb2FzdChtc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzID09IDIwMDAwOSl7Ly/kvZnpop3kuI3otrPvvIzot7PovazliLDlhYXlgLxcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbkJldEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8c2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5Lmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gc2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3dlckpTID0gY2hvb3NlQXJlYS5nZXRDb21wb25lbnQoXCJQb3dlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgbmV0RGF0YS5yZXFCZXRMaXN0Lmxlbmd0aDsgaiArKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBvd2VySlMuYmV0SWQgPT0gbmV0RGF0YS5yZXFCZXRMaXN0W2pdLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3dlckpTLnJlZHVjZVNlbGZDaGlwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDI6ey8v5riF56m65oqV5rOoXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyV2l0aEZsYWcoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbGVhcmluZ0ZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1RvYXN0KG1zZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnN0YWdlU3RvcERpYWxvZy5hY3RpdmUgID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+mAmuW4uOeahOmUmeivr+aPkOekulxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yRGlhbG9nSnMgPSBzZWxmLmVycm9yRGlhbG9nLmdldENvbXBvbmVudChcImVycm9yRGlhbG9nXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JEaWFsb2dKcy5zaG93RGlhbG9nKG1zZywgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93VG9hc3QobXNnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuICAgIC8qKioqKioqKioqKioqKioqKipuZXRDYWxsYmFjayoqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLyoqXG4gICAgICog5qOA5p+l5ZCM5qGM5Lq677yM5q+P5bGA57uT5p2f5pe25qOA5p+l77yM5oqK5rKh5pyJ5oqV5rOo55qE5riF5o6J77yM5oqK5pyJ5oqV5rOo55qEc3ViSWTmuIXmjolcbiAgICAgKi9cbiAgICBjaGVja1RhYmxlIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbmV0RGF0YS5yZXFUYWJsZUFycmF5Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGlmKG5ldERhdGEucmVxVGFibGVBcnJheVtpXS5zdWJJZHMubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgIG5ldERhdGEucmVxVGFibGVBcnJheS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgLS1pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOabtOaWsOWQjOahjOS6uu+8jOavj+asoeivt+axguWbnuadpeWQjuiwg+eUqO+8jOWMheWQq+aWsOeahOaKleazqOS/oeaBr1xuICAgICAqL1xuICAgIHVwZGF0YVRhYmxlIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbmV0RGF0YS50YWJsZUFycmF5Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIHZhciBmbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgbmV0RGF0YS5yZXFUYWJsZUFycmF5Lmxlbmd0aDsgKytqKXtcbiAgICAgICAgICAgICAgICBpZihuZXREYXRhLnJlcVRhYmxlQXJyYXlbal0udWlkID09IG5ldERhdGEudGFibGVBcnJheVtpXS51aWQpe1xuICAgICAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBrID0gMDsgayA8IG5ldERhdGEudGFibGVBcnJheVtpXS5zdWJJZHMubGVuZ3RoOyArK2spe1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV0RGF0YS5yZXFUYWJsZUFycmF5W2pdLnN1Yklkcy5wdXNoKG5ldERhdGEudGFibGVBcnJheVtpXS5zdWJJZHNba10pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoIWZsYWcpe1xuICAgICAgICAgICAgICAgIG5ldERhdGEucmVxVGFibGVBcnJheS5wdXNoKG5ldERhdGEudGFibGVBcnJheVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy/nu5Pnrpfpo57miLPnu5PmnZ9cbiAgICByZXdhcmRGbHlGaW5pc2hlZENhbGxiYWNrOiBmdW5jdGlvbigpXG4gICAge1xuICAgICAgICAvL+aPkOekuuWGjeadpeS4gOWxgDEwM1xuICAgICAgICBjYy5sb2coXCLor6Xmj5DnpLrnu5PnrpfpobXpnaLkuoZcIik7XG4gICAgICAgIHRoaXMuYmV0QXJlYU5vVG91Y2hOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHZhciBzdGF0dXMgPSBuZXREYXRhLnJld2FyZERhdGEuc3RhdHVzO1xuICAgICAgICB0aGlzLnJld2FyZE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIG51bSA9IDA7XG4gICAgICAgIGlmKHN0YXR1cyA9PSAxKS8vc2hlbmdcbiAgICAgICAge1xuICAgICAgICAgICAgbnVtID0gbmV0RGF0YS5yZXdhcmREYXRhLmFtb3VudDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAyKS8vZnVcbiAgICAgICAge1xuICAgICAgICAgICAgbnVtID0gbmV0RGF0YS5yZXdhcmREYXRhLmFsbE51bTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAzKS8vcGluZ1xuICAgICAgICB7XG4gICAgICAgICAgICBudW0gPSBuZXREYXRhLnJld2FyZERhdGEuYW1vdW50O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJld2FyZE5vZGUuZ2V0Q29tcG9uZW50KFwicmV3YXJkTm9kZVwiKS5zZXRDb250ZW50KHN0YXR1cywgbnVtKTtcblxuICAgIH0sXG5cbiAgICBuZXh0UGVyaW9kIDogZnVuY3Rpb24oZHQpe1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5uZXh0UGVyaW9kKTtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuc2VjQ2QpO1xuICAgICAgICB0aGlzLm5ldERhdGEudGltZUZsYWcgPSAxO1xuXG4gICAgICAgIHRoaXMucmV3YXJkTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGNob29zZUFyZWEgPSB0aGlzLmNob29zZUFyZWFOb2RlQXJyYXlbaV07XG4gICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICBwb3dlckpTLnJlc2V0SW5mbygpO1xuICAgICAgICAgICAgcG93ZXJKUy51cGRhdGFVSSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5zaG93U2VjLCAxKTtcbiAgICAgICAgdGhpcy5ncmF5TGlnaHQoZmFsc2UpO1xuICAgICAgICB0aGlzLnNldENoaXBHcmF5KGZhbHNlKTtcbiAgICAgICAgdGhpcy5zZXRTdGFnZVRleHQoKTtcbiAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IHRoaXMubmV0RGF0YS5zZWNzICsgXCLigLNcIjtcblxuICAgICAgICB2YXIgY29udmVydE5vZGUgPSBjYy5maW5kKFwiQ2FudmFzL2NvbnZlcnROb2RlXCIpO1xuICAgICAgICB2YXIgY29udmVydE5vZGVKUyA9IGNvbnZlcnROb2RlLmdldENvbXBvbmVudChcImNvbnZlcnROb2RlXCIpO1xuICAgICAgICBjb252ZXJ0Tm9kZUpTLmZseVJld2FyZEFjdGlvbkZpbmlzaGVkKCk7XG5cbiAgICAgICAgLy/lkIzmoYzkurpcbiAgICAgICAgdGhpcy5jaGVja1RhYmxlKCk7XG4gICAgfSxcbiAgICBcbiAgICBjbGVhcldpdGhGbGFnOiBmdW5jdGlvbihmbGFnKVxuICAgIHtcbiAgICAgICAgdGhpcy5jbGVhck9uTm9kZS5wYXJlbnQuYWN0aXZlID0gZmxhZztcbiAgICAgICAgdGhpcy5jbGVhck9mZk5vZGUucGFyZW50LmFjdGl2ZSA9ICFmbGFnO1xuICAgIH0sXG4gICAgXG4gICAgLy/miYDmnInmjInpkq7nmoTlm57osIPnrYnnrYnkuovku7ZcbiAgICBidG5BY3Rpb25DYWxsQmFjayA6ZnVuY3Rpb24oYnRuVGFnKVxuICAgIHtcbiAgICAgICAgc3dpdGNoKGJ0blRhZylcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gY2FzZSBCdXR0b25TY2FsZS5FYnV0dG9uVGFnLmVDbGVhcmU6XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICB7ICBcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJjbGVhciBjbGVhciEhIVwiKTtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgaWYodGhpcy5jYW5CZXRGbGFnKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhcmluZ0ZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyV2l0aEZsYWcoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0TGF5ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFPcGVyID0gRGF0YU9wZXIuRGF0YU9wZXIuZ2V0SW5zdCgpO1xuICAgICAgICAgICAgICAgICAgICBkYXRhT3Blci5nZXRDbGVhcih0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx5QmFjaygpO1xuICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdW1MaW1pdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldERhdGEuYmV0TGltaXQgPSB0aGlzLm5ldERhdGEudG90YWxCZXRMaW1pdDtcblxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXsvL+ato+WcqOS4i+WNle+8jOS4jeiuqea4hVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dUb2FzdChcIuato+WcqOS4uuaCqOS4i+WNle+8jOivt+eojeWQjuaSpOWNlVwiKTtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZWVkQ2xlYXJGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mbHlCYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VtTGltaXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldERhdGEuYmV0TGltaXQgPSB0aGlzLm5ldERhdGEudG90YWxCZXRMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQnV0dG9uU2NhbGUuRWJ1dHRvblRhZy5lQ2hpcDIwOlxuICAgICAgICAgICAgY2FzZSBCdXR0b25TY2FsZS5FYnV0dG9uVGFnLmVDaGlwNTA6XG4gICAgICAgICAgICBjYXNlIEJ1dHRvblNjYWxlLkVidXR0b25UYWcuZUNoaXAxMDA6XG4gICAgICAgICAgICBjYXNlIEJ1dHRvblNjYWxlLkVidXR0b25UYWcuZUNoaXA1MDA6XG4gICAgICAgICAgICBjYXNlIEJ1dHRvblNjYWxlLkVidXR0b25UYWcuZUNoaXAxMDAwOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vY2MubG9nKFwiXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpcEluZGV4ID0gYnRuVGFnO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRDaGlwKCk7XG4gICAgICAgICAgICAgICAgLy9jYy5sb2coXCJjaGlwSW5kZXggaXMgPSBcIiwgdGhpcy5jaGlwSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBlcnJvckRpYWxvZ0NhbGxiYWNrOiBmdW5jdGlvbih0eXBlYWN0aW9uLCBwb3NpdG9uKS8vMSDlt6bovrnmjInpkq4gMiDlj7PovrnmjInpkq5cbiAgICB7XG4gICAgICAgIHZhciBlcnJvckRpYWxvZ0pzID0gdGhpcy5lcnJvckRpYWxvZy5nZXRDb21wb25lbnQoXCJlcnJvckRpYWxvZ1wiKTtcbiAgICAgICAgZXJyb3JEaWFsb2dKcy5oaWRlRGlhbG9nKCk7XG4gICAgICAgIFxuICAgICAgICBpZihwb3NpdG9uID09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN3aXRjaCh0eXBlYWN0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/lj6rmnInkuIDkuKrmjInpkq7liLfmlrDliLfmlrDnmoRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VuQ21kID09IDEwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuZ2V0SW5pdCh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5jdW5DbWQgPT0gMTAxKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmN1bkNtZCA9PSAxMDIpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuY3VuQ21kID09IDEwMylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhT3Blci5nZXRSZXdhcmQodGhpcy5uZXRDYWxsYmFjaywgdGhpcyk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmN1bkNtZCA9PSAxMDQpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNob3dXYWl0TGF5ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuZ2V0U2Vjb25kRGF0YSh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5jdW5DbWQgPT0gMTA1KVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmN1bkNtZCA9PSAxMDYpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgc3dpdGNoKHR5cGVhY3Rpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAge31cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9ICBcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgc2hvd0NoaXBOdW06IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlwTm9kZUFycmF5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBsZSA9IHRoaXMuY2hpcE5vZGVBcnJheVtpXS5nZXRDaGlsZEJ5TmFtZShcIkxhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICB0aGlzLmFkanVzdEZvbnRzaXplKGxlLCBuZXREYXRhLmluaXREYXRhLmJldExpc3RbaV0pOyAgICAgICAgICAgIFxuICAgICAgICAgICAgbGUuc3RyaW5nID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0W2ldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgbmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0Lmxlbmd0aDsgaiArKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYobmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0W2pdID09IG5ldERhdGEuaW5pdERhdGEucHJlQmV0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpcEluZGV4ID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2V0Q2hpcCgpO1xuICAgIH0sXG5cbiAgICBhZGp1c3RGb250c2l6ZTogZnVuY3Rpb24obGFiZWwsIG51bSl7XG4gICAgICAgIGxldCBzZSA9IDcxO1xuXG4gICAgICAgIGlmKG51bSA8IDEwMCl7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihudW0gPCAxMDAwKXtcbiAgICAgICAgICAgIGxhYmVsLmZvbnRTaXplID0gc2UgKiAwLjg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGxhYmVsLmZvbnRTaXplID0gc2UgKiAwLjU2O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICByZXNldENoaXA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuc2V0Q2hpcEdyYXkoZmFsc2UpO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlwTm9kZUFycmF5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmKHRoaXMuY2hpcEluZGV4ID09IGkpe1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpcE5vZGVBcnJheVtpXS5nZXRDaGlsZEJ5TmFtZShcImNob3VtYVwiKS5zY2FsZSA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwTm9kZUFycmF5W2ldLmdldENoaWxkQnlOYW1lKFwibm9Ub3VjaFwiKS5zY2FsZSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuY2hpcE5vZGVBcnJheVtpXS5nZXRDaGlsZEJ5TmFtZShcImNob3VtYVwiKS5zY2FsZSA9IDAuODtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaXBOb2RlQXJyYXlbaV0uZ2V0Q2hpbGRCeU5hbWUoXCJub1RvdWNoXCIpLnNjYWxlID0gMC44O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzZXRDaGlwR3JheTogZnVuY3Rpb24oZmxhZyl7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaXBOb2RlQXJyYXkubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgdGhpcy5jaGlwTm9kZUFycmF5W2ldLmdldENoaWxkQnlOYW1lKFwibm9Ub3VjaFwiKS5hY3RpdmUgPSBmbGFnO1xuXG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIHNob3dUb2FzdDogZnVuY3Rpb24obXNnKXtcbiAgICAgICAgdGhpcy50b2FzdE5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICAgICAgdGhpcy50b2FzdE5vZGUuc2NhbGUgPSAwO1xuICAgICAgICBsZXQgbGUgID0gdGhpcy50b2FzdE5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ3b3JkXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgIGxlLnN0cmluZyA9IG1zZztcbiAgICAgICAgbGV0IGxlbiA9IGxlLm5vZGUud2lkdGggKyAyMDsgXG4gICAgICAgIHRoaXMudG9hc3ROb2RlLndpZHRoID0gbGVuO1xuICAgICAgICBsZXQgZHQgPSAwLjI7XG4gICAgICAgIGxldCBhYzEgPSBjYy5zY2FsZVRvKGR0LCAxLjAsIDEuMCk7XG4gICAgICAgIGxldCBhYzIgPSBjYy5zY2FsZVRvKGR0LCAwLCAwKTtcbiAgICAgICAgdGhpcy50b2FzdE5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGFjMSwgY2MuZGVsYXlUaW1lKDIpLCBhYzIpKTtcbiAgICB9LFxuICAgIFxuICAgIGZseUJhY2s6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGNob29zZUFyZWEgPSB0aGlzLmNob29zZUFyZWFOb2RlQXJyYXlbaV07XG4gICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICBpZihwb3dlckpTLmJldEZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcG93ZXJKUy5iZXRMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgcG93ZXJKUy5mbHlCYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuXG4gICAgcG93ZXJCZXQgOiBmdW5jdGlvbihjYWxsRnVuYywgcG93ZXIpe1xuICAgICAgICAvL+WIpOaWreeZu+W9leOAgeS9meminVRPRE9cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vaWYoc2VsZi5uZXREYXRhLmluaXREYXRhLnN0YXR1cyA9PSAxIHx8IHNlbGYubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvL3NlbGYuY2FuQmV0RmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhcldpdGhGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgIGNhbGxGdW5jKHNlbGYuY2hpcEluZGV4LCBwb3dlcik7XG4gICAgICAgICAgICAgICAgc2VsZi51bnNjaGVkdWxlKHNlbGYuZGVhbEJldCk7XG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2Uoc2VsZi5kZWFsQmV0LCAwLjUpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuaXNDYW5CZXQoY2FsbGJhY2spO1xuICAgICAgICBcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog55yf5a6e5oqV5rOoXG4gICAgICovXG4gICAgZGVhbEJldCA6IGZ1bmN0aW9uKGR0KXtcbiAgICAgICAgLy90aGlzLnNob3dXYWl0TGF5ZXIoKTtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgIC8v6aaW5YWI5qOA5p+l5b2T5YmN5piv5ZCm5pyJ5rKh5pyJ5Zue5p2l55qE5oqV5rOo6K+35rGCXG4gICAgICAgIGlmKHRoaXMuY2FuQmV0RmxhZyl7XG4gICAgICAgICAgICB0aGlzLmNhbkJldEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbmV0RGF0YS5yZXFCZXRMaXN0ID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hvb3NlQXJlYSA9IHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheVtpXTtcbiAgICAgICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICAgICAgaWYocG93ZXJKUy5iZXRGbGFnKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcG93ZXJKUy5iZXROdW0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgcG93ZXJKUy5iZXRMaXN0Lmxlbmd0aDsgKytqKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldERhdGEucmVxQmV0TGlzdC5wdXNoKHBvd2VySlMuYmV0TGlzdFtqXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3dlckpTLmJldE51bSArPSBwb3dlckpTLmJldExpc3Rbal0uYmV0ICogcG93ZXJKUy5iZXRMaXN0W2pdLm51bTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwb3dlckpTLmJldExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRhdGFPcGVyLmdldEJldCh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5kZWFsQmV0LCAwLjUpO1xuICAgICAgICB9XG4gICAgfSxcblxufSk7XG4iLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTsoZnVuY3Rpb24oTWF0aCl7dmFyIEM9Q3J5cHRvSlM7dmFyIENfbGliPUMubGliO3ZhciBXb3JkQXJyYXk9Q19saWIuV29yZEFycmF5O3ZhciBIYXNoZXI9Q19saWIuSGFzaGVyO3ZhciBDX2FsZ289Qy5hbGdvO3ZhciBUPVtdOyhmdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8NjQ7aSsrKXtUW2ldPShNYXRoLmFicyhNYXRoLnNpbihpKzEpKSo0Mjk0OTY3Mjk2KXwwfX0oKSk7dmFyIE1ENT1DX2FsZ28uTUQ1PUhhc2hlci5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgV29yZEFycmF5LmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OF0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oTSxvZmZzZXQpe2Zvcih2YXIgaT0wO2k8MTY7aSsrKXt2YXIgb2Zmc2V0X2k9b2Zmc2V0K2k7dmFyIE1fb2Zmc2V0X2k9TVtvZmZzZXRfaV07TVtvZmZzZXRfaV09KCgoKE1fb2Zmc2V0X2k8PDgpfChNX29mZnNldF9pPj4+MjQpKSYxNjcxMTkzNSl8KCgoTV9vZmZzZXRfaTw8MjQpfChNX29mZnNldF9pPj4+OCkpJjQyNzgyNTUzNjApKX12YXIgSD10aGlzLl9oYXNoLndvcmRzO3ZhciBNX29mZnNldF8wPU1bb2Zmc2V0KzBdO3ZhciBNX29mZnNldF8xPU1bb2Zmc2V0KzFdO3ZhciBNX29mZnNldF8yPU1bb2Zmc2V0KzJdO3ZhciBNX29mZnNldF8zPU1bb2Zmc2V0KzNdO3ZhciBNX29mZnNldF80PU1bb2Zmc2V0KzRdO3ZhciBNX29mZnNldF81PU1bb2Zmc2V0KzVdO3ZhciBNX29mZnNldF82PU1bb2Zmc2V0KzZdO3ZhciBNX29mZnNldF83PU1bb2Zmc2V0KzddO3ZhciBNX29mZnNldF84PU1bb2Zmc2V0KzhdO3ZhciBNX29mZnNldF85PU1bb2Zmc2V0KzldO3ZhciBNX29mZnNldF8xMD1NW29mZnNldCsxMF07dmFyIE1fb2Zmc2V0XzExPU1bb2Zmc2V0KzExXTt2YXIgTV9vZmZzZXRfMTI9TVtvZmZzZXQrMTJdO3ZhciBNX29mZnNldF8xMz1NW29mZnNldCsxM107dmFyIE1fb2Zmc2V0XzE0PU1bb2Zmc2V0KzE0XTt2YXIgTV9vZmZzZXRfMTU9TVtvZmZzZXQrMTVdO3ZhciBhPUhbMF07dmFyIGI9SFsxXTt2YXIgYz1IWzJdO3ZhciBkPUhbM107YT1GRihhLGIsYyxkLE1fb2Zmc2V0XzAsNyxUWzBdKTtkPUZGKGQsYSxiLGMsTV9vZmZzZXRfMSwxMixUWzFdKTtjPUZGKGMsZCxhLGIsTV9vZmZzZXRfMiwxNyxUWzJdKTtiPUZGKGIsYyxkLGEsTV9vZmZzZXRfMywyMixUWzNdKTthPUZGKGEsYixjLGQsTV9vZmZzZXRfNCw3LFRbNF0pO2Q9RkYoZCxhLGIsYyxNX29mZnNldF81LDEyLFRbNV0pO2M9RkYoYyxkLGEsYixNX29mZnNldF82LDE3LFRbNl0pO2I9RkYoYixjLGQsYSxNX29mZnNldF83LDIyLFRbN10pO2E9RkYoYSxiLGMsZCxNX29mZnNldF84LDcsVFs4XSk7ZD1GRihkLGEsYixjLE1fb2Zmc2V0XzksMTIsVFs5XSk7Yz1GRihjLGQsYSxiLE1fb2Zmc2V0XzEwLDE3LFRbMTBdKTtiPUZGKGIsYyxkLGEsTV9vZmZzZXRfMTEsMjIsVFsxMV0pO2E9RkYoYSxiLGMsZCxNX29mZnNldF8xMiw3LFRbMTJdKTtkPUZGKGQsYSxiLGMsTV9vZmZzZXRfMTMsMTIsVFsxM10pO2M9RkYoYyxkLGEsYixNX29mZnNldF8xNCwxNyxUWzE0XSk7Yj1GRihiLGMsZCxhLE1fb2Zmc2V0XzE1LDIyLFRbMTVdKTthPUdHKGEsYixjLGQsTV9vZmZzZXRfMSw1LFRbMTZdKTtkPUdHKGQsYSxiLGMsTV9vZmZzZXRfNiw5LFRbMTddKTtjPUdHKGMsZCxhLGIsTV9vZmZzZXRfMTEsMTQsVFsxOF0pO2I9R0coYixjLGQsYSxNX29mZnNldF8wLDIwLFRbMTldKTthPUdHKGEsYixjLGQsTV9vZmZzZXRfNSw1LFRbMjBdKTtkPUdHKGQsYSxiLGMsTV9vZmZzZXRfMTAsOSxUWzIxXSk7Yz1HRyhjLGQsYSxiLE1fb2Zmc2V0XzE1LDE0LFRbMjJdKTtiPUdHKGIsYyxkLGEsTV9vZmZzZXRfNCwyMCxUWzIzXSk7YT1HRyhhLGIsYyxkLE1fb2Zmc2V0XzksNSxUWzI0XSk7ZD1HRyhkLGEsYixjLE1fb2Zmc2V0XzE0LDksVFsyNV0pO2M9R0coYyxkLGEsYixNX29mZnNldF8zLDE0LFRbMjZdKTtiPUdHKGIsYyxkLGEsTV9vZmZzZXRfOCwyMCxUWzI3XSk7YT1HRyhhLGIsYyxkLE1fb2Zmc2V0XzEzLDUsVFsyOF0pO2Q9R0coZCxhLGIsYyxNX29mZnNldF8yLDksVFsyOV0pO2M9R0coYyxkLGEsYixNX29mZnNldF83LDE0LFRbMzBdKTtiPUdHKGIsYyxkLGEsTV9vZmZzZXRfMTIsMjAsVFszMV0pO2E9SEgoYSxiLGMsZCxNX29mZnNldF81LDQsVFszMl0pO2Q9SEgoZCxhLGIsYyxNX29mZnNldF84LDExLFRbMzNdKTtjPUhIKGMsZCxhLGIsTV9vZmZzZXRfMTEsMTYsVFszNF0pO2I9SEgoYixjLGQsYSxNX29mZnNldF8xNCwyMyxUWzM1XSk7YT1ISChhLGIsYyxkLE1fb2Zmc2V0XzEsNCxUWzM2XSk7ZD1ISChkLGEsYixjLE1fb2Zmc2V0XzQsMTEsVFszN10pO2M9SEgoYyxkLGEsYixNX29mZnNldF83LDE2LFRbMzhdKTtiPUhIKGIsYyxkLGEsTV9vZmZzZXRfMTAsMjMsVFszOV0pO2E9SEgoYSxiLGMsZCxNX29mZnNldF8xMyw0LFRbNDBdKTtkPUhIKGQsYSxiLGMsTV9vZmZzZXRfMCwxMSxUWzQxXSk7Yz1ISChjLGQsYSxiLE1fb2Zmc2V0XzMsMTYsVFs0Ml0pO2I9SEgoYixjLGQsYSxNX29mZnNldF82LDIzLFRbNDNdKTthPUhIKGEsYixjLGQsTV9vZmZzZXRfOSw0LFRbNDRdKTtkPUhIKGQsYSxiLGMsTV9vZmZzZXRfMTIsMTEsVFs0NV0pO2M9SEgoYyxkLGEsYixNX29mZnNldF8xNSwxNixUWzQ2XSk7Yj1ISChiLGMsZCxhLE1fb2Zmc2V0XzIsMjMsVFs0N10pO2E9SUkoYSxiLGMsZCxNX29mZnNldF8wLDYsVFs0OF0pO2Q9SUkoZCxhLGIsYyxNX29mZnNldF83LDEwLFRbNDldKTtjPUlJKGMsZCxhLGIsTV9vZmZzZXRfMTQsMTUsVFs1MF0pO2I9SUkoYixjLGQsYSxNX29mZnNldF81LDIxLFRbNTFdKTthPUlJKGEsYixjLGQsTV9vZmZzZXRfMTIsNixUWzUyXSk7ZD1JSShkLGEsYixjLE1fb2Zmc2V0XzMsMTAsVFs1M10pO2M9SUkoYyxkLGEsYixNX29mZnNldF8xMCwxNSxUWzU0XSk7Yj1JSShiLGMsZCxhLE1fb2Zmc2V0XzEsMjEsVFs1NV0pO2E9SUkoYSxiLGMsZCxNX29mZnNldF84LDYsVFs1Nl0pO2Q9SUkoZCxhLGIsYyxNX29mZnNldF8xNSwxMCxUWzU3XSk7Yz1JSShjLGQsYSxiLE1fb2Zmc2V0XzYsMTUsVFs1OF0pO2I9SUkoYixjLGQsYSxNX29mZnNldF8xMywyMSxUWzU5XSk7YT1JSShhLGIsYyxkLE1fb2Zmc2V0XzQsNixUWzYwXSk7ZD1JSShkLGEsYixjLE1fb2Zmc2V0XzExLDEwLFRbNjFdKTtjPUlJKGMsZCxhLGIsTV9vZmZzZXRfMiwxNSxUWzYyXSk7Yj1JSShiLGMsZCxhLE1fb2Zmc2V0XzksMjEsVFs2M10pO0hbMF09KEhbMF0rYSl8MDtIWzFdPShIWzFdK2IpfDA7SFsyXT0oSFsyXStjKXwwO0hbM109KEhbM10rZCl8MH0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgZGF0YT10aGlzLl9kYXRhO3ZhciBkYXRhV29yZHM9ZGF0YS53b3Jkczt2YXIgbkJpdHNUb3RhbD10aGlzLl9uRGF0YUJ5dGVzKjg7dmFyIG5CaXRzTGVmdD1kYXRhLnNpZ0J5dGVzKjg7ZGF0YVdvcmRzW25CaXRzTGVmdD4+PjVdfD0xMjg8PCgyNC1uQml0c0xlZnQlMzIpO3ZhciBuQml0c1RvdGFsSD1NYXRoLmZsb29yKG5CaXRzVG90YWwvNDI5NDk2NzI5Nik7dmFyIG5CaXRzVG90YWxMPW5CaXRzVG90YWw7ZGF0YVdvcmRzWygoKG5CaXRzTGVmdCs2NCk+Pj45KTw8NCkrMTVdPSgoKChuQml0c1RvdGFsSDw8OCl8KG5CaXRzVG90YWxIPj4+MjQpKSYxNjcxMTkzNSl8KCgobkJpdHNUb3RhbEg8PDI0KXwobkJpdHNUb3RhbEg+Pj44KSkmNDI3ODI1NTM2MCkpO2RhdGFXb3Jkc1soKChuQml0c0xlZnQrNjQpPj4+OSk8PDQpKzE0XT0oKCgobkJpdHNUb3RhbEw8PDgpfChuQml0c1RvdGFsTD4+PjI0KSkmMTY3MTE5MzUpfCgoKG5CaXRzVG90YWxMPDwyNCl8KG5CaXRzVG90YWxMPj4+OCkpJjQyNzgyNTUzNjApKTtkYXRhLnNpZ0J5dGVzPShkYXRhV29yZHMubGVuZ3RoKzEpKjQ7dGhpcy5fcHJvY2VzcygpO3ZhciBoYXNoPXRoaXMuX2hhc2g7dmFyIEg9aGFzaC53b3Jkcztmb3IodmFyIGk9MDtpPDQ7aSsrKXt2YXIgSF9pPUhbaV07SFtpXT0oKChIX2k8PDgpfChIX2k+Pj4yNCkpJjE2NzExOTM1KXwoKChIX2k8PDI0KXwoSF9pPj4+OCkpJjQyNzgyNTUzNjApfXJldHVybiBoYXNofSxjbG9uZTpmdW5jdGlvbigpe3ZhciBjbG9uZT1IYXNoZXIuY2xvbmUuY2FsbCh0aGlzKTtjbG9uZS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCk7cmV0dXJuIGNsb25lfX0pO2Z1bmN0aW9uIEZGKGEsYixjLGQseCxzLHQpe3ZhciBuPWErKChiJmMpfCh+YiZkKSkreCt0O3JldHVybigobjw8cyl8KG4+Pj4oMzItcykpKStifWZ1bmN0aW9uIEdHKGEsYixjLGQseCxzLHQpe3ZhciBuPWErKChiJmQpfChjJn5kKSkreCt0O3JldHVybigobjw8cyl8KG4+Pj4oMzItcykpKStifWZ1bmN0aW9uIEhIKGEsYixjLGQseCxzLHQpe3ZhciBuPWErKGJeY15kKSt4K3Q7cmV0dXJuKChuPDxzKXwobj4+PigzMi1zKSkpK2J9ZnVuY3Rpb24gSUkoYSxiLGMsZCx4LHMsdCl7dmFyIG49YSsoY14oYnx+ZCkpK3grdDtyZXR1cm4oKG48PHMpfChuPj4+KDMyLXMpKSkrYn1DLk1ENT1IYXNoZXIuX2NyZWF0ZUhlbHBlcihNRDUpO0MuSG1hY01ENT1IYXNoZXIuX2NyZWF0ZUhtYWNIZWxwZXIoTUQ1KX0oTWF0aCkpIiwidmFyIENyeXB0b0pTPXJlcXVpcmUoXCIuL2NvcmVcIik7Q3J5cHRvSlMubW9kZS5FQ0I9KGZ1bmN0aW9uKCl7dmFyIEVDQj1DcnlwdG9KUy5saWIuQmxvY2tDaXBoZXJNb2RlLmV4dGVuZCgpO0VDQi5FbmNyeXB0b3I9RUNCLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHdvcmRzLG9mZnNldCl7dGhpcy5fY2lwaGVyLmVuY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpfX0pO0VDQi5EZWNyeXB0b3I9RUNCLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHdvcmRzLG9mZnNldCl7dGhpcy5fY2lwaGVyLmRlY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpfX0pO3JldHVybiBFQ0J9KCkpIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgaW1nQXJyYXk6IFtjYy5Ob2RlXSxcbiAgICAgICAgYnRuSW1nOiBjYy5Ob2RlLFxuICAgICAgICBidG5UZXh0OiBjYy5MYWJlbCxcbiAgICAgICAgdGV4dDogY2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLmxvZyhcInJld2FyZE5vZGVcIik7XG4gICAgICAgIHRoaXMuYnRuSW1nLnBhcmVudC5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKGV2ZW50KXtcbiAgICAgICAgICAgICB0aGlzLmJ0bkltZy5zY2FsZSA9IDAuODtcbiAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5idG5JbWcucGFyZW50Lm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKGV2ZW50KXtcbiAgICAgICAgICAgICB0aGlzLmJ0bkltZy5zY2FsZSA9IDE7XG4gICAgICAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgIGNjLmxvZyhcInJld2FyZENvbHNlXCIpO1xuICAgICAgICAgICAgdmFyIG9uRnVuY3Rpb24gPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dhbWUnKTtcbiAgICAgICAgICAgIG9uRnVuY3Rpb24ubmV4dFBlcmlvZCgpO1xuXG4gICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuYnRuSW1nLnBhcmVudC5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpe1xuXG4gICAgICAgICAgICB0aGlzLmJ0bkltZy5zY2FsZSA9IDE7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuICAgIFxuICAgIHNldENvbnRlbnQ6IGZ1bmN0aW9uKHN0YXR1cywgbnVtKVxuICAgIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgaWYoc3RhdHVzID09PSAwKS8v5pyq5byA5aWWXG4gICAgICAgIHt9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEpLy9zaGVuZ1xuICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0ID0gXCLkuK1cIiArIG51bSArIFwi6LGGXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMikvL2Z1XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRleHQgPSBcIuS7iuaXpeW3suaciVwiICsgbnVtICsgXCLkurrnjJzkuK0hXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMykvL3BpbmdcbiAgICAgICAge1xuICAgICAgICAgICAgdGV4dCA9IFwi6L+U6L+YXCIgKyBudW0gKyBcIuixhlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDQpLy/mnKrmipXms6hcbiAgICAgICAge31cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG5cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRleHQuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xuICAgICAgICBpZihzdGF0dXMgPj0gMSAmJiBzdGF0dXMgPD0gMykvL3NoZW5nXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmltZ0FycmF5Lmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZigoc3RhdHVzLTEpID09IGkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmltZ0FycmF5W2ldLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW1nQXJyYXlbaV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIFxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=