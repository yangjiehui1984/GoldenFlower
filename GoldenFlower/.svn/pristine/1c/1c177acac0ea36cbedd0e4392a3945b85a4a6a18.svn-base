require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ButtonScale":[function(require,module,exports){
"use strict";
cc._RFpush(module, '5a421EEBHBHVa9GjAAkNYhq', 'ButtonScale');
// Script/Tools/ButtonScale.js

'use strict';

//按钮标识
var EbuttonTag = cc.Enum({

    eChip20: 0,
    eChip50: 1,
    eChip100: 2,
    eChip500: 3,
    eChip1000: 4,
    eClear: 5,
    eHistoryList: 6

});

cc.Class({
    extends: cc.Component,

    properties: {
        scaleFlag: true,
        buttonTag: 0,
        parentNode: cc.Node },

    // use this for initialization
    onLoad: function onLoad() {

        // var timeCallback = function (dt)
        {
            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_START, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 0.8;
                    }
                }, this);
            }

            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_END, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 1;
                    }
                    var onFunction = cc.find('Canvas').getComponent('game');
                    onFunction.btnActionCallBack(this.buttonTag);
                }, this);
            }

            if (this.parentNode) {
                this.parentNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
                    if (this.scaleFlag) {
                        this.node.scale = 1;
                    }
                }, this);
            }
        }
    }

});

module.exports = {
    EbuttonTag: EbuttonTag
};

cc._RFpop();
},{}],"DataOper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '370d7GWnVZOL5PlfbPKEsjx', 'DataOper');
// Script/network/DataOper.js

"use strict";

var CryptoJS = require("core");
require("aes");
var NetData = require("NetData");

var KeyValue = cc.Class({
    properties: {
        key: "",
        value: ""
    }
});

var CusMap = cc.Class({
    properties: {
        maps: {
            default: [],
            type: [KeyValue],
            serializable: false
        }
    },

    set: function set(key, value) {
        var s_key = key.toString();
        var flag = false;

        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key === s_key) {
                flag = true;
                this.maps[i].value = value;
                break;
            }
        }

        if (flag === false) {
            var keyValue = new KeyValue();
            keyValue.key = s_key;
            keyValue.value = value;
            this.maps.push(keyValue);
        }
    },

    get: function get(key) {
        var s_key = key.toString();

        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key === s_key) {
                return this.maps[i].value;
            }
        }

        return null;
    },

    clear: function clear(key) {
        for (var i = 0; i < this.maps.length; ++i) {
            if (this.maps[i].key == key) {
                this.maps.splice(i, 1);
                break;
            }
        }
    }
});

var NetWork = cc.Class({
    send: function send(requestId, requestHeaders, requestData, callfunc) {
        var xhr = cc.loader.getXMLHttpRequest();

        if (!CC_JSB) {
            if (window.aliLotteryCasinoSDK) {
                xhr = window.aliLotteryCasinoSDK.getHttpRequestObject();
            }
        }

        xhr.open("POST", "http://10.0.20.172:8080/gateway/process");
        //xhr.open("POST", "http://172.16.20.161:7080/gateway/process");//"http://172.16.20.175:8080/gateway/process"); //"http://10.0.1.232:7080/new_gateway/process"); 
        xhr.timeout = 15000; //15s超时

        //设置请求头
        for (var i = 0; i < requestHeaders.length; ++i) {
            xhr.setRequestHeader(requestHeaders[i].key, requestHeaders[i].value);
        }

        xhr.send(requestData);

        xhr.onload = function () {
            callfunc(requestId, xhr);
        };

        xhr.onerror = function () {
            callfunc(requestId, xhr);
        };

        xhr.ontimeout = function () {
            callfunc(requestId, xhr);
        };
    }
});

var DataOper = cc.Class({

    statics: {
        g_DataOperInst: null,
        s_index: 0,

        getInst: function getInst() {

            if (DataOper.g_DataOperInst === null) {
                DataOper.g_DataOperInst = new DataOper();
                DataOper.g_DataOperInst.init();
            }
            return DataOper.g_DataOperInst;
        },

        destoryInst: function destoryInst() {

            if (DataOper.g_DataOperInst !== null) {
                DataOper.g_DataOperInst = null;
            }
        }
    },

    properties: {
        //请求data
        requestData: "",
        //请求id
        requestId: 0,
        //aes Key
        aesKey: "817fed95f9e16bed", //秘钥，写死

        //****************请求头信息**********
        //请求头数组
        requestHeaders: {
            default: [],
            type: [KeyValue],
            serializable: false
        },
        //命令号
        headerCmd: 0, //初始化-100  投注-101  结算-103
        //sig
        headerSig: "",
        //版本号
        headerVer: "1.0",
        //会话标识
        headerToken: "3706201779", //"3706201779",
        //游戏渠道实例标识
        gameToken: "ad80db994dabb90b42db00214b8d301d-9-901-1202" },

    init: function init() {
        this.callfuncs = new CusMap();
        this.callnode = new CusMap();
        this.callcmd = new CusMap();
        cc.log("jb=" + CC_JSB);

        if (!CC_JSB) {
            this.gameToken = this.GetQueryString("accessToken");

            if (this.gameToken == null) {
                this.gameToken = "ad80db994dabb90b42db00214b8d301d-9-901-1202"; //"ddd76cd6e9b62dc2259aa772a4501b22-9-951-926";
                var tok = this.GetQueryString("tok");

                if (tok) {
                    this.headerToken = tok;
                    console.log("tok=" + this.headerToken);
                } else {
                    this.headerToken = "";
                }
                //test
                /*var myDate = new Date();
                this.headerToken = myDate.getTime();*/
            }
        } else {}

        console.log("this.gameToken = " + this.gameToken);
    },

    GetQueryString: function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r !== null) return unescape(r[2]);return null;
    },

    setRequestHeader: function setRequestHeader() {
        this.requestHeaders = [];

        var keyValue = new KeyValue();
        keyValue.key = "cmd";
        keyValue.value = this.headerCmd.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "Content-Type";
        keyValue.value = "text/plain";
        this.requestHeaders.push(keyValue);

        /*keyValue = new KeyValue();
        keyValue.key = "cid";
        keyValue.value = this.headerCid.toString();
        this.requestHeaders.push(keyValue);*/

        keyValue = new KeyValue();
        keyValue.key = "sig";
        keyValue.value = this.headerSig.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "ver";
        keyValue.value = this.headerVer.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "tok";
        keyValue.value = this.headerToken.toString();
        this.requestHeaders.push(keyValue);

        keyValue = new KeyValue();
        keyValue.key = "gameToken";
        keyValue.value = this.gameToken.toString();
        this.requestHeaders.push(keyValue);

        /*keyValue = new KeyValue();
        keyValue.key = "gid";
        keyValue.value = this.headerGid.toString();
        this.requestHeaders.push(keyValue);*/
    },

    request: function request(callFunc, self) {
        if (this.headerCmd != 105) {
            console.log("request-----------data = " + this.requestData + ";cmd:" + this.headerCmd);
        }

        this.callfuncs.set(DataOper.s_index, callFunc);
        this.callnode.set(DataOper.s_index, self);
        this.callcmd.set(DataOper.s_index, this.headerCmd);
        //aes加密
        this.requestData = this.AESEncryption(this.requestData, this.aesKey);
        //Base64
        //this.requestData = Base64.encode(this.requestData);
        //gzip
        //this.requestData = this.requestData;
        //md5
        this.headerSig = CryptoJS.MD5(this.requestData);
        //请求头
        this.setRequestHeader();
        //send
        var netWork = new NetWork();
        netWork.send(DataOper.s_index, this.requestHeaders, this.requestData, this.onHttpRequestCompleted);
        DataOper.s_index++;
    },

    /**
     * 联网回调
     * @Param requestId 请求id
     * @param status   联网状态
     * @param responeData 响应data
     */
    onHttpRequestCompleted: function onHttpRequestCompleted(requestId, xhr) {
        console.log("onHttpRequestCompleted.xhr.status=" + xhr.status);
        var callFunc = DataOper.getInst().callfuncs.get(requestId);
        var callNode = DataOper.getInst().callnode.get(requestId);
        var callCmd = DataOper.getInst().callcmd.get(requestId);
        cc.log("callCmd=" + callCmd + "/ln=" + DataOper.getInst().callcmd.maps.length + "'" + DataOper.getInst().callfuncs.maps.length + "'" + DataOper.getInst().callnode.maps.length);
        DataOper.getInst().callfuncs.clear(requestId);
        DataOper.getInst().callnode.clear(requestId);
        DataOper.getInst().callcmd.clear(requestId);

        if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {
            //取http头
            //命令号
            var cmd = xhr.getResponseHeader("cmd");
            cmd = parseInt(cmd);
            //res
            var res = xhr.getResponseHeader("res");
            //msg
            var msg = xhr.getResponseHeader("msg");
            msg = decodeURIComponent(msg);
            //sig
            var sig = xhr.getResponseHeader("sig");
            cc.log("xhr.status=" + xhr.status + "|re=" + res);

            if (res == 0) {
                //取body
                var body = xhr.responseText;
                //md5验证
                var t_sig = CryptoJS.MD5(body);
                var t_sig_str = new String(t_sig);
                var sig_str = new String(sig);
                t_sig_str = t_sig_str.trim();
                sig_str = sig_str.trim();

                if (t_sig_str == sig_str) {
                    console.log("valify right");
                    DataOper.getInst().parserServerData(body, cmd);
                    callFunc(cmd, res, msg, callNode);

                    //更新账户余额
                    //初始化调过了，不调了。
                    if (!CC_JSB) {
                        if (window.aliLotteryCasinoSDK) {
                            switch (cmd) {
                                case 101: //bet
                                case 102: //clear
                                case 103:
                                    //reward
                                    {
                                        window.aliLotteryCasinoSDK.updateUserInfo();
                                    }
                                    break;
                                default:
                                    break;
                            }
                        }
                    }
                } else {
                    callFunc(cmd, -1, "加密验证错误", callNode);
                }
            } else {
                console.log("报错---res:" + res + "----msg:" + msg);

                //纯业务logic
                if (cmd == 100 && res == 999999) {
                    NetData.NetData.getInst().initFlag = 2;
                    NetData.NetData.getInst().stopSellingDesc = msg;
                }
                //end 业务
                callFunc(cmd, res, msg, callNode);
            }
        } else {
            //联网失败
            console.log("http status:" + xhr.status + "|callCmd=" + callCmd);
            callFunc(callCmd, -1, "网络可能不好哦，请重试", callNode);
        }
    },

    /**
     *解析服务器返回数据
     * @param data
     * @param cmd
     */
    parserServerData: function parserServerData(data, cmd) {
        //gzip解压
        //data = data;
        //Base64
        //data = Base64.decode(data);
        //aes解密
        data = this.AESDecrypt(data, this.aesKey);
        var iNum1 = parseInt(cmd);

        if (iNum1 != 105) {
            console.log("data = " + data + ", cmd = " + cmd);
        }

        switch (iNum1) {
            case 100:
                {
                    this.parserInit(data);
                }
                break;
            case 101:
                {
                    this.parserBet(data);
                }
                break;
            case 102:
                {
                    this.parseClear(data);
                }
                break;
            case 103:
                {
                    this.parserReward(data);
                }
                break;
            case 104:
                {
                    this.parseSecondData(data);
                }
                break;
            case 105:
                {
                    this.parseTable(data);
                }
                break;
            case 106:
                {
                    this.parseOrderList(data);
                }
                break;
            case 107:
                {
                    this.parserHistory(data);
                }
                break;
            default:
                break;
        }
    },

    //AES加密
    AESEncryption: function AESEncryption(data, aesKey) {
        var key = CryptoJS.enc.Utf8.parse(aesKey);
        var iv = CryptoJS.enc.Utf8.parse(aesKey);
        var srcs = CryptoJS.enc.Utf8.parse(data);
        var encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: CryptoJS.mode.ECB });
        return encrypted.toString();
    },

    //AES解密
    AESDecrypt: function AESDecrypt(data, aesKey) {
        var key = CryptoJS.enc.Utf8.parse(aesKey);
        var iv = CryptoJS.enc.Utf8.parse(aesKey);
        var decrypt = CryptoJS.AES.decrypt(data, key, { iv: iv, mode: CryptoJS.mode.ECB });
        return CryptoJS.enc.Utf8.stringify(decrypt).toString();
    },

    /**
     * 解析初始化
     * @param data
     */
    parserInit: function parserInit(data) {
        var netData = NetData.NetData.getInst();
        netData.initData = JSON.parse(data);
        cc.log("netData.initData.oddsList ", netData.initData.oddsList);
        netData.session = netData.initData.session;
        netData.periodId = netData.initData.periodId;
        netData.ticketNo = netData.initData.ticketNo;
        netData.betLimit = netData.initData.betLimit;
        netData.totalBetLimit = netData.initData.totalBetLimit;

        var periodEndTime = null;
        if (netData.initData.status == 1) {
            netData.timeFlag = 1;
            periodEndTime = netData.initData.periodEndTime1;
        } else if (netData.initData.status == 3) {
            netData.timeFlag = 2;
            periodEndTime = netData.initData.periodEndTime2;
        }

        if (periodEndTime != null) {
            netData.lotteryId = netData.initData.lotteryId;
            netData.lotteryIndex = netData.initData.lotteryIndex;

            var te = new Date();
            var localTime = te.getTime();
            var severTime = netData.initData.serverTime;
            netData.receiveTime = localTime - severTime;
            netData.secs = Math.floor((periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        //
        netData.initFlag = 1;
    },

    /**
     * 解析投注
     */
    parserBet: function parserBet(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.betLimit = objRoot.betLimit;
        netData.totalBetLimit = objRoot.totalBetLimit;
        netData.ticketNo = objRoot.ticketNo;

        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;

        if (tmp < netData.receiveTime) {
            netData.receiveTime = tmp;
            netData.secs = Math.floor((netData.betData.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
    },

    parseClear: function parseClear(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.ticketNo = "";
        netData.betLimit = netData.initData.betLimit;
        netData.totalBetLimit = netData.initData.totalBetLimit;
        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;

        if (tmp < netData.receiveTime) {
            netData.receiveTime = tmp;
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
    },

    /**
     * 结算
     */
    parserReward: function parserReward(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.rewardData = objRoot;
        // netData.rewardData = JSON.parse(data);      

        netData.periodId = netData.rewardData.nextPeriodId;
        netData.timeFlag = netData.rewardData.nextTimeFlag;

        if (objRoot.periodEndTime != undefined) {
            var te = new Date();
            var localTime = te.getTime();
            var severTime = objRoot.serverTime;
            netData.receiveTime = localTime - severTime;
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
    },

    parseTable: function parseTable(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        var te = new Date();
        var localTime = te.getTime();
        var severTime = objRoot.serverTime;
        var tmp = localTime - severTime;

        if (tmp < netData.receiveTime) {
            netData.receiveTime = tmp;
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }

        //解析list
        netData.tableArray = [];
        netData.tableArray = objRoot.list;
    },

    parseSecondData: function parseSecondData(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.secondData = objRoot;
        netData.timeFlag = 2;
        /*
        var te = new Date();
        let localTime = te.getTime();
        let severTime = objRoot.serverTime;
        let tmp = localTime - severTime;
         if(tmp < netData.receiveTime){
            netData.receiveTime = tmp; 
            netData.secs = Math.floor((objRoot.periodEndTime - severTime) / 1000 - netData.betThreshold - 3);
            cc.log("receiveTime=" + netData.receiveTime + "|" + netData.secs);
        }
        */
    },

    parseOrderList: function parseOrderList(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.orderList = [];
        netData.orderList = objRoot.data;
    },

    parserHistory: function parserHistory(data) {
        var netData = NetData.NetData.getInst();
        var objRoot = JSON.parse(data);
        netData.historyList = [];
        netData.historyList = objRoot.historyList;
    },

    /**
     * 初始化
     * @param
     * 
     */
    getInit: function getInit(session, callFunc, self) {
        if (session == null) {
            this.requestData = "{}";
        } else {
            var obj = new Object();
            obj.session = session;
            this.requestData = JSON.stringify(obj);
        }

        //提前初始化
        NetData.NetData.getInst().initFlag = 0;
        //设置命令号，每个请求都不一样
        this.headerCmd = 100;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 投注
     * @param ticket_no 订单号，首次投注为空
     * @param step 步数
     * @Parma trans_data 数据交互
     */
    getBet: function getBet(callFunc, self) {
        var netData = NetData.NetData.getInst();
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        var te = new Date();
        obj.tid = te.getTime().toString();
        te = null;
        obj.betList = netData.reqBetList;
        obj.periodId = netData.periodId;
        obj.timeFlag = netData.timeFlag;
        obj.session = netData.session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 101;
        //请求网络
        this.request(callFunc, self);
    },

    getClear: function getClear(callFunc, self) {
        var netData = NetData.NetData.getInst();
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = netData.periodId;
        obj.session = netData.session;
        obj.timeFlag = netData.timeFlag;
        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 102;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 结算
     * @param ticket_no 订单号
     */
    getReward: function getReward(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        obj.ticketNo = NetData.NetData.getInst().ticketNo;

        // obj.uids = new Array();
        obj.uids = [12, 123];
        // for(let i = 0; i < NetData.NetData.getInst().tableArray.length(); ++i){
        //     obj.uids.push(NetData.NetData.getInst().tableArray[i].uid);
        // }

        this.requestData = JSON.stringify(obj);
        obj = null;
        //设置命令号，每个请求都不一样
        this.headerCmd = 103;
        //请求网络
        this.request(callFunc, self);
    },

    getTable: function getTable(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.list = NetData.NetData.getInst().tableArray;
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        obj.timeFlag = NetData.NetData.getInst().timeFlag;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 105;
        //请求网络
        this.request(callFunc, self);
    },

    /**
     * 获取二阶段数据
     */
    getSecondData: function getSecondData(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.periodId = NetData.NetData.getInst().periodId;
        obj.session = NetData.NetData.getInst().session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 104;
        //请求网络
        this.request(callFunc, self);
    },

    getOrderList: function getOrderList(callFunc, self) {
        this.requestData = "";
        this.headerCmd = 106;
        //请求网络
        this.request(callFunc, self);
    },

    getHistory: function getHistory(callFunc, self) {
        this.requestData = "";
        //拼成json串，每个请求都不一样
        var obj = new Object();
        obj.session = NetData.NetData.getInst().session;
        this.requestData = JSON.stringify(obj);
        obj = null;
        this.headerCmd = 107;
        //请求网络
        this.request(callFunc, self);
    }
});

module.exports = {
    DataOper: DataOper
};

cc._RFpop();
},{"NetData":"NetData","aes":"aes","core":"core"}],"HelloWorld":[function(require,module,exports){
"use strict";
cc._RFpush(module, '280c3rsZJJKnZ9RqbALVwtK', 'HelloWorld');
// Script/HelloWorld.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        label: {
            default: null,
            type: cc.Label
        },
        // defaults, set visually when attaching this script to the Canvas
        text: 'Hello, World!'
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.label.string = this.text;
    },

    // called every frame
    update: function update(dt) {}
});

cc._RFpop();
},{}],"Help":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cdd59b7NnNFr59YCYK5OLHf', 'Help');
// Script/Help.js

"use strict";

var NetData = require("NetData");
var Game = require("game");

cc.Class({
    extends: cc.Component,

    properties: {
        //游戏帮助
        uiBlack: cc.Node,
        testNode: cc.Node,
        scrollView: cc.Node,
        content: cc.Node,
        view: cc.Node,
        lock: false,
        gameNode: cc.Node,
        imgArray: [cc.Sprite]
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.netData = NetData.NetData.getInst();
        this.lock = true;
        var oriP1 = this.testNode.convertToWorldSpaceAR(cc.v2(0, 0));
        this.oriY = this.testNode.y - oriP1.y;
        //console.log("oriY=" + this.node.y + "|" + oriP1.y);        

        var callFunc_1 = cc.callFunc(function () {
            this.lock = false;
            var se = cc.director.getWinSize();
            this.scrollView.height = se.height * 0.8;
            this.scrollView.getChildByName("view").height = this.scrollView.height;
            this.node.height = this.scrollView.height;
            this.node.y = this.oriY - this.scrollView.height;
            //console.log("ny=" + this.node.y);
        }, this);

        this.node.runAction(cc.sequence(cc.delayTime(0.1), callFunc_1));

        this.uiBlack.on(cc.Node.EventType.TOUCH_START, function (event) {
            event.stopPropagation();
            this.close();
        }, this);
    },

    close: function close() {
        if (!this.lock) {
            this.uiBlack.active = false;

            var call3 = cc.callFunc(function () {
                this.netData.helpShowFlag = false;
            }, this);

            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.v2(0, this.oriY - this.scrollView.height)), call3));
        }
    },

    downHelp: function downHelp() {
        var self = this;
        var spt = this.gameNode.getComponent(Game);
        spt.showWaitLayer();
        var rh = 0;

        cc.loader.load(this.netData.rulePics, null, function (errors, results) {
            if (errors) {
                for (var i = 0; i < errors.length; i++) {
                    console.log('Error url [' + errors[i] + ']: ' + results.getError(errors[i]));
                }
            }
            // cc.log("results is %% ", results.getContent.length);
            var len = self.netData.rulePics.length;

            for (var _i = 0; _i < len; _i++) {

                var aTex = results.getContent(self.netData.rulePics[_i]);
                console.log(self.netData.rulePics[_i] + "|" + aTex);
                var sf = new cc.SpriteFrame();
                sf.setTexture(aTex);
                self.imgArray[_i].spriteFrame = sf;
                rh += self.imgArray[_i].node.height;
                cc.log("height is $$$ ", self.imgArray[_i].node.height);
                //支持多张图排版（2017-03-27 pm：520）
                if (_i > 0) {

                    var index = _i - 1;
                    var ht = self.imgArray[index].node.height;
                    self.imgArray[_i].node.y = self.imgArray[index].node.y - ht + 1;
                    // cc.log("height is $$$ ", ht);
                }
            }

            // if(len == 2){
            //     let ht = self.imgArray[0].node.height;
            //     self.imgArray[1].node.y = -ht;
            // }

            self.content.height = rh;
            spt.hideWaitLayer();
            self.initHelp();
        });
    },

    initHelp: function initHelp() {
        if (!this.lock) {
            console.log("initHelp");
            this.netData.helpShowFlag = true;
            this.lock = true;
            this.scrollView.getComponent(cc.ScrollView).scrollToOffset(cc.p(0, 0), 0.1);
            var callback = cc.callFunc(this.selectShowCallBack, this);
            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.p(0, this.oriY)), callback));
        }
    },

    selectShowCallBack: function selectShowCallBack() {
        this.uiBlack.active = true;
        this.lock = false;
    }
});

cc._RFpop();
},{"NetData":"NetData","game":"game"}],"Init":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9e257NxGEhC4Z+E/o15ic/D', 'Init');
// Script/Init.js

"use strict";

var DataOper = require("DataOper");
var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    /*ctor: function() {
        
    },*/

    init: function init() {
        var self = this;
        if (!CC_JSB && window.aliLotteryCasinoSDK) {
            document.addEventListener('casino:init', function (e) {

                /************************20170509在1.4.2修改获取gameToken****************************/

                var dataOper = DataOper.DataOper.getInst();
                dataOper.gameToken = e.data.accessToken;

                if (dataOper.gameToken === null) {
                    dataOper.gameToken = "26a09ca052d4c7dcde13449ba1b735df-11-1151-1051";
                    var tok = dataOper.GetQueryString("tok");

                    if (tok) {
                        dataOper.headerToken = tok;
                        console.log("tok=" + dataOper.headerToken);
                    } else {
                        dataOper.headerToken = "0";
                    }
                    //testsssssss
                    /*var myDate = new Date();
                    this.headerToken = myDate.getTime();*/
                }

                console.log("this.gameToken = " + dataOper.gameToken);
                console.log("this.headerToken = " + dataOper.headerToken);

                /************************20170509在1.4.2修改获取gameToken ****************************/

                self.fetch(function (isError) {
                    console.log(isError);
                    if (!isError) {
                        // 合并资源
                        window.aliLotteryCasinoSDK.mergeResources();
                        // 显示 loading
                        window.aliLotteryCasinoSDK.initLoading();
                        // 运行游戏
                        window.aliLotteryCasinoSDK.runGame();
                    } else {
                        window.aliLotteryCasinoSDK.showError();
                    }
                });
            }, false);
        } else {
            self.fetch();
        }
    },

    fetch: function fetch(callback) {
        console.log("VersionN:201705251200");
        cc.log("fetch");
        this.initData = {};
        var self = this;
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getInit(null, function (cmd, res, msg, self) {
            // 判断是否成功并存储初始化
            var isError = false;

            //每日****游戏暂停运营（客户端处理）
            if (res == 100007) {
                isError = false;
            } else if (res != 0) {
                isError = true;
            } else {
                // if(NetData.NetData.getInst().status == 1){
                //     var te = new Date();
                //     self.timeStamp = te.getTime();
                //     cc.log("timeStamp is ", self.timeStamp);
                // } 

                var te = new Date();
                self.timeStamp = te.getTime();
                cc.log("timeStamp is ", self.timeStamp);
            }

            cc.log('fetch init data');
            cc.log(cmd, res, msg);
            self.initData.cmd = cmd;
            self.initData.res = res;
            self.initData.msg = msg;
            callback && callback(isError);
        }, this);
    }
});

cc._RFpop();
},{"DataOper":"DataOper","NetData":"NetData"}],"NetData":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2c0127/qANHkKFLguhv7AkS', 'NetData');
// Script/network/NetData.js

"use strict";

var NetData = cc.Class({
    statics: {
        g_Inst: null,
        s_index: 0,

        getInst: function getInst() {

            if (NetData.g_Inst === null) {
                NetData.g_Inst = new NetData();
                NetData.g_Inst.init();
            }
            return NetData.g_Inst;
        },

        destoryInst: function destoryInst() {

            if (NetData.g_Inst !== null) {
                NetData.g_Inst = null;
            }
        }
    },

    properties: {
        //请求参数
        reqBetList: [], //投注数据


        //响应
        timeFlag: 1, //投注阶段 1-第一阶段  2-第二阶段
        session: null,
        periodId: 1, //期次
        receiveTime: 0, //接收时间差
        secs: 0, //彩期剩余秒数
        betThreshold: 3,
        ticketNo: "", //订单号
        betLimit: 0, //投注限额
        totalBetLimit: 0, //总投注限额

        tableArray: [], //同桌人
        initData: null, //初始化data
        rewardData: null, //结算data
        secondData: null, //第二阶段数据data
        historyList: [], //历史走势
        orderList: [], //订单data

        //sdk        
        initFlag: 0 //提前初始化 0:没好  1:好了 2.停售
    },

    init: function init() {},

    clear: function clear() {}
});

module.exports = {
    NetData: NetData
};

cc._RFpop();
},{}],"Notouch":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b71281epI1FgLCfftSwge5e', 'Notouch');
// Script/Tools/Notouch.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {
            //不再派发事件
            event.stopPropagation();

            if (this.obj != undefined) {
                this.fun(this.obj);
                this.obj = undefined;
                this.fun = undefined;
            }
        }, this);
    },

    init: function init(obj, fun) {
        this.obj = obj;
        this.fun = fun;
    }

});

cc._RFpop();
},{}],"Power":[function(require,module,exports){
"use strict";
cc._RFpush(module, '21c82a03dJILKwxwhzMrsbH', 'Power');
// Script/Power.js

"use strict";

var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    properties: {

        pukeHighLightNodeArray: {
            default: [],
            type: [cc.Node]
        },

        betHighLightLayer: cc.Node,

        selfChipNode: {
            default: [],
            type: [cc.Node]
        },

        othersPositionNode: cc.Node,

        pokersNode: {
            default: [],
            type: [cc.Node]
        },

        noPokersNode: {
            default: [],
            type: [cc.Node]
        },

        historysListNode: {
            default: [],
            type: [cc.Node]
        },

        oddsLabel: cc.Node,

        pokerNameNode: cc.Node,

        pokerNoTouchLayer: cc.Node,

        options: "", //选项说明
        //势力
        powerFlag: true, //是否势力
        powerId: 0, //势力id
        pockers: [], //牌型
        historys: [], //胜负走势

        //投注项
        betFlag: true, //是否投注项
        betId: 0, //投注项id
        odds1: 1, //一阶段赔率
        odds2: 1, //二阶段赔率
        oddType: 0, //赔率变化类型  0-降低  1-上升  2-不变
        betStatus: 1, //是否可投注, 1-可投 0-不可投
        betNumTotal1: 0, //第一阶段总投注额
        betNumTotal2: 0, //第二阶段投注总额
        betNum: 0, //单次投注额，用于记录投注批次，失败的要退回来
        betList: [], //最后一次投注列表，用于投注，把所有投注项的这个数组收集起来就是真正的投注列表
        chipColor: 0, //筹码颜色  0-  1-  2-  3-
        ligthFlag: false, //投注项是否高亮

        //结算状态
        win: -1, //-1: 未开奖 1:胜利，0:负，2:平
        types: -1, //-1: 未开奖 0:散牌，1:散牌，2:对子，3：顺子，4:同花，5:同花顺，6:豹子
        pokerLight: [], //扑克高亮 空为全不亮， [0, 1, 2]全亮， [0, 2]亮两个

        //飞筹码
        chipPositions: [], //楼下5个筹码的相对位置
        playerPositions: [], //玩家头像相对位置，包括自己的（自己的筹码飞回）
        currentChipIndex: 0 },

    // use this for initialization
    onLoad: function onLoad() {
        this.node.on(cc.Node.EventType.TOUCH_START, function (event) {}, this);

        this.node.on(cc.Node.EventType.TOUCH_END, function (event) {
            cc.log("TOUCH_END!!!");
            if (this.betFlag && this.betStatus) {
                //投注操作，回调到game去判断登录状态、余额等
                var onFunction = cc.find('Canvas').getComponent('game');
                onFunction.powerBet(this.addselfChip, this);
            }
        }, this);
    },

    /**
     * 重置info，下一期开始时调用
     */
    resetInfo: function resetInfo() {
        this.pockers = [];
        this.oddType = 2;
        this.betStatus = 1;
        this.betNumTotal1 = 0;
        this.betNumTotal2 = 0;
        this.betNum = 0;
        this.betList = [];
        this.win = -1;
        this.types = -1;
        this.pokerLight = [];
        this.ligthFlag = false;
    },

    /**
     * 更新选项info
     * @param status 100-初始化   101-投注  102-清空投注  103-结算  104-获取二阶段数据
     */
    updataInfo: function updataInfo(status) {
        var netData = NetData.NetData.getInst();

        if (status == 100) {
            var initData = netData.initData;
            if (this.powerFlag) {
                if (initData.pockerList) {
                    for (var i = 0; i < initData.pockerList.length; ++i) {
                        if (this.powerId == initData.pockerList[i].powerId) {
                            cc.log("this.powerId ", this.powerId);
                            if (initData.pockerList[i].pockers) {
                                this.pockers = initData.pockerList[i].pockers;
                                cc.log("this.pockers", this.pockers);
                            }

                            this.historys = initData.pockerList[i].historys;
                            break;
                        }
                    }
                }
            }

            if (this.betFlag) {
                for (var _i = 0; _i < initData.oddsList.length; ++_i) {
                    if (this.betId == initData.oddsList[_i].id) {
                        cc.log("odds2 ", initData.oddsList[_i].odds2);
                        this.options = initData.oddsList[_i].option;
                        this.odds1 = initData.oddsList[_i].odds1;
                        this.odds2 = initData.oddsList[_i].odds2;
                        this.betStatus = initData.oddsList[_i].status;
                        break;
                    }
                }

                //投注额,用于恢复
                if (initData.bets) {
                    for (var _i2 = 0; _i2 < initData.bets.length; ++_i2) {
                        if (initData.bets[_i2].id == this.betId) {
                            if (initData.bets[_i2].timeFlag == 1) {
                                this.betNumTotal1 = initData.bets[_i2].totalBet;
                            } else {
                                this.betNumTotal2 = initData.bets[_i2].totalBet;
                            }
                        }
                    }
                }
            }
        } else if (status == 101) {} else if (status == 102) {
            if (netData.timeFlag == 1) {
                this.betNumTotal1 = 0;
            } else {
                this.betNumTotal2 = 0;
            }

            // betList = [];
        } else if (status == 103) {
            var rewardData = netData.rewardData;
            if (this.powerFlag) {
                var lottery = rewardData.lottery;
                var idstring = "power" + this.powerId;

                var pockers = lottery.cache.idstring.pockers;
                this.win = lottery.cache.idstring.win;
                this.types = lottery.cache.idstring.types;
                this.historys.pop();
                this.historys.unshift(this.win);
                this.pockers.push(pockers);

                // for(let i = 0; i < lottery.length; ++i){
                //     if(lottery[i].powerId == this.powerId){
                //         this.win = lottery[i].win;
                //         this.historys.pop();
                //         this.historys.unshift(this.win);

                //         this.types = lottery[i].types;
                //         this.pockers.push(lottery[i].pocker);
                //         cc.log("103 pockers length is ", this.pockers.length);
                //         //牌型高亮
                //         this.pokerLight = [];
                //         if(this.types === 0 || this.types == 1){
                //             //散牌，都不亮
                //         }
                //         else if(this.types == 2){
                //             //对子
                //             if(this.pockers[0].val == this.pockers[1].val){
                //                 this.pokerLight = [0, 1];
                //             }
                //             else if(this.pockers[0].val == this.pockers[2].val){
                //                 this.pokerLight = [0, 2];
                //             }
                //             else if(this.pockers[1].val == this.pockers[2].val){
                //                 this.pokerLight = [1, 2];
                //             }

                //             //对子投注项高亮
                //             if(this.betId == 5){
                //                 this.ligthFlag = true;
                //             }
                //         }
                //         else if(this.types == 6){
                //             this.pokerLight = [0, 1, 2];

                //             //三同号投注项高亮
                //             if(this.betId == 6){
                //                 this.ligthFlag = true;
                //             }
                //         }
                //         else{
                //             this.pokerLight = [0, 1, 2];
                //             //其他牌型投注项高亮
                //             if(this.betId == 7){
                //                 this.ligthFlag = true;
                //             }
                //         }
                //         break;
                //     }
                // }
            }

            if (this.betFlag) {
                // cc.log("odds2 ", rewardData.oddsList[0].odds2);

                for (var _i3 = 0; _i3 < rewardData.oddsList.length; ++_i3) {

                    if (this.betId == rewardData.oddsList[_i3].id) {
                        cc.log("odds2 ", rewardData.oddsList[_i3].odds2);
                        this.options = rewardData.oddsList[_i3].option;
                        this.odds1 = rewardData.oddsList[_i3].odds1;
                        this.odds2 = rewardData.oddsList[_i3].odds2;
                        this.betStatus = rewardData.oddsList[_i3].status;
                        break;
                    }
                }
            }
        } else if (status == 104) {
            var secondData = netData.secondData;
            if (this.powerFlag) {
                for (var _i4 = 0; _i4 < secondData.pockerList.length; ++_i4) {
                    if (this.powerId == secondData.pockerList[_i4].powerId) {
                        this.pockers = secondData.pockerList[_i4].pockers;
                        break;
                    }
                }
            }

            if (this.betFlag) {
                for (var _i5 = 0; _i5 < secondData.oddsList.length; ++_i5) {
                    if (this.betId == secondData.oddsList[_i5].id) {
                        this.options = secondData.oddsList[_i5].option;
                        //这里判断一下赔率是变大变小
                        this.odds1 = secondData.oddsList[_i5].odds1;
                        this.odds2 = secondData.oddsList[_i5].odds2;
                        if (this.odds2 > this.odds1) {
                            this.oddType = 1;
                        } else if (this.odds2 < this.odds1) {
                            this.oddType = 0;
                        } else {
                            this.oddType = 2;
                        }

                        this.betStatus = secondData.oddsList[_i5].status;
                        break;
                    }
                }
            }
        }
    },

    //更新UI
    updataUI: function updataUI(status) {
        if (this.powerFlag) {
            if (this.pockers.length == 0) {
                cc.log("pockers length is 0");
                for (var j = 0; j < this.noPokersNode.length; j++) {
                    this.noPokersNode[j].active = true;
                }
            } else {
                var netData = NetData.NetData.getInst();
                if (netData.initData.status == 3 || status == 104) {
                    for (var i = 0; i < this.pockers.length; i++) {

                        if (this.pockers.length <= this.pokersNode.length) {
                            this.noPokersNode[i + 1].active = false;
                            cc.log("pocker length is ", this.pockers.length);
                            cc.log("pokersNode length is ", this.pokersNode.length);
                            cc.log("current index is ", i);
                            var pokerNum = this.pokersNode[i + 1].getChildByName("num").getComponent(cc.Label);
                            var num = "";
                            if (this.pockers[i].val == 1) {
                                num = "A";
                            } else if (this.pockers[i].val == 11) {
                                num = "J";
                            } else if (this.pockers[i].val == 12) {
                                num = "Q";
                            } else if (this.pockers[i].val == 13) {
                                num = "K";
                            } else {
                                num = this.pockers[i].val;
                            }
                            cc.log("pocker num is ", num);
                            pokerNum.string = num;

                            var pokerType = this.pokersNode[i + 1].getChildByName("type").getComponent(cc.Label);
                            var color = "";
                            switch (this.pockers[i].color) {
                                case 1:
                                    {
                                        color = "心形";
                                    }
                                    break;
                                case 2:
                                    {
                                        color = "菱形";
                                    }
                                    break;
                                case 3:
                                    {
                                        color = "桃形";
                                    }
                                    break;
                                case 4:
                                    {
                                        color = "梅花形";
                                    }
                                    break;
                            }
                            pokerType.string = color;
                            cc.log("pocker color is ", color);
                        }
                    }
                } else if (status == 103 || netData.initData.status == 5) {
                    if (netData.initData.status) this.noPokersNode[0].active = true;

                    var pokerNum = this.pokersNode[0].getChildByName("num").getComponent(cc.Label);
                    var num = "";
                    if (this.pockers[2].val == 1) {
                        num = "A";
                    } else if (this.pockers[2].val == 11) {
                        num = "J";
                    } else if (this.pockers[2].val == 12) {
                        num = "Q";
                    } else if (this.pockers[2].val == 13) {
                        num = "K";
                    } else {
                        num = this.pockers[2].val;
                    }
                    pokerNum.string = num;
                    cc.log("pocker num is ", num);

                    var pokerType = this.pokersNode[0].getChildByName("type").getComponent(cc.Label);
                    var color = "";
                    switch (this.pockers[2].color) {
                        case 1:
                            {
                                color = "心形";
                            }
                            break;
                        case 2:
                            {
                                color = "菱形";
                            }
                            break;
                        case 3:
                            {
                                color = "桃形";
                            }
                            break;
                        case 4:
                            {
                                color = "梅花形";
                            }
                            break;
                    }
                    pokerType.string = color;
                    cc.log("pocker color is ", color);
                    //高亮高亮的
                    for (var i = 0; i < this.pokerLight.length; i++) {
                        var index = this.pokerLight[i];
                        this.pukeHighLightNodeArray[index].active = true;
                    }
                }
            }
        }
        if (this.betFlag) {
            var netData = NetData.NetData.getInst();
            if (netData.timeFlag == 1) {
                this.oddsLabel.getComponent(cc.Label).string = this.odds1 + "倍";
                this.oddsLabel.color = new cc.Color(255, 255, 255);
            } else {
                this.oddsLabel.getComponent(cc.Label).string = this.odds2 + "倍";
                if (this.oddType == 0) {
                    this.oddsLabel.color = new cc.Color(255, 0, 0);
                } else if (this.oddType == 1) {
                    this.oddsLabel.color = new cc.Color(45, 67, 100);
                } else {
                    this.oddsLabel.color = new cc.Color(255, 255, 255);
                }
            }
        }

        if (this.powerFlag && this.powerId != 1) {
            for (var i = 0; i < this.historysListNode.length; i++) {
                var historyIconNode = this.historysListNode[i];
                if (this.historys[i] == 1) //胜
                    {
                        historyIconNode.color = new cc.Color(255, 0, 0);
                    } else if (this.historys[i] == 0) //负
                    {
                        historyIconNode.Color = new cc.Color(45, 67, 100);
                    } else //平
                    {
                        historyIconNode.Color = new cc.Color(255, 255, 255);
                    }
            }
        }

        if (this.betFlag && !this.powerFlag) {

            if (this.betStatus == 1) {
                this.pokerNoTouchLayer.active = false;
            } else {
                this.pokerNoTouchLayer.active = true;
            }

            if (this.ligthFlag == true) //中奖结果高亮
                {
                    this.betHighLightLayer.active = true;
                } else {
                this.betHighLightLayer.active = false;
            }
        }
    },

    //飞结果，盖戳
    putStampOnAction: function putStampOnAction() {
        cc.log("flyStamp!!!");
        var netData = NetData.NetData.getInst();
        var rewardData = netData.rewardData;
        var convertNode = cc.find("Canvas/convertNode");
        var convertNodeJS = convertNode.getComponent("convertNode");
        convertNodeJS.flyRewardNode(rewardData.lottery.win, this.powerId);

        //10s收回
        this.scheduleOnce(this.getback, 1.3);
    },

    getback: function getback() {
        var gameJS = cc.find("Canvas").getComponent("game");
        gameJS.rewardFlyFinishedCallback();
    },

    /**
     * 自己投注飞筹码
     * @param chipIndex 楼下筹码的index
     */
    addselfChip: function addselfChip(chipIndex, self) {
        self.currentChipIndex = chipIndex;
        var netData = NetData.NetData.getInst();
        var bet = netData.initData.betList[chipIndex];

        //投注总额变化
        if (netData.timeFlag == 1) {
            self.betNumTotal1 += bet;
        } else {
            self.betNumTotal2 += bet;
        }

        //检查是否已经存在该类型筹码
        var exitFlag = false;
        for (var i = 0; i < self.betList.length; ++i) {
            if (self.betList[i].bet == bet) {
                self.betList[i].num++;
                exitFlag = true;
                break;
            }
        }

        if (!exitFlag) {
            var obj = new Object();
            obj.id = self.betId;
            obj.bet = bet;
            obj.num = 1;
            if (netData.timeFlag == 1) {
                obj.odds = self.odds1;
            } else {
                obj.odds = self.odds2;
            }

            self.betList.push(obj);
        }

        //跑动画，目标位置是个固定值，一阶段和二阶段分别固定一个筹码位置
        //跑完动画后，更新投注额的label
        if (self.betFlag) {
            var convertNode = cc.find("Canvas/convertNode");
            var convertNodeJS = convertNode.getComponent("convertNode");
            convertNodeJS.chipFlyAction(bet, chipIndex, self.betId - 1, true, self);
        }
    },

    flyChipNodeFinished: function flyChipNodeFinished(sender, flag) {
        var flag = flag;
        var self = sender;
        var netData = NetData.NetData.getInst();
        if (flag) {
            if (netData.timeFlag == 1) {
                self.selfChipNode[0].active = flag;
                self.selfChipNode[0].zIndex = 500;
                var label = self.selfChipNode[0].getChildByName("Label").getComponent(cc.Label);
                label.string = self.betNumTotal1;
            } else {
                self.selfChipNode[1].active = flag;
                self.selfChipNode[1].zIndex = 500;
                var label = self.selfChipNode[1].getChildByName("Label").getComponent(cc.Label);
                label.string = self.betNumTotal2;
            }
        }
    },

    /**
     * 自己筹码飞回
     * @param chipNum  飞回的筹码数额
     */
    reduceSelfChip: function reduceSelfChip() {
        var netData = NetData.NetData.getInst();
        if (netData.timeFlag == 1) {
            this.betNumTotal1 -= this.betNum;
        } else {
            this.betNumTotal2 -= this.betNum;
        }

        var ser = null;
        if (netData.timeFlag == 1) {
            ser = this.selfChipNode[0];
        } else {
            ser = this.selfChipNode[1];
        }
        if (ser.active) {
            //先隐藏
            ser.active = false;
            ser.zIndex = 500;
            var label = ser.getChildByName("Label").getComponent(cc.Label);
            label.string = this.betNumTotal2;

            //再找筹码飞
            var convertNode = cc.find("Canvas/convertNode");
            var convertNodeJS = convertNode.getComponent("convertNode");
            convertNodeJS.chipFlyAction(this.betNum, this.currentChipIndex, this.betId - 1, false, this);
        }
    },

    /**
     *  动作飞回来
     */
    flyBack: function flyBack() {
        this.clearSelfChip();
    },

    /**
     * 清空筹码
     */
    clearSelfChip: function clearSelfChip() {
        var netData = NetData.NetData.getInst();
        if (netData.timeFlag == 1) {
            this.betNum = this.betNumTotal1;
        } else {
            this.betNum = this.betNumTotal2;
        }
        this.reduceSelfChip();
    },

    /**
     * 其他玩家飞筹码
     * @param seatIndex 其他玩家座位号
     */
    addOtherChip: function addOtherChip(seatIndex) {}

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{"NetData":"NetData"}],"WaitScript":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f819ds8PopLZZ+dyHaJMjdF', 'WaitScript');
// Script/Tools/WaitScript.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {},

    // use this for initialization
    onLoad: function onLoad() {
        this.angle = 0;
    },

    // called every frame, uncomment this function to activate update callback
    update: function update(dt) {
        this.angle += dt * 360;

        if (this.angle > 360) {
            this.angle -= 360;
        }

        this.node.rotation = this.angle;
    }
});

cc._RFpop();
},{}],"aes":[function(require,module,exports){
"use strict";
cc._RFpush(module, '02d8bZs2vRKGJgbl2iiyPN7', 'aes');
// Script/network/aes/aes.js

"use strict";

var CryptoJS = require("./core");require("../aes/md5");require("../aes/enc-base64");require("../aes/evpkdf");require("../aes/cipher-core");require("../aes/mode-ecb");(function () {
  var C = CryptoJS;var C_lib = C.lib;var BlockCipher = C_lib.BlockCipher;var C_algo = C.algo;var SBOX = [];var INV_SBOX = [];var SUB_MIX_0 = [];var SUB_MIX_1 = [];var SUB_MIX_2 = [];var SUB_MIX_3 = [];var INV_SUB_MIX_0 = [];var INV_SUB_MIX_1 = [];var INV_SUB_MIX_2 = [];var INV_SUB_MIX_3 = [];(function () {
    var d = [];for (var i = 0; i < 256; i++) {
      if (i < 128) {
        d[i] = i << 1;
      } else {
        d[i] = i << 1 ^ 283;
      }
    }var x = 0;var xi = 0;for (var i = 0; i < 256; i++) {
      var sx = xi ^ xi << 1 ^ xi << 2 ^ xi << 3 ^ xi << 4;sx = sx >>> 8 ^ sx & 255 ^ 99;SBOX[x] = sx;INV_SBOX[sx] = x;var x2 = d[x];var x4 = d[x2];var x8 = d[x4];var t = d[sx] * 257 ^ sx * 16843008;SUB_MIX_0[x] = t << 24 | t >>> 8;SUB_MIX_1[x] = t << 16 | t >>> 16;SUB_MIX_2[x] = t << 8 | t >>> 24;SUB_MIX_3[x] = t;var t = x8 * 16843009 ^ x4 * 65537 ^ x2 * 257 ^ x * 16843008;INV_SUB_MIX_0[sx] = t << 24 | t >>> 8;INV_SUB_MIX_1[sx] = t << 16 | t >>> 16;INV_SUB_MIX_2[sx] = t << 8 | t >>> 24;INV_SUB_MIX_3[sx] = t;if (!x) {
        x = xi = 1;
      } else {
        x = x2 ^ d[d[d[x8 ^ x2]]];xi ^= d[d[xi]];
      }
    }
  })();var RCON = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54];var AES = C_algo.AES = BlockCipher.extend({ _doReset: function _doReset() {
      var key = this._key;var keyWords = key.words;var keySize = key.sigBytes / 4;var nRounds = this._nRounds = keySize + 6;var ksRows = (nRounds + 1) * 4;var keySchedule = this._keySchedule = [];for (var ksRow = 0; ksRow < ksRows; ksRow++) {
        if (ksRow < keySize) {
          keySchedule[ksRow] = keyWords[ksRow];
        } else {
          var t = keySchedule[ksRow - 1];if (!(ksRow % keySize)) {
            t = t << 8 | t >>> 24;t = SBOX[t >>> 24] << 24 | SBOX[t >>> 16 & 255] << 16 | SBOX[t >>> 8 & 255] << 8 | SBOX[t & 255];t ^= RCON[ksRow / keySize | 0] << 24;
          } else {
            if (keySize > 6 && ksRow % keySize == 4) {
              t = SBOX[t >>> 24] << 24 | SBOX[t >>> 16 & 255] << 16 | SBOX[t >>> 8 & 255] << 8 | SBOX[t & 255];
            }
          }keySchedule[ksRow] = keySchedule[ksRow - keySize] ^ t;
        }
      }var invKeySchedule = this._invKeySchedule = [];for (var invKsRow = 0; invKsRow < ksRows; invKsRow++) {
        var ksRow = ksRows - invKsRow;if (invKsRow % 4) {
          var t = keySchedule[ksRow];
        } else {
          var t = keySchedule[ksRow - 4];
        }if (invKsRow < 4 || ksRow <= 4) {
          invKeySchedule[invKsRow] = t;
        } else {
          invKeySchedule[invKsRow] = INV_SUB_MIX_0[SBOX[t >>> 24]] ^ INV_SUB_MIX_1[SBOX[t >>> 16 & 255]] ^ INV_SUB_MIX_2[SBOX[t >>> 8 & 255]] ^ INV_SUB_MIX_3[SBOX[t & 255]];
        }
      }
    }, encryptBlock: function encryptBlock(M, offset) {
      this._doCryptBlock(M, offset, this._keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX);
    }, decryptBlock: function decryptBlock(M, offset) {
      var t = M[offset + 1];M[offset + 1] = M[offset + 3];M[offset + 3] = t;this._doCryptBlock(M, offset, this._invKeySchedule, INV_SUB_MIX_0, INV_SUB_MIX_1, INV_SUB_MIX_2, INV_SUB_MIX_3, INV_SBOX);var t = M[offset + 1];M[offset + 1] = M[offset + 3];M[offset + 3] = t;
    }, _doCryptBlock: function _doCryptBlock(M, offset, keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX) {
      var nRounds = this._nRounds;var s0 = M[offset] ^ keySchedule[0];var s1 = M[offset + 1] ^ keySchedule[1];var s2 = M[offset + 2] ^ keySchedule[2];var s3 = M[offset + 3] ^ keySchedule[3];var ksRow = 4;for (var round = 1; round < nRounds; round++) {
        var t0 = SUB_MIX_0[s0 >>> 24] ^ SUB_MIX_1[s1 >>> 16 & 255] ^ SUB_MIX_2[s2 >>> 8 & 255] ^ SUB_MIX_3[s3 & 255] ^ keySchedule[ksRow++];var t1 = SUB_MIX_0[s1 >>> 24] ^ SUB_MIX_1[s2 >>> 16 & 255] ^ SUB_MIX_2[s3 >>> 8 & 255] ^ SUB_MIX_3[s0 & 255] ^ keySchedule[ksRow++];var t2 = SUB_MIX_0[s2 >>> 24] ^ SUB_MIX_1[s3 >>> 16 & 255] ^ SUB_MIX_2[s0 >>> 8 & 255] ^ SUB_MIX_3[s1 & 255] ^ keySchedule[ksRow++];var t3 = SUB_MIX_0[s3 >>> 24] ^ SUB_MIX_1[s0 >>> 16 & 255] ^ SUB_MIX_2[s1 >>> 8 & 255] ^ SUB_MIX_3[s2 & 255] ^ keySchedule[ksRow++];s0 = t0;s1 = t1;s2 = t2;s3 = t3;
      }var t0 = (SBOX[s0 >>> 24] << 24 | SBOX[s1 >>> 16 & 255] << 16 | SBOX[s2 >>> 8 & 255] << 8 | SBOX[s3 & 255]) ^ keySchedule[ksRow++];var t1 = (SBOX[s1 >>> 24] << 24 | SBOX[s2 >>> 16 & 255] << 16 | SBOX[s3 >>> 8 & 255] << 8 | SBOX[s0 & 255]) ^ keySchedule[ksRow++];var t2 = (SBOX[s2 >>> 24] << 24 | SBOX[s3 >>> 16 & 255] << 16 | SBOX[s0 >>> 8 & 255] << 8 | SBOX[s1 & 255]) ^ keySchedule[ksRow++];var t3 = (SBOX[s3 >>> 24] << 24 | SBOX[s0 >>> 16 & 255] << 16 | SBOX[s1 >>> 8 & 255] << 8 | SBOX[s2 & 255]) ^ keySchedule[ksRow++];M[offset] = t0;M[offset + 1] = t1;M[offset + 2] = t2;M[offset + 3] = t3;
    }, keySize: 256 / 32 });C.AES = BlockCipher._createHelper(AES);
})();

cc._RFpop();
},{"../aes/cipher-core":"cipher-core","../aes/enc-base64":"enc-base64","../aes/evpkdf":"evpkdf","../aes/md5":"md5","../aes/mode-ecb":"mode-ecb","./core":"core"}],"cipher-core":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7009oc2wJMlbzy3sUEYXQR', 'cipher-core');
// Script/network/aes/cipher-core.js

"use strict";

var CryptoJS = require("./core");CryptoJS.lib.Cipher || function (undefined) {
    var C = CryptoJS;var C_lib = C.lib;var Base = C_lib.Base;var WordArray = C_lib.WordArray;var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm;var C_enc = C.enc;var Utf8 = C_enc.Utf8;var Base64 = C_enc.Base64;var C_algo = C.algo;var EvpKDF = C_algo.EvpKDF;var Cipher = C_lib.Cipher = BufferedBlockAlgorithm.extend({ cfg: Base.extend(), createEncryptor: function createEncryptor(key, cfg) {
            return this.create(this._ENC_XFORM_MODE, key, cfg);
        }, createDecryptor: function createDecryptor(key, cfg) {
            return this.create(this._DEC_XFORM_MODE, key, cfg);
        }, init: function init(xformMode, key, cfg) {
            this.cfg = this.cfg.extend(cfg);this._xformMode = xformMode;this._key = key;this.reset();
        }, reset: function reset() {
            BufferedBlockAlgorithm.reset.call(this);this._doReset();
        }, process: function process(dataUpdate) {
            this._append(dataUpdate);return this._process();
        }, finalize: function finalize(dataUpdate) {
            if (dataUpdate) {
                this._append(dataUpdate);
            }var finalProcessedData = this._doFinalize();return finalProcessedData;
        }, keySize: 128 / 32, ivSize: 128 / 32, _ENC_XFORM_MODE: 1, _DEC_XFORM_MODE: 2, _createHelper: function () {
            function selectCipherStrategy(key) {
                if (typeof key == "string") {
                    return PasswordBasedCipher;
                } else {
                    return SerializableCipher;
                }
            }return function (cipher) {
                return { encrypt: function encrypt(message, key, cfg) {
                        return selectCipherStrategy(key).encrypt(cipher, message, key, cfg);
                    }, decrypt: function decrypt(ciphertext, key, cfg) {
                        return selectCipherStrategy(key).decrypt(cipher, ciphertext, key, cfg);
                    } };
            };
        }() });var StreamCipher = C_lib.StreamCipher = Cipher.extend({ _doFinalize: function _doFinalize() {
            var finalProcessedBlocks = this._process(!!"flush");return finalProcessedBlocks;
        }, blockSize: 1 });var C_mode = C.mode = {};var BlockCipherMode = C_lib.BlockCipherMode = Base.extend({ createEncryptor: function createEncryptor(cipher, iv) {
            return this.Encryptor.create(cipher, iv);
        }, createDecryptor: function createDecryptor(cipher, iv) {
            return this.Decryptor.create(cipher, iv);
        }, init: function init(cipher, iv) {
            this._cipher = cipher;this._iv = iv;
        } });var CBC = C_mode.CBC = function () {
        var CBC = BlockCipherMode.extend();CBC.Encryptor = CBC.extend({ processBlock: function processBlock(words, offset) {
                var cipher = this._cipher;var blockSize = cipher.blockSize;xorBlock.call(this, words, offset, blockSize);cipher.encryptBlock(words, offset);this._prevBlock = words.slice(offset, offset + blockSize);
            } });CBC.Decryptor = CBC.extend({ processBlock: function processBlock(words, offset) {
                var cipher = this._cipher;var blockSize = cipher.blockSize;var thisBlock = words.slice(offset, offset + blockSize);cipher.decryptBlock(words, offset);xorBlock.call(this, words, offset, blockSize);this._prevBlock = thisBlock;
            } });function xorBlock(words, offset, blockSize) {
            var iv = this._iv;if (iv) {
                var block = iv;this._iv = undefined;
            } else {
                var block = this._prevBlock;
            }for (var i = 0; i < blockSize; i++) {
                words[offset + i] ^= block[i];
            }
        }return CBC;
    }();var C_pad = C.pad = {};var Pkcs7 = C_pad.Pkcs7 = { pad: function pad(data, blockSize) {
            var blockSizeBytes = blockSize * 4;var nPaddingBytes = blockSizeBytes - data.sigBytes % blockSizeBytes;var paddingWord = nPaddingBytes << 24 | nPaddingBytes << 16 | nPaddingBytes << 8 | nPaddingBytes;var paddingWords = [];for (var i = 0; i < nPaddingBytes; i += 4) {
                paddingWords.push(paddingWord);
            }var padding = WordArray.create(paddingWords, nPaddingBytes);data.concat(padding);
        }, unpad: function unpad(data) {
            var nPaddingBytes = data.words[data.sigBytes - 1 >>> 2] & 255;data.sigBytes -= nPaddingBytes;
        } };var BlockCipher = C_lib.BlockCipher = Cipher.extend({ cfg: Cipher.cfg.extend({ mode: CBC, padding: Pkcs7 }), reset: function reset() {
            Cipher.reset.call(this);var cfg = this.cfg;var iv = cfg.iv;var mode = cfg.mode;if (this._xformMode == this._ENC_XFORM_MODE) {
                var modeCreator = mode.createEncryptor;
            } else {
                var modeCreator = mode.createDecryptor;this._minBufferSize = 1;
            }this._mode = modeCreator.call(mode, this, iv && iv.words);
        }, _doProcessBlock: function _doProcessBlock(words, offset) {
            this._mode.processBlock(words, offset);
        }, _doFinalize: function _doFinalize() {
            var padding = this.cfg.padding;if (this._xformMode == this._ENC_XFORM_MODE) {
                padding.pad(this._data, this.blockSize);var finalProcessedBlocks = this._process(!!"flush");
            } else {
                var finalProcessedBlocks = this._process(!!"flush");padding.unpad(finalProcessedBlocks);
            }return finalProcessedBlocks;
        }, blockSize: 128 / 32 });var CipherParams = C_lib.CipherParams = Base.extend({ init: function init(cipherParams) {
            this.mixIn(cipherParams);
        }, toString: function toString(formatter) {
            return (formatter || this.formatter).stringify(this);
        } });var C_format = C.format = {};var OpenSSLFormatter = C_format.OpenSSL = { stringify: function stringify(cipherParams) {
            var ciphertext = cipherParams.ciphertext;var salt = cipherParams.salt;if (salt) {
                var wordArray = WordArray.create([1398893684, 1701076831]).concat(salt).concat(ciphertext);
            } else {
                var wordArray = ciphertext;
            }return wordArray.toString(Base64);
        }, parse: function parse(openSSLStr) {
            var ciphertext = Base64.parse(openSSLStr);var ciphertextWords = ciphertext.words;if (ciphertextWords[0] == 1398893684 && ciphertextWords[1] == 1701076831) {
                var salt = WordArray.create(ciphertextWords.slice(2, 4));ciphertextWords.splice(0, 4);ciphertext.sigBytes -= 16;
            }return CipherParams.create({ ciphertext: ciphertext, salt: salt });
        } };var SerializableCipher = C_lib.SerializableCipher = Base.extend({ cfg: Base.extend({ format: OpenSSLFormatter }), encrypt: function encrypt(cipher, message, key, cfg) {
            cfg = this.cfg.extend(cfg);
            var encryptor = cipher.createEncryptor(key, cfg);var ciphertext = encryptor.finalize(message);var cipherCfg = encryptor.cfg;return CipherParams.create({ ciphertext: ciphertext, key: key, iv: cipherCfg.iv, algorithm: cipher, mode: cipherCfg.mode, padding: cipherCfg.padding, blockSize: cipher.blockSize, formatter: cfg.format });
        }, decrypt: function decrypt(cipher, ciphertext, key, cfg) {
            cfg = this.cfg.extend(cfg);ciphertext = this._parse(ciphertext, cfg.format);var plaintext = cipher.createDecryptor(key, cfg).finalize(ciphertext.ciphertext);return plaintext;
        }, _parse: function _parse(ciphertext, format) {
            if (typeof ciphertext == "string") {
                return format.parse(ciphertext, this);
            } else {
                return ciphertext;
            }
        } });var C_kdf = C.kdf = {};var OpenSSLKdf = C_kdf.OpenSSL = { execute: function execute(password, keySize, ivSize, salt) {
            if (!salt) {
                salt = WordArray.random(64 / 8);
            }var key = EvpKDF.create({ keySize: keySize + ivSize }).compute(password, salt);var iv = WordArray.create(key.words.slice(keySize), ivSize * 4);key.sigBytes = keySize * 4;return CipherParams.create({ key: key, iv: iv, salt: salt });
        } };var PasswordBasedCipher = C_lib.PasswordBasedCipher = SerializableCipher.extend({ cfg: SerializableCipher.cfg.extend({ kdf: OpenSSLKdf }), encrypt: function encrypt(cipher, message, password, cfg) {
            cfg = this.cfg.extend(cfg);var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize);cfg.iv = derivedParams.iv;var ciphertext = SerializableCipher.encrypt.call(this, cipher, message, derivedParams.key, cfg);ciphertext.mixIn(derivedParams);return ciphertext;
        }, decrypt: function decrypt(cipher, ciphertext, password, cfg) {
            cfg = this.cfg.extend(cfg);ciphertext = this._parse(ciphertext, cfg.format);var derivedParams = cfg.kdf.execute(password, cipher.keySize, cipher.ivSize, ciphertext.salt);cfg.iv = derivedParams.iv;var plaintext = SerializableCipher.decrypt.call(this, cipher, ciphertext, derivedParams.key, cfg);return plaintext;
        } });
}();

cc._RFpop();
},{"./core":"core"}],"convertNode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '52d79u8vuROVY3yrhoo8aXz', 'convertNode');
// Script/convertNode.js

"use strict";

var NetData = require("NetData");

cc.Class({
    extends: cc.Component,

    properties: {

        flyChipNode: cc.Prefab,

        homePosition: {
            default: [],
            type: [cc.Vec2]
        },

        targetLocation1: {
            default: [],
            type: [cc.Vec2]
        },

        targetLocation2: {
            default: [],
            type: [cc.Vec2]
        },

        flyChipNodeArray: {
            default: [],
            type: [cc.Node]
        },

        rewardFlyNodeArray: {
            default: [],
            type: [cc.Prefab]
        },

        rewardFlyNodeTargetLocation: {
            default: [],
            type: [cc.Vec2]
        },

        rewardFlyNodeHomePosition: cc.Vec2,
        rewardFlyNodeInistantArray: [],
        markFlyRewardCnt: 0
    },

    // use this for initialization
    onLoad: function onLoad() {},

    chipFlyAction: function chipFlyAction(chipNum, chipIndex, betId, flag, powerTarget) {
        var netData = NetData.NetData.getInst();
        var homep = this.homePosition[chipIndex];

        var targetP = null;
        if (netData.timeFlag == 1) {
            targetP = this.targetLocation1[betId];
        } else {
            targetP = this.targetLocation2[betId];
        }

        var flyNode = this.getFlyChipNode();
        var flyNodeJS = flyNode.getComponent("flyChipNodePre");

        flyNodeJS.setSkinWithTag(chipIndex);
        flyNodeJS.setMoney(chipNum);
        flyNodeJS.chipFlyAction(homep, targetP, flag, flyNode, powerTarget, this, this.finishedCallback);
    },

    getFlyChipNode: function getFlyChipNode() {
        var flyNode = null;
        if (this.flyChipNodeArray.length > 0) {
            flyNode = this.flyChipNodeArray.shift();
            flyNode.active = true;
            return flyNode;
        }

        flyNode = cc.instantiate(this.flyChipNode);
        this.node.addChild(flyNode);
        flyNode.active = true;
        return flyNode;
    },

    setFlyChipNode: function setFlyChipNode(flynode) {
        this.flyChipNodeArray.push(flynode);
        flynode.active = false;
    },

    finishedCallback: function finishedCallback(target, object) {
        var powerTarget = object.powerTarget;
        var flag = object.flag;
        var self = object.target;
        var flynode = object.flyNode;

        self.setFlyChipNode(flynode);
        powerTarget.flyChipNodeFinished(powerTarget, flag);

        object = null;
    },

    //index: 0负 1胜  2平
    flyRewardNode: function flyRewardNode(index, positionIndex) {
        var flyNode = null;
        if (this.rewardFlyNodeInistantArray.length) {
            flyNode = this.rewardFlyNodeInistantArray[i];
        } else {
            flyNode = cc.instantiate(this.rewardFlyNodeArray[i]);
            this.node.addChild(flyNode);
            this.rewardFlyNodeInistantArray.push(flyNode);
        }

        flyNode.active = true;
        var flyNodeJS = flyNode.getComponent("flyRewardNodePre");
        flyNodeJS.setSkinWithTag(index);
        var p1 = this.rewardFlyNodeHomePosition;
        var p2 = this.rewardFlyNodeTargetLocation[positionIndex];
        flyNodeJS.flyRewardAction(p1, p2, this.flyRewardActionFinished);
    },

    flyRewardActionFinished: function flyRewardActionFinished() {
        this.markFlyRewardCnt++;
        if (this.markFlyRewardCnt == 4) {
            for (var i = 0; i < this.rewardFlyNodeInistantArray.length; i++) {
                this.rewardFlyNodeInistantArray.active = false;
            }
        }
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{"NetData":"NetData"}],"core":[function(require,module,exports){
"use strict";
cc._RFpush(module, '572fe/2x+JCKIyUCoP5avyE', 'core');
// Script/network/aes/core.js

"use strict";

var CryptoJS = CryptoJS || function (Math, undefined) {
    var C = {};var C_lib = C.lib = {};var Base = C_lib.Base = function () {
        function F() {}return { extend: function extend(overrides) {
                F.prototype = this;var subtype = new F();if (overrides) {
                    subtype.mixIn(overrides);
                }if (!subtype.hasOwnProperty("init")) {
                    subtype.init = function () {
                        subtype.$super.init.apply(this, arguments);
                    };
                }subtype.init.prototype = subtype;subtype.$super = this;return subtype;
            }, create: function create() {
                var instance = this.extend();instance.init.apply(instance, arguments);return instance;
            }, init: function init() {}, mixIn: function mixIn(properties) {
                for (var propertyName in properties) {
                    if (properties.hasOwnProperty(propertyName)) {
                        this[propertyName] = properties[propertyName];
                    }
                }if (properties.hasOwnProperty("toString")) {
                    this.toString = properties.toString;
                }
            }, clone: function clone() {
                return this.init.prototype.extend(this);
            } };
    }();var WordArray = C_lib.WordArray = Base.extend({ init: function init(words, sigBytes) {
            words = this.words = words || [];if (sigBytes != undefined) {
                this.sigBytes = sigBytes;
            } else {
                this.sigBytes = words.length * 4;
            }
        }, toString: function toString(encoder) {
            return (encoder || Hex).stringify(this);
        }, concat: function concat(wordArray) {
            var thisWords = this.words;var thatWords = wordArray.words;var thisSigBytes = this.sigBytes;var thatSigBytes = wordArray.sigBytes;this.clamp();if (thisSigBytes % 4) {
                for (var i = 0; i < thatSigBytes; i++) {
                    var thatByte = thatWords[i >>> 2] >>> 24 - i % 4 * 8 & 255;thisWords[thisSigBytes + i >>> 2] |= thatByte << 24 - (thisSigBytes + i) % 4 * 8;
                }
            } else {
                for (var i = 0; i < thatSigBytes; i += 4) {
                    thisWords[thisSigBytes + i >>> 2] = thatWords[i >>> 2];
                }
            }this.sigBytes += thatSigBytes;return this;
        }, clamp: function clamp() {
            var words = this.words;var sigBytes = this.sigBytes;words[sigBytes >>> 2] &= 4294967295 << 32 - sigBytes % 4 * 8;words.length = Math.ceil(sigBytes / 4);
        }, clone: function clone() {
            var clone = Base.clone.call(this);clone.words = this.words.slice(0);return clone;
        }, random: function random(nBytes) {
            var words = [];var r = function r(m_w) {
                var m_w = m_w;var m_z = 987654321;var mask = 4294967295;return function () {
                    m_z = 36969 * (m_z & 65535) + (m_z >> 16) & mask;m_w = 18000 * (m_w & 65535) + (m_w >> 16) & mask;var result = (m_z << 16) + m_w & mask;result /= 4294967296;result += 0.5;return result * (Math.random() > 0.5 ? 1 : -1);
                };
            };for (var i = 0, rcache; i < nBytes; i += 4) {
                var _r = r((rcache || Math.random()) * 4294967296);rcache = _r() * 987654071;words.push(_r() * 4294967296 | 0);
            }return new WordArray.init(words, nBytes);
        } });var C_enc = C.enc = {};var Hex = C_enc.Hex = { stringify: function stringify(wordArray) {
            var words = wordArray.words;var sigBytes = wordArray.sigBytes;var hexChars = [];for (var i = 0; i < sigBytes; i++) {
                var bite = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;hexChars.push((bite >>> 4).toString(16));hexChars.push((bite & 15).toString(16));
            }return hexChars.join("");
        }, parse: function parse(hexStr) {
            var hexStrLength = hexStr.length;var words = [];for (var i = 0; i < hexStrLength; i += 2) {
                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << 24 - i % 8 * 4;
            }return new WordArray.init(words, hexStrLength / 2);
        } };var Latin1 = C_enc.Latin1 = { stringify: function stringify(wordArray) {
            var words = wordArray.words;var sigBytes = wordArray.sigBytes;var latin1Chars = [];for (var i = 0; i < sigBytes; i++) {
                var bite = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;latin1Chars.push(String.fromCharCode(bite));
            }return latin1Chars.join("");
        }, parse: function parse(latin1Str) {
            var latin1StrLength = latin1Str.length;var words = [];for (var i = 0; i < latin1StrLength; i++) {
                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 255) << 24 - i % 4 * 8;
            }return new WordArray.init(words, latin1StrLength);
        } };var Utf8 = C_enc.Utf8 = { stringify: function stringify(wordArray) {
            try {
                return decodeURIComponent(escape(Latin1.stringify(wordArray)));
            } catch (e) {
                throw new Error("Malformed UTF-8 data");
            }
        }, parse: function parse(utf8Str) {
            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));
        } };var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({ reset: function reset() {
            this._data = new WordArray.init();this._nDataBytes = 0;
        }, _append: function _append(data) {
            if (typeof data == "string") {
                data = Utf8.parse(data);
            }this._data.concat(data);this._nDataBytes += data.sigBytes;
        }, _process: function _process(doFlush) {
            var data = this._data;var dataWords = data.words;var dataSigBytes = data.sigBytes;var blockSize = this.blockSize;var blockSizeBytes = blockSize * 4;var nBlocksReady = dataSigBytes / blockSizeBytes;if (doFlush) {
                nBlocksReady = Math.ceil(nBlocksReady);
            } else {
                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);
            }var nWordsReady = nBlocksReady * blockSize;var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);if (nWordsReady) {
                for (var offset = 0; offset < nWordsReady; offset += blockSize) {
                    this._doProcessBlock(dataWords, offset);
                }var processedWords = dataWords.splice(0, nWordsReady);data.sigBytes -= nBytesReady;
            }return new WordArray.init(processedWords, nBytesReady);
        }, clone: function clone() {
            var clone = Base.clone.call(this);clone._data = this._data.clone();return clone;
        }, _minBufferSize: 0 });var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({ cfg: Base.extend(), init: function init(cfg) {
            this.cfg = this.cfg.extend(cfg);this.reset();
        }, reset: function reset() {
            BufferedBlockAlgorithm.reset.call(this);this._doReset();
        }, update: function update(messageUpdate) {
            this._append(messageUpdate);this._process();return this;
        }, finalize: function finalize(messageUpdate) {
            if (messageUpdate) {
                this._append(messageUpdate);
            }var hash = this._doFinalize();
            return hash;
        }, blockSize: 512 / 32, _createHelper: function _createHelper(hasher) {
            return function (message, cfg) {
                return new hasher.init(cfg).finalize(message);
            };
        }, _createHmacHelper: function _createHmacHelper(hasher) {
            return function (message, key) {
                return new C_algo.HMAC.init(hasher, key).finalize(message);
            };
        } });var C_algo = C.algo = {};return C;
}(Math);module.exports = CryptoJS;

cc._RFpop();
},{}],"enc-base64":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0f5e3DWxj5ADaF0mRNcqcyU', 'enc-base64');
// Script/network/aes/enc-base64.js

"use strict";

var CryptoJS = require("./core");(function () {
  var C = CryptoJS;var C_lib = C.lib;var WordArray = C_lib.WordArray;var C_enc = C.enc;var Base64 = C_enc.Base64 = { stringify: function stringify(wordArray) {
      var words = wordArray.words;var sigBytes = wordArray.sigBytes;var map = this._map;wordArray.clamp();var base64Chars = [];for (var i = 0; i < sigBytes; i += 3) {
        var byte1 = words[i >>> 2] >>> 24 - i % 4 * 8 & 255;var byte2 = words[i + 1 >>> 2] >>> 24 - (i + 1) % 4 * 8 & 255;var byte3 = words[i + 2 >>> 2] >>> 24 - (i + 2) % 4 * 8 & 255;var triplet = byte1 << 16 | byte2 << 8 | byte3;for (var j = 0; j < 4 && i + j * 0.75 < sigBytes; j++) {
          base64Chars.push(map.charAt(triplet >>> 6 * (3 - j) & 63));
        }
      }var paddingChar = map.charAt(64);if (paddingChar) {
        while (base64Chars.length % 4) {
          base64Chars.push(paddingChar);
        }
      }return base64Chars.join("");
    }, parse: function parse(base64Str) {
      var base64StrLength = base64Str.length;var map = this._map;var paddingChar = map.charAt(64);if (paddingChar) {
        var paddingIndex = base64Str.indexOf(paddingChar);if (paddingIndex != -1) {
          base64StrLength = paddingIndex;
        }
      }var words = [];var nBytes = 0;for (var i = 0; i < base64StrLength; i++) {
        if (i % 4) {
          var bits1 = map.indexOf(base64Str.charAt(i - 1)) << i % 4 * 2;var bits2 = map.indexOf(base64Str.charAt(i)) >>> 6 - i % 4 * 2;var bitsCombined = bits1 | bits2;words[nBytes >>> 2] |= bitsCombined << 24 - nBytes % 4 * 8;nBytes++;
        }
      }return WordArray.create(words, nBytes);
    }, _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=" };
})();

cc._RFpop();
},{"./core":"core"}],"errorDialog":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a5cchPFopKmrHUbPd5bRLY', 'errorDialog');
// Script/Tools/errorDialog.js

'use strict';

var EbuttonTag = cc.Enum({

    eSkinFresh: 0,
    eSkinOK: 1,
    eSkinCannel: 2,
    eSkin3: 3,
    eSkin4: 4,
    eSkin5: 5,
    eSkin6: 6

});
cc.Class({
    extends: cc.Component,

    properties: {
        leftButton: cc.Node,
        rightButton: cc.Node,
        title: cc.Label,
        leftSkinArray: {
            default: [],
            type: [cc.Node]
        },
        leftTitle: cc.Label,
        rightSkinArray: {
            default: [],
            type: [cc.Node]
        },
        rightTitle: cc.Label,
        typeAction: 0

    },

    // use this for initialization
    onLoad: function onLoad() {
        this.leftButton.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.leftButton.scale = 0.8;
        }, this);

        this.leftButton.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.leftButton.scale = 1;
            var gameFun = cc.find('Canvas').getComponent('game');
            gameFun.errorDialogCallback(this.typeAction, 1);
        }, this);

        this.leftButton.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            this.leftButton.scale = 1;
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.rightButton.scale = 0.8;
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.rightButton.scale = 1;
            var onFunction = cc.find('Canvas').getComponent('game');
            onFunction.errorDialogCallback(this.typeAction, 2);
        }, this);

        this.rightButton.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            this.rightButton.scale = 1;
        }, this);
    },

    showDialog: function showDialog(title, buttonType) {
        this.typeAction = buttonType;
        this.node.active = true;
        this.resetzIndexZreo();
        this.title.string = title;

        if (buttonType === 0) //刷新
            {
                this.leftButton.x = 0;
                this.leftButton.y = 0;
                this.rightButton.active = false;
                this.leftSkinArray[0].zIndex = 20;
                this.leftIndex = 0;
                this.rightIndex = -1;
            } else if (buttonType == 1) //等等再走 不玩了
            {
                this.leftButton.x = -160;
                this.leftButton.y = -100;
                this.rightButton.active = true;
                this.leftSkinArray[1].zIndex = 20;
                this.rightSkinArray[1].zIndex = 20;
            } else if (buttonType == 2) //
            {
                this.leftButton.x = -160;
                this.leftButton.y = -100;
                this.rightButton.active = true;
                this.leftSkinArray[2].zIndex = 20;
                this.rightSkinArray[2].zIndex = 20;
            }
    },

    hideDialog: function hideDialog() {
        this.node.active = false;
    },

    resetzIndexZreo: function resetzIndexZreo() {
        for (var i = 0; i < this.leftSkinArray.length; i++) {
            this.leftSkinArray[i].zIndex = 0;
        }

        for (var j = 0; j < this.rightSkinArray.length; j++) {
            this.rightSkinArray[j].zIndex = 0;
        }
    }

});

cc._RFpop();
},{}],"evpkdf":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'aa885BKH39D3pF0VusgBsiO', 'evpkdf');
// Script/network/aes/evpkdf.js

"use strict";

var CryptoJS = require("./core");(function () {
  var C = CryptoJS;var C_lib = C.lib;var Base = C_lib.Base;var WordArray = C_lib.WordArray;var C_algo = C.algo;var MD5 = C_algo.MD5;var EvpKDF = C_algo.EvpKDF = Base.extend({ cfg: Base.extend({ keySize: 128 / 32, hasher: MD5, iterations: 1 }), init: function init(cfg) {
      this.cfg = this.cfg.extend(cfg);
    }, compute: function compute(password, salt) {
      var cfg = this.cfg;var hasher = cfg.hasher.create();var derivedKey = WordArray.create();var derivedKeyWords = derivedKey.words;var keySize = cfg.keySize;var iterations = cfg.iterations;while (derivedKeyWords.length < keySize) {
        if (block) {
          hasher.update(block);
        }var block = hasher.update(password).finalize(salt);hasher.reset();for (var i = 1; i < iterations; i++) {
          block = hasher.finalize(block);hasher.reset();
        }derivedKey.concat(block);
      }derivedKey.sigBytes = keySize * 4;return derivedKey;
    } });C.EvpKDF = function (password, salt, cfg) {
    return EvpKDF.create(cfg).compute(password, salt);
  };
})();

cc._RFpop();
},{"./core":"core"}],"flyChipNodePre":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a48faS/teNMq5rWcxyKMFdi', 'flyChipNodePre');
// Script/flyChipNodePre.js

"use strict";

var ESkinTag = cc.Enum({

    eChip20: 0,
    eChip50: 1,
    eChip100: 2,
    eChip500: 3,
    eChip1000: 4,
    eGaryChip: 5,
    eOtherChip: 6

});

cc.Class({
    extends: cc.Component,

    properties: {
        //20 50 100 500 1000 gray other
        chipSkinNodeArray: {
            default: [],
            type: [cc.Node]
        },
        moneyLabel: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {},

    /**
     * 设置筹码皮肤
     * @param tag 对应的筹码编号(20 50 100 500 1000 gray other)
     */
    setSkinWithTag: function setSkinWithTag(tag) {

        for (var i = 0; i < this.chipSkinNodeArray.length; i++) {
            if (tag == i) {
                this.chipSkinNodeArray[i].activate = true;
            } else {
                this.chipSkinNodeArray[i].activate = false;
            }
        }
    },

    /**
     * 设置投注金额
     * @param chipMoney 对应的金额
     */
    setMoney: function setMoney(chipMoney) {
        if (chipMoney > 0) {
            this.moneyLabel.getComponent(cc.Label).string = chipMoney;
        } else {
            this.moneyLabel.getComponent(cc.Label).string = "";
        }
    },

    /**
     * 动画飞
     * @param position1 源位置
     * @param position2 目标位置
     * @param flag  飞回来还是飞回去
     * @param flyNode 飞过程的筹码对象
     * @param self 飞到的目标对象
     * @param callFun 回调的指针
     */
    chipFlyAction: function chipFlyAction(position1, position2, flag, flyNode, powerTarget, self, callFun) {
        var moveto = void 0;
        var dt = 0.2;
        this.node.stopAllActions();
        if (flag) {
            this.node.setPosition(position1);
            moveto = cc.moveTo(dt, position2);
        } else {
            this.node.setPosition(position2);
            moveto = cc.moveTo(dt, position1);
        }

        var ac1 = cc.scaleTo(dt, 1.0, 1.0);

        var obj = new Object();
        obj.powerTarget = powerTarget;
        obj.flyNode = flyNode;
        obj.target = self;
        obj.flag = flag;

        this.node.runAction(cc.sequence(moveto, cc.callFunc(callFun, self, obj)));
    }

});

module.exports = {
    ESkinTag: ESkinTag
};

cc._RFpop();
},{}],"flyRewardNodePre":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'edcb84oyLtPR4yixmZKo0vu', 'flyRewardNodePre');
// Script/flyRewardNodePre.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {

        rewardFlyNodeSkinArray: {
            default: [],
            type: [cc.Node]
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setSkin: function setSkin(index) {
        for (var i = 0; i < this.rewardFlyNodeSkinArray.length; i++) {
            if (index == i) {
                this.rewardFlyNodeSkinArray[i].active = true;
            } else {
                this.rewardFlyNodeSkinArray[i].active = false;
            }
        }
    },

    flyRewardAction: function flyRewardAction(position1, position2) {
        var moveto = void 0;
        var dt = 0.2;
        this.node.stopAllActions();
        this.node.setPosition(position1);
        moveto = cc.moveTo(dt, position2);
        var ac1 = cc.scaleTo(dt, 1.0, 1.0);

        var obj = new Object();
        obj.target = self;

        this.node.runAction(cc.sequence(moveto));
    }
});

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '96ad77uxvBOBKqKlCOn0FKD', 'game');
// Script/game.js

"use strict";

// const i18n = require('LanguageData');

var NetData = require("NetData");
var DataOper = require("DataOper");
var ButtonScale = require("ButtonScale");
var Init = require("Init");
var init = new Init();
init.init();

cc.Class({
    extends: cc.Component,

    properties: {
        rewardNode: cc.Node,

        blackLayer: {
            default: null,
            type: cc.Node
        },

        waitLayer: {
            default: null,
            type: cc.Node
        },

        cdtimeIcon: cc.Node,
        //倒计时看区域
        cdBgYellow: {
            default: null,
            type: cc.Node
        },
        cdBgRed: {
            default: null,
            type: cc.Node
        },
        cdLabel: {
            default: null,
            type: cc.Label
        },
        cdJieduanLabel: {
            default: null,
            type: cc.Label
        },

        //筹码区
        chipNodeArray: {
            default: [],
            type: [cc.Node]
        },

        //清除
        clearOnNode: {
            default: null,
            type: cc.Node
        },
        clearOffNode: {
            default: null,
            type: cc.Node
        },

        //toast
        toastNode: {
            default: null,
            type: cc.Node
        },

        chooseAreaNodeArray: {
            default: [],
            type: [cc.Node]
        },

        chipAreaNoTouchNode: {
            default: null,
            type: cc.Node
        },

        betAreaNoTouchNode: {
            default: null,
            type: cc.Node
        },

        stageStopDialog: cc.Node, //第一回合结束提示框label
        sumLimit: 0, //判断投注和值； 是否超过limit;
        needClearFlag: false, //需要清理;要在投注成功后调;
        chipIndex: 0, //筹码node 的 index
        clearingFlag: false, //清理中

        canBetFlag: true, //当前是否可以投注
        cunCmd: 100, //默认100

        errorDialog: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {

        // i18n.init('en');
        // this.cdLabel.string = i18n.t('label.hello');

        this.netData = NetData.NetData.getInst();

        if (this.netData.initFlag == 1) {
            cc.log("正常初始化进入UI");
            //直接初始化
            this.frontInit();
            this.gameStart();
        } else if (this.netData.initFlag == 2) {
            // this.midNode.active = false;
            // this.stopHint(this, this.netData.stopSellingDesc);
        } else {
            cc.log("fei正常初始化进入UI");
            this.schedule(this.initWait, 0.1);
        }

        // //测试
        // this.netData.timeFlag = 1;
        // this.netData.secs = 25;

        // var obj = new Object();
        // obj.status = 1;
        // obj.betList = [10, 20, 30, 40, 50];
        // var oddsListObj = new Object();
        // oddsListObj.option = "群雄";
        // oddsListObj.id = 1;
        // oddsListObj.powerId = 2;
        // oddsListObj.odds1 = 0.2;
        // oddsListObj.odds2 = 0.8;
        // oddsListObj.status = 1;
        // obj.oddsList = oddsListObj;
        // this.netData.initData = obj;
        // this.gameStart();
    },

    initWait: function initWait(dt) {
        if (this.netData.initFlag) {
            //直接初始化
            this.frontInit();
            this.gameStart();
            this.unschedule(this.initWait);
        }
    },

    frontInit: function frontInit() {
        // if(this.netData.initData.status == 1){
        var te = new Date();
        var localTime = te.getTime();
        var offset = Math.round((localTime - init.timeStamp) / 1000);
        this.netData.secs -= offset;
        console.log("offset= " + offset + "sec= " + this.netData.secs);

        if (this.netData.secs < 0) {
            this.netData.initData.status = 3;
        }
        // }
    },

    resumeTick: function resumeTick(dt) {
        this.resumFlag = true;
    },

    start: function start() {
        if (cc._renderType === cc.game.RENDER_TYPE_CANVAS) {
            cc.renderer.enableDirtyRegion(false);
        }
    },

    isCanBet: function isCanBet(callback) {
        var flag = false;

        if (!CC_JSB) {
            var self = this;
            var sdk = window.aliLotteryCasinoSDK;
            if (sdk) {

                sdk.isLogin(function (isLogin) {

                    if (!isLogin) //没登录去登录
                        {
                            self.goLogin();
                        } else //登录了 判断是否获取豆成功
                        {

                            sdk.setCache('chip', self.netData.betList[self.chipIndex]);

                            //在判断是否足额（淘宝相关）
                            var price = self.netdata.betList[self.chipIndex];

                            flag = self.judgeBalance(price);
                            if (flag) {
                                callback();
                            }
                        }
                });
            } else {
                callback();
            }
        } else {
            callback();
        }
    },

    goLogin: function goLogin() {
        if (!CC_JSB) {
            var self = this;
            var sdk = window.aliLotteryCasinoSDK;

            if (sdk) {
                sdk.login(function () {
                    //需要调初始化;
                    // login 后执行
                    sdk.updateUserInfo();
                    /*sdk.getUserInfo(function(info) {
                        if (info) {
                            self.netData.sdkBalance = info.fee;
                            var uid = info.uid;
                            var nick = info.nick;
                            self.showUserIcon(uid, nick);
                        }
                    });*/
                    self.fresh();
                });
            } else {
                this.fresh();
            }
        } else {
            this.fresh();
        }
    },

    exitJudge: function exitJudge() {
        var fg = false;
        var unfinish = false;

        if (!this.canBetFlag || unfinish) {
            this.errDialogTag = 3;

            if (this.clearingFlag) {
                this.showErrorLayer("正在帮你撤单，请稍等", true);
            } else {
                this.showErrorLayer("正在帮你下单，请稍等", true);
            }

            fg = true;
        }

        return fg;
    },

    fresh: function fresh() {
        this.setStageText();
    },

    exitGame: function exitGame() {
        if (!CC_JSB) {
            if (window.aliLotteryCasinoSDK) {
                window.aliLotteryCasinoSDK.popWindow();
            }
        } else {
            cc.director.loadScene('game');
        }
    },

    gameStart: function gameStart() {
        cc.log("gamestart");
        this.setStageText();
        this.getChipIndex();
        this.showChipNum();
        this.swiftSec();
        this.showPowerInfo();
    },

    reGo: function reGo() {},

    showPowerInfo: function showPowerInfo() {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            powerJS.updataInfo(this.cunCmd);
            powerJS.updataUI(this.cunCmd);
        }
    },

    flyStamp: function flyStamp() {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            if (powerJS.powerId > 1 && powerJS.powerId <= 5) {
                //延时的2s走盖戳
                this.scheduleOnce(powerJS.putStampOnAction(), 0.3);
            }
        }
    },

    setStageText: function setStageText() {
        this.cdJieduanLabel.node.active = true;
        this.cdtimeIcon.active = true;
        this.cdLabel.node.x = -54;

        var jieduan = this.cdJieduanLabel.getComponent(cc.Label);
        if (this.netData.timeFlag == 1) //盲选阶段
            {
                jieduan.string = "盲选";
            } else if (this.netData.timeFlag == 2) //明选阶段
            {
                jieduan.string = "明选";
            }
    },

    swiftSec: function swiftSec() {
        //1：暗牌正在投注，2：暗牌阶段已截止，3：明牌正在投注，4:明牌截至投注，5：正在开奖，7:停售
        cc.log("this.netData.initData.status ", this.netData.initData.status);
        cc.log("time is ", this.netData.secs);
        switch (this.netData.initData.status) {
            case 1:
            case 3:
                {

                    if (this.netData.secs >= 0) {
                        this.cdLabel.string = this.netData.secs + "″";
                    } else {
                        this.cdLabel.string = "0″";
                    }

                    var pt = this.cdBgRed.parent;
                    pt.stopAllActions();
                    pt.runAction(cc.show());

                    if (this.netData.secs <= 3) {

                        this.cdBgRed.active = true;
                        this.cdBgYellow.active = false;
                        var dt = 0.38; //3 / 8;
                        pt.runAction(cc.repeat(cc.sequence(cc.delayTime(dt), cc.hide(), cc.delayTime(dt), cc.show()), 4));
                    } else {
                        this.cdBgYellow.active = true;
                        this.cdBgRed.active = false;
                    }

                    this.schedule(this.showSec, 1);
                    this.grayLight(false);
                }
                break;
            case 2:
            case 4:
                {
                    this.doStopBet();
                }
                break;
            case 5:
                {
                    //正在开奖
                    this.getReward();
                }
                break;
            case 7:
                {
                    //停售

                }
                break;
            default:
                break;
        }
    },

    secCd: function secCd(dt) {
        this.netData.secs--;
    },

    showSec: function showSec(dt) {
        // cc.log("showSec：this.netData.secs ",this.netData.secs);

        this.netData.secs--;

        if (this.netData.secs >= 0) {
            this.cdLabel.string = this.netData.secs + "″";
        } else {
            this.cdLabel.string = "0″";
        }

        if (this.netData.secs <= 3) {
            var pt = this.cdBgRed.parent;
            cc.log("sec<3");
            this.cdBgRed.active = true;
            this.cdBgYellow.active = false;
            var _dt = 0.38; //3 / 8;
            pt.runAction(cc.repeat(cc.sequence(cc.delayTime(_dt), cc.hide(), cc.delayTime(_dt), cc.show()), 4));
        }

        if (this.netData.secs <= 0) {
            cc.log("sec== 0");
            this.doStopBet();
        }
    },

    doStopBet: function doStopBet() {
        cc.log("this.netData.timeFlag", this.netData.timeFlag);
        this.canBetFlag = false;
        // this.unschedule(this.turnTableLogic);
        this.cdBgRed.parent.stopAllActions();
        this.cdBgRed.parent.runAction(cc.show());
        this.cdBgYellow.active = true;
        this.cdBgRed.active = false;
        this.cdLabel.node.x = -54;
        // this.cdLabel.w = 220;
        this.cdLabel.string = "已截止";
        this.unschedule(this.showSec);
        //变灰;
        this.grayLight(true);
        this.netData.initData.status = 2;
        if (this.netData.timeFlag == 1) //提示框的弹出获取结果开奖就然后获取第二回合数据
            {
                this.stageStopDialog.active = true;

                var self = this;
                var callback = function callback(dt) {
                    this.getSecondData(); //获取第二阶段
                };
                this.scheduleOnce(callback, 10);
            } else //获取开奖结果
            {
                this.getReward();
            }
    },

    grayLight: function grayLight(flag) {
        this.clearOnNode.parent.active = !flag;
        this.clearOffNode.parent.active = flag;
        this.betAreaNoTouchNode.active = flag;
    },

    getReward: function getReward() {

        this.unschedule(this.showSec);
        this.cdBgRed.parent.stopAllActions();
        this.cdBgRed.parent.runAction(cc.show());
        this.cdBgYellow.active = true;
        this.cdBgRed.active = false;
        this.cdJieduanLabel.node.active = false;
        this.cdtimeIcon.active = false;
        this.cdLabel.node.x = -100;
        this.cdLabel.string = "正在开奖";
        this.scheduleOnce(this.doReward, 6); //提前的3秒 + 给服务器预留的2秒;
    },

    getSecondData: function getSecondData() //获取第二阶段的数据
    {
        this.showWaitLayer();
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getSecondData(this.netCallback, this);
    },

    doReward: function doReward(dt) {
        this.showWaitLayer();
        var dataOper = DataOper.DataOper.getInst();
        dataOper.getReward(this.netCallback, this);
    },

    showWaitLayer: function showWaitLayer() {
        this.blackLayer.active = true;
        this.waitLayer.active = true;
    },

    hideWaitLayer: function hideWaitLayer() {
        this.blackLayer.active = false;
        this.waitLayer.active = false;
    },

    judgeBalance: function judgeBalance(amount) {
        var fg = true;

        if (this.sdkBalance == -1) {
            // this.errDialogTag = 5;
            // this.blackLayer.active = true;
            // this.refreshNode.getChildByName("word").getComponent(cc.Label).string = "获取" + this.netData.currency + "失败，请刷新页面";
            // this.refreshNode.runAction(cc.scaleTo(0.2, 1.0, 1.0));
            fg = false;
        } else {

            if (amount > this.sdkBalance) {
                //提示余额不足，跳转到充值
                if (!CC_JSB) {
                    if (window.aliLotteryCasinoSDK) {
                        window.aliLotteryCasinoSDK.recharge(true);
                    }
                }

                fg = false;
                console.log("no balance");
            }
        }

        return fg;
    },

    getChipIndex: function getChipIndex() {
        var sdk = window.aliLotteryCasinoSDK;

        if (sdk) {
            var self = this;
            var len = this.netData.betList.length;

            window.aliLotteryCasinoSDK.getCache('chip', function (result) {
                if (result) {
                    for (var i = 0; i < len; i++) {
                        if (self.netData.betList[i] == result) {
                            self.chipIndex = i;
                            break;
                        }
                    }
                } else {
                    for (var _i = 0; _i < len; _i++) {
                        if (self.netData.betList[_i] == self.netData.preBet) {
                            self.chipIndex = _i;
                            break;
                        }
                    }
                }
            });
        }
    },

    /******************netCallback********************/
    netCallback: function netCallback(cmd, res, msg, self) {
        cc.log("netCallback cmd=" + cmd);
        self.cunCmd = cmd;
        var netData = NetData.NetData.getInst();
        self.hideWaitLayer();
        res = parseInt(res);
        console.log("res=" + res + "/mg=" + msg + "/cmd=" + self.cunCmd);
        switch (res) {
            case 0:
                {
                    switch (cmd) {
                        case 100:
                            //init
                            {
                                self.gameStart();
                            }
                            break;
                        case 101:
                            //bet
                            {
                                self.showPowerInfo();
                                //投注成功后清零
                                for (var i = 0; i < self.chooseAreaNodeArray.length; i++) {
                                    var chooseArea = self.chooseAreaNodeArray[i];
                                    var powerJS = chooseArea.getComponent("Power");
                                    if (powerJS.betFlag) {
                                        powerJS.betNum = 0;
                                    }
                                }
                            }
                            break;
                        case 102:
                            //clear
                            {
                                self.showPowerInfo();
                            }
                            break;
                        case 103:
                            //reward
                            {
                                self.chipAreaNoTouchNode.active = true;

                                self.showPowerInfo();
                                self.flyStamp();
                            }
                            break;
                        case 104:
                            //twostemp
                            {
                                self.stageStopDialog.active = false;
                                self.schedule(self.showSec, 1);
                                self.grayLight(false);
                                self.setStageText();
                                self.showPowerInfo();
                            }
                            break;
                        case 105:
                            //orderlist
                            {}
                            break;
                        case 106:
                            //historylist
                            {}
                            break;
                    }
                }
                break;
            case 200009:
                //余额不足;
                {}
                break;
            default:
                {
                    cc.log("res default!");
                    switch (cmd) {
                        case 101:
                            //投注失败回收筹码
                            {
                                self.showToast(msg);

                                self.canBetFlag = false;
                                for (var i = 0; i < self.chooseAreaNodeArray.length; i++) {
                                    var chooseArea = self.chooseAreaNodeArray[i];
                                    var powerJS = chooseArea.getComponent("Power");
                                    if (powerJS.betFlag) {
                                        powerJS.reduceSelfChip();
                                    }
                                }
                            }
                            break;
                        default:
                            {
                                self.stageStopDialog.active = false;
                                //通常的错误提示
                                var errorDialogJs = self.errorDialog.getComponent("errorDialog");
                                errorDialogJs.showDialog(msg, 0);
                            }
                            break;
                    }
                }
                break;
        }
    },
    /******************netCallback********************/
    //结算飞戳结束
    rewardFlyFinishedCallback: function rewardFlyFinishedCallback() {
        //提示再来一局103
        cc.log("该提示结算页面了");

        var netData = NetData.NetData.getInst();
        var status = netData.rewardData.status;
        this.rewardNode.active = true;
        var num = 0;
        if (status == 1) //sheng
            {
                num = netData.rewardData.amount;
            } else if (status == 2) //fu
            {
                num = netData.rewardData.allNum;
            } else if (status == 3) //ping
            {
                num = netData.rewardData.amount;
            }

        this.rewardNode.getComponent("rewardNode").setContent(status, num);
    },

    rewardNodeColse: function rewardNodeColse() {
        this.rewardNode.active = false;

        this.showPowerInfo();
        this.schedule(self.showSec, 1);
        this.grayLight(false);
        this.setStageText();
    },

    clearWithFlag: function clearWithFlag(flag) {
        this.clearOnNode.parent.active = flag;
        this.clearOffNode.parent.active = !flag;
    },

    //所有按钮的回调等等事件
    btnActionCallBack: function btnActionCallBack(btnTag) {
        switch (btnTag) {
            // case ButtonScale.EbuttonTag.eCleare:
            case 5:
                {
                    cc.log("clear clear!!!");

                    this.clearingFlag = true;

                    if (this.canBetFlag) {
                        this.canBetFlag = false;
                        this.clearWithFlag(false);

                        this.showWaitLayer();
                        var dataOper = DataOper.DataOper.getInst();
                        dataOper.getClear(this.netCallback, this);

                        this.flyBack();
                        this.sumLimit = 0;
                        this.netData.betLimit = this.netData.totalBetLimit;
                    } else {
                        this.needClearFlag = true;
                        this.flyBack();
                        this.sumLimit = 0;
                        this.netData.betLimit = this.netData.totalBetLimit;
                    }
                }
                break;
            case ButtonScale.EbuttonTag.eChip20:
            case ButtonScale.EbuttonTag.eChip50:
            case ButtonScale.EbuttonTag.eChip100:
            case ButtonScale.EbuttonTag.eChip500:
            case ButtonScale.EbuttonTag.eChip1000:
                {
                    cc.log("");
                    this.chipIndex = btnTag;
                    this.resetChip();
                    cc.log("chipIndex is = ", this.chipIndex);
                }
                break;

            default:
                break;
        }
    },

    errorDialogCallback: function errorDialogCallback(typeaction, positon) //1 左边按钮 2 右边按钮
    {
        var errorDialogJs = this.errorDialog.getComponent("errorDialog");
        errorDialogJs.hideDialog();

        if (positon == 1) {
            switch (typeaction) {
                case 0:
                    {
                        //只有一个按钮刷新刷新的
                        if (this.cunCmd == 100) {
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getInit(this.netCallback, this);
                        } else if (this.cunCmd == 101) {} else if (this.cunCmd == 102) {} else if (this.cunCmd == 103) {
                            this.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getReward(this.netCallback, this);
                        } else if (this.cunCmd == 104) {
                            this.showWaitLayer();
                            var dataOper = DataOper.DataOper.getInst();
                            dataOper.getSecondData(this.netCallback, this);
                        } else if (this.cunCmd == 105) {} else if (this.cunCmd == 106) {}
                    }
                    break;
                case 1:
                    {}
                    break;
                case 2:
                    {}
                    break;
            }
        } else {
            switch (typeaction) {
                case 0:
                    {}
                    break;
                case 1:
                    {}
                    break;
                case 2:
                    {}
                    break;
            }
        }
    },

    showChipNum: function showChipNum() {
        var netData = NetData.NetData.getInst();

        for (var i = 0; i < this.chipNodeArray.length; i++) {
            var le = this.chipNodeArray[i].getChildByName("Label").getComponent(cc.Label);
            this.adjustFontsize(le, netData.initData.betList[i]);
            le.string = netData.initData.betList[i];
        }

        for (var j = 0; j < netData.initData.betList.length; j++) {
            if (netData.initData.betList[j] == netData.initData.preBet) {
                this.chipIndex = j;
            }
        }
        this.resetChip();
    },

    adjustFontsize: function adjustFontsize(label, num) {
        var se = 71;

        if (num < 100) {} else if (num < 1000) {
            label.fontSize = se * 0.8;
        } else {
            label.fontSize = se * 0.56;
        }
    },

    resetChip: function resetChip() {
        for (var i = 0; i < this.chipNodeArray.length; i++) {
            if (this.chipIndex == i) {
                this.chipNodeArray[i].scale = 1;
            } else {
                this.chipNodeArray[i].scale = 0.8;
            }
        }
    },

    showToast: function showToast(msg) {
        this.toastNode.stopAllActions();
        this.toastNode.scale = 0;
        var le = this.toastNode.getChildByName("word").getComponent(cc.Label);
        le.string = msg;
        var len = le.node.width + 20;
        this.toastNode.width = len;
        var dt = 0.2;
        var ac1 = cc.scaleTo(dt, 1.0, 1.0);
        var ac2 = cc.scaleTo(dt, 0, 0);
        this.toastNode.runAction(cc.sequence(ac1, cc.delayTime(2), ac2));
    },

    flyBack: function flyBack() {
        for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
            var chooseArea = this.chooseAreaNodeArray[i];
            var powerJS = chooseArea.getComponent("Power");
            if (powerJS.betFlag) {
                powerJS.flyBack();
            }
        }
    },

    powerBet: function powerBet(callFunc, power) {
        //判断登录、余额TODO
        var self = this;
        var callback = function callback() {
            if (self.netData.initData.status == 1 || self.netData.initData.status == 3) {
                self.canBetFlag = true;
                self.clearWithFlag(true);
                callFunc(self.chipIndex, power);
                self.unschedule(self.dealBet);
                self.scheduleOnce(self.dealBet, 0.5);
            }
        };
        self.isCanBet(callback);
    },

    /**
     * 真实投注
     */
    dealBet: function dealBet(dt) {
        this.showWaitLayer();
        var netData = NetData.NetData.getInst();
        var dataOper = DataOper.DataOper.getInst();
        //首先检查当前是否有没有回来的投注请求
        if (this.canBetFlag) {
            this.canBetFlag = false;

            netData.reqBetList = [];

            for (var i = 0; i < this.chooseAreaNodeArray.length; i++) {
                var chooseArea = this.chooseAreaNodeArray[i];
                var powerJS = chooseArea.getComponent("Power");
                if (powerJS.betFlag) {
                    powerJS.betNum = 0;
                    for (var j = 0; j < powerJS.betList.length; ++j) {
                        netData.reqBetList.push(powerJS.betList[j]);
                        powerJS.betNum += powerJS.betList[j].bet * powerJS.betList[j].num;
                    }
                    powerJS.betList = [];
                }
            }

            dataOper.getBet(this.netCallback, this);
        } else {
            this.scheduleOnce(this.dealBet, 0.5);
        }
    }

});

cc._RFpop();
},{"ButtonScale":"ButtonScale","DataOper":"DataOper","Init":"Init","NetData":"NetData"}],"md5":[function(require,module,exports){
"use strict";
cc._RFpush(module, '2ceb3709r9Ml6wPLEEyiUfd', 'md5');
// Script/network/aes/md5.js

"use strict";

var CryptoJS = require("./core");(function (Math) {
  var C = CryptoJS;var C_lib = C.lib;var WordArray = C_lib.WordArray;var Hasher = C_lib.Hasher;var C_algo = C.algo;var T = [];(function () {
    for (var i = 0; i < 64; i++) {
      T[i] = Math.abs(Math.sin(i + 1)) * 4294967296 | 0;
    }
  })();var MD5 = C_algo.MD5 = Hasher.extend({ _doReset: function _doReset() {
      this._hash = new WordArray.init([1732584193, 4023233417, 2562383102, 271733878]);
    }, _doProcessBlock: function _doProcessBlock(M, offset) {
      for (var i = 0; i < 16; i++) {
        var offset_i = offset + i;var M_offset_i = M[offset_i];M[offset_i] = (M_offset_i << 8 | M_offset_i >>> 24) & 16711935 | (M_offset_i << 24 | M_offset_i >>> 8) & 4278255360;
      }var H = this._hash.words;var M_offset_0 = M[offset + 0];var M_offset_1 = M[offset + 1];var M_offset_2 = M[offset + 2];var M_offset_3 = M[offset + 3];var M_offset_4 = M[offset + 4];var M_offset_5 = M[offset + 5];var M_offset_6 = M[offset + 6];var M_offset_7 = M[offset + 7];var M_offset_8 = M[offset + 8];var M_offset_9 = M[offset + 9];var M_offset_10 = M[offset + 10];var M_offset_11 = M[offset + 11];var M_offset_12 = M[offset + 12];var M_offset_13 = M[offset + 13];var M_offset_14 = M[offset + 14];var M_offset_15 = M[offset + 15];var a = H[0];var b = H[1];var c = H[2];var d = H[3];a = FF(a, b, c, d, M_offset_0, 7, T[0]);d = FF(d, a, b, c, M_offset_1, 12, T[1]);c = FF(c, d, a, b, M_offset_2, 17, T[2]);b = FF(b, c, d, a, M_offset_3, 22, T[3]);a = FF(a, b, c, d, M_offset_4, 7, T[4]);d = FF(d, a, b, c, M_offset_5, 12, T[5]);c = FF(c, d, a, b, M_offset_6, 17, T[6]);b = FF(b, c, d, a, M_offset_7, 22, T[7]);a = FF(a, b, c, d, M_offset_8, 7, T[8]);d = FF(d, a, b, c, M_offset_9, 12, T[9]);c = FF(c, d, a, b, M_offset_10, 17, T[10]);b = FF(b, c, d, a, M_offset_11, 22, T[11]);a = FF(a, b, c, d, M_offset_12, 7, T[12]);d = FF(d, a, b, c, M_offset_13, 12, T[13]);c = FF(c, d, a, b, M_offset_14, 17, T[14]);b = FF(b, c, d, a, M_offset_15, 22, T[15]);a = GG(a, b, c, d, M_offset_1, 5, T[16]);d = GG(d, a, b, c, M_offset_6, 9, T[17]);c = GG(c, d, a, b, M_offset_11, 14, T[18]);b = GG(b, c, d, a, M_offset_0, 20, T[19]);a = GG(a, b, c, d, M_offset_5, 5, T[20]);d = GG(d, a, b, c, M_offset_10, 9, T[21]);c = GG(c, d, a, b, M_offset_15, 14, T[22]);b = GG(b, c, d, a, M_offset_4, 20, T[23]);a = GG(a, b, c, d, M_offset_9, 5, T[24]);d = GG(d, a, b, c, M_offset_14, 9, T[25]);c = GG(c, d, a, b, M_offset_3, 14, T[26]);b = GG(b, c, d, a, M_offset_8, 20, T[27]);a = GG(a, b, c, d, M_offset_13, 5, T[28]);d = GG(d, a, b, c, M_offset_2, 9, T[29]);c = GG(c, d, a, b, M_offset_7, 14, T[30]);b = GG(b, c, d, a, M_offset_12, 20, T[31]);a = HH(a, b, c, d, M_offset_5, 4, T[32]);d = HH(d, a, b, c, M_offset_8, 11, T[33]);c = HH(c, d, a, b, M_offset_11, 16, T[34]);b = HH(b, c, d, a, M_offset_14, 23, T[35]);a = HH(a, b, c, d, M_offset_1, 4, T[36]);d = HH(d, a, b, c, M_offset_4, 11, T[37]);c = HH(c, d, a, b, M_offset_7, 16, T[38]);b = HH(b, c, d, a, M_offset_10, 23, T[39]);a = HH(a, b, c, d, M_offset_13, 4, T[40]);d = HH(d, a, b, c, M_offset_0, 11, T[41]);c = HH(c, d, a, b, M_offset_3, 16, T[42]);b = HH(b, c, d, a, M_offset_6, 23, T[43]);a = HH(a, b, c, d, M_offset_9, 4, T[44]);d = HH(d, a, b, c, M_offset_12, 11, T[45]);c = HH(c, d, a, b, M_offset_15, 16, T[46]);b = HH(b, c, d, a, M_offset_2, 23, T[47]);a = II(a, b, c, d, M_offset_0, 6, T[48]);d = II(d, a, b, c, M_offset_7, 10, T[49]);c = II(c, d, a, b, M_offset_14, 15, T[50]);b = II(b, c, d, a, M_offset_5, 21, T[51]);a = II(a, b, c, d, M_offset_12, 6, T[52]);d = II(d, a, b, c, M_offset_3, 10, T[53]);c = II(c, d, a, b, M_offset_10, 15, T[54]);b = II(b, c, d, a, M_offset_1, 21, T[55]);a = II(a, b, c, d, M_offset_8, 6, T[56]);d = II(d, a, b, c, M_offset_15, 10, T[57]);c = II(c, d, a, b, M_offset_6, 15, T[58]);b = II(b, c, d, a, M_offset_13, 21, T[59]);a = II(a, b, c, d, M_offset_4, 6, T[60]);d = II(d, a, b, c, M_offset_11, 10, T[61]);c = II(c, d, a, b, M_offset_2, 15, T[62]);b = II(b, c, d, a, M_offset_9, 21, T[63]);H[0] = H[0] + a | 0;H[1] = H[1] + b | 0;H[2] = H[2] + c | 0;H[3] = H[3] + d | 0;
    }, _doFinalize: function _doFinalize() {
      var data = this._data;var dataWords = data.words;var nBitsTotal = this._nDataBytes * 8;var nBitsLeft = data.sigBytes * 8;dataWords[nBitsLeft >>> 5] |= 128 << 24 - nBitsLeft % 32;var nBitsTotalH = Math.floor(nBitsTotal / 4294967296);var nBitsTotalL = nBitsTotal;dataWords[(nBitsLeft + 64 >>> 9 << 4) + 15] = (nBitsTotalH << 8 | nBitsTotalH >>> 24) & 16711935 | (nBitsTotalH << 24 | nBitsTotalH >>> 8) & 4278255360;dataWords[(nBitsLeft + 64 >>> 9 << 4) + 14] = (nBitsTotalL << 8 | nBitsTotalL >>> 24) & 16711935 | (nBitsTotalL << 24 | nBitsTotalL >>> 8) & 4278255360;data.sigBytes = (dataWords.length + 1) * 4;this._process();var hash = this._hash;var H = hash.words;for (var i = 0; i < 4; i++) {
        var H_i = H[i];H[i] = (H_i << 8 | H_i >>> 24) & 16711935 | (H_i << 24 | H_i >>> 8) & 4278255360;
      }return hash;
    }, clone: function clone() {
      var clone = Hasher.clone.call(this);clone._hash = this._hash.clone();return clone;
    } });function FF(a, b, c, d, x, s, t) {
    var n = a + (b & c | ~b & d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function GG(a, b, c, d, x, s, t) {
    var n = a + (b & d | c & ~d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function HH(a, b, c, d, x, s, t) {
    var n = a + (b ^ c ^ d) + x + t;return (n << s | n >>> 32 - s) + b;
  }function II(a, b, c, d, x, s, t) {
    var n = a + (c ^ (b | ~d)) + x + t;return (n << s | n >>> 32 - s) + b;
  }C.MD5 = Hasher._createHelper(MD5);C.HmacMD5 = Hasher._createHmacHelper(MD5);
})(Math);

cc._RFpop();
},{"./core":"core"}],"mode-ecb":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e11dbyI/bFD/4JfK0/gf6re', 'mode-ecb');
// Script/network/aes/mode-ecb.js

"use strict";

var CryptoJS = require("./core");CryptoJS.mode.ECB = function () {
  var ECB = CryptoJS.lib.BlockCipherMode.extend();ECB.Encryptor = ECB.extend({ processBlock: function processBlock(words, offset) {
      this._cipher.encryptBlock(words, offset);
    } });ECB.Decryptor = ECB.extend({ processBlock: function processBlock(words, offset) {
      this._cipher.decryptBlock(words, offset);
    } });return ECB;
}();

cc._RFpop();
},{"./core":"core"}],"rewardNode":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'b717b2HbwlOla7ieO9oW8vk', 'rewardNode');
// Script/rewardNode.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        imgArray: [cc.Node],
        btnImg: cc.Node,
        btnText: cc.Label,
        text: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.btnImg.parent.on(cc.Node.EventType.TOUCH_START, function (event) {
            this.btnImg.scale = 0.8;
        }, this);

        this.btnImg.parent.on(cc.Node.EventType.TOUCH_END, function (event) {
            this.btnImg.scale = 1;
            this.node.active = false;
            var onFunction = cc.find('Canvas').getComponent('game');
            onFunction.rewardNodeColse();
        }, this);

        this.btnImg.parent.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {

            this.btnImg.scale = 1;
        }, this);
    },

    setContent: function setContent(status, num) {
        this.node.active = true;
        var text = "";
        if (status === 0) //未开奖
            {} else if (status == 1) //sheng
            {
                text = "中" + num + "豆";
            } else if (status == 2) //fu
            {
                text = "今日已有" + num + "人猜中!";
            } else if (status == 3) //ping
            {
                text = "返还" + num + "豆";
            } else if (status == 4) //未投注
            {} else {}
        this.text.getComponent(cc.Label).string = text;
        if (status >= 1 && status <= 3) //sheng
            {
                for (var i = 0; i < this.imgArray.length; i++) {
                    if (status - 1 == i) {
                        this.imgArray[i].active = true;
                    } else {
                        this.imgArray[i].active = false;
                    }
                }
            }
    }

});

cc._RFpop();
},{}]},{},["HelloWorld","Help","Init","Power","ButtonScale","Notouch","WaitScript","errorDialog","convertNode","flyChipNodePre","flyRewardNodePre","game","DataOper","NetData","aes","cipher-core","core","enc-base64","evpkdf","md5","mode-ecb","rewardNode"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9TY3JpcHQvVG9vbHMvQnV0dG9uU2NhbGUuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvRGF0YU9wZXIuanMiLCJhc3NldHMvU2NyaXB0L0hlbGxvV29ybGQuanMiLCJhc3NldHMvU2NyaXB0L0hlbHAuanMiLCJhc3NldHMvU2NyaXB0L0luaXQuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvTmV0RGF0YS5qcyIsImFzc2V0cy9TY3JpcHQvVG9vbHMvTm90b3VjaC5qcyIsImFzc2V0cy9TY3JpcHQvUG93ZXIuanMiLCJhc3NldHMvU2NyaXB0L1Rvb2xzL1dhaXRTY3JpcHQuanMiLCJhc3NldHMvU2NyaXB0L25ldHdvcmsvYWVzL2Flcy5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvY2lwaGVyLWNvcmUuanMiLCJhc3NldHMvU2NyaXB0L2NvbnZlcnROb2RlLmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9jb3JlLmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9lbmMtYmFzZTY0LmpzIiwiYXNzZXRzL1NjcmlwdC9Ub29scy9lcnJvckRpYWxvZy5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvZXZwa2RmLmpzIiwiYXNzZXRzL1NjcmlwdC9mbHlDaGlwTm9kZVByZS5qcyIsImFzc2V0cy9TY3JpcHQvZmx5UmV3YXJkTm9kZVByZS5qcyIsImFzc2V0cy9TY3JpcHQvZ2FtZS5qcyIsImFzc2V0cy9TY3JpcHQvbmV0d29yay9hZXMvbWQ1LmpzIiwiYXNzZXRzL1NjcmlwdC9uZXR3b3JrL2Flcy9tb2RlLWVjYi5qcyIsImFzc2V0cy9TY3JpcHQvcmV3YXJkTm9kZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7QUFDQTs7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFSdUI7O0FBY3pCO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7O0FBS0o7QUFDQTs7QUFFSTtBQUNBO0FBQ0k7QUFFSTtBQUNBO0FBRUc7QUFDRjtBQUVBO0FBQ0o7O0FBR0w7QUFFSTtBQUNBO0FBRUk7QUFDSDtBQUNEO0FBQ0E7QUFHQztBQUNKOztBQUVEO0FBRUk7QUFDQTtBQUVJO0FBQ0g7QUFFQTtBQUNKO0FBR0E7QUFFSjs7QUF4REk7O0FBNkRUO0FBQ0k7QUFEYTs7Ozs7Ozs7OztBQzVFakI7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDSTtBQUNBO0FBRlE7QUFEUTs7QUFPeEI7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBSEc7QUFEQTs7QUFRWDtBQUNJO0FBQ0E7O0FBRUE7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTs7QUFFQTtBQUNJO0FBQ0k7QUFDSDtBQUNKOztBQUVEO0FBQ0g7O0FBRUQ7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQWhEaUI7O0FBbUR0QjtBQUNJO0FBQ0k7O0FBRUE7QUFDSTtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7O0FBRUE7QUFDSTtBQUNIOztBQUVEO0FBQ0k7QUFDSDs7QUFFRDtBQUNJO0FBQ0g7QUFDSjtBQWhDa0I7O0FBbUN2Qjs7QUFFSTtBQUNJO0FBQ0E7O0FBRUE7O0FBRUk7QUFFSTtBQUNBO0FBQ0g7QUFDRDtBQUVIOztBQUVEOztBQUVJO0FBQ0k7QUFDSDtBQUNKO0FBcEJLOztBQXVCVjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFIYTtBQUtqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFLSjtBQUNJO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7O0FBRUE7QUFDSTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNIO0FBRUc7QUFDSDtBQUNEO0FBQ0E7O0FBRUg7QUFDSjs7QUFLRDtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7OztBQUlIOztBQUVEO0FBQ0k7QUFDSTtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7Ozs7O0FBTUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFUSjtBQVdIO0FBQ0o7QUFDSjtBQUVHO0FBQ0g7QUFDSjtBQUNHOztBQUVBO0FBQ0E7QUFDSTtBQUNBO0FBQ0g7QUFDRDtBQUNBO0FBQ0g7QUFDSjtBQUNHO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7Ozs7O0FBS0M7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDSTtBQUFTO0FBQ0w7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNMO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDTDtBQUNIO0FBQ0Q7QUFDQTtBQUFTO0FBQ0w7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNMO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDTDtBQUNIO0FBQ0Q7QUFDQTtBQUFTO0FBQ047QUFDRjtBQUNEO0FBQ0E7QUFBVztBQUNSO0FBQ0Y7QUFDRDtBQUNBO0FBQ0E7QUFsQ0o7QUFvQ0g7O0FBRUY7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7OztBQUlBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBRUc7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFDSDs7QUFFRDs7O0FBR0M7QUFDRztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSDs7QUFFRDtBQUNHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTtBQUNIO0FBQ0g7O0FBRUQ7OztBQUdEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FBWUg7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7Ozs7QUFLQTtBQUNJO0FBQ0k7QUFDSDtBQUVHO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEOzs7Ozs7QUFNQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7Ozs7QUFJQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7OztBQUdBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQW5tQm1COztBQXNtQnhCO0FBQ0k7QUFEYTs7Ozs7Ozs7OztBQ3hzQmpCO0FBQ0k7O0FBRUE7QUFDSTtBQUNJO0FBQ0E7QUFGRztBQUlQO0FBQ0E7QUFOUTs7QUFTWjtBQUNBO0FBQ0k7QUFDSDs7QUFFRDtBQUNBO0FBbEJLOzs7Ozs7Ozs7O0FDQVQ7QUFDQTs7QUFFQTtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVFE7O0FBWVo7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEOztBQUVBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJOztBQUVBO0FBRUk7QUFDSDs7QUFFRDtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFDRDtBQUNBOztBQUVBOztBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNQO0FBQ0E7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUVJO0FBQ0E7QUFDSDtBQW5ISTs7Ozs7Ozs7OztBQ0hUO0FBQ0E7O0FBRUE7QUFDSTs7QUFFQTs7OztBQUlBO0FBQ0k7QUFDQTtBQUNJOztBQUdJOztBQUVBO0FBQ0E7O0FBRUE7QUFDSTtBQUNBOztBQUVBO0FBQ0k7QUFDQTtBQUNIO0FBRUc7QUFDSDtBQUNEO0FBQ0E7O0FBRUg7O0FBR0Q7QUFDQTs7QUFFQTs7QUFFQTtBQUNJO0FBQ0E7QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTDtBQUNHO0FBQ0g7QUFDSjtBQUNGO0FBQ047QUFDRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBOztBQUVBO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUk7QUFDQTtBQUNBO0FBQ1A7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQS9GSTs7Ozs7Ozs7OztBQ0ZUO0FBQ0k7QUFDSTtBQUNBOztBQUVBOztBQUVJO0FBRUk7QUFDQTtBQUNIO0FBQ0Q7QUFFSDs7QUFFRDs7QUFFSTtBQUNJO0FBQ0g7QUFDSjtBQXBCSzs7QUF1QlY7QUFDSTtBQUNBOzs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQTFCUTs7QUE2Qlo7O0FBSUE7QUF6RG1COztBQTZEdkI7QUFDSTtBQURhOzs7Ozs7Ozs7O0FDOURqQjtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVFE7O0FBWVo7QUFDQTtBQUNHO0FBQ0s7QUFDQTs7QUFFQTtBQUVJO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDSDs7QUFqQ0k7Ozs7Ozs7Ozs7QUNBVDs7QUFFQTtBQUNJOztBQUVBOztBQUVJO0FBQ0k7QUFDQTtBQUZvQjs7QUFLeEI7O0FBRUE7QUFDSTtBQUNBO0FBRlM7O0FBS2I7O0FBRUE7QUFDSTtBQUNBO0FBRk87O0FBS1g7QUFDSTtBQUNBO0FBRlM7O0FBS2I7QUFDSTtBQUNBO0FBRmE7O0FBS2pCOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFHSjtBQUNBO0FBQ0k7O0FBSUE7QUFDSTtBQUNBO0FBQ0k7QUFDQztBQUNEO0FBQ0g7QUFDSjtBQUNKOztBQUVEOzs7QUFHQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7OztBQUlBO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBS0c7QUFDSTtBQUNIO0FBRUc7QUFDSDs7QUFFRDtBQUNIO0FBRUc7QUFDQTtBQUNJO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTs7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBRUc7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKOztBQUVEO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7O0FBRUQ7QUFDQTtBQUVJO0FBRUk7QUFFSTtBQUNBO0FBRUk7QUFDSDtBQUNKO0FBR0c7QUFDQTtBQUVJOztBQUdJO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNIO0FBR0c7QUFDSDtBQUdHO0FBQ0g7QUFHRztBQUNIO0FBR0c7QUFDSDtBQUNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQXJCSjtBQXVCQTtBQUNBO0FBRUg7QUFFSjtBQUNKO0FBR0c7O0FBR0Q7QUFDUztBQUNBO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFHRztBQUNIO0FBR0c7QUFDSDtBQUdHO0FBQ0g7QUFDRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFyQko7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0g7QUFDWjtBQUNKO0FBRUo7QUFDRztBQUVJO0FBQ0E7QUFFSTtBQUNBO0FBQ0g7QUFHRztBQUNBO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFHRztBQUNIO0FBR0o7QUFDSjs7QUFFRDtBQUVJO0FBRUk7QUFDQTtBQUNBO0FBQ0k7QUFDSDtBQUVEO0FBQ0k7QUFDSDtBQUVEO0FBQ0k7QUFDSDtBQUNKO0FBQ0o7O0FBR0w7O0FBRVE7QUFFSTtBQUNIO0FBR0c7QUFDSDs7QUFFRDtBQUNBO0FBQ0k7QUFDSDtBQUdHO0FBQ0g7QUFFSjtBQUVSOztBQUVEO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQTtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNIOztBQUVEOzs7O0FBSUE7QUFDSTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0g7QUFFRztBQUNIOztBQUdEO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDs7QUFFRDtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUVIO0FBRUo7O0FBRUQ7QUFFSTtBQUNBO0FBQ0M7QUFDQTtBQUVHO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSDtBQUVMOztBQUdEOzs7O0FBSUE7QUFDSTtBQUNBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUVJO0FBQ0g7QUFHRztBQUNIO0FBQ0Q7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUg7QUFFSjs7QUFFRDs7O0FBR0E7QUFFSTtBQUNIOztBQUVEOzs7QUFHQTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBRUc7QUFDSDtBQUNEO0FBQ0g7O0FBRUQ7Ozs7QUFJQTs7QUFJQTtBQUNBOztBQUVBO0FBaHJCSzs7Ozs7Ozs7OztBQ0ZUO0FBQ0k7O0FBRUE7O0FBR0E7QUFDQTtBQUNJO0FBQ0g7O0FBRUQ7QUFDQztBQUNJOztBQUVBO0FBRUk7QUFDSDs7QUFFRDtBQUNIO0FBckJHOzs7Ozs7Ozs7O0FDQVQ7QUFBZ0w7QUFBbVI7QUFBZ0M7QUFBVTtBQUFVO0FBQUs7QUFBZ0I7QUFBQztBQUF3QztBQUFnYztBQUFPO0FBQUs7QUFBaUM7QUFBQztBQUFDO0FBQXVHO0FBQTRNO0FBQWtCO0FBQW1DO0FBQUs7QUFBZ0Q7QUFBa0k7QUFBSztBQUFnQztBQUFpRjtBQUFDO0FBQWdEO0FBQUM7QUFBMEY7QUFBeUM7QUFBeUI7QUFBSztBQUEyQjtBQUF5QjtBQUEyQjtBQUFLO0FBQW1KO0FBQUM7QUFBQztBQUFpQztBQUE0RjtBQUFpQztBQUFtTztBQUEyRjtBQUFtTjtBQUFnZTtBQUE4ZjtBQUF1RDs7Ozs7Ozs7OztBQ0F6ekg7QUFBeUU7QUFBMlY7QUFBaUQ7QUFBbUM7QUFBaUQ7QUFBa0M7QUFBbUY7QUFBa0I7QUFBd0Q7QUFBOEI7QUFBZ0Q7QUFBK0I7QUFBZTtBQUF5QjtBQUFvRTtBQUE0RjtBQUFtQztBQUF5QjtBQUEyQjtBQUFLO0FBQTBCO0FBQUM7QUFBd0I7QUFBeUM7QUFBaUU7QUFBc0M7QUFBb0U7QUFBRTtBQUFDO0FBQWdGO0FBQThFO0FBQStIO0FBQXdDO0FBQXFDO0FBQXdDO0FBQTBCO0FBQWdDO0FBQWtDO0FBQStGO0FBQXlMO0FBQWlFO0FBQWlOO0FBQTZDO0FBQXVCO0FBQWdDO0FBQUs7QUFBMEI7QUFBNkI7QUFBMEI7QUFBQztBQUFXO0FBQTJFO0FBQTRPO0FBQStCO0FBQThFO0FBQXNCO0FBQXFGO0FBQW9IO0FBQW1IO0FBQXFDO0FBQUs7QUFBMkQ7QUFBb0Q7QUFBd0M7QUFBc0M7QUFBd0I7QUFBdUU7QUFBeUY7QUFBSztBQUFzRjtBQUE0QjtBQUFpRztBQUF5QjtBQUE4QjtBQUFrRDtBQUFvRztBQUEyRTtBQUF3RjtBQUFLO0FBQXlCO0FBQWtDO0FBQTRCO0FBQWdKO0FBQTBHO0FBQThEO0FBQW1KO0FBQ2oySjtBQUFnVDtBQUE2QztBQUFzSztBQUFvQztBQUFnQztBQUFxQztBQUFLO0FBQWtCO0FBQUM7QUFBbUc7QUFBVTtBQUE0QjtBQUErTTtBQUFpTDtBQUFzUTtBQUFrRDtBQUFxUztBQUFHOzs7Ozs7Ozs7O0FDQWp2RDs7QUFFQTtBQUNJOztBQUVBOztBQUVJOztBQUVBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBRUk7QUFDQTtBQUZKOztBQUtBO0FBQ0k7QUFDQTtBQUZhOztBQUtqQjtBQUNJO0FBQ0E7QUFGZTs7QUFLbkI7QUFFSTtBQUNBO0FBRko7O0FBS0E7QUFDQTtBQUNBO0FBeENROztBQTRDWjtBQUNBOztBQUlBO0FBRUk7QUFDQzs7QUFFRztBQUNBO0FBRUk7QUFDSDtBQUdHO0FBQ0g7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFUDs7QUFFRDtBQUVJO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUVIOztBQUVEO0FBRUk7QUFDQTtBQUNIOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUVIOztBQUVEO0FBQ0E7QUFFSTtBQUNBO0FBRUk7QUFDSDtBQUdHO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUdEO0FBRUk7QUFDQTtBQUVJO0FBRUk7QUFDSDtBQUNKO0FBRUo7O0FBR0Q7QUFDQTs7QUFFQTtBQTFKSzs7Ozs7Ozs7OztBQ0hUO0FBQWlEO0FBQTREO0FBQWdEO0FBQW1EO0FBQXlCO0FBQW9DO0FBQXdCO0FBQTBDO0FBQUM7QUFBa0U7QUFBbUI7QUFBbUY7QUFBOEM7QUFBb0M7QUFBNEM7QUFBNEM7QUFBQztBQUEwQztBQUFrQztBQUFDO0FBQWtCO0FBQXdDO0FBQUU7QUFBNkU7QUFBbUQ7QUFBdUI7QUFBSztBQUE2QjtBQUFDO0FBQTRCO0FBQXFDO0FBQTRCO0FBQTBKO0FBQWdDO0FBQTBIO0FBQUM7QUFBSztBQUFpQztBQUFpRDtBQUFDO0FBQXdDO0FBQWtCO0FBQXdJO0FBQWtCO0FBQTZFO0FBQXlCO0FBQWtDO0FBQW9FO0FBQW9MO0FBQUM7QUFBb0M7QUFBbUc7QUFBd0M7QUFBdUU7QUFBc0c7QUFBd0g7QUFBeUI7QUFBd0I7QUFBNkU7QUFBNEQ7QUFBZ0Q7QUFBeUQ7QUFBeUc7QUFBdUY7QUFBNEI7QUFBMkI7QUFBcUY7QUFBMEQ7QUFBaUQ7QUFBcUQ7QUFBSTtBQUErRDtBQUFTO0FBQXdDO0FBQUM7QUFBeUI7QUFBMkQ7QUFBd0Y7QUFBbUQ7QUFBd0I7QUFBMEI7QUFBc0I7QUFBd0Q7QUFBNEI7QUFBaU07QUFBcUM7QUFBSztBQUE4RDtBQUE0RztBQUF1RDtBQUF1QztBQUE4RTtBQUFzRDtBQUFrQjtBQUE0RTtBQUFnSDtBQUEyQztBQUFrQjtBQUF3RDtBQUFnQztBQUF3RDtBQUFrQztBQUFrQjtBQUE0QjtBQUN0MUo7QUFBWTtBQUFpRDtBQUE2QjtBQUE4QztBQUFDO0FBQW9DO0FBQTZCO0FBQTBEO0FBQUM7QUFBaUM7Ozs7Ozs7Ozs7QUNEMVM7QUFBMkM7QUFBb0k7QUFBOEk7QUFBeU87QUFBdUQ7QUFBQztBQUErQztBQUE0QjtBQUE4QjtBQUFDO0FBQTRCO0FBQTJCO0FBQXNHO0FBQXFFO0FBQTZCO0FBQUM7QUFBNkQ7QUFBUTtBQUE0TTtBQUFDO0FBQXNDO0FBQTJFOzs7Ozs7Ozs7O0FDQzMwQzs7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFSdUI7QUFXekI7QUFDSTs7QUFFQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZXO0FBSWY7QUFDQTtBQUNJO0FBQ0E7QUFGWTtBQUloQjtBQUNBOztBQWRROztBQWtCWjtBQUNBO0FBQ0k7QUFDSztBQUNKOztBQUVEO0FBQ0s7QUFDRDtBQUNBO0FBRUg7O0FBRUQ7QUFDSztBQUNKOztBQUVEO0FBQ0s7QUFDSjs7QUFFRDtBQUNLO0FBQ0Q7QUFDQTtBQUVIOztBQUVEO0FBQ0s7QUFDSjtBQUVKOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVIO0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBRUk7QUFDSDs7QUFFRDtBQUVJO0FBRUk7QUFDSDs7QUFFRDtBQUVJO0FBQ0g7QUFDSjs7QUExR0k7Ozs7Ozs7Ozs7QUNaVDtBQUEyQztBQUF5TztBQUE4QjtBQUFpQztBQUFtTjtBQUFVO0FBQXFCO0FBQThGO0FBQTRDO0FBQXlCO0FBQWdEO0FBQXdDO0FBQWlEO0FBQUM7Ozs7Ozs7Ozs7QUNDbDNCOztBQUVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQVJxQjs7QUFhdkI7QUFDSTs7QUFFQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBRmU7QUFJbkI7QUFOUTs7QUFTWjtBQUNBOztBQUlBOzs7O0FBSUE7O0FBR0k7QUFFSTtBQUVJO0FBQ0g7QUFHRztBQUNIO0FBQ0o7QUFHSjs7QUFFRDs7OztBQUlBO0FBRUk7QUFFSTtBQUNIO0FBR0c7QUFDSDtBQUNKOztBQUVEOzs7Ozs7Ozs7QUFTQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBR0c7QUFDQTtBQUNIOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDSDs7QUF6Rkk7O0FBaUdUO0FBQ0k7QUFEYTs7Ozs7Ozs7OztBQy9HakI7QUFDSTs7QUFFQTs7QUFFSTtBQUVJO0FBQ0E7QUFGSjtBQUhROztBQVNaO0FBQ0E7O0FBSUE7QUFFSTtBQUVJO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFFSjtBQUNKOztBQUVEO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBR0E7QUFDSDtBQS9DSTs7Ozs7Ozs7OztBQ0NUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNJOztBQUVBO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBRlE7O0FBS1o7QUFDSTtBQUNBO0FBRk87O0FBS1g7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUZRO0FBSVo7QUFDSTtBQUNBO0FBRks7QUFJVDtBQUNJO0FBQ0E7QUFGSztBQUlUO0FBQ0U7QUFDQTtBQUZhOztBQUtmO0FBQ0E7QUFDSTtBQUNBO0FBRlc7O0FBS2Y7QUFDQTtBQUNJO0FBQ0E7QUFGUztBQUliO0FBQ0k7QUFDQTtBQUZVOztBQUtkO0FBQ0E7QUFDSTtBQUNBO0FBRk87O0FBS1g7QUFDSTtBQUNBO0FBRmlCOztBQUtyQjtBQUNJO0FBQ0E7QUFGaUI7O0FBS3JCO0FBQ0k7QUFDQTtBQUZnQjs7QUFLcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQTlFUTs7QUFrRlo7QUFDQTs7QUFFSTtBQUNBOztBQUVBOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUVHO0FBQ0E7QUFDSDtBQUVHO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSDs7QUFHRDtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0k7QUFDSDtBQUNMO0FBQ0g7O0FBRUQ7QUFDSTtBQUNIOztBQUVEO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7O0FBRUQ7QUFFSzs7QUFFRDtBQUVJO0FBQ0g7QUFDRzs7QUFHSTs7QUFHRTtBQUNBO0FBQ0k7QUFDSDtBQUVEOztBQUVFOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVJO0FBQ0g7QUFDRjtBQUNGO0FBQ0o7QUFHRztBQUNIO0FBQ0o7QUFHRTtBQUNGO0FBRUg7O0FBRUY7QUFDSTtBQUNJO0FBQ0E7O0FBRUE7QUFDSTtBQUFzQjtBQUNsQjtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDSDtBQUNKO0FBRUc7QUFDSDtBQUNKO0FBRUc7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTs7QUFFQTtBQUNJOztBQUVBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDSDs7QUFFRDtBQUNIOztBQUVEO0FBRUk7QUFDSDs7QUFFRDtBQUNJO0FBQ0k7QUFDSTtBQUNIO0FBQ0o7QUFFRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDs7QUFHQTtBQUVJO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBRUk7QUFFSTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0g7QUFDSjtBQUNKOztBQUVEO0FBRUk7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFDSjs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJOztBQUVBO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7O0FBRUQ7QUFDQTtBQUNBOztBQUVBOztBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFFRztBQUNBO0FBQ0g7O0FBRUQ7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUFPO0FBQ0g7QUFDQTtBQUNIO0FBQ0Q7QUFDQTtBQUFPO0FBQ0g7O0FBRUg7QUFDRDtBQUNBO0FBQ0E7QUFqREo7QUFtREg7O0FBRUQ7QUFDSTtBQUNIOztBQUVEO0FBQ0k7O0FBRUE7O0FBRUE7QUFDSTtBQUNIO0FBRUc7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUVEO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJOztBQUVBO0FBQ0E7QUFFSTtBQUNIO0FBQ0Q7QUFDSDtBQUVEO0FBQ0k7QUFDSDtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7O0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNEO0FBQ0E7QUFDSDs7QUFFRDtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFDSTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBQ0E7QUFDSDs7QUFFRDtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIOztBQUdHO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDSDtBQUNKOztBQUVEO0FBQ0E7QUFDSDtBQUNKOztBQUVEO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTtBQUNJO0FBQ0E7O0FBRUE7QUFDSTtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDSjtBQUNKO0FBQ0c7QUFDSTtBQUNJO0FBQ0E7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUNKO0FBQ0o7O0FBRUQ7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBTztBQUNIO0FBRUk7QUFBUztBQUNUO0FBQ0k7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNUO0FBQ0k7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDSDtBQUNKO0FBQ0o7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNJO0FBQ0g7QUFDRDtBQUNBO0FBQVM7QUFDVDtBQUNJOztBQUVBO0FBQ0E7QUFDSDtBQUNEO0FBQ0E7QUFBUztBQUNUO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVIO0FBQ0Q7QUFDQTtBQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQVM7QUFDVDtBQUNBO0FBbERKO0FBb0RIO0FBQ0Q7QUFDQTtBQUFZO0FBQ1o7QUFHQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBRUk7QUFBUztBQUNMO0FBQ0k7O0FBRUE7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUVJO0FBQ0g7QUFDSjtBQUNKO0FBQ0Q7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEO0FBekJSO0FBMkJIO0FBQ0Q7QUE3RkE7QUFnR0g7QUFDRDtBQUNBO0FBQ0E7QUFFSTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7QUFFRDtBQUNJO0FBQ0g7O0FBRUQ7QUFFSDs7QUFFRDtBQUVJOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUNBO0FBQ0g7O0FBRUQ7QUFDQTtBQUVJO0FBRUk7QUFDQTtBQUNBO0FBQ0k7O0FBRUE7O0FBRUE7QUFDSTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDSDtBQUVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7QUFDSjtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNEOztBQUVBO0FBQ0k7QUEzQ1I7QUE4Q0g7O0FBRUQ7QUFDQTtBQUNJO0FBQ0E7O0FBRUE7QUFFSTtBQUVJO0FBQ0k7QUFDSTtBQUNBO0FBRUk7QUFDQTtBQUNIO0FBV0c7QUFDQTtBQUNBO0FBQ0g7QUFHRztBQUNBO0FBQ0E7QUFDSDtBQVdKO0FBQ0Q7QUFDSjtBQUNJO0FBR0E7QUFDSjtBQUNJO0FBQ0E7QUFqRFI7QUFtREg7QUFHRztBQUVJO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQUNKO0FBQ0k7QUFDQTtBQVZSO0FBWUg7QUFDSjs7QUFFRDtBQUNJOztBQUVBO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7O0FBRUQ7QUFFSTtBQUVJO0FBQ0g7QUFDSjtBQUNEO0FBQ0g7O0FBRUQ7QUFDSTs7QUFFQTtBQUdJO0FBQ0g7QUFFRztBQUNIO0FBQ0o7O0FBRUQ7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUVHO0FBQ0g7QUFDSjtBQUNKOztBQUVEO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDs7QUFFRDtBQUNJO0FBRUk7QUFDQTtBQUNBO0FBRUk7QUFDSDtBQUNKO0FBQ0o7O0FBR0Q7QUFDSTtBQUNBO0FBQ0E7QUFFSTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUNKO0FBQ0Q7QUFFSDs7QUFFRDs7O0FBR0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7O0FBRUE7O0FBRUo7QUFFSTtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0Q7QUFDSDtBQUNKOztBQUVEO0FBQ0M7QUFFRztBQUNIO0FBQ0o7O0FBOTZCSTs7Ozs7Ozs7OztBQ1hUO0FBQStDO0FBQTRIO0FBQXNCO0FBQTRDO0FBQUM7QUFBMEQ7QUFBNEU7QUFBb0M7QUFBc0I7QUFBK0o7QUFBeXJGO0FBQXdCO0FBQXNuQjtBQUFzRjtBQUFZO0FBQWtCO0FBQThFO0FBQThCO0FBQXlEO0FBQTJCO0FBQXlEO0FBQTJCO0FBQWtEO0FBQTJCO0FBQXFEO0FBQXdFOzs7Ozs7Ozs7O0FDQXQrSTtBQUE2RDtBQUE0RztBQUF3QztBQUFpRTtBQUF3QztBQUFjOzs7Ozs7Ozs7O0FDQXhVO0FBQ0k7O0FBRUE7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpROztBQU9aO0FBQ0E7QUFDSTtBQUNLO0FBQ0o7O0FBRUQ7QUFDSztBQUNBO0FBQ0Q7QUFDQTtBQUVIOztBQUVEOztBQUVJO0FBR0M7QUFDUjs7QUFFRDtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDSTtBQUNIO0FBRUQ7QUFDSTtBQUNIO0FBRUQ7QUFDSTtBQUNIO0FBRUQ7QUFLQTtBQUNBO0FBQ0E7QUFDSTtBQUVJO0FBRUk7QUFDSDtBQUdHO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7O0FBdkVJIiwic291cmNlc0NvbnRlbnQiOlsiXG4vL+aMiemSruagh+ivhlxudmFyIEVidXR0b25UYWcgPSBjYy5FbnVtKHtcblxuICBlQ2hpcDIwOiAwLFxuICBlQ2hpcDUwOiAxLCAgIFxuICBlQ2hpcDEwMDogMiwgICAgICBcbiAgZUNoaXA1MDA6MywgXG4gIGVDaGlwMTAwMDo0LCBcbiAgZUNsZWFyIDogNSwgIFxuICBlSGlzdG9yeUxpc3Q6IDYsXG5cbn0pO1xuXG5cblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgc2NhbGVGbGFnOnRydWUsXG4gICAgICAgIGJ1dHRvblRhZzowLFxuICAgICAgICBwYXJlbnROb2RlOiBjYy5Ob2RlLC8v54i26IqC54K5KOS4uuS6hue7k+WxgOeCueWHu+WMuuWfn+e8qeWQjiDkuovku7bkuI3lk43lupQg57uf57uf5Yqg5LqG54i26IqC54K55p2l5aSE55CG5LqL5Lu277yM5a+55a2Q6IqC54K557yp5pS+IDIwMTctMDQtMTAgUE06MzQwKVxuICAgICAgICBcbiAgICB9LFxuXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyB2YXIgdGltZUNhbGxiYWNrID0gZnVuY3Rpb24gKGR0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih0aGlzLnBhcmVudE5vZGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnNjYWxlRmxhZylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNjYWxlID0gMC44O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sdGhpcyk7IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICBpZih0aGlzLnBhcmVudE5vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgaWYodGhpcy5zY2FsZUZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNjYWxlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbkZ1bmN0aW9uID0gY2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnYW1lJyk7XG4gICAgICAgICAgICBvbkZ1bmN0aW9uLmJ0bkFjdGlvbkNhbGxCYWNrKHRoaXMuYnV0dG9uVGFnKTtcblxuICAgICAgICAgICBcbiAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZih0aGlzLnBhcmVudE5vZGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgICAgICAgaWYodGhpcy5zY2FsZUZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNjYWxlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBFYnV0dG9uVGFnIDogRWJ1dHRvblRhZyxcbn07XG5cblxuXG4iLCJcbnZhciBDcnlwdG9KUyA9IHJlcXVpcmUoXCJjb3JlXCIpO1xucmVxdWlyZShcImFlc1wiKTtcbnZhciBOZXREYXRhID0gcmVxdWlyZShcIk5ldERhdGFcIik7XG5cbnZhciBLZXlWYWx1ZSA9IGNjLkNsYXNzKHtcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGtleSA6IFwiXCIsXG4gICAgICAgIHZhbHVlIDogXCJcIlxuICAgIH1cbn0pO1xuXG52YXIgQ3VzTWFwID0gY2MuQ2xhc3Moe1xuICAgIHByb3BlcnRpZXM6e1xuICAgICAgICBtYXBzIDoge1xuICAgICAgICAgICAgZGVmYXVsdCA6IFtdLFxuICAgICAgICAgICAgdHlwZSA6IFtLZXlWYWx1ZV0sXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IGZhbHNlXG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIHNldCA6IGZ1bmN0aW9uKGtleSwgdmFsdWUpe1xuICAgICAgICB2YXIgc19rZXkgPSBrZXkudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIGZsYWcgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLm1hcHMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgaWYodGhpcy5tYXBzW2ldLmtleSA9PT0gc19rZXkpe1xuICAgICAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMubWFwc1tpXS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZihmbGFnID09PSBmYWxzZSl7XG4gICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAgICAgIGtleVZhbHVlLmtleSA9IHNfa2V5O1xuICAgICAgICAgICAga2V5VmFsdWUudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMubWFwcy5wdXNoKGtleVZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgZ2V0IDogZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgdmFyIHNfa2V5ID0ga2V5LnRvU3RyaW5nKCk7XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5tYXBzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGlmKHRoaXMubWFwc1tpXS5rZXkgPT09IHNfa2V5KXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXBzW2ldLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgY2xlYXIgOiBmdW5jdGlvbihrZXkpe1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5tYXBzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgIGlmKHRoaXMubWFwc1tpXS5rZXkgPT0ga2V5KXtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cbnZhciBOZXRXb3JrID0gY2MuQ2xhc3Moe1xuICAgIHNlbmQgOiBmdW5jdGlvbihyZXF1ZXN0SWQsIHJlcXVlc3RIZWFkZXJzLCByZXF1ZXN0RGF0YSwgY2FsbGZ1bmMpe1xuICAgICAgICB2YXIgeGhyID0gY2MubG9hZGVyLmdldFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgICAgaWYgKCFDQ19KU0Ipe1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLKSB7XG4gICAgICAgICAgICAgICAgeGhyID0gd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREsuZ2V0SHR0cFJlcXVlc3RPYmplY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHhoci5vcGVuKFwiUE9TVFwiLCBcImh0dHA6Ly8xMC4wLjIwLjE3Mjo4MDgwL2dhdGV3YXkvcHJvY2Vzc1wiKTtcbiAgICAgICAgLy94aHIub3BlbihcIlBPU1RcIiwgXCJodHRwOi8vMTcyLjE2LjIwLjE2MTo3MDgwL2dhdGV3YXkvcHJvY2Vzc1wiKTsvL1wiaHR0cDovLzE3Mi4xNi4yMC4xNzU6ODA4MC9nYXRld2F5L3Byb2Nlc3NcIik7IC8vXCJodHRwOi8vMTAuMC4xLjIzMjo3MDgwL25ld19nYXRld2F5L3Byb2Nlc3NcIik7IFxuICAgICAgICB4aHIudGltZW91dCA9IDE1MDAwOy8vMTVz6LaF5pe2XG4gICAgICAgIFxuICAgICAgICAvL+iuvue9ruivt+axguWktFxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcmVxdWVzdEhlYWRlcnMubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIocmVxdWVzdEhlYWRlcnNbaV0ua2V5LCByZXF1ZXN0SGVhZGVyc1tpXS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHhoci5zZW5kKHJlcXVlc3REYXRhKTtcbiAgICBcbiAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhbGxmdW5jKHJlcXVlc3RJZCwgeGhyKTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNhbGxmdW5jKHJlcXVlc3RJZCwgeGhyKTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgY2FsbGZ1bmMocmVxdWVzdElkLCB4aHIpO1xuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG52YXIgRGF0YU9wZXIgPSBjYy5DbGFzcyh7XG4gICAgXG4gICAgc3RhdGljcyA6IHtcbiAgICAgICAgZ19EYXRhT3Blckluc3QgOiBudWxsLFxuICAgICAgICBzX2luZGV4IDogMCxcbiAgICAgICAgXG4gICAgICAgIGdldEluc3Q6ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoRGF0YU9wZXIuZ19EYXRhT3Blckluc3QgPT09IG51bGwpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgRGF0YU9wZXIuZ19EYXRhT3Blckluc3QgPSBuZXcgRGF0YU9wZXIoKTtcbiAgICAgICAgICAgICAgICBEYXRhT3Blci5nX0RhdGFPcGVySW5zdC5pbml0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRGF0YU9wZXIuZ19EYXRhT3Blckluc3Q7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcblxuICAgICAgICBkZXN0b3J5SW5zdDpmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihEYXRhT3Blci5nX0RhdGFPcGVySW5zdCAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgRGF0YU9wZXIuZ19EYXRhT3Blckluc3QgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHByb3BlcnRpZXMgOiB7XG4gICAgICAgIC8v6K+35rGCZGF0YVxuICAgICAgICByZXF1ZXN0RGF0YSA6IFwiXCIsXG4gICAgICAgIC8v6K+35rGCaWRcbiAgICAgICAgcmVxdWVzdElkIDogMCxcbiAgICAgICAgLy9hZXMgS2V5XG4gICAgICAgIGFlc0tleSA6IFwiODE3ZmVkOTVmOWUxNmJlZFwiLC8v56eY6ZKl77yM5YaZ5q27XG4gICAgICAgIFxuICAgICAgICAvLyoqKioqKioqKioqKioqKiror7fmsYLlpLTkv6Hmga8qKioqKioqKioqXG4gICAgICAgIC8v6K+35rGC5aS05pWw57uEXG4gICAgICAgIHJlcXVlc3RIZWFkZXJzIDoge1xuICAgICAgICAgICAgZGVmYXVsdCA6IFtdLFxuICAgICAgICAgICAgdHlwZSA6IFtLZXlWYWx1ZV0sXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIC8v5ZG95Luk5Y+3XG4gICAgICAgIGhlYWRlckNtZCA6IDAsIC8v5Yid5aeL5YyWLTEwMCAg5oqV5rOoLTEwMSAg57uT566XLTEwM1xuICAgICAgICAvL3NpZ1xuICAgICAgICBoZWFkZXJTaWcgOiBcIlwiLFxuICAgICAgICAvL+eJiOacrOWPt1xuICAgICAgICBoZWFkZXJWZXIgOiBcIjEuMFwiLFxuICAgICAgICAvL+S8muivneagh+ivhlxuICAgICAgICBoZWFkZXJUb2tlbiA6IFwiMzcwNjIwMTc3OVwiLC8vXCIzNzA2MjAxNzc5XCIsXG4gICAgICAgIC8v5ri45oiP5rig6YGT5a6e5L6L5qCH6K+GXG4gICAgICAgIGdhbWVUb2tlbiA6IFwiYWQ4MGRiOTk0ZGFiYjkwYjQyZGIwMDIxNGI4ZDMwMWQtOS05MDEtMTIwMlwiLC8vXCJkZGQ3NmNkNmU5YjYyZGMyMjU5YWE3NzJhNDUwMWIyMi05LTk1MS05MjZcIixcbiAgICAgICAgLy/muLjmiI/moIfor4ZcbiAgICAgICAgLy9oZWFkZXJHaWQgOiBcIjEwMDA0XCIgIC8v5q+P5Liq5ri45oiP5Zyo6L+Z6YeM5YaZ5q27ICDlkIzoirHpobotMTAwMDAgIOWwj+aAquiBlOebny0xMDAwMSAg5peX5byA5b6X6IOcLTEwMDAyIOWlh+W5u+Wuneefsy0xMDAwMyDogIHomY7mnLotMTAwMDQg5Zyw5Lqn5aSn5LqoLTEwMDA1XG4gICAgfSxcbiAgICBcbiAgICBpbml0IDogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5jYWxsZnVuY3MgPSBuZXcgQ3VzTWFwKCk7XG4gICAgICAgIHRoaXMuY2FsbG5vZGUgPSBuZXcgQ3VzTWFwKCk7XG4gICAgICAgIHRoaXMuY2FsbGNtZCA9IG5ldyBDdXNNYXAoKTtcbiAgICAgICAgY2MubG9nKFwiamI9XCIgKyBDQ19KU0IpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFDQ19KU0Ipe1xuICAgICAgICAgICAgdGhpcy5nYW1lVG9rZW4gPSB0aGlzLkdldFF1ZXJ5U3RyaW5nKFwiYWNjZXNzVG9rZW5cIik7XG4gICAgICAgIFxuICAgICAgICAgICAgaWYodGhpcy5nYW1lVG9rZW4gPT0gbnVsbCl7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVRva2VuID0gXCJhZDgwZGI5OTRkYWJiOTBiNDJkYjAwMjE0YjhkMzAxZC05LTkwMS0xMjAyXCI7Ly9cImRkZDc2Y2Q2ZTliNjJkYzIyNTlhYTc3MmE0NTAxYjIyLTktOTUxLTkyNlwiO1xuICAgICAgICAgICAgICAgIGxldCB0b2sgPSB0aGlzLkdldFF1ZXJ5U3RyaW5nKFwidG9rXCIpO1xuXG4gICAgICAgICAgICAgICAgaWYodG9rKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJUb2tlbiA9IHRvaztcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0b2s9XCIgKyB0aGlzLmhlYWRlclRva2VuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJUb2tlbiA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vdGVzdFxuICAgICAgICAgICAgICAgIC8qdmFyIG15RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJUb2tlbiA9IG15RGF0ZS5nZXRUaW1lKCk7Ki9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuXG4gICAgICAgIH0gICAgICAgIFxuXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGhpcy5nYW1lVG9rZW4gPSBcIiArIHRoaXMuZ2FtZVRva2VuKTtcbiAgICB9LFxuXG4gICAgR2V0UXVlcnlTdHJpbmcgOiBmdW5jdGlvbihuYW1lKVxuICAgIHtcbiAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiKyBuYW1lICtcIj0oW14mXSopKCZ8JClcIik7XG4gICAgICAgIHZhciByID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkubWF0Y2gocmVnKTtcbiAgICAgICAgaWYociE9PW51bGwpcmV0dXJuICB1bmVzY2FwZShyWzJdKTsgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICBcbiAgICBzZXRSZXF1ZXN0SGVhZGVyIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycyA9IFtdO1xuXG4gICAgICAgIHZhciBrZXlWYWx1ZSA9IG5ldyBLZXlWYWx1ZSgpO1xuICAgICAgICBrZXlWYWx1ZS5rZXkgPSBcImNtZFwiO1xuICAgICAgICBrZXlWYWx1ZS52YWx1ZSA9IHRoaXMuaGVhZGVyQ21kLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucmVxdWVzdEhlYWRlcnMucHVzaChrZXlWYWx1ZSk7XG4gICAgICAgIFxuICAgICAgICBrZXlWYWx1ZSA9IG5ldyBLZXlWYWx1ZSgpO1xuICAgICAgICBrZXlWYWx1ZS5rZXkgPSBcIkNvbnRlbnQtVHlwZVwiO1xuICAgICAgICBrZXlWYWx1ZS52YWx1ZSA9IFwidGV4dC9wbGFpblwiO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpO1xuICAgICAgICBcbiAgICAgICAgLyprZXlWYWx1ZSA9IG5ldyBLZXlWYWx1ZSgpO1xuICAgICAgICBrZXlWYWx1ZS5rZXkgPSBcImNpZFwiO1xuICAgICAgICBrZXlWYWx1ZS52YWx1ZSA9IHRoaXMuaGVhZGVyQ2lkLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMucmVxdWVzdEhlYWRlcnMucHVzaChrZXlWYWx1ZSk7Ki9cbiAgICAgICAgXG4gICAgICAgIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwic2lnXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5oZWFkZXJTaWcudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycy5wdXNoKGtleVZhbHVlKTtcbiAgICAgICAgXG4gICAgICAgIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwidmVyXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5oZWFkZXJWZXIudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycy5wdXNoKGtleVZhbHVlKTtcbiAgICAgICAgXG4gICAgICAgIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwidG9rXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5oZWFkZXJUb2tlbi50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpO1xuXG4gICAgICAgIGtleVZhbHVlID0gbmV3IEtleVZhbHVlKCk7XG4gICAgICAgIGtleVZhbHVlLmtleSA9IFwiZ2FtZVRva2VuXCI7XG4gICAgICAgIGtleVZhbHVlLnZhbHVlID0gdGhpcy5nYW1lVG9rZW4udG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SGVhZGVycy5wdXNoKGtleVZhbHVlKTtcbiAgICAgICAgXG4gICAgICAgIC8qa2V5VmFsdWUgPSBuZXcgS2V5VmFsdWUoKTtcbiAgICAgICAga2V5VmFsdWUua2V5ID0gXCJnaWRcIjtcbiAgICAgICAga2V5VmFsdWUudmFsdWUgPSB0aGlzLmhlYWRlckdpZC50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnJlcXVlc3RIZWFkZXJzLnB1c2goa2V5VmFsdWUpOyovXG4gICAgfSxcbiAgICBcbiAgICByZXF1ZXN0IDogZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICBpZih0aGlzLmhlYWRlckNtZCAhPSAxMDUpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXF1ZXN0LS0tLS0tLS0tLS1kYXRhID0gXCIgKyB0aGlzLnJlcXVlc3REYXRhICsgXCI7Y21kOlwiICsgdGhpcy5oZWFkZXJDbWQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNhbGxmdW5jcy5zZXQoRGF0YU9wZXIuc19pbmRleCwgY2FsbEZ1bmMpO1xuICAgICAgICB0aGlzLmNhbGxub2RlLnNldChEYXRhT3Blci5zX2luZGV4LCBzZWxmKTtcbiAgICAgICAgdGhpcy5jYWxsY21kLnNldChEYXRhT3Blci5zX2luZGV4LCB0aGlzLmhlYWRlckNtZCk7XG4gICAgICAgIC8vYWVz5Yqg5a+GXG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSB0aGlzLkFFU0VuY3J5cHRpb24odGhpcy5yZXF1ZXN0RGF0YSwgdGhpcy5hZXNLZXkpO1xuICAgICAgICAvL0Jhc2U2NFxuICAgICAgICAvL3RoaXMucmVxdWVzdERhdGEgPSBCYXNlNjQuZW5jb2RlKHRoaXMucmVxdWVzdERhdGEpO1xuICAgICAgICAvL2d6aXBcbiAgICAgICAgLy90aGlzLnJlcXVlc3REYXRhID0gdGhpcy5yZXF1ZXN0RGF0YTtcbiAgICAgICAgLy9tZDVcbiAgICAgICAgdGhpcy5oZWFkZXJTaWcgPSBDcnlwdG9KUy5NRDUodGhpcy5yZXF1ZXN0RGF0YSk7XG4gICAgICAgIC8v6K+35rGC5aS0XG4gICAgICAgIHRoaXMuc2V0UmVxdWVzdEhlYWRlcigpO1xuICAgICAgICAvL3NlbmRcbiAgICAgICAgdmFyIG5ldFdvcmsgPSBuZXcgTmV0V29yaygpO1xuICAgICAgICBuZXRXb3JrLnNlbmQoRGF0YU9wZXIuc19pbmRleCwgdGhpcy5yZXF1ZXN0SGVhZGVycywgdGhpcy5yZXF1ZXN0RGF0YSwgdGhpcy5vbkh0dHBSZXF1ZXN0Q29tcGxldGVkKTtcbiAgICAgICAgRGF0YU9wZXIuc19pbmRleCsrO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog6IGU572R5Zue6LCDXG4gICAgICogQFBhcmFtIHJlcXVlc3RJZCDor7fmsYJpZFxuICAgICAqIEBwYXJhbSBzdGF0dXMgICDogZTnvZHnirbmgIFcbiAgICAgKiBAcGFyYW0gcmVzcG9uZURhdGEg5ZON5bqUZGF0YVxuICAgICAqL1xuICAgIG9uSHR0cFJlcXVlc3RDb21wbGV0ZWQgOiBmdW5jdGlvbihyZXF1ZXN0SWQsIHhocil7XG4gICAgICAgIGNvbnNvbGUubG9nKFwib25IdHRwUmVxdWVzdENvbXBsZXRlZC54aHIuc3RhdHVzPVwiICsgeGhyLnN0YXR1cyk7XG4gICAgICAgIHZhciBjYWxsRnVuYyA9IERhdGFPcGVyLmdldEluc3QoKS5jYWxsZnVuY3MuZ2V0KHJlcXVlc3RJZCk7XG4gICAgICAgIHZhciBjYWxsTm9kZSA9IERhdGFPcGVyLmdldEluc3QoKS5jYWxsbm9kZS5nZXQocmVxdWVzdElkKTtcbiAgICAgICAgdmFyIGNhbGxDbWQgPSBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGNtZC5nZXQocmVxdWVzdElkKTtcbiAgICAgICAgY2MubG9nKFwiY2FsbENtZD1cIiArIGNhbGxDbWQgKyBcIi9sbj1cIiArIERhdGFPcGVyLmdldEluc3QoKS5jYWxsY21kLm1hcHMubGVuZ3RoICsgXCInXCIgKyBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGZ1bmNzLm1hcHMubGVuZ3RoICsgXCInXCIgKyBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbG5vZGUubWFwcy5sZW5ndGgpO1xuICAgICAgICBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGZ1bmNzLmNsZWFyKHJlcXVlc3RJZCk7XG4gICAgICAgIERhdGFPcGVyLmdldEluc3QoKS5jYWxsbm9kZS5jbGVhcihyZXF1ZXN0SWQpO1xuICAgICAgICBEYXRhT3Blci5nZXRJbnN0KCkuY2FsbGNtZC5jbGVhcihyZXF1ZXN0SWQpO1xuXG4gICAgICAgIGlmKCh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzAwKSB8fCB4aHIuc3RhdHVzID09PSAzMDQpe1xuICAgICAgICAgICAgLy/lj5ZodHRw5aS0XG4gICAgICAgICAgICAvL+WRveS7pOWPt1xuICAgICAgICAgICAgdmFyIGNtZCA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcImNtZFwiKTtcbiAgICAgICAgICAgIGNtZCA9IHBhcnNlSW50KGNtZCk7XG4gICAgICAgICAgICAvL3Jlc1xuICAgICAgICAgICAgdmFyIHJlcyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcInJlc1wiKTtcbiAgICAgICAgICAgIC8vbXNnXG4gICAgICAgICAgICB2YXIgbXNnID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKFwibXNnXCIpO1xuICAgICAgICAgICAgbXNnID0gZGVjb2RlVVJJQ29tcG9uZW50KG1zZyk7XG4gICAgICAgICAgICAvL3NpZ1xuICAgICAgICAgICAgdmFyIHNpZyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcihcInNpZ1wiKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInhoci5zdGF0dXM9XCIgKyB4aHIuc3RhdHVzICsgXCJ8cmU9XCIgKyByZXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihyZXMgPT0gMCl7XG4gICAgICAgICAgICAgICAgLy/lj5Zib2R5XG4gICAgICAgICAgICAgICAgdmFyIGJvZHkgPSB4aHIucmVzcG9uc2VUZXh0O1xuICAgICAgICAgICAgICAgIC8vbWQ16aqM6K+BXG4gICAgICAgICAgICAgICAgdmFyIHRfc2lnID0gQ3J5cHRvSlMuTUQ1KGJvZHkpO1xuICAgICAgICAgICAgICAgIGxldCB0X3NpZ19zdHIgPSBuZXcgU3RyaW5nKHRfc2lnKTtcbiAgICAgICAgICAgICAgICBsZXQgc2lnX3N0ciA9IG5ldyBTdHJpbmcoc2lnKTtcbiAgICAgICAgICAgICAgICB0X3NpZ19zdHIgPSB0X3NpZ19zdHIudHJpbSgpO1xuICAgICAgICAgICAgICAgIHNpZ19zdHIgPSBzaWdfc3RyLnRyaW0oKTtcblxuICAgICAgICAgICAgICAgIGlmKHRfc2lnX3N0ciA9PSBzaWdfc3RyKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ2YWxpZnkgcmlnaHRcIik7XG4gICAgICAgICAgICAgICAgICAgIERhdGFPcGVyLmdldEluc3QoKS5wYXJzZXJTZXJ2ZXJEYXRhKGJvZHksIGNtZCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxGdW5jKGNtZCwgcmVzLCBtc2csIGNhbGxOb2RlKTtcblxuICAgICAgICAgICAgICAgICAgICAvL+abtOaWsOi0puaIt+S9meminVxuICAgICAgICAgICAgICAgICAgICAvL+WIneWni+WMluiwg+i/h+S6hu+8jOS4jeiwg+S6huOAglxuICAgICAgICAgICAgICAgICAgICBpZiAoIUNDX0pTQil7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goY21kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDE6Ly9iZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDI6Ly9jbGVhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwMzovL3Jld2FyZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy51cGRhdGVVc2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxGdW5jKGNtZCwgLTEsIFwi5Yqg5a+G6aqM6K+B6ZSZ6K+vXCIsIGNhbGxOb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaKpemUmS0tLXJlczpcIiArIHJlcyArIFwiLS0tLW1zZzpcIiArIG1zZyk7XG5cbiAgICAgICAgICAgICAgICAvL+e6r+S4muWKoWxvZ2ljXG4gICAgICAgICAgICAgICAgaWYoKGNtZCA9PSAxMDApICYmIChyZXMgPT0gOTk5OTk5KSl7XG4gICAgICAgICAgICAgICAgICAgIE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuaW5pdEZsYWcgPSAyO1xuICAgICAgICAgICAgICAgICAgICBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnN0b3BTZWxsaW5nRGVzYyA9IG1zZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9lbmQg5Lia5YqhXG4gICAgICAgICAgICAgICAgY2FsbEZ1bmMoY21kLCByZXMsIG1zZywgY2FsbE5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8v6IGU572R5aSx6LSlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImh0dHAgc3RhdHVzOlwiICsgeGhyLnN0YXR1cyArIFwifGNhbGxDbWQ9XCIgKyBjYWxsQ21kKTtcbiAgICAgICAgICAgIGNhbGxGdW5jKGNhbGxDbWQsIC0xLCBcIue9kee7nOWPr+iDveS4jeWlveWTpu+8jOivt+mHjeivlVwiLCBjYWxsTm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAq6Kej5p6Q5pyN5Yqh5Zmo6L+U5Zue5pWw5o2uXG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcGFyYW0gY21kXG4gICAgICovXG4gICAgIHBhcnNlclNlcnZlckRhdGEgOiBmdW5jdGlvbihkYXRhLCBjbWQpe1xuICAgICAgICAgLy9nemlw6Kej5Y6LXG4gICAgICAgICAvL2RhdGEgPSBkYXRhO1xuICAgICAgICAgLy9CYXNlNjRcbiAgICAgICAgIC8vZGF0YSA9IEJhc2U2NC5kZWNvZGUoZGF0YSk7XG4gICAgICAgICAvL2Flc+ino+WvhlxuICAgICAgICAgZGF0YSA9IHRoaXMuQUVTRGVjcnlwdChkYXRhLCB0aGlzLmFlc0tleSk7XG4gICAgICAgICB2YXIgaU51bTEgPSBwYXJzZUludChjbWQpO1xuXG4gICAgICAgICBpZihpTnVtMSAhPSAxMDUpe1xuICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGF0YSA9IFwiICsgZGF0YSArIFwiLCBjbWQgPSBcIiArIGNtZCk7XG4gICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgIHN3aXRjaChpTnVtMSl7XG4gICAgICAgICAgICAgY2FzZSAxMDA6e1xuICAgICAgICAgICAgICAgICB0aGlzLnBhcnNlckluaXQoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTAxOntcbiAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZXJCZXQoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTAyOntcbiAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZUNsZWFyKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwMzp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VyUmV3YXJkKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwNDp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VTZWNvbmREYXRhKGRhdGEpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBjYXNlIDEwNTp7XG4gICAgICAgICAgICAgICAgIHRoaXMucGFyc2VUYWJsZShkYXRhKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgY2FzZSAxMDY6e1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VPcmRlckxpc3QoZGF0YSk7XG4gICAgICAgICAgICAgfVxuICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgIGNhc2UgMTA3IDoge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VySGlzdG9yeShkYXRhKTtcbiAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgIH1cbiAgICAgfSxcbiAgICAgXG4gICAgLy9BRVPliqDlr4ZcbiAgICBBRVNFbmNyeXB0aW9uIDogZnVuY3Rpb24gKGRhdGEsIGFlc0tleSkge1xuICAgICAgICB2YXIga2V5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoYWVzS2V5KTtcbiAgICAgICAgdmFyIGl2ICA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKGFlc0tleSk7XG4gICAgICAgIHZhciBzcmNzID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoZGF0YSk7XG4gICAgICAgIHZhciBlbmNyeXB0ZWQgPSBDcnlwdG9KUy5BRVMuZW5jcnlwdChzcmNzLCBrZXksIHsgaXY6IGl2LG1vZGU6Q3J5cHRvSlMubW9kZS5FQ0J9KTtcbiAgICAgICAgcmV0dXJuIGVuY3J5cHRlZC50b1N0cmluZygpO1xuICAgIH0sXG4gICAgXG4gICAgLy9BRVPop6Plr4ZcbiAgICBBRVNEZWNyeXB0IDogZnVuY3Rpb24gKGRhdGEsIGFlc0tleSkge1xuICAgICAgICB2YXIga2V5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UoYWVzS2V5KTtcbiAgICAgICAgdmFyIGl2ICA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKGFlc0tleSk7XG4gICAgICAgIHZhciBkZWNyeXB0ID0gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoZGF0YSwga2V5LCB7IGl2OiBpdixtb2RlOkNyeXB0b0pTLm1vZGUuRUNCfSk7XG4gICAgICAgIHJldHVybiBDcnlwdG9KUy5lbmMuVXRmOC5zdHJpbmdpZnkoZGVjcnlwdCkudG9TdHJpbmcoKTtcbiAgICB9LFxuICAgICBcbiAgICAvKipcbiAgICAgKiDop6PmnpDliJ3lp4vljJZcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqL1xuICAgIHBhcnNlckluaXQgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBuZXREYXRhLmluaXREYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgY2MubG9nKFwibmV0RGF0YS5pbml0RGF0YS5vZGRzTGlzdCBcIiwgbmV0RGF0YS5pbml0RGF0YS5vZGRzTGlzdCk7XG4gICAgICAgIG5ldERhdGEuc2Vzc2lvbiA9IG5ldERhdGEuaW5pdERhdGEuc2Vzc2lvbjtcbiAgICAgICAgbmV0RGF0YS5wZXJpb2RJZCA9IG5ldERhdGEuaW5pdERhdGEucGVyaW9kSWQ7XG4gICAgICAgIG5ldERhdGEudGlja2V0Tm8gPSBuZXREYXRhLmluaXREYXRhLnRpY2tldE5vO1xuICAgICAgICBuZXREYXRhLmJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaW1pdDtcbiAgICAgICAgbmV0RGF0YS50b3RhbEJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS50b3RhbEJldExpbWl0O1xuXG4gICAgICAgIHZhciBwZXJpb2RFbmRUaW1lID0gbnVsbDtcbiAgICAgICAgaWYobmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMSl7XG4gICAgICAgICAgICBuZXREYXRhLnRpbWVGbGFnID0gMTtcbiAgICAgICAgICAgIHBlcmlvZEVuZFRpbWUgPSBuZXREYXRhLmluaXREYXRhLnBlcmlvZEVuZFRpbWUxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYobmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMyl7XG4gICAgICAgICAgICBuZXREYXRhLnRpbWVGbGFnID0gMjtcbiAgICAgICAgICAgIHBlcmlvZEVuZFRpbWUgPSBuZXREYXRhLmluaXREYXRhLnBlcmlvZEVuZFRpbWUyO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYocGVyaW9kRW5kVGltZSAhPSBudWxsKXtcbiAgICAgICAgICAgIG5ldERhdGEubG90dGVyeUlkID0gbmV0RGF0YS5pbml0RGF0YS5sb3R0ZXJ5SWQ7XG4gICAgICAgICAgICBuZXREYXRhLmxvdHRlcnlJbmRleCA9IG5ldERhdGEuaW5pdERhdGEubG90dGVyeUluZGV4O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGxvY2FsVGltZSA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGxldCBzZXZlclRpbWUgPSBuZXREYXRhLmluaXREYXRhLnNlcnZlclRpbWU7XG4gICAgICAgICAgICBuZXREYXRhLnJlY2VpdmVUaW1lID0gbG9jYWxUaW1lIC0gc2V2ZXJUaW1lO1xuICAgICAgICAgICAgbmV0RGF0YS5zZWNzID0gTWF0aC5mbG9vcigocGVyaW9kRW5kVGltZSAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlY2VpdmVUaW1lPVwiICsgbmV0RGF0YS5yZWNlaXZlVGltZSArIFwifFwiICsgbmV0RGF0YS5zZWNzKTtcbiAgICAgICAgfSAgICAgICAgXG4gICAgICAgIC8vXG4gICAgICAgIG5ldERhdGEuaW5pdEZsYWcgPSAxO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog6Kej5p6Q5oqV5rOoXG4gICAgICovXG4gICAgIHBhcnNlckJldCA6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHZhciBvYmpSb290ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgbmV0RGF0YS5iZXRMaW1pdCA9IG9ialJvb3QuYmV0TGltaXQ7XG4gICAgICAgIG5ldERhdGEudG90YWxCZXRMaW1pdCA9IG9ialJvb3QudG90YWxCZXRMaW1pdDtcbiAgICAgICAgbmV0RGF0YS50aWNrZXRObyA9IG9ialJvb3QudGlja2V0Tm87XG5cblxuICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICBsZXQgc2V2ZXJUaW1lID0gb2JqUm9vdC5zZXJ2ZXJUaW1lO1xuICAgICAgICBsZXQgdG1wID0gbG9jYWxUaW1lIC0gc2V2ZXJUaW1lO1xuXG4gICAgICAgIGlmKHRtcCA8IG5ldERhdGEucmVjZWl2ZVRpbWUpe1xuICAgICAgICAgICAgbmV0RGF0YS5yZWNlaXZlVGltZSA9IHRtcDtcbiAgICAgICAgICAgIG5ldERhdGEuc2VjcyA9IE1hdGguZmxvb3IoKG5ldERhdGEuYmV0RGF0YS5wZXJpb2RFbmRUaW1lIC0gc2V2ZXJUaW1lKSAvIDEwMDAgLSBuZXREYXRhLmJldFRocmVzaG9sZCAtIDMpO1xuICAgICAgICAgICAgY2MubG9nKFwicmVjZWl2ZVRpbWU9XCIgKyBuZXREYXRhLnJlY2VpdmVUaW1lICsgXCJ8XCIgKyBuZXREYXRhLnNlY3MpO1xuICAgICAgICB9XG4gICAgIH0sXG5cbiAgICAgcGFyc2VDbGVhciA6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7IFxuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEudGlja2V0Tm8gPSBcIlwiO1xuICAgICAgICBuZXREYXRhLmJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaW1pdDtcbiAgICAgICAgbmV0RGF0YS50b3RhbEJldExpbWl0ID0gbmV0RGF0YS5pbml0RGF0YS50b3RhbEJldExpbWl0O1xuICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICBsZXQgc2V2ZXJUaW1lID0gb2JqUm9vdC5zZXJ2ZXJUaW1lO1xuICAgICAgICBsZXQgdG1wID0gbG9jYWxUaW1lIC0gc2V2ZXJUaW1lO1xuXG4gICAgICAgIGlmKHRtcCA8IG5ldERhdGEucmVjZWl2ZVRpbWUpe1xuICAgICAgICAgICAgbmV0RGF0YS5yZWNlaXZlVGltZSA9IHRtcDtcbiAgICAgICAgICAgIG5ldERhdGEuc2VjcyA9IE1hdGguZmxvb3IoKG9ialJvb3QucGVyaW9kRW5kVGltZSAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlY2VpdmVUaW1lPVwiICsgbmV0RGF0YS5yZWNlaXZlVGltZSArIFwifFwiICsgbmV0RGF0YS5zZWNzKTtcbiAgICAgICAgfVxuICAgICB9LFxuICAgICBcbiAgICAgLyoqXG4gICAgICAqIOe7k+eul1xuICAgICAgKi9cbiAgICBwYXJzZXJSZXdhcmQgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpOyBcbiAgICAgICAgdmFyIG9ialJvb3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBuZXREYXRhLnJld2FyZERhdGEgPSBvYmpSb290O1xuICAgICAgICAvLyBuZXREYXRhLnJld2FyZERhdGEgPSBKU09OLnBhcnNlKGRhdGEpOyAgICAgIFxuXG4gICAgICAgIG5ldERhdGEucGVyaW9kSWQgPSBuZXREYXRhLnJld2FyZERhdGEubmV4dFBlcmlvZElkO1xuICAgICAgICBuZXREYXRhLnRpbWVGbGFnID0gbmV0RGF0YS5yZXdhcmREYXRhLm5leHRUaW1lRmxhZztcblxuICAgICAgICBpZihvYmpSb290LnBlcmlvZEVuZFRpbWUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIHZhciB0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgbGV0IHNldmVyVGltZSA9IG9ialJvb3Quc2VydmVyVGltZTtcbiAgICAgICAgICAgIG5ldERhdGEucmVjZWl2ZVRpbWUgPSBsb2NhbFRpbWUgLSBzZXZlclRpbWU7XG4gICAgICAgICAgICBuZXREYXRhLnNlY3MgPSBNYXRoLmZsb29yKChvYmpSb290LnBlcmlvZEVuZFRpbWUgLSBzZXZlclRpbWUpIC8gMTAwMCAtIG5ldERhdGEuYmV0VGhyZXNob2xkIC0gMyk7XG4gICAgICAgICAgICBjYy5sb2coXCJyZWNlaXZlVGltZT1cIiArIG5ldERhdGEucmVjZWl2ZVRpbWUgKyBcInxcIiArIG5ldERhdGEuc2Vjcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGFyc2VUYWJsZSA6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIHZhciB0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGxldCBsb2NhbFRpbWUgPSB0ZS5nZXRUaW1lKCk7XG4gICAgICAgIGxldCBzZXZlclRpbWUgPSBvYmpSb290LnNlcnZlclRpbWU7XG4gICAgICAgIGxldCB0bXAgPSBsb2NhbFRpbWUgLSBzZXZlclRpbWU7XG5cbiAgICAgICAgaWYodG1wIDwgbmV0RGF0YS5yZWNlaXZlVGltZSl7XG4gICAgICAgICAgICBuZXREYXRhLnJlY2VpdmVUaW1lID0gdG1wOyBcbiAgICAgICAgICAgIG5ldERhdGEuc2VjcyA9IE1hdGguZmxvb3IoKG9ialJvb3QucGVyaW9kRW5kVGltZSAtIHNldmVyVGltZSkgLyAxMDAwIC0gbmV0RGF0YS5iZXRUaHJlc2hvbGQgLSAzKTtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlY2VpdmVUaW1lPVwiICsgbmV0RGF0YS5yZWNlaXZlVGltZSArIFwifFwiICsgbmV0RGF0YS5zZWNzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v6Kej5p6QbGlzdFxuICAgICAgICBuZXREYXRhLnRhYmxlQXJyYXkgPSBbXTtcbiAgICAgICAgbmV0RGF0YS50YWJsZUFycmF5ID0gb2JqUm9vdC5saXN0O1xuICAgIH0sXG5cbiAgICBwYXJzZVNlY29uZERhdGEgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEuc2Vjb25kRGF0YSA9IG9ialJvb3Q7XG4gICAgICAgIG5ldERhdGEudGltZUZsYWcgPSAyO1xuICAgICAgICAvKlxuICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9jYWxUaW1lID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICBsZXQgc2V2ZXJUaW1lID0gb2JqUm9vdC5zZXJ2ZXJUaW1lO1xuICAgICAgICBsZXQgdG1wID0gbG9jYWxUaW1lIC0gc2V2ZXJUaW1lO1xuXG4gICAgICAgIGlmKHRtcCA8IG5ldERhdGEucmVjZWl2ZVRpbWUpe1xuICAgICAgICAgICAgbmV0RGF0YS5yZWNlaXZlVGltZSA9IHRtcDsgXG4gICAgICAgICAgICBuZXREYXRhLnNlY3MgPSBNYXRoLmZsb29yKChvYmpSb290LnBlcmlvZEVuZFRpbWUgLSBzZXZlclRpbWUpIC8gMTAwMCAtIG5ldERhdGEuYmV0VGhyZXNob2xkIC0gMyk7XG4gICAgICAgICAgICBjYy5sb2coXCJyZWNlaXZlVGltZT1cIiArIG5ldERhdGEucmVjZWl2ZVRpbWUgKyBcInxcIiArIG5ldERhdGEuc2Vjcyk7XG4gICAgICAgIH1cbiAgICAgICAgKi9cbiAgICB9LFxuXG4gICAgcGFyc2VPcmRlckxpc3QgOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgb2JqUm9vdCA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIG5ldERhdGEub3JkZXJMaXN0ID0gW107XG4gICAgICAgIG5ldERhdGEub3JkZXJMaXN0ID0gb2JqUm9vdC5kYXRhO1xuICAgIH0sXG5cbiAgICBwYXJzZXJIaXN0b3J5IDogZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdmFyIG9ialJvb3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICBuZXREYXRhLmhpc3RvcnlMaXN0ID0gW107XG4gICAgICAgIG5ldERhdGEuaGlzdG9yeUxpc3QgPSBvYmpSb290Lmhpc3RvcnlMaXN0O1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog5Yid5aeL5YyWXG4gICAgICogQHBhcmFtXG4gICAgICogXG4gICAgICovXG4gICAgZ2V0SW5pdCA6IGZ1bmN0aW9uKHNlc3Npb24sIGNhbGxGdW5jLCBzZWxmKXtcbiAgICAgICAgaWYoc2Vzc2lvbiA9PSBudWxsKXtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBcInt9XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgICAgICBvYmouc2Vzc2lvbiA9IHNlc3Npb247XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8v5o+Q5YmN5Yid5aeL5YyWXG4gICAgICAgIE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuaW5pdEZsYWcgPSAwO1xuICAgICAgICAvL+iuvue9ruWRveS7pOWPt++8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB0aGlzLmhlYWRlckNtZCA9IDEwMDtcbiAgICAgICAgLy/or7fmsYLnvZHnu5xcbiAgICAgICAgdGhpcy5yZXF1ZXN0KGNhbGxGdW5jLCBzZWxmKTtcbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIOaKleazqFxuICAgICAqIEBwYXJhbSB0aWNrZXRfbm8g6K6i5Y2V5Y+377yM6aaW5qyh5oqV5rOo5Li656m6XG4gICAgICogQHBhcmFtIHN0ZXAg5q2l5pWwXG4gICAgICogQFBhcm1hIHRyYW5zX2RhdGEg5pWw5o2u5Lqk5LqSXG4gICAgICovXG4gICAgZ2V0QmV0IDogZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBcIlwiO1xuICAgICAgICAvL+aLvOaIkGpzb27kuLLvvIzmr4/kuKror7fmsYLpg73kuI3kuIDmoLdcbiAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgb2JqLnRpZCA9IHRlLmdldFRpbWUoKS50b1N0cmluZygpO1xuICAgICAgICB0ZSA9IG51bGw7XG4gICAgICAgIG9iai5iZXRMaXN0ID0gbmV0RGF0YS5yZXFCZXRMaXN0O1xuICAgICAgICBvYmoucGVyaW9kSWQgPSBuZXREYXRhLnBlcmlvZElkO1xuICAgICAgICBvYmoudGltZUZsYWcgPSBuZXREYXRhLnRpbWVGbGFnO1xuICAgICAgICBvYmouc2Vzc2lvbiA9IG5ldERhdGEuc2Vzc2lvbjtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gICAgICAgIG9iaiA9IG51bGw7XG4gICAgICAgIC8v6K6+572u5ZG95Luk5Y+377yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTAxO1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH0sXG5cbiAgICBnZXRDbGVhciA6IGZ1bmN0aW9uKGNhbGxGdW5jLCBzZWxmKSB7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIC8v5ou85oiQanNvbuS4su+8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBvYmoucGVyaW9kSWQgPSBuZXREYXRhLnBlcmlvZElkO1xuICAgICAgICBvYmouc2Vzc2lvbiA9IG5ldERhdGEuc2Vzc2lvbjtcbiAgICAgICAgb2JqLnRpbWVGbGFnID0gbmV0RGF0YS50aW1lRmxhZztcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7IFxuICAgICAgICBvYmogPSBudWxsO1xuICAgICAgICAvL+iuvue9ruWRveS7pOWPt++8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB0aGlzLmhlYWRlckNtZCA9IDEwMjtcbiAgICAgICAgLy/or7fmsYLnvZHnu5xcbiAgICAgICAgdGhpcy5yZXF1ZXN0KGNhbGxGdW5jLCBzZWxmKTtcbiAgICB9LFxuICAgICBcbiAgICAvKipcbiAgICAgKiDnu5PnrpdcbiAgICAgKiBAcGFyYW0gdGlja2V0X25vIOiuouWNleWPt1xuICAgICAqL1xuICAgIGdldFJld2FyZCA6IGZ1bmN0aW9uKGNhbGxGdW5jLCBzZWxmKXtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIC8v5ou85oiQanNvbuS4su+8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBvYmoucGVyaW9kSWQgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnBlcmlvZElkO1xuICAgICAgICBvYmouc2Vzc2lvbiA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuc2Vzc2lvbjtcbiAgICAgICAgb2JqLnRpY2tldE5vID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS50aWNrZXRObztcblxuICAgICAgICAvLyBvYmoudWlkcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBvYmoudWlkcyA9IFsxMiwgMTIzXTtcbiAgICAgICAgLy8gZm9yKGxldCBpID0gMDsgaSA8IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkudGFibGVBcnJheS5sZW5ndGgoKTsgKytpKXtcbiAgICAgICAgLy8gICAgIG9iai51aWRzLnB1c2goTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS50YWJsZUFycmF5W2ldLnVpZCk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBKU09OLnN0cmluZ2lmeShvYmopOyBcbiAgICAgICAgb2JqID0gbnVsbDtcbiAgICAgICAgLy/orr7nva7lkb3ku6Tlj7fvvIzmr4/kuKror7fmsYLpg73kuI3kuIDmoLdcbiAgICAgICAgdGhpcy5oZWFkZXJDbWQgPSAxMDM7XG4gICAgICAgIC8v6K+35rGC572R57ucXG4gICAgICAgIHRoaXMucmVxdWVzdChjYWxsRnVuYywgc2VsZik7XG4gICAgfSxcblxuICAgIGdldFRhYmxlIDogZnVuY3Rpb24oIGNhbGxGdW5jLCBzZWxmKSB7XG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBcIlwiO1xuICAgICAgICAvL+aLvOaIkGpzb27kuLLvvIzmr4/kuKror7fmsYLpg73kuI3kuIDmoLdcbiAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgb2JqLmxpc3QgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnRhYmxlQXJyYXk7XG4gICAgICAgIG9iai5wZXJpb2RJZCA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkucGVyaW9kSWQ7IFxuICAgICAgICBvYmouc2Vzc2lvbiA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuc2Vzc2lvbjtcbiAgICAgICAgb2JqLnRpbWVGbGFnID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKS50aW1lRmxhZztcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gICAgICAgIG9iaiA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTA1O1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDojrflj5bkuozpmLbmrrXmlbDmja5cbiAgICAgKi9cbiAgICBnZXRTZWNvbmREYXRhICA6ZnVuY3Rpb24oY2FsbEZ1bmMsIHNlbGYpe1xuICAgICAgICB0aGlzLnJlcXVlc3REYXRhID0gXCJcIjtcbiAgICAgICAgLy/mi7zmiJBqc29u5Liy77yM5q+P5Liq6K+35rGC6YO95LiN5LiA5qC3XG4gICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIG9iai5wZXJpb2RJZCA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkucGVyaW9kSWQ7IFxuICAgICAgICBvYmouc2Vzc2lvbiA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuc2Vzc2lvbjtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gICAgICAgIG9iaiA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTA0O1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH0sXG5cbiAgICBnZXRPcmRlckxpc3QgOiBmdW5jdGlvbihjYWxsRnVuYywgc2VsZil7XG4gICAgICAgIHRoaXMucmVxdWVzdERhdGEgPSBcIlwiO1xuICAgICAgICB0aGlzLmhlYWRlckNtZCA9IDEwNjtcbiAgICAgICAgLy/or7fmsYLnvZHnu5xcbiAgICAgICAgdGhpcy5yZXF1ZXN0KGNhbGxGdW5jLCBzZWxmKTsgICAgICAgIFxuICAgIH0sXG5cbiAgICBnZXRIaXN0b3J5ICA6IGZ1bmN0aW9uKGNhbGxGdW5jLCBzZWxmKXtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IFwiXCI7XG4gICAgICAgIC8v5ou85oiQanNvbuS4su+8jOavj+S4quivt+axgumDveS4jeS4gOagt1xuICAgICAgICB2YXIgb2JqID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBvYmouc2Vzc2lvbiA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCkuc2Vzc2lvbjtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RGF0YSA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gICAgICAgIG9iaiA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVhZGVyQ21kID0gMTA3O1xuICAgICAgICAvL+ivt+axgue9kee7nFxuICAgICAgICB0aGlzLnJlcXVlc3QoY2FsbEZ1bmMsIHNlbGYpO1xuICAgIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBEYXRhT3BlciA6IERhdGFPcGVyXG59OyIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcbiAgICAgICAgfSxcbiAgICAgICAgLy8gZGVmYXVsdHMsIHNldCB2aXN1YWxseSB3aGVuIGF0dGFjaGluZyB0aGlzIHNjcmlwdCB0byB0aGUgQ2FudmFzXG4gICAgICAgIHRleHQ6ICdIZWxsbywgV29ybGQhJ1xuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHJpbmcgPSB0aGlzLnRleHQ7XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZVxuICAgIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICB9LFxufSk7XG4iLCJ2YXIgTmV0RGF0YSA9IHJlcXVpcmUoXCJOZXREYXRhXCIpO1xudmFyIEdhbWUgPSByZXF1aXJlKFwiZ2FtZVwiKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy/muLjmiI/luK7liqlcbiAgICAgICAgdWlCbGFjayA6IGNjLk5vZGUsXG4gICAgICAgIHRlc3ROb2RlIDogY2MuTm9kZSxcbiAgICAgICAgc2Nyb2xsVmlldzogY2MuTm9kZSxcbiAgICAgICAgY29udGVudDogY2MuTm9kZSxcbiAgICAgICAgdmlldzogY2MuTm9kZSxcbiAgICAgICAgbG9jayA6IGZhbHNlLFxuICAgICAgICBnYW1lTm9kZTogY2MuTm9kZSxcbiAgICAgICAgaW1nQXJyYXkgOiBbY2MuU3ByaXRlXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHRoaXMubG9jayA9IHRydWU7XG4gICAgICAgIGxldCBvcmlQMSA9IHRoaXMudGVzdE5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLnYyKDAsIDApKTtcbiAgICAgICAgdGhpcy5vcmlZID0gdGhpcy50ZXN0Tm9kZS55IC0gb3JpUDEueTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIm9yaVk9XCIgKyB0aGlzLm5vZGUueSArIFwifFwiICsgb3JpUDEueSk7ICAgICAgICBcblxuICAgICAgICB2YXIgY2FsbEZ1bmNfMSA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5sb2NrID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc2UgPSBjYy5kaXJlY3Rvci5nZXRXaW5TaXplKCk7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuaGVpZ2h0ID0gc2UuaGVpZ2h0ICogMC44O1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmdldENoaWxkQnlOYW1lKFwidmlld1wiKS5oZWlnaHQgPSB0aGlzLnNjcm9sbFZpZXcuaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IHRoaXMuc2Nyb2xsVmlldy5oZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLm5vZGUueSA9IHRoaXMub3JpWSAtIHRoaXMuc2Nyb2xsVmlldy5oZWlnaHQ7ICAgIFxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm55PVwiICsgdGhpcy5ub2RlLnkpO1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLmRlbGF5VGltZSgwLjEpLCBjYWxsRnVuY18xKSk7XG5cbiAgICAgICAgdGhpcy51aUJsYWNrLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbG9zZTogZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoIXRoaXMubG9jayl7XG4gICAgICAgICAgICB0aGlzLnVpQmxhY2suYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxldCBjYWxsMyA9IGNjLmNhbGxGdW5jKGZ1bmN0aW9uKClcbiAgICAgICAgICAgIHsgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLm5ldERhdGEuaGVscFNob3dGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5tb3ZlVG8oMC4zLCBjYy52MigwLCB0aGlzLm9yaVkgLSB0aGlzLnNjcm9sbFZpZXcuaGVpZ2h0KSksIGNhbGwzKSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZG93bkhlbHA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbGV0IHNwdCA9IHRoaXMuZ2FtZU5vZGUuZ2V0Q29tcG9uZW50KEdhbWUpO1xuICAgICAgICBzcHQuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICBsZXQgcmggPSAwO1xuICAgICAgICBcbiAgICAgICAgY2MubG9hZGVyLmxvYWQodGhpcy5uZXREYXRhLnJ1bGVQaWNzLCBudWxsLCBmdW5jdGlvbiAoZXJyb3JzLCByZXN1bHRzKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlcnJvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHVybCBbJyArIGVycm9yc1tpXSArICddOiAnICsgcmVzdWx0cy5nZXRFcnJvcihlcnJvcnNbaV0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjYy5sb2coXCJyZXN1bHRzIGlzICUlIFwiLCByZXN1bHRzLmdldENvbnRlbnQubGVuZ3RoKTtcbiAgICAgICAgICAgIGxldCBsZW4gPSBzZWxmLm5ldERhdGEucnVsZVBpY3MubGVuZ3RoO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspeyAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhVGV4ID0gcmVzdWx0cy5nZXRDb250ZW50KHNlbGYubmV0RGF0YS5ydWxlUGljc1tpXSk7IFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYubmV0RGF0YS5ydWxlUGljc1tpXSArIFwifFwiICsgYVRleCk7XG4gICAgICAgICAgICAgICAgbGV0IHNmID0gbmV3IGNjLlNwcml0ZUZyYW1lKCk7XG4gICAgICAgICAgICAgICAgc2Yuc2V0VGV4dHVyZShhVGV4KTtcbiAgICAgICAgICAgICAgICBzZWxmLmltZ0FycmF5W2ldLnNwcml0ZUZyYW1lID0gc2Y7XG4gICAgICAgICAgICAgICAgcmggKz0gc2VsZi5pbWdBcnJheVtpXS5ub2RlLmhlaWdodDtcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJoZWlnaHQgaXMgJCQkIFwiLCBzZWxmLmltZ0FycmF5W2ldLm5vZGUuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAvL+aUr+aMgeWkmuW8oOWbvuaOkueJiO+8iDIwMTctMDMtMjcgcG3vvJo1MjDvvIlcbiAgICAgICAgICAgICAgICBpZihpID4gMCl7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBpIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGh0ID0gc2VsZi5pbWdBcnJheVtpbmRleF0ubm9kZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW1nQXJyYXlbaV0ubm9kZS55ICA9IHNlbGYuaW1nQXJyYXlbaW5kZXhdLm5vZGUueSAtIGh0ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2MubG9nKFwiaGVpZ2h0IGlzICQkJCBcIiwgaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZihsZW4gPT0gMil7XG4gICAgICAgICAgICAvLyAgICAgbGV0IGh0ID0gc2VsZi5pbWdBcnJheVswXS5ub2RlLmhlaWdodDtcbiAgICAgICAgICAgIC8vICAgICBzZWxmLmltZ0FycmF5WzFdLm5vZGUueSA9IC1odDtcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgc2VsZi5jb250ZW50LmhlaWdodCA9IHJoO1xuICAgICAgICAgICAgc3B0LmhpZGVXYWl0TGF5ZXIoKTtcbiAgICAgICAgICAgIHNlbGYuaW5pdEhlbHAoKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGluaXRIZWxwOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZighdGhpcy5sb2NrKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaW5pdEhlbHBcIik7XG4gICAgICAgICAgICB0aGlzLm5ldERhdGEuaGVscFNob3dGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubG9jayA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLnNjcm9sbFRvT2Zmc2V0KGNjLnAoMCwwKSwgMC4xKTtcbiAgICAgICAgICAgIGxldCBjYWxsYmFjayA9IGNjLmNhbGxGdW5jKHRoaXMuc2VsZWN0U2hvd0NhbGxCYWNrLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoY2MubW92ZVRvKDAuMywgY2MucCgwLCB0aGlzLm9yaVkpKSwgY2FsbGJhY2spKTtcbiAgICAgICAgfSAgICAgICAgXG4gICAgfSxcblxuICAgIHNlbGVjdFNob3dDYWxsQmFjazpmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB0aGlzLnVpQmxhY2suYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2NrID0gZmFsc2U7XG4gICAgfSxcbn0pO1xuIiwidmFyIERhdGFPcGVyID0gcmVxdWlyZShcIkRhdGFPcGVyXCIpO1xudmFyIE5ldERhdGEgPSByZXF1aXJlKFwiTmV0RGF0YVwiKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIC8qY3RvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIFxuICAgIH0sKi9cblxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmICghQ0NfSlNCICYmIHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjYXNpbm86aW5pdCcsIGZ1bmN0aW9uKGUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKjIwMTcwNTA55ZyoMS40LjLkv67mlLnojrflj5ZnYW1lVG9rZW4qKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgICAgICAgICBkYXRhT3Blci5nYW1lVG9rZW4gPSBlLmRhdGEuYWNjZXNzVG9rZW47XG4gICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKGRhdGFPcGVyLmdhbWVUb2tlbiA9PT0gbnVsbCl7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBkYXRhT3Blci5nYW1lVG9rZW4gPSBcIjI2YTA5Y2EwNTJkNGM3ZGNkZTEzNDQ5YmExYjczNWRmLTExLTExNTEtMTA1MVwiO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdG9rID0gZGF0YU9wZXIuR2V0UXVlcnlTdHJpbmcoXCJ0b2tcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYodG9rKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPcGVyLmhlYWRlclRva2VuID0gdG9rO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0b2s9XCIgKyBkYXRhT3Blci5oZWFkZXJUb2tlbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFPcGVyLmhlYWRlclRva2VuID0gXCIwXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy90ZXN0c3Nzc3Nzc1xuICAgICAgICAgICAgICAgICAgICAvKnZhciBteURhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlclRva2VuID0gbXlEYXRlLmdldFRpbWUoKTsqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgXG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMuZ2FtZVRva2VuID0gXCIgKyBkYXRhT3Blci5nYW1lVG9rZW4pO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGhpcy5oZWFkZXJUb2tlbiA9IFwiICsgZGF0YU9wZXIuaGVhZGVyVG9rZW4pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioyMDE3MDUwOeWcqDEuNC4y5L+u5pS56I635Y+WZ2FtZVRva2VuICoqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIFxuICAgICAgICAgICAgICAgIHNlbGYuZmV0Y2goZnVuY3Rpb24oaXNFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpc0Vycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWQiOW5tui1hOa6kFxuICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5tZXJnZVJlc291cmNlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmmL7npLogbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5pbml0TG9hZGluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDov5DooYzmuLjmiI9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREsucnVuR2FtZSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREsuc2hvd0Vycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5mZXRjaCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGZldGNoOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlZlcnNpb25OOjIwMTcwNTI1MTIwMFwiKTtcbiAgICAgICAgY2MubG9nKFwiZmV0Y2hcIik7XG4gICAgICAgIHRoaXMuaW5pdERhdGEgPSB7fTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgIGRhdGFPcGVyLmdldEluaXQobnVsbCwgZnVuY3Rpb24oY21kLCByZXMsIG1zZywgc2VsZikge1xuICAgICAgICAgICAgLy8g5Yik5pat5piv5ZCm5oiQ5Yqf5bm25a2Y5YKo5Yid5aeL5YyWXG4gICAgICAgICAgICB2YXIgaXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvL+avj+aXpSoqKirmuLjmiI/mmoLlgZzov5DokKXvvIjlrqLmiLfnq6/lpITnkIbvvIlcbiAgICAgICAgICAgIGlmKHJlcyA9PSAxMDAwMDcpe1xuICAgICAgICAgICAgICAgIGlzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYocmVzICE9IDApe1xuICAgICAgICAgICAgICAgIGlzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAvLyBpZihOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpLnN0YXR1cyA9PSAxKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIHRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgc2VsZi50aW1lU3RhbXAgPSB0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgLy8gICAgIGNjLmxvZyhcInRpbWVTdGFtcCBpcyBcIiwgc2VsZi50aW1lU3RhbXApO1xuICAgICAgICAgICAgICAgIC8vIH0gXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYudGltZVN0YW1wID0gdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJ0aW1lU3RhbXAgaXMgXCIsIHNlbGYudGltZVN0YW1wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2MubG9nKCdmZXRjaCBpbml0IGRhdGEnKTtcbiAgICAgICAgICAgIGNjLmxvZyhjbWQsIHJlcywgbXNnKTtcbiAgICAgICAgICAgIHNlbGYuaW5pdERhdGEuY21kID0gY21kO1xuICAgICAgICAgICAgc2VsZi5pbml0RGF0YS5yZXMgPSByZXM7XG4gICAgICAgICAgICBzZWxmLmluaXREYXRhLm1zZyA9IG1zZztcbiAgICAgICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGlzRXJyb3IpO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICB9LFxufSk7XG4iLCJcbnZhciBOZXREYXRhID0gY2MuQ2xhc3Moe1xuICAgIHN0YXRpY3MgOiB7XG4gICAgICAgIGdfSW5zdCA6IG51bGwsXG4gICAgICAgIHNfaW5kZXggOiAwLFxuICAgICAgICBcbiAgICAgICAgZ2V0SW5zdDpmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihOZXREYXRhLmdfSW5zdCA9PT0gbnVsbClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBOZXREYXRhLmdfSW5zdCA9IG5ldyBOZXREYXRhKCk7XG4gICAgICAgICAgICAgICAgTmV0RGF0YS5nX0luc3QuaW5pdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5ldERhdGEuZ19JbnN0O1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVzdG9yeUluc3Q6ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoTmV0RGF0YS5nX0luc3QgIT09IG51bGwpe1xuICAgICAgICAgICAgICAgIE5ldERhdGEuZ19JbnN0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvL+ivt+axguWPguaVsFxuICAgICAgICByZXFCZXRMaXN0IDogW10sLy/mipXms6jmlbDmja5cblxuXG5cblxuICAgICAgICAvL+WTjeW6lFxuICAgICAgICB0aW1lRmxhZyA6IDEsLy/mipXms6jpmLbmrrUgMS3nrKzkuIDpmLbmrrUgIDIt56ys5LqM6Zi25q61XG4gICAgICAgIHNlc3Npb24gOiBudWxsLFxuICAgICAgICBwZXJpb2RJZCA6IDEsLy/mnJ/mrKFcbiAgICAgICAgcmVjZWl2ZVRpbWUgOiAwLC8v5o6l5pS25pe26Ze05beuXG4gICAgICAgIHNlY3MgOiAwLC8v5b2p5pyf5Ymp5L2Z56eS5pWwXG4gICAgICAgIGJldFRocmVzaG9sZCA6IDMsXG4gICAgICAgIHRpY2tldE5vIDogXCJcIiwvL+iuouWNleWPt1xuICAgICAgICBiZXRMaW1pdCA6IDAsLy/mipXms6jpmZDpop1cbiAgICAgICAgdG90YWxCZXRMaW1pdCA6IDAsLy/mgLvmipXms6jpmZDpop1cblxuICAgICAgICB0YWJsZUFycmF5IDogW10sLy/lkIzmoYzkurpcbiAgICAgICAgaW5pdERhdGEgOiBudWxsLC8v5Yid5aeL5YyWZGF0YVxuICAgICAgICByZXdhcmREYXRhIDogbnVsbCwvL+e7k+eul2RhdGFcbiAgICAgICAgc2Vjb25kRGF0YSA6IG51bGwsLy/nrKzkuozpmLbmrrXmlbDmja5kYXRhXG4gICAgICAgIGhpc3RvcnlMaXN0IDogW10sLy/ljoblj7LotbDlir9cbiAgICAgICAgb3JkZXJMaXN0IDogW10sLy/orqLljZVkYXRhXG5cbiAgICAgICAgLy9zZGsgICAgICAgIFxuICAgICAgICBpbml0RmxhZyA6IDAgLy/mj5DliY3liJ3lp4vljJYgMDrmsqHlpb0gIDE65aW95LqGIDIu5YGc5ZSuXG4gICAgfSxcbiAgICBcbiAgICBpbml0IDogZnVuY3Rpb24oKXtcblxuICAgIH0sXG5cbiAgICBjbGVhcjogZnVuY3Rpb24oKXtcbiAgICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIE5ldERhdGEgOiBOZXREYXRhXG59O1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCl7XG4gICAgICAgICAgICAvL+S4jeWGjea0vuWPkeS6i+S7tlxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgIGlmKHRoaXMub2JqICE9IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZ1bih0aGlzLm9iaik7XG4gICAgICAgICAgICAgICAgdGhpcy5vYmogPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5mdW4gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sdGhpcyk7XG4gICAgfSxcblxuICAgIGluaXQ6IGZ1bmN0aW9uKG9iaiwgZnVuKXtcbiAgICAgICAgdGhpcy5vYmogPSBvYmo7XG4gICAgICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIH0sXG4gICAgXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwidmFyIE5ldERhdGEgPSByZXF1aXJlKFwiTmV0RGF0YVwiKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgXG4gICAgICAgIHB1a2VIaWdoTGlnaHROb2RlQXJyYXk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBiZXRIaWdoTGlnaHRMYXllcjpjYy5Ob2RlLFxuICAgICAgICBcbiAgICAgICAgc2VsZkNoaXBOb2RlOntcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBvdGhlcnNQb3NpdGlvbk5vZGU6Y2MuTm9kZSxcbiAgICAgICAgXG4gICAgICAgIHBva2Vyc05vZGU6e1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG5vUG9rZXJzTm9kZTp7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgaGlzdG9yeXNMaXN0Tm9kZTp7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXSBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIG9kZHNMYWJlbDpjYy5Ob2RlLFxuICAgICAgICBcbiAgICAgICAgcG9rZXJOYW1lTm9kZTpjYy5Ob2RlLFxuICAgICAgICBcbiAgICAgICAgcG9rZXJOb1RvdWNoTGF5ZXI6Y2MuTm9kZSxcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbnMgOiBcIlwiLC8v6YCJ6aG56K+05piOXG4gICAgICAgIC8v5Yq/5YqbXG4gICAgICAgIHBvd2VyRmxhZyA6IHRydWUsLy/mmK/lkKblir/liptcbiAgICAgICAgcG93ZXJJZCA6IDAsLy/lir/liptpZFxuICAgICAgICBwb2NrZXJzIDogW10sLy/niYzlnotcbiAgICAgICAgaGlzdG9yeXMgOiBbXSwvL+iDnOi0n+i1sOWKv1xuXG4gICAgICAgIC8v5oqV5rOo6aG5XG4gICAgICAgIGJldEZsYWcgOiB0cnVlLC8v5piv5ZCm5oqV5rOo6aG5XG4gICAgICAgIGJldElkIDogMCwvL+aKleazqOmhuWlkXG4gICAgICAgIG9kZHMxIDogMSwvL+S4gOmYtuautei1lOeOh1xuICAgICAgICBvZGRzMiA6IDEsLy/kuozpmLbmrrXotZTnjodcbiAgICAgICAgb2RkVHlwZSA6IDAsLy/otZTnjoflj5jljJbnsbvlnosgIDAt6ZmN5L2OICAxLeS4iuWNhyAgMi3kuI3lj5hcbiAgICAgICAgYmV0U3RhdHVzIDogMSwvL+aYr+WQpuWPr+aKleazqCwgMS3lj6/mipUgMC3kuI3lj6/mipVcbiAgICAgICAgYmV0TnVtVG90YWwxIDogMCwvL+esrOS4gOmYtuauteaAu+aKleazqOminVxuICAgICAgICBiZXROdW1Ub3RhbDIgOiAwLC8v56ys5LqM6Zi25q615oqV5rOo5oC76aKdXG4gICAgICAgIGJldE51bSAgOiAwLC8v5Y2V5qyh5oqV5rOo6aKd77yM55So5LqO6K6w5b2V5oqV5rOo5om55qyh77yM5aSx6LSl55qE6KaB6YCA5Zue5p2lXG4gICAgICAgIGJldExpc3QgOiBbXSwvL+acgOWQjuS4gOasoeaKleazqOWIl+ihqO+8jOeUqOS6juaKleazqO+8jOaKiuaJgOacieaKleazqOmhueeahOi/meS4quaVsOe7hOaUtumbhui1t+adpeWwseaYr+ecn+ato+eahOaKleazqOWIl+ihqFxuICAgICAgICBjaGlwQ29sb3IgOiAwLC8v562556CB6aKc6ImyICAwLSAgMS0gIDItICAzLVxuICAgICAgICBsaWd0aEZsYWcgOiBmYWxzZSwvL+aKleazqOmhueaYr+WQpumrmOS6rlxuXG4gICAgICAgIC8v57uT566X54q25oCBXG4gICAgICAgIHdpbiA6IC0xLCAvLy0xOiDmnKrlvIDlpZYgMTrog5zliKnvvIwwOui0n++8jDI65bmzXG4gICAgICAgIHR5cGVzIDogLTEsLy8tMTog5pyq5byA5aWWIDA65pWj54mM77yMMTrmlaPniYzvvIwyOuWvueWtkO+8jDPvvJrpobrlrZDvvIw0OuWQjOiKse+8jDU65ZCM6Iqx6aG677yMNjrosbnlrZBcbiAgICAgICAgcG9rZXJMaWdodCA6IFtdLC8v5omR5YWL6auY5LquIOepuuS4uuWFqOS4jeS6ru+8jCBbMCwgMSwgMl3lhajkuq7vvIwgWzAsIDJd5Lqu5Lik5LiqXG5cbiAgICAgICAgLy/po57nrbnnoIFcbiAgICAgICAgY2hpcFBvc2l0aW9ucyA6IFtdLC8v5qW85LiLNeS4quetueeggeeahOebuOWvueS9jee9rlxuICAgICAgICBwbGF5ZXJQb3NpdGlvbnMgOiBbXSwvL+eOqeWutuWktOWDj+ebuOWvueS9jee9ru+8jOWMheaLrOiHquW3seeahO+8iOiHquW3seeahOetueeggemjnuWbnu+8iVxuICAgICAgICBjdXJyZW50Q2hpcEluZGV4OiAwLC8v6K6w5b2V5b2T5YmN5oqV5rOo6aKd55qEaW5kZXhcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKGV2ZW50KXtcblxuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgY2MubG9nKFwiVE9VQ0hfRU5EISEhXCIpO1xuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnICYmIHRoaXMuYmV0U3RhdHVzKXtcbiAgICAgICAgICAgICAgICAvL+aKleazqOaTjeS9nO+8jOWbnuiwg+WIsGdhbWXljrvliKTmlq3nmbvlvZXnirbmgIHjgIHkvZnpop3nrYlcbiAgICAgICAgICAgICAgICAgdmFyIG9uRnVuY3Rpb24gPSBjYy5maW5kKCdDYW52YXMnKS5nZXRDb21wb25lbnQoJ2dhbWUnKTtcbiAgICAgICAgICAgICAgICBvbkZ1bmN0aW9uLnBvd2VyQmV0KHRoaXMuYWRkc2VsZkNoaXAsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog6YeN572uaW5mb++8jOS4i+S4gOacn+W8gOWni+aXtuiwg+eUqFxuICAgICAqL1xuICAgIHJlc2V0SW5mbyA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMucG9ja2VycyA9IFtdO1xuICAgICAgICB0aGlzLm9kZFR5cGUgPSAyO1xuICAgICAgICB0aGlzLmJldFN0YXR1cyA9IDE7XG4gICAgICAgIHRoaXMuYmV0TnVtVG90YWwxID0gMDtcbiAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDIgPSAwO1xuICAgICAgICB0aGlzLmJldE51bSA9IDA7XG4gICAgICAgIHRoaXMuYmV0TGlzdCA9IFtdO1xuICAgICAgICB0aGlzLndpbiA9IC0xO1xuICAgICAgICB0aGlzLnR5cGVzID0gLTE7XG4gICAgICAgIHRoaXMucG9rZXJMaWdodCA9IFtdO1xuICAgICAgICB0aGlzLmxpZ3RoRmxhZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiDmm7TmlrDpgInpoblpbmZvXG4gICAgICogQHBhcmFtIHN0YXR1cyAxMDAt5Yid5aeL5YyWICAgMTAxLeaKleazqCAgMTAyLea4heepuuaKleazqCAgMTAzLee7k+eulyAgMTA0LeiOt+WPluS6jOmYtuauteaVsOaNrlxuICAgICAqL1xuICAgIHVwZGF0YUluZm8gOiBmdW5jdGlvbihzdGF0dXMpe1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIFxuICAgICAgICBpZihzdGF0dXMgPT0gMTAwKXtcbiAgICAgICAgICAgIHZhciBpbml0RGF0YSA9IG5ldERhdGEuaW5pdERhdGE7XG4gICAgICAgICAgICBpZih0aGlzLnBvd2VyRmxhZyl7XG4gICAgICAgICAgICAgICAgaWYoaW5pdERhdGEucG9ja2VyTGlzdCl7XG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBpbml0RGF0YS5wb2NrZXJMaXN0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG93ZXJJZCA9PSBpbml0RGF0YS5wb2NrZXJMaXN0W2ldLnBvd2VySWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInRoaXMucG93ZXJJZCBcIiwgdGhpcy5wb3dlcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbml0RGF0YS5wb2NrZXJMaXN0W2ldLnBvY2tlcnMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvY2tlcnMgPSBpbml0RGF0YS5wb2NrZXJMaXN0W2ldLnBvY2tlcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInRoaXMucG9ja2Vyc1wiLCB0aGlzLnBvY2tlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlzID0gaW5pdERhdGEucG9ja2VyTGlzdFtpXS5oaXN0b3J5cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnKXtcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgaW5pdERhdGEub2Rkc0xpc3QubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmJldElkID09IGluaXREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcIm9kZHMyIFwiLCBpbml0RGF0YS5vZGRzTGlzdFtpXS5vZGRzMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBpbml0RGF0YS5vZGRzTGlzdFtpXS5vcHRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMxID0gaW5pdERhdGEub2Rkc0xpc3RbaV0ub2RkczE7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMyID0gaW5pdERhdGEub2Rkc0xpc3RbaV0ub2RkczI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJldFN0YXR1cyA9IGluaXREYXRhLm9kZHNMaXN0W2ldLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy/mipXms6jpop0s55So5LqO5oGi5aSNXG4gICAgICAgICAgICAgICAgaWYoaW5pdERhdGEuYmV0cyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBpbml0RGF0YS5iZXRzLmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluaXREYXRhLmJldHNbaV0uaWQgPT0gdGhpcy5iZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5pdERhdGEuYmV0c1tpXS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDEgPSBpbml0RGF0YS5iZXRzW2ldLnRvdGFsQmV0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJldE51bVRvdGFsMiA9IGluaXREYXRhLmJldHNbaV0udG90YWxCZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEwMSl7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAxMDIpe1xuICAgICAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKXtcbiAgICAgICAgICAgICAgICB0aGlzLmJldE51bVRvdGFsMSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuYmV0TnVtVG90YWwyID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmV0TGlzdCA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEwMyl7XG4gICAgICAgICAgICB2YXIgcmV3YXJkRGF0YSA9IG5ldERhdGEucmV3YXJkRGF0YTtcbiAgICAgICAgICAgIGlmKHRoaXMucG93ZXJGbGFnKXtcbiAgICAgICAgICAgICAgICB2YXIgbG90dGVyeSA9IHJld2FyZERhdGEubG90dGVyeTtcbiAgICAgICAgICAgICAgICB2YXIgaWRzdHJpbmcgPSBcInBvd2VyXCIrIHRoaXMucG93ZXJJZDtcblxuICAgICAgICAgICAgICAgIHZhciBwb2NrZXJzID0gbG90dGVyeS5jYWNoZS5pZHN0cmluZy5wb2NrZXJzO1xuICAgICAgICAgICAgICAgIHRoaXMud2luID0gbG90dGVyeS5jYWNoZS5pZHN0cmluZy53aW47XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlcyA9IGxvdHRlcnkuY2FjaGUuaWRzdHJpbmcudHlwZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5cy5wb3AoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlzLnVuc2hpZnQodGhpcy53aW4pO1xuICAgICAgICAgICAgICAgIHRoaXMucG9ja2Vycy5wdXNoKHBvY2tlcnMpO1xuXG5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBmb3IobGV0IGkgPSAwOyBpIDwgbG90dGVyeS5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICAgICAgLy8gICAgIGlmKGxvdHRlcnlbaV0ucG93ZXJJZCA9PSB0aGlzLnBvd2VySWQpe1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy53aW4gPSBsb3R0ZXJ5W2ldLndpbjtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuaGlzdG9yeXMucG9wKCk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLmhpc3RvcnlzLnVuc2hpZnQodGhpcy53aW4pO1xuXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLnR5cGVzID0gbG90dGVyeVtpXS50eXBlcztcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRoaXMucG9ja2Vycy5wdXNoKGxvdHRlcnlbaV0ucG9ja2VyKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNjLmxvZyhcIjEwMyBwb2NrZXJzIGxlbmd0aCBpcyBcIiwgdGhpcy5wb2NrZXJzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAvL+eJjOWei+mrmOS6rlxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gW107XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBpZih0aGlzLnR5cGVzID09PSAwIHx8IHRoaXMudHlwZXMgPT0gMSl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgLy/mlaPniYzvvIzpg73kuI3kuq5cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGVsc2UgaWYodGhpcy50eXBlcyA9PSAyKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAvL+WvueWtkFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmKHRoaXMucG9ja2Vyc1swXS52YWwgPT0gdGhpcy5wb2NrZXJzWzFdLnZhbCl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMucG9rZXJMaWdodCA9IFswLCAxXTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgZWxzZSBpZih0aGlzLnBvY2tlcnNbMF0udmFsID09IHRoaXMucG9ja2Vyc1syXS52YWwpe1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLnBva2VyTGlnaHQgPSBbMCwgMl07XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5wb2NrZXJzWzFdLnZhbCA9PSB0aGlzLnBvY2tlcnNbMl0udmFsKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5wb2tlckxpZ2h0ID0gWzEsIDJdO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIC8v5a+55a2Q5oqV5rOo6aG56auY5LquXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYodGhpcy5iZXRJZCA9PSA1KXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5saWd0aEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGVsc2UgaWYodGhpcy50eXBlcyA9PSA2KXtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLnBva2VyTGlnaHQgPSBbMCwgMSwgMl07XG5cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAvL+S4ieWQjOWPt+aKleazqOmhuemrmOS6rlxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmKHRoaXMuYmV0SWQgPT0gNil7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMubGlndGhGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHRoaXMucG9rZXJMaWdodCA9IFswLCAxLCAyXTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAvL+WFtuS7lueJjOWei+aKleazqOmhuemrmOS6rlxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmKHRoaXMuYmV0SWQgPT0gNyl7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMubGlndGhGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnKXtcbiAgICAgICAgICAgICAgICAvLyBjYy5sb2coXCJvZGRzMiBcIiwgcmV3YXJkRGF0YS5vZGRzTGlzdFswXS5vZGRzMik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHJld2FyZERhdGEub2Rkc0xpc3QubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5iZXRJZCA9PSByZXdhcmREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcIm9kZHMyIFwiLCByZXdhcmREYXRhLm9kZHNMaXN0W2ldLm9kZHMyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHJld2FyZERhdGEub2Rkc0xpc3RbaV0ub3B0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzMSA9IHJld2FyZERhdGEub2Rkc0xpc3RbaV0ub2RkczE7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHMyID0gcmV3YXJkRGF0YS5vZGRzTGlzdFtpXS5vZGRzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmV0U3RhdHVzID0gcmV3YXJkRGF0YS5vZGRzTGlzdFtpXS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAxMDQpe1xuICAgICAgICAgICAgdmFyIHNlY29uZERhdGEgPSBuZXREYXRhLnNlY29uZERhdGE7XG4gICAgICAgICAgICBpZih0aGlzLnBvd2VyRmxhZyl7XG4gICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHNlY29uZERhdGEucG9ja2VyTGlzdC5sZW5ndGg7ICsraSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG93ZXJJZCA9PSBzZWNvbmREYXRhLnBvY2tlckxpc3RbaV0ucG93ZXJJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvY2tlcnMgPSBzZWNvbmREYXRhLnBvY2tlckxpc3RbaV0ucG9ja2VycztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZih0aGlzLmJldEZsYWcpe1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzZWNvbmREYXRhLm9kZHNMaXN0Lmxlbmd0aDsgKytpKXtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5iZXRJZCA9PSBzZWNvbmREYXRhLm9kZHNMaXN0W2ldLmlkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHNlY29uZERhdGEub2Rkc0xpc3RbaV0ub3B0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/ov5nph4zliKTmlq3kuIDkuIvotZTnjofmmK/lj5jlpKflj5jlsI9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkczEgPSBzZWNvbmREYXRhLm9kZHNMaXN0W2ldLm9kZHMxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzMiA9IHNlY29uZERhdGEub2Rkc0xpc3RbaV0ub2RkczI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm9kZHMyID4gdGhpcy5vZGRzMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRUeXBlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5vZGRzMiA8IHRoaXMub2RkczEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkVHlwZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2RkVHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmV0U3RhdHVzID0gc2Vjb25kRGF0YS5vZGRzTGlzdFtpXS5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgLy/mm7TmlrBVSVxuICAgIHVwZGF0YVVJOmZ1bmN0aW9uKHN0YXR1cylcbiAgICB7XG4gICAgICAgIGlmKHRoaXMucG93ZXJGbGFnKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih0aGlzLnBvY2tlcnMubGVuZ3RoID09IDApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2MubG9nKFwicG9ja2VycyBsZW5ndGggaXMgMFwiKTtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgdGhpcy5ub1Bva2Vyc05vZGUubGVuZ3RoOyBqICsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub1Bva2Vyc05vZGVbal0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICAgICAgICAgIGlmKG5ldERhdGEuaW5pdERhdGEuc3RhdHVzID09IDMgfHwgc3RhdHVzID09IDEwNClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnBvY2tlcnMubGVuZ3RoOyBpICsrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG9ja2Vycy5sZW5ndGggPD0gdGhpcy5wb2tlcnNOb2RlLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vUG9rZXJzTm9kZVtpKzFdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInBvY2tlciBsZW5ndGggaXMgXCIsIHRoaXMucG9ja2Vycy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInBva2Vyc05vZGUgbGVuZ3RoIGlzIFwiLCB0aGlzLnBva2Vyc05vZGUubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJjdXJyZW50IGluZGV4IGlzIFwiLCBpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9rZXJOdW0gPSB0aGlzLnBva2Vyc05vZGVbaSsxXS5nZXRDaGlsZEJ5TmFtZShcIm51bVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW0gPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMucG9ja2Vyc1tpXS52YWwgPT0gMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IFwiQVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMucG9ja2Vyc1tpXS52YWwgPT0gMTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSBcIkpcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLnBvY2tlcnNbaV0udmFsID09IDEyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gXCJRXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5wb2NrZXJzW2ldLnZhbCA9PSAxMylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IFwiS1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSB0aGlzLnBvY2tlcnNbaV0udmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJwb2NrZXIgbnVtIGlzIFwiLCBudW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBva2VyTnVtLnN0cmluZyA9IG51bTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9rZXJUeXBlID0gdGhpcy5wb2tlcnNOb2RlW2krMV0uZ2V0Q2hpbGRCeU5hbWUoXCJ0eXBlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2godGhpcy5wb2NrZXJzW2ldLmNvbG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwi5b+D5b2iXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBcIuiPseW9olwiOyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gXCLmoYPlvaJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwi5qKF6Iqx5b2iXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBva2VyVHlwZS5zdHJpbmcgPSBjb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJwb2NrZXIgY29sb3IgaXMgXCIsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKHN0YXR1cyA9PSAxMDMgfHwgbmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gNSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmKG5ldERhdGEuaW5pdERhdGEuc3RhdHVzIClcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub1Bva2Vyc05vZGVbMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgdmFyIHBva2VyTnVtID0gdGhpcy5wb2tlcnNOb2RlWzBdLmdldENoaWxkQnlOYW1lKFwibnVtXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG51bSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5wb2NrZXJzWzJdLnZhbCA9PSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gXCJBXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5wb2NrZXJzWzJdLnZhbCA9PSAxMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IFwiSlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMucG9ja2Vyc1syXS52YWwgPT0gMTIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW0gPSBcIlFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLnBvY2tlcnNbMl0udmFsID09IDEzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtID0gXCJLXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bSA9IHRoaXMucG9ja2Vyc1syXS52YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBva2VyTnVtLnN0cmluZyA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJwb2NrZXIgbnVtIGlzIFwiLCBudW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2tlclR5cGUgPSB0aGlzLnBva2Vyc05vZGVbMF0uZ2V0Q2hpbGRCeU5hbWUoXCJ0eXBlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2godGhpcy5wb2NrZXJzWzJdLmNvbG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwi5b+D5b2iXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBcIuiPseW9olwiOyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gXCLmoYPlvaJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9IFwi5qKF6Iqx5b2iXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBva2VyVHlwZS5zdHJpbmcgPSBjb2xvcjsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MubG9nKFwicG9ja2VyIGNvbG9yIGlzIFwiLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/pq5jkuq7pq5jkuq7nmoRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5wb2tlckxpZ2h0Lmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IHRoaXMucG9rZXJMaWdodFtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdWtlSGlnaExpZ2h0Tm9kZUFycmF5W2luZGV4XS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICAgICAgaWYodGhpcy5iZXRGbGFnKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHNMYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMub2RkczEgKyBcIuWAjVwiO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9kZHNMYWJlbC5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzTGFiZWwuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLm9kZHMyICsgXCLlgI1cIjtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5vZGRUeXBlID09IDApXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2Rkc0xhYmVsLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwgMCwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLm9kZFR5cGUgPT0gMSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzTGFiZWwuY29sb3IgPSBuZXcgY2MuQ29sb3IoNDUsIDY3LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZGRzTGFiZWwuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjU1LCAyNTUsIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYodGhpcy5wb3dlckZsYWcgJiYgdGhpcy5wb3dlcklkICE9IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuaGlzdG9yeXNMaXN0Tm9kZS5sZW5ndGg7IGkgKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeUljb25Ob2RlID0gdGhpcy5oaXN0b3J5c0xpc3ROb2RlW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmhpc3RvcnlzW2ldID09IDEpLy/og5xcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeUljb25Ob2RlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwgMCwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmhpc3RvcnlzW2ldID09IDApLy/otJ9cbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeUljb25Ob2RlLkNvbG9yID0gbmV3IGNjLkNvbG9yKDQ1LCA2NywgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlLy/lubNcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeUljb25Ob2RlLkNvbG9yID0gbmV3IGNjLkNvbG9yKDI1NSwgMjU1LCAyNTUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgXG4gICAgICAgIGlmKHRoaXMuYmV0RmxhZyAmJiAhdGhpcy5wb3dlckZsYWcpe1xuXG4gICAgICAgICAgICAgICAgaWYodGhpcy5iZXRTdGF0dXMgPT0gMSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9rZXJOb1RvdWNoTGF5ZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9rZXJOb1RvdWNoTGF5ZXIuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYodGhpcy5saWd0aEZsYWcgPT0gdHJ1ZSkvL+S4reWllue7k+aenOmrmOS6rlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iZXRIaWdoTGlnaHRMYXllci5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJldEhpZ2hMaWdodExheWVyLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIC8v6aOe57uT5p6c77yM55uW5oizXG4gICAgcHV0U3RhbXBPbkFjdGlvbjogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgY2MubG9nKFwiZmx5U3RhbXAhISFcIik7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdmFyIHJld2FyZERhdGEgPSBuZXREYXRhLnJld2FyZERhdGE7XG4gICAgICAgIHZhciBjb252ZXJ0Tm9kZSA9IGNjLmZpbmQoXCJDYW52YXMvY29udmVydE5vZGVcIik7XG4gICAgICAgIHZhciBjb252ZXJ0Tm9kZUpTID0gY29udmVydE5vZGUuZ2V0Q29tcG9uZW50KFwiY29udmVydE5vZGVcIik7XG4gICAgICAgIGNvbnZlcnROb2RlSlMuZmx5UmV3YXJkTm9kZShyZXdhcmREYXRhLmxvdHRlcnkud2luLCB0aGlzLnBvd2VySWQpO1xuXG4gICAgICAgIFxuICAgICAgICAvLzEwc+aUtuWbnlxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZSh0aGlzLmdldGJhY2ssIDEuMyk7XG4gICAgfSxcbiAgICBcbiAgICBnZXRiYWNrOiBmdW5jdGlvbigpXG4gICAge1xuICAgICAgICB2YXIgZ2FtZUpTID0gY2MuZmluZChcIkNhbnZhc1wiKS5nZXRDb21wb25lbnQoXCJnYW1lXCIpO1xuICAgICAgICBnYW1lSlMucmV3YXJkRmx5RmluaXNoZWRDYWxsYmFjaygpO1xuICAgIH0sXG4gICAgXG4gICAgLyoqXG4gICAgICog6Ieq5bex5oqV5rOo6aOe562556CBXG4gICAgICogQHBhcmFtIGNoaXBJbmRleCDmpbzkuIvnrbnnoIHnmoRpbmRleFxuICAgICAqL1xuICAgIGFkZHNlbGZDaGlwIDogZnVuY3Rpb24oY2hpcEluZGV4LCBzZWxmKXtcbiAgICAgICAgc2VsZi5jdXJyZW50Q2hpcEluZGV4ID0gY2hpcEluZGV4O1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgIHZhciBiZXQgPSBuZXREYXRhLmluaXREYXRhLmJldExpc3RbY2hpcEluZGV4XTtcblxuICAgICAgICAvL+aKleazqOaAu+mineWPmOWMllxuICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpe1xuICAgICAgICAgICAgc2VsZi5iZXROdW1Ub3RhbDEgKz0gYmV0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBzZWxmLmJldE51bVRvdGFsMiArPSBiZXQ7XG4gICAgICAgIH1cbiAgICAgICAgXG5cbiAgICAgICAgLy/mo4Dmn6XmmK/lkKblt7Lnu4/lrZjlnKjor6XnsbvlnovnrbnnoIFcbiAgICAgICAgdmFyIGV4aXRGbGFnID0gZmFsc2U7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzZWxmLmJldExpc3QubGVuZ3RoOyArK2kpe1xuICAgICAgICAgICAgaWYoc2VsZi5iZXRMaXN0W2ldLmJldCA9PSBiZXQpe1xuICAgICAgICAgICAgICAgIHNlbGYuYmV0TGlzdFtpXS5udW0rKztcbiAgICAgICAgICAgICAgICBleGl0RmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZighZXhpdEZsYWcpe1xuICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgICAgIG9iai5pZCA9IHNlbGYuYmV0SWQ7XG4gICAgICAgICAgICBvYmouYmV0ID0gYmV0O1xuICAgICAgICAgICAgb2JqLm51bSA9IDE7XG4gICAgICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpe1xuICAgICAgICAgICAgICAgIG9iai5vZGRzID0gc2VsZi5vZGRzMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgb2JqLm9kZHMgPSBzZWxmLm9kZHMyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBzZWxmLmJldExpc3QucHVzaChvYmopO1xuICAgICAgICB9XG5cbiAgICAgICAgLy/ot5HliqjnlLvvvIznm67moIfkvY3nva7mmK/kuKrlm7rlrprlgLzvvIzkuIDpmLbmrrXlkozkuozpmLbmrrXliIbliKvlm7rlrprkuIDkuKrnrbnnoIHkvY3nva5cbiAgICAgICAgLy/ot5HlrozliqjnlLvlkI7vvIzmm7TmlrDmipXms6jpop3nmoRsYWJlbFxuICAgICAgICBpZihzZWxmLmJldEZsYWcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBjb252ZXJ0Tm9kZSA9IGNjLmZpbmQoXCJDYW52YXMvY29udmVydE5vZGVcIik7XG4gICAgICAgICAgICB2YXIgY29udmVydE5vZGVKUyA9IGNvbnZlcnROb2RlLmdldENvbXBvbmVudChcImNvbnZlcnROb2RlXCIpO1xuICAgICAgICAgICAgY29udmVydE5vZGVKUy5jaGlwRmx5QWN0aW9uKGJldCwgY2hpcEluZGV4LCBzZWxmLmJldElkLTEsIHRydWUsIHNlbGYpO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgIH0sXG4gICAgXG4gICAgZmx5Q2hpcE5vZGVGaW5pc2hlZDogZnVuY3Rpb24oc2VuZGVyLCBmbGFnKVxuICAgIHtcbiAgICAgICAgdmFyIGZsYWcgPSBmbGFnO1xuICAgICAgICB2YXIgc2VsZiA9IHNlbmRlcjtcbiAgICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgIGlmKGZsYWcpXG4gICAgICAgICB7XG4gICAgICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxmQ2hpcE5vZGVbMF0uYWN0aXZlID0gZmxhZztcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGZDaGlwTm9kZVswXS56SW5kZXggPSA1MDA7XG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gc2VsZi5zZWxmQ2hpcE5vZGVbMF0uZ2V0Q2hpbGRCeU5hbWUoXCJMYWJlbFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHNlbGYuYmV0TnVtVG90YWwxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZkNoaXBOb2RlWzFdLmFjdGl2ZSA9IGZsYWc7XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxmQ2hpcE5vZGVbMV0uekluZGV4ID0gNTAwO1xuICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IHNlbGYuc2VsZkNoaXBOb2RlWzFdLmdldENoaWxkQnlOYW1lKFwiTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgICAgICAgICBsYWJlbC5zdHJpbmcgPSBzZWxmLmJldE51bVRvdGFsMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgIH1cblxuICAgIH0sXG4gICAgXG4gICAgXG4gICAgLyoqXG4gICAgICog6Ieq5bex562556CB6aOe5ZueXG4gICAgICogQHBhcmFtIGNoaXBOdW0gIOmjnuWbnueahOetueeggeaVsOminVxuICAgICAqL1xuICAgIHJlZHVjZVNlbGZDaGlwIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpe1xuICAgICAgICAgICAgdGhpcy5iZXROdW1Ub3RhbDEgLT0gdGhpcy5iZXROdW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHRoaXMuYmV0TnVtVG90YWwyIC09IHRoaXMuYmV0TnVtO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgc2VyID0gbnVsbDtcbiAgICAgICAgaWYobmV0RGF0YS50aW1lRmxhZyA9PSAxKVxuICAgICAgICB7XG4gICAgICAgICAgICBzZXIgPSB0aGlzLnNlbGZDaGlwTm9kZVswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNlciA9IHRoaXMuc2VsZkNoaXBOb2RlWzFdO1xuICAgICAgICB9XG4gICAgICAgIGlmKHNlci5hY3RpdmUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8v5YWI6ZqQ6JePXG4gICAgICAgICAgICBzZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBzZXIuekluZGV4ID0gNTAwO1xuICAgICAgICAgICAgdmFyIGxhYmVsID0gc2VyLmdldENoaWxkQnlOYW1lKFwiTGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcbiAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHRoaXMuYmV0TnVtVG90YWwyO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvL+WGjeaJvuetueeggemjnlxuICAgICAgICAgICAgdmFyIGNvbnZlcnROb2RlID0gY2MuZmluZChcIkNhbnZhcy9jb252ZXJ0Tm9kZVwiKTtcbiAgICAgICAgICAgIHZhciBjb252ZXJ0Tm9kZUpTID0gY29udmVydE5vZGUuZ2V0Q29tcG9uZW50KFwiY29udmVydE5vZGVcIik7XG4gICAgICAgICAgICBjb252ZXJ0Tm9kZUpTLmNoaXBGbHlBY3Rpb24odGhpcy5iZXROdW0sIHRoaXMuY3VycmVudENoaXBJbmRleCwgdGhpcy5iZXRJZC0xLCBmYWxzZSwgdGhpcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiAg5Yqo5L2c6aOe5Zue5p2lXG4gICAgICovXG4gICAgZmx5QmFjazogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5jbGVhclNlbGZDaGlwKCk7XG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiDmuIXnqbrnrbnnoIFcbiAgICAgKi9cbiAgICBjbGVhclNlbGZDaGlwIDogZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpe1xuICAgICAgICAgICAgdGhpcy5iZXROdW0gPSB0aGlzLmJldE51bVRvdGFsMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5iZXROdW0gPSB0aGlzLmJldE51bVRvdGFsMjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZHVjZVNlbGZDaGlwKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOWFtuS7lueOqeWutumjnuetueeggVxuICAgICAqIEBwYXJhbSBzZWF0SW5kZXgg5YW25LuW546p5a625bqn5L2N5Y+3XG4gICAgICovXG4gICAgYWRkT3RoZXJDaGlwIDogZnVuY3Rpb24oc2VhdEluZGV4KXtcblxuICAgIH1cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFuZ2xlID0gMDtcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAgdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgIHRoaXMuYW5nbGUgKz0gZHQgKiAzNjA7XG4gICAgICAgICBcbiAgICAgICAgIGlmKHRoaXMuYW5nbGUgPiAzNjApXG4gICAgICAgICB7XG4gICAgICAgICAgICAgdGhpcy5hbmdsZSAtPSAzNjA7XG4gICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgIHRoaXMubm9kZS5yb3RhdGlvbiA9ICB0aGlzLmFuZ2xlO1xuICAgICB9LFxufSk7XG4iLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTtyZXF1aXJlKFwiLi4vYWVzL21kNVwiKTtyZXF1aXJlKFwiLi4vYWVzL2VuYy1iYXNlNjRcIik7cmVxdWlyZShcIi4uL2Flcy9ldnBrZGZcIik7cmVxdWlyZShcIi4uL2Flcy9jaXBoZXItY29yZVwiKTtyZXF1aXJlKFwiLi4vYWVzL21vZGUtZWNiXCIpOyhmdW5jdGlvbigpe3ZhciBDPUNyeXB0b0pTO3ZhciBDX2xpYj1DLmxpYjt2YXIgQmxvY2tDaXBoZXI9Q19saWIuQmxvY2tDaXBoZXI7dmFyIENfYWxnbz1DLmFsZ287dmFyIFNCT1g9W107dmFyIElOVl9TQk9YPVtdO3ZhciBTVUJfTUlYXzA9W107dmFyIFNVQl9NSVhfMT1bXTt2YXIgU1VCX01JWF8yPVtdO3ZhciBTVUJfTUlYXzM9W107dmFyIElOVl9TVUJfTUlYXzA9W107dmFyIElOVl9TVUJfTUlYXzE9W107dmFyIElOVl9TVUJfTUlYXzI9W107dmFyIElOVl9TVUJfTUlYXzM9W107KGZ1bmN0aW9uKCl7dmFyIGQ9W107Zm9yKHZhciBpPTA7aTwyNTY7aSsrKXtpZihpPDEyOCl7ZFtpXT1pPDwxfWVsc2V7ZFtpXT0oaTw8MSleMjgzfX12YXIgeD0wO3ZhciB4aT0wO2Zvcih2YXIgaT0wO2k8MjU2O2krKyl7dmFyIHN4PXhpXih4aTw8MSleKHhpPDwyKV4oeGk8PDMpXih4aTw8NCk7c3g9KHN4Pj4+OCleKHN4JjI1NSleOTk7U0JPWFt4XT1zeDtJTlZfU0JPWFtzeF09eDt2YXIgeDI9ZFt4XTt2YXIgeDQ9ZFt4Ml07dmFyIHg4PWRbeDRdO3ZhciB0PShkW3N4XSoyNTcpXihzeCoxNjg0MzAwOCk7U1VCX01JWF8wW3hdPSh0PDwyNCl8KHQ+Pj44KTtTVUJfTUlYXzFbeF09KHQ8PDE2KXwodD4+PjE2KTtTVUJfTUlYXzJbeF09KHQ8PDgpfCh0Pj4+MjQpO1NVQl9NSVhfM1t4XT10O3ZhciB0PSh4OCoxNjg0MzAwOSleKHg0KjY1NTM3KV4oeDIqMjU3KV4oeCoxNjg0MzAwOCk7SU5WX1NVQl9NSVhfMFtzeF09KHQ8PDI0KXwodD4+PjgpO0lOVl9TVUJfTUlYXzFbc3hdPSh0PDwxNil8KHQ+Pj4xNik7SU5WX1NVQl9NSVhfMltzeF09KHQ8PDgpfCh0Pj4+MjQpO0lOVl9TVUJfTUlYXzNbc3hdPXQ7aWYoIXgpe3g9eGk9MX1lbHNle3g9eDJeZFtkW2RbeDheeDJdXV07eGlePWRbZFt4aV1dfX19KCkpO3ZhciBSQ09OPVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XTt2YXIgQUVTPUNfYWxnby5BRVM9QmxvY2tDaXBoZXIuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3ZhciBrZXk9dGhpcy5fa2V5O3ZhciBrZXlXb3Jkcz1rZXkud29yZHM7dmFyIGtleVNpemU9a2V5LnNpZ0J5dGVzLzQ7dmFyIG5Sb3VuZHM9dGhpcy5fblJvdW5kcz1rZXlTaXplKzY7dmFyIGtzUm93cz0oblJvdW5kcysxKSo0O3ZhciBrZXlTY2hlZHVsZT10aGlzLl9rZXlTY2hlZHVsZT1bXTtmb3IodmFyIGtzUm93PTA7a3NSb3c8a3NSb3dzO2tzUm93Kyspe2lmKGtzUm93PGtleVNpemUpe2tleVNjaGVkdWxlW2tzUm93XT1rZXlXb3Jkc1trc1Jvd119ZWxzZXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvdy0xXTtpZighKGtzUm93JWtleVNpemUpKXt0PSh0PDw4KXwodD4+PjI0KTt0PShTQk9YW3Q+Pj4yNF08PDI0KXwoU0JPWFsodD4+PjE2KSYyNTVdPDwxNil8KFNCT1hbKHQ+Pj44KSYyNTVdPDw4KXxTQk9YW3QmMjU1XTt0Xj1SQ09OWyhrc1Jvdy9rZXlTaXplKXwwXTw8MjR9ZWxzZXtpZihrZXlTaXplPjYmJmtzUm93JWtleVNpemU9PTQpe3Q9KFNCT1hbdD4+PjI0XTw8MjQpfChTQk9YWyh0Pj4+MTYpJjI1NV08PDE2KXwoU0JPWFsodD4+PjgpJjI1NV08PDgpfFNCT1hbdCYyNTVdfX1rZXlTY2hlZHVsZVtrc1Jvd109a2V5U2NoZWR1bGVba3NSb3cta2V5U2l6ZV1edH19dmFyIGludktleVNjaGVkdWxlPXRoaXMuX2ludktleVNjaGVkdWxlPVtdO2Zvcih2YXIgaW52S3NSb3c9MDtpbnZLc1Jvdzxrc1Jvd3M7aW52S3NSb3crKyl7dmFyIGtzUm93PWtzUm93cy1pbnZLc1JvdztpZihpbnZLc1JvdyU0KXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvd119ZWxzZXt2YXIgdD1rZXlTY2hlZHVsZVtrc1Jvdy00XX1pZihpbnZLc1Jvdzw0fHxrc1Jvdzw9NCl7aW52S2V5U2NoZWR1bGVbaW52S3NSb3ddPXR9ZWxzZXtpbnZLZXlTY2hlZHVsZVtpbnZLc1Jvd109SU5WX1NVQl9NSVhfMFtTQk9YW3Q+Pj4yNF1dXklOVl9TVUJfTUlYXzFbU0JPWFsodD4+PjE2KSYyNTVdXV5JTlZfU1VCX01JWF8yW1NCT1hbKHQ+Pj44KSYyNTVdXV5JTlZfU1VCX01JWF8zW1NCT1hbdCYyNTVdXX19fSxlbmNyeXB0QmxvY2s6ZnVuY3Rpb24oTSxvZmZzZXQpe3RoaXMuX2RvQ3J5cHRCbG9jayhNLG9mZnNldCx0aGlzLl9rZXlTY2hlZHVsZSxTVUJfTUlYXzAsU1VCX01JWF8xLFNVQl9NSVhfMixTVUJfTUlYXzMsU0JPWCl9LGRlY3J5cHRCbG9jazpmdW5jdGlvbihNLG9mZnNldCl7dmFyIHQ9TVtvZmZzZXQrMV07TVtvZmZzZXQrMV09TVtvZmZzZXQrM107TVtvZmZzZXQrM109dDt0aGlzLl9kb0NyeXB0QmxvY2soTSxvZmZzZXQsdGhpcy5faW52S2V5U2NoZWR1bGUsSU5WX1NVQl9NSVhfMCxJTlZfU1VCX01JWF8xLElOVl9TVUJfTUlYXzIsSU5WX1NVQl9NSVhfMyxJTlZfU0JPWCk7dmFyIHQ9TVtvZmZzZXQrMV07TVtvZmZzZXQrMV09TVtvZmZzZXQrM107TVtvZmZzZXQrM109dH0sX2RvQ3J5cHRCbG9jazpmdW5jdGlvbihNLG9mZnNldCxrZXlTY2hlZHVsZSxTVUJfTUlYXzAsU1VCX01JWF8xLFNVQl9NSVhfMixTVUJfTUlYXzMsU0JPWCl7dmFyIG5Sb3VuZHM9dGhpcy5fblJvdW5kczt2YXIgczA9TVtvZmZzZXRdXmtleVNjaGVkdWxlWzBdO3ZhciBzMT1NW29mZnNldCsxXV5rZXlTY2hlZHVsZVsxXTt2YXIgczI9TVtvZmZzZXQrMl1ea2V5U2NoZWR1bGVbMl07dmFyIHMzPU1bb2Zmc2V0KzNdXmtleVNjaGVkdWxlWzNdO3ZhciBrc1Jvdz00O2Zvcih2YXIgcm91bmQ9MTtyb3VuZDxuUm91bmRzO3JvdW5kKyspe3ZhciB0MD1TVUJfTUlYXzBbczA+Pj4yNF1eU1VCX01JWF8xWyhzMT4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczI+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMyYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0MT1TVUJfTUlYXzBbczE+Pj4yNF1eU1VCX01JWF8xWyhzMj4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczM+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMCYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mj1TVUJfTUlYXzBbczI+Pj4yNF1eU1VCX01JWF8xWyhzMz4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczA+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMSYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mz1TVUJfTUlYXzBbczM+Pj4yNF1eU1VCX01JWF8xWyhzMD4+PjE2KSYyNTVdXlNVQl9NSVhfMlsoczE+Pj44KSYyNTVdXlNVQl9NSVhfM1tzMiYyNTVdXmtleVNjaGVkdWxlW2tzUm93KytdO3MwPXQwO3MxPXQxO3MyPXQyO3MzPXQzfXZhciB0MD0oKFNCT1hbczA+Pj4yNF08PDI0KXwoU0JPWFsoczE+Pj4xNikmMjU1XTw8MTYpfChTQk9YWyhzMj4+PjgpJjI1NV08PDgpfFNCT1hbczMmMjU1XSlea2V5U2NoZWR1bGVba3NSb3crK107dmFyIHQxPSgoU0JPWFtzMT4+PjI0XTw8MjQpfChTQk9YWyhzMj4+PjE2KSYyNTVdPDwxNil8KFNCT1hbKHMzPj4+OCkmMjU1XTw8OCl8U0JPWFtzMCYyNTVdKV5rZXlTY2hlZHVsZVtrc1JvdysrXTt2YXIgdDI9KChTQk9YW3MyPj4+MjRdPDwyNCl8KFNCT1hbKHMzPj4+MTYpJjI1NV08PDE2KXwoU0JPWFsoczA+Pj44KSYyNTVdPDw4KXxTQk9YW3MxJjI1NV0pXmtleVNjaGVkdWxlW2tzUm93KytdO3ZhciB0Mz0oKFNCT1hbczM+Pj4yNF08PDI0KXwoU0JPWFsoczA+Pj4xNikmMjU1XTw8MTYpfChTQk9YWyhzMT4+PjgpJjI1NV08PDgpfFNCT1hbczImMjU1XSlea2V5U2NoZWR1bGVba3NSb3crK107TVtvZmZzZXRdPXQwO01bb2Zmc2V0KzFdPXQxO01bb2Zmc2V0KzJdPXQyO01bb2Zmc2V0KzNdPXQzfSxrZXlTaXplOjI1Ni8zMn0pO0MuQUVTPUJsb2NrQ2lwaGVyLl9jcmVhdGVIZWxwZXIoQUVTKX0oKSkiLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTtDcnlwdG9KUy5saWIuQ2lwaGVyfHwoZnVuY3Rpb24odW5kZWZpbmVkKXt2YXIgQz1DcnlwdG9KUzt2YXIgQ19saWI9Qy5saWI7dmFyIEJhc2U9Q19saWIuQmFzZTt2YXIgV29yZEFycmF5PUNfbGliLldvcmRBcnJheTt2YXIgQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1DX2xpYi5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtO3ZhciBDX2VuYz1DLmVuYzt2YXIgVXRmOD1DX2VuYy5VdGY4O3ZhciBCYXNlNjQ9Q19lbmMuQmFzZTY0O3ZhciBDX2FsZ289Qy5hbGdvO3ZhciBFdnBLREY9Q19hbGdvLkV2cEtERjt2YXIgQ2lwaGVyPUNfbGliLkNpcGhlcj1CdWZmZXJlZEJsb2NrQWxnb3JpdGhtLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKCksY3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGtleSxjZmcpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9FTkNfWEZPUk1fTU9ERSxrZXksY2ZnKX0sY3JlYXRlRGVjcnlwdG9yOmZ1bmN0aW9uKGtleSxjZmcpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9ERUNfWEZPUk1fTU9ERSxrZXksY2ZnKX0saW5pdDpmdW5jdGlvbih4Zm9ybU1vZGUsa2V5LGNmZyl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGNmZyk7dGhpcy5feGZvcm1Nb2RlPXhmb3JtTW9kZTt0aGlzLl9rZXk9a2V5O3RoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtCdWZmZXJlZEJsb2NrQWxnb3JpdGhtLnJlc2V0LmNhbGwodGhpcyk7dGhpcy5fZG9SZXNldCgpfSxwcm9jZXNzOmZ1bmN0aW9uKGRhdGFVcGRhdGUpe3RoaXMuX2FwcGVuZChkYXRhVXBkYXRlKTtyZXR1cm4gdGhpcy5fcHJvY2VzcygpfSxmaW5hbGl6ZTpmdW5jdGlvbihkYXRhVXBkYXRlKXtpZihkYXRhVXBkYXRlKXt0aGlzLl9hcHBlbmQoZGF0YVVwZGF0ZSl9dmFyIGZpbmFsUHJvY2Vzc2VkRGF0YT10aGlzLl9kb0ZpbmFsaXplKCk7cmV0dXJuIGZpbmFsUHJvY2Vzc2VkRGF0YX0sa2V5U2l6ZToxMjgvMzIsaXZTaXplOjEyOC8zMixfRU5DX1hGT1JNX01PREU6MSxfREVDX1hGT1JNX01PREU6MixfY3JlYXRlSGVscGVyOihmdW5jdGlvbigpe2Z1bmN0aW9uIHNlbGVjdENpcGhlclN0cmF0ZWd5KGtleSl7aWYodHlwZW9mIGtleT09XCJzdHJpbmdcIil7cmV0dXJuIFBhc3N3b3JkQmFzZWRDaXBoZXJ9ZWxzZXtyZXR1cm4gU2VyaWFsaXphYmxlQ2lwaGVyfX1yZXR1cm4gZnVuY3Rpb24oY2lwaGVyKXtyZXR1cm57ZW5jcnlwdDpmdW5jdGlvbihtZXNzYWdlLGtleSxjZmcpe3JldHVybiBzZWxlY3RDaXBoZXJTdHJhdGVneShrZXkpLmVuY3J5cHQoY2lwaGVyLG1lc3NhZ2Usa2V5LGNmZyl9LGRlY3J5cHQ6ZnVuY3Rpb24oY2lwaGVydGV4dCxrZXksY2ZnKXtyZXR1cm4gc2VsZWN0Q2lwaGVyU3RyYXRlZ3koa2V5KS5kZWNyeXB0KGNpcGhlcixjaXBoZXJ0ZXh0LGtleSxjZmcpfX19fSgpKX0pO3ZhciBTdHJlYW1DaXBoZXI9Q19saWIuU3RyZWFtQ2lwaGVyPUNpcGhlci5leHRlbmQoe19kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIGZpbmFsUHJvY2Vzc2VkQmxvY2tzPXRoaXMuX3Byb2Nlc3MoISFcImZsdXNoXCIpO3JldHVybiBmaW5hbFByb2Nlc3NlZEJsb2Nrc30sYmxvY2tTaXplOjF9KTt2YXIgQ19tb2RlPUMubW9kZT17fTt2YXIgQmxvY2tDaXBoZXJNb2RlPUNfbGliLkJsb2NrQ2lwaGVyTW9kZT1CYXNlLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGNpcGhlcixpdil7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZShjaXBoZXIsaXYpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24oY2lwaGVyLGl2KXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKGNpcGhlcixpdil9LGluaXQ6ZnVuY3Rpb24oY2lwaGVyLGl2KXt0aGlzLl9jaXBoZXI9Y2lwaGVyO3RoaXMuX2l2PWl2fX0pO3ZhciBDQkM9Q19tb2RlLkNCQz0oZnVuY3Rpb24oKXt2YXIgQ0JDPUJsb2NrQ2lwaGVyTW9kZS5leHRlbmQoKTtDQkMuRW5jcnlwdG9yPUNCQy5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih3b3JkcyxvZmZzZXQpe3ZhciBjaXBoZXI9dGhpcy5fY2lwaGVyO3ZhciBibG9ja1NpemU9Y2lwaGVyLmJsb2NrU2l6ZTt4b3JCbG9jay5jYWxsKHRoaXMsd29yZHMsb2Zmc2V0LGJsb2NrU2l6ZSk7Y2lwaGVyLmVuY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpO3RoaXMuX3ByZXZCbG9jaz13b3Jkcy5zbGljZShvZmZzZXQsb2Zmc2V0K2Jsb2NrU2l6ZSl9fSk7Q0JDLkRlY3J5cHRvcj1DQkMuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24od29yZHMsb2Zmc2V0KXt2YXIgY2lwaGVyPXRoaXMuX2NpcGhlcjt2YXIgYmxvY2tTaXplPWNpcGhlci5ibG9ja1NpemU7dmFyIHRoaXNCbG9jaz13b3Jkcy5zbGljZShvZmZzZXQsb2Zmc2V0K2Jsb2NrU2l6ZSk7Y2lwaGVyLmRlY3J5cHRCbG9jayh3b3JkcyxvZmZzZXQpO3hvckJsb2NrLmNhbGwodGhpcyx3b3JkcyxvZmZzZXQsYmxvY2tTaXplKTt0aGlzLl9wcmV2QmxvY2s9dGhpc0Jsb2NrfX0pO2Z1bmN0aW9uIHhvckJsb2NrKHdvcmRzLG9mZnNldCxibG9ja1NpemUpe3ZhciBpdj10aGlzLl9pdjtpZihpdil7dmFyIGJsb2NrPWl2O3RoaXMuX2l2PXVuZGVmaW5lZH1lbHNle3ZhciBibG9jaz10aGlzLl9wcmV2QmxvY2t9Zm9yKHZhciBpPTA7aTxibG9ja1NpemU7aSsrKXt3b3Jkc1tvZmZzZXQraV1ePWJsb2NrW2ldfX1yZXR1cm4gQ0JDfSgpKTt2YXIgQ19wYWQ9Qy5wYWQ9e307dmFyIFBrY3M3PUNfcGFkLlBrY3M3PXtwYWQ6ZnVuY3Rpb24oZGF0YSxibG9ja1NpemUpe3ZhciBibG9ja1NpemVCeXRlcz1ibG9ja1NpemUqNDt2YXIgblBhZGRpbmdCeXRlcz1ibG9ja1NpemVCeXRlcy1kYXRhLnNpZ0J5dGVzJWJsb2NrU2l6ZUJ5dGVzO3ZhciBwYWRkaW5nV29yZD0oblBhZGRpbmdCeXRlczw8MjQpfChuUGFkZGluZ0J5dGVzPDwxNil8KG5QYWRkaW5nQnl0ZXM8PDgpfG5QYWRkaW5nQnl0ZXM7dmFyIHBhZGRpbmdXb3Jkcz1bXTtmb3IodmFyIGk9MDtpPG5QYWRkaW5nQnl0ZXM7aSs9NCl7cGFkZGluZ1dvcmRzLnB1c2gocGFkZGluZ1dvcmQpfXZhciBwYWRkaW5nPVdvcmRBcnJheS5jcmVhdGUocGFkZGluZ1dvcmRzLG5QYWRkaW5nQnl0ZXMpO2RhdGEuY29uY2F0KHBhZGRpbmcpfSx1bnBhZDpmdW5jdGlvbihkYXRhKXt2YXIgblBhZGRpbmdCeXRlcz1kYXRhLndvcmRzWyhkYXRhLnNpZ0J5dGVzLTEpPj4+Ml0mMjU1O2RhdGEuc2lnQnl0ZXMtPW5QYWRkaW5nQnl0ZXN9fTt2YXIgQmxvY2tDaXBoZXI9Q19saWIuQmxvY2tDaXBoZXI9Q2lwaGVyLmV4dGVuZCh7Y2ZnOkNpcGhlci5jZmcuZXh0ZW5kKHttb2RlOkNCQyxwYWRkaW5nOlBrY3M3fSkscmVzZXQ6ZnVuY3Rpb24oKXtDaXBoZXIucmVzZXQuY2FsbCh0aGlzKTt2YXIgY2ZnPXRoaXMuY2ZnO3ZhciBpdj1jZmcuaXY7dmFyIG1vZGU9Y2ZnLm1vZGU7aWYodGhpcy5feGZvcm1Nb2RlPT10aGlzLl9FTkNfWEZPUk1fTU9ERSl7dmFyIG1vZGVDcmVhdG9yPW1vZGUuY3JlYXRlRW5jcnlwdG9yfWVsc2V7dmFyIG1vZGVDcmVhdG9yPW1vZGUuY3JlYXRlRGVjcnlwdG9yO3RoaXMuX21pbkJ1ZmZlclNpemU9MX10aGlzLl9tb2RlPW1vZGVDcmVhdG9yLmNhbGwobW9kZSx0aGlzLGl2JiZpdi53b3Jkcyl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih3b3JkcyxvZmZzZXQpe3RoaXMuX21vZGUucHJvY2Vzc0Jsb2NrKHdvcmRzLG9mZnNldCl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHBhZGRpbmc9dGhpcy5jZmcucGFkZGluZztpZih0aGlzLl94Zm9ybU1vZGU9PXRoaXMuX0VOQ19YRk9STV9NT0RFKXtwYWRkaW5nLnBhZCh0aGlzLl9kYXRhLHRoaXMuYmxvY2tTaXplKTt2YXIgZmluYWxQcm9jZXNzZWRCbG9ja3M9dGhpcy5fcHJvY2VzcyghIVwiZmx1c2hcIil9ZWxzZXt2YXIgZmluYWxQcm9jZXNzZWRCbG9ja3M9dGhpcy5fcHJvY2VzcyghIVwiZmx1c2hcIik7cGFkZGluZy51bnBhZChmaW5hbFByb2Nlc3NlZEJsb2Nrcyl9cmV0dXJuIGZpbmFsUHJvY2Vzc2VkQmxvY2tzfSxibG9ja1NpemU6MTI4LzMyfSk7dmFyIENpcGhlclBhcmFtcz1DX2xpYi5DaXBoZXJQYXJhbXM9QmFzZS5leHRlbmQoe2luaXQ6ZnVuY3Rpb24oY2lwaGVyUGFyYW1zKXt0aGlzLm1peEluKGNpcGhlclBhcmFtcyl9LHRvU3RyaW5nOmZ1bmN0aW9uKGZvcm1hdHRlcil7cmV0dXJuKGZvcm1hdHRlcnx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19KTt2YXIgQ19mb3JtYXQ9Qy5mb3JtYXQ9e307dmFyIE9wZW5TU0xGb3JtYXR0ZXI9Q19mb3JtYXQuT3BlblNTTD17c3RyaW5naWZ5OmZ1bmN0aW9uKGNpcGhlclBhcmFtcyl7dmFyIGNpcGhlcnRleHQ9Y2lwaGVyUGFyYW1zLmNpcGhlcnRleHQ7dmFyIHNhbHQ9Y2lwaGVyUGFyYW1zLnNhbHQ7aWYoc2FsdCl7dmFyIHdvcmRBcnJheT1Xb3JkQXJyYXkuY3JlYXRlKFsxMzk4ODkzNjg0LDE3MDEwNzY4MzFdKS5jb25jYXQoc2FsdCkuY29uY2F0KGNpcGhlcnRleHQpfWVsc2V7dmFyIHdvcmRBcnJheT1jaXBoZXJ0ZXh0fXJldHVybiB3b3JkQXJyYXkudG9TdHJpbmcoQmFzZTY0KX0scGFyc2U6ZnVuY3Rpb24ob3BlblNTTFN0cil7dmFyIGNpcGhlcnRleHQ9QmFzZTY0LnBhcnNlKG9wZW5TU0xTdHIpO3ZhciBjaXBoZXJ0ZXh0V29yZHM9Y2lwaGVydGV4dC53b3JkcztpZihjaXBoZXJ0ZXh0V29yZHNbMF09PTEzOTg4OTM2ODQmJmNpcGhlcnRleHRXb3Jkc1sxXT09MTcwMTA3NjgzMSl7dmFyIHNhbHQ9V29yZEFycmF5LmNyZWF0ZShjaXBoZXJ0ZXh0V29yZHMuc2xpY2UoMiw0KSk7Y2lwaGVydGV4dFdvcmRzLnNwbGljZSgwLDQpO2NpcGhlcnRleHQuc2lnQnl0ZXMtPTE2fXJldHVybiBDaXBoZXJQYXJhbXMuY3JlYXRlKHtjaXBoZXJ0ZXh0OmNpcGhlcnRleHQsc2FsdDpzYWx0fSl9fTt2YXIgU2VyaWFsaXphYmxlQ2lwaGVyPUNfbGliLlNlcmlhbGl6YWJsZUNpcGhlcj1CYXNlLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKHtmb3JtYXQ6T3BlblNTTEZvcm1hdHRlcn0pLGVuY3J5cHQ6ZnVuY3Rpb24oY2lwaGVyLG1lc3NhZ2Usa2V5LGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO1xyXG4gICAgdmFyIGVuY3J5cHRvcj1jaXBoZXIuY3JlYXRlRW5jcnlwdG9yKGtleSxjZmcpO3ZhciBjaXBoZXJ0ZXh0PWVuY3J5cHRvci5maW5hbGl6ZShtZXNzYWdlKTt2YXIgY2lwaGVyQ2ZnPWVuY3J5cHRvci5jZmc7cmV0dXJuIENpcGhlclBhcmFtcy5jcmVhdGUoe2NpcGhlcnRleHQ6Y2lwaGVydGV4dCxrZXk6a2V5LGl2OmNpcGhlckNmZy5pdixhbGdvcml0aG06Y2lwaGVyLG1vZGU6Y2lwaGVyQ2ZnLm1vZGUscGFkZGluZzpjaXBoZXJDZmcucGFkZGluZyxibG9ja1NpemU6Y2lwaGVyLmJsb2NrU2l6ZSxmb3JtYXR0ZXI6Y2ZnLmZvcm1hdH0pfSxkZWNyeXB0OmZ1bmN0aW9uKGNpcGhlcixjaXBoZXJ0ZXh0LGtleSxjZmcpe2NmZz10aGlzLmNmZy5leHRlbmQoY2ZnKTtjaXBoZXJ0ZXh0PXRoaXMuX3BhcnNlKGNpcGhlcnRleHQsY2ZnLmZvcm1hdCk7dmFyIHBsYWludGV4dD1jaXBoZXIuY3JlYXRlRGVjcnlwdG9yKGtleSxjZmcpLmZpbmFsaXplKGNpcGhlcnRleHQuY2lwaGVydGV4dCk7cmV0dXJuIHBsYWludGV4dH0sX3BhcnNlOmZ1bmN0aW9uKGNpcGhlcnRleHQsZm9ybWF0KXtpZih0eXBlb2YgY2lwaGVydGV4dD09XCJzdHJpbmdcIil7cmV0dXJuIGZvcm1hdC5wYXJzZShjaXBoZXJ0ZXh0LHRoaXMpfWVsc2V7cmV0dXJuIGNpcGhlcnRleHR9fX0pO3ZhciBDX2tkZj1DLmtkZj17fTt2YXIgT3BlblNTTEtkZj1DX2tkZi5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKHBhc3N3b3JkLGtleVNpemUsaXZTaXplLHNhbHQpe2lmKCFzYWx0KXtzYWx0PVdvcmRBcnJheS5yYW5kb20oNjQvOCl9dmFyIGtleT1FdnBLREYuY3JlYXRlKHtrZXlTaXplOmtleVNpemUraXZTaXplfSkuY29tcHV0ZShwYXNzd29yZCxzYWx0KTt2YXIgaXY9V29yZEFycmF5LmNyZWF0ZShrZXkud29yZHMuc2xpY2Uoa2V5U2l6ZSksaXZTaXplKjQpO2tleS5zaWdCeXRlcz1rZXlTaXplKjQ7cmV0dXJuIENpcGhlclBhcmFtcy5jcmVhdGUoe2tleTprZXksaXY6aXYsc2FsdDpzYWx0fSl9fTt2YXIgUGFzc3dvcmRCYXNlZENpcGhlcj1DX2xpYi5QYXNzd29yZEJhc2VkQ2lwaGVyPVNlcmlhbGl6YWJsZUNpcGhlci5leHRlbmQoe2NmZzpTZXJpYWxpemFibGVDaXBoZXIuY2ZnLmV4dGVuZCh7a2RmOk9wZW5TU0xLZGZ9KSxlbmNyeXB0OmZ1bmN0aW9uKGNpcGhlcixtZXNzYWdlLHBhc3N3b3JkLGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO3ZhciBkZXJpdmVkUGFyYW1zPWNmZy5rZGYuZXhlY3V0ZShwYXNzd29yZCxjaXBoZXIua2V5U2l6ZSxjaXBoZXIuaXZTaXplKTtjZmcuaXY9ZGVyaXZlZFBhcmFtcy5pdjt2YXIgY2lwaGVydGV4dD1TZXJpYWxpemFibGVDaXBoZXIuZW5jcnlwdC5jYWxsKHRoaXMsY2lwaGVyLG1lc3NhZ2UsZGVyaXZlZFBhcmFtcy5rZXksY2ZnKTtjaXBoZXJ0ZXh0Lm1peEluKGRlcml2ZWRQYXJhbXMpO3JldHVybiBjaXBoZXJ0ZXh0fSxkZWNyeXB0OmZ1bmN0aW9uKGNpcGhlcixjaXBoZXJ0ZXh0LHBhc3N3b3JkLGNmZyl7Y2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO2NpcGhlcnRleHQ9dGhpcy5fcGFyc2UoY2lwaGVydGV4dCxjZmcuZm9ybWF0KTt2YXIgZGVyaXZlZFBhcmFtcz1jZmcua2RmLmV4ZWN1dGUocGFzc3dvcmQsY2lwaGVyLmtleVNpemUsY2lwaGVyLml2U2l6ZSxjaXBoZXJ0ZXh0LnNhbHQpO2NmZy5pdj1kZXJpdmVkUGFyYW1zLml2O3ZhciBwbGFpbnRleHQ9U2VyaWFsaXphYmxlQ2lwaGVyLmRlY3J5cHQuY2FsbCh0aGlzLGNpcGhlcixjaXBoZXJ0ZXh0LGRlcml2ZWRQYXJhbXMua2V5LGNmZyk7cmV0dXJuIHBsYWludGV4dH19KX0oKSkiLCJcbnZhciBOZXREYXRhID0gcmVxdWlyZShcIk5ldERhdGFcIik7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFxuICAgICAgICBmbHlDaGlwTm9kZTogY2MuUHJlZmFiLFxuICAgICAgICBcbiAgICAgICAgaG9tZVBvc2l0aW9uOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5WZWMyXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgdGFyZ2V0TG9jYXRpb24xOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5WZWMyXSxcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHRhcmdldExvY2F0aW9uMjpcbiAgICAgICAge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuVmVjMl0sXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBmbHlDaGlwTm9kZUFycmF5OntcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICByZXdhcmRGbHlOb2RlQXJyYXk6e1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuUHJlZmFiXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgcmV3YXJkRmx5Tm9kZVRhcmdldExvY2F0aW9uOlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5WZWMyXSxcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIHJld2FyZEZseU5vZGVIb21lUG9zaXRpb246IGNjLlZlYzIsXG4gICAgICAgIHJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5OltdLFxuICAgICAgICBtYXJrRmx5UmV3YXJkQ250OiAwLFxuICAgIH0sXG4gICAgXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG4gICAgXG4gICAgY2hpcEZseUFjdGlvbjogZnVuY3Rpb24oY2hpcE51bSwgY2hpcEluZGV4LCBiZXRJZCwgZmxhZywgcG93ZXJUYXJnZXQpXG4gICAge1xuICAgICAgICB2YXIgbmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG4gICAgICAgICB2YXIgaG9tZXAgPSB0aGlzLmhvbWVQb3NpdGlvbltjaGlwSW5kZXhdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdGFyZ2V0UCA9IG51bGw7XG4gICAgICAgICAgICBpZihuZXREYXRhLnRpbWVGbGFnID09IDEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0UCA9IHRoaXMudGFyZ2V0TG9jYXRpb24xW2JldElkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRQID0gdGhpcy50YXJnZXRMb2NhdGlvbjJbYmV0SWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgZmx5Tm9kZSA9IHRoaXMuZ2V0Rmx5Q2hpcE5vZGUoKTtcbiAgICAgICAgICAgIHZhciBmbHlOb2RlSlMgPSBmbHlOb2RlLmdldENvbXBvbmVudChcImZseUNoaXBOb2RlUHJlXCIpO1xuXG4gICAgICAgICAgICBmbHlOb2RlSlMuc2V0U2tpbldpdGhUYWcoY2hpcEluZGV4KTtcbiAgICAgICAgICAgIGZseU5vZGVKUy5zZXRNb25leShjaGlwTnVtKTtcbiAgICAgICAgICAgIGZseU5vZGVKUy5jaGlwRmx5QWN0aW9uKGhvbWVwLCB0YXJnZXRQLCBmbGFnLCBmbHlOb2RlLCBwb3dlclRhcmdldCwgdGhpcywgdGhpcy5maW5pc2hlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIFxuICAgIH0sXG4gICAgXG4gICAgZ2V0Rmx5Q2hpcE5vZGU6IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHZhciBmbHlOb2RlID0gbnVsbDtcbiAgICAgICAgaWYodGhpcy5mbHlDaGlwTm9kZUFycmF5Lmxlbmd0aCA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZseU5vZGUgPSB0aGlzLmZseUNoaXBOb2RlQXJyYXkuc2hpZnQoKTtcbiAgICAgICAgICAgIGZseU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBmbHlOb2RlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmbHlOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy5mbHlDaGlwTm9kZSk7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChmbHlOb2RlKTtcbiAgICAgICAgZmx5Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gZmx5Tm9kZTtcbiAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBzZXRGbHlDaGlwTm9kZTogZnVuY3Rpb24oZmx5bm9kZSlcbiAgICB7XG4gICAgICAgIHRoaXMuZmx5Q2hpcE5vZGVBcnJheS5wdXNoKGZseW5vZGUpO1xuICAgICAgICBmbHlub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgXG4gICAgZmluaXNoZWRDYWxsYmFjazogZnVuY3Rpb24odGFyZ2V0LCBvYmplY3QpXG4gICAge1xuICAgICAgICB2YXIgcG93ZXJUYXJnZXQgPSBvYmplY3QucG93ZXJUYXJnZXQ7XG4gICAgICAgIHZhciBmbGFnID0gb2JqZWN0LmZsYWc7XG4gICAgICAgIHZhciBzZWxmID0gb2JqZWN0LnRhcmdldDtcbiAgICAgICAgdmFyIGZseW5vZGUgPSBvYmplY3QuZmx5Tm9kZTtcbiAgICAgICAgXG4gICAgICAgIHNlbGYuc2V0Rmx5Q2hpcE5vZGUoZmx5bm9kZSk7XG4gICAgICAgIHBvd2VyVGFyZ2V0LmZseUNoaXBOb2RlRmluaXNoZWQocG93ZXJUYXJnZXQsIGZsYWcpO1xuICAgICAgICBcbiAgICAgICAgb2JqZWN0ID0gbnVsbDtcbiAgXG4gICAgfSxcbiAgICBcbiAgICAvL2luZGV4OiAw6LSfIDHog5wgIDLlubNcbiAgICBmbHlSZXdhcmROb2RlOmZ1bmN0aW9uIChpbmRleCwgcG9zaXRpb25JbmRleClcbiAgICB7XG4gICAgICAgIHZhciBmbHlOb2RlID0gbnVsbDtcbiAgICAgICAgaWYodGhpcy5yZXdhcmRGbHlOb2RlSW5pc3RhbnRBcnJheS5sZW5ndGgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZseU5vZGUgPSB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5W2ldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgZmx5Tm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmV3YXJkRmx5Tm9kZUFycmF5W2ldKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChmbHlOb2RlKTtcbiAgICAgICAgICAgIHRoaXMucmV3YXJkRmx5Tm9kZUluaXN0YW50QXJyYXkucHVzaChmbHlOb2RlKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIGZseU5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGZseU5vZGVKUyA9IGZseU5vZGUuZ2V0Q29tcG9uZW50KFwiZmx5UmV3YXJkTm9kZVByZVwiKTtcbiAgICAgICAgZmx5Tm9kZUpTLnNldFNraW5XaXRoVGFnKGluZGV4KTtcbiAgICAgICAgdmFyIHAxID0gdGhpcy5yZXdhcmRGbHlOb2RlSG9tZVBvc2l0aW9uO1xuICAgICAgICB2YXIgcDIgPSB0aGlzLnJld2FyZEZseU5vZGVUYXJnZXRMb2NhdGlvbltwb3NpdGlvbkluZGV4XTtcbiAgICAgICAgZmx5Tm9kZUpTLmZseVJld2FyZEFjdGlvbihwMSwgcDIsIHRoaXMuZmx5UmV3YXJkQWN0aW9uRmluaXNoZWQpO1xuICAgIH0sXG4gICAgXG4gICAgXG4gICAgZmx5UmV3YXJkQWN0aW9uRmluaXNoZWQ6IGZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHRoaXMubWFya0ZseVJld2FyZENudCArKztcbiAgICAgICAgaWYodGhpcy5tYXJrRmx5UmV3YXJkQ250ID09IDQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5Lmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJld2FyZEZseU5vZGVJbmlzdGFudEFycmF5LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG4gICAgXG4gICAgXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwidmFyIENyeXB0b0pTPUNyeXB0b0pTfHwoZnVuY3Rpb24oTWF0aCx1bmRlZmluZWQpe3ZhciBDPXt9O3ZhciBDX2xpYj1DLmxpYj17fTt2YXIgQmFzZT1DX2xpYi5CYXNlPShmdW5jdGlvbigpe2Z1bmN0aW9uIEYoKXt9cmV0dXJue2V4dGVuZDpmdW5jdGlvbihvdmVycmlkZXMpe0YucHJvdG90eXBlPXRoaXM7dmFyIHN1YnR5cGU9bmV3IEYoKTtpZihvdmVycmlkZXMpe3N1YnR5cGUubWl4SW4ob3ZlcnJpZGVzKX1pZighc3VidHlwZS5oYXNPd25Qcm9wZXJ0eShcImluaXRcIikpe3N1YnR5cGUuaW5pdD1mdW5jdGlvbigpe3N1YnR5cGUuJHN1cGVyLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfX1zdWJ0eXBlLmluaXQucHJvdG90eXBlPXN1YnR5cGU7c3VidHlwZS4kc3VwZXI9dGhpcztyZXR1cm4gc3VidHlwZX0sY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGluc3RhbmNlPXRoaXMuZXh0ZW5kKCk7aW5zdGFuY2UuaW5pdC5hcHBseShpbnN0YW5jZSxhcmd1bWVudHMpO3JldHVybiBpbnN0YW5jZX0saW5pdDpmdW5jdGlvbigpe30sbWl4SW46ZnVuY3Rpb24ocHJvcGVydGllcyl7Zm9yKHZhciBwcm9wZXJ0eU5hbWUgaW4gcHJvcGVydGllcyl7aWYocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpKXt0aGlzW3Byb3BlcnR5TmFtZV09cHJvcGVydGllc1twcm9wZXJ0eU5hbWVdfX1pZihwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KFwidG9TdHJpbmdcIikpe3RoaXMudG9TdHJpbmc9cHJvcGVydGllcy50b1N0cmluZ319LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpfX19KCkpO3ZhciBXb3JkQXJyYXk9Q19saWIuV29yZEFycmF5PUJhc2UuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHdvcmRzLHNpZ0J5dGVzKXt3b3Jkcz10aGlzLndvcmRzPXdvcmRzfHxbXTtpZihzaWdCeXRlcyE9dW5kZWZpbmVkKXt0aGlzLnNpZ0J5dGVzPXNpZ0J5dGVzfWVsc2V7dGhpcy5zaWdCeXRlcz13b3Jkcy5sZW5ndGgqNH19LHRvU3RyaW5nOmZ1bmN0aW9uKGVuY29kZXIpe3JldHVybihlbmNvZGVyfHxIZXgpLnN0cmluZ2lmeSh0aGlzKX0sY29uY2F0OmZ1bmN0aW9uKHdvcmRBcnJheSl7dmFyIHRoaXNXb3Jkcz10aGlzLndvcmRzO3ZhciB0aGF0V29yZHM9d29yZEFycmF5LndvcmRzO3ZhciB0aGlzU2lnQnl0ZXM9dGhpcy5zaWdCeXRlczt2YXIgdGhhdFNpZ0J5dGVzPXdvcmRBcnJheS5zaWdCeXRlczt0aGlzLmNsYW1wKCk7aWYodGhpc1NpZ0J5dGVzJTQpe2Zvcih2YXIgaT0wO2k8dGhhdFNpZ0J5dGVzO2krKyl7dmFyIHRoYXRCeXRlPSh0aGF0V29yZHNbaT4+PjJdPj4+KDI0LShpJTQpKjgpKSYyNTU7dGhpc1dvcmRzWyh0aGlzU2lnQnl0ZXMraSk+Pj4yXXw9dGhhdEJ5dGU8PCgyNC0oKHRoaXNTaWdCeXRlcytpKSU0KSo4KX19ZWxzZXtmb3IodmFyIGk9MDtpPHRoYXRTaWdCeXRlcztpKz00KXt0aGlzV29yZHNbKHRoaXNTaWdCeXRlcytpKT4+PjJdPXRoYXRXb3Jkc1tpPj4+Ml19fXRoaXMuc2lnQnl0ZXMrPXRoYXRTaWdCeXRlcztyZXR1cm4gdGhpc30sY2xhbXA6ZnVuY3Rpb24oKXt2YXIgd29yZHM9dGhpcy53b3Jkczt2YXIgc2lnQnl0ZXM9dGhpcy5zaWdCeXRlczt3b3Jkc1tzaWdCeXRlcz4+PjJdJj00Mjk0OTY3Mjk1PDwoMzItKHNpZ0J5dGVzJTQpKjgpO3dvcmRzLmxlbmd0aD1NYXRoLmNlaWwoc2lnQnl0ZXMvNCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGNsb25lPUJhc2UuY2xvbmUuY2FsbCh0aGlzKTtjbG9uZS53b3Jkcz10aGlzLndvcmRzLnNsaWNlKDApO3JldHVybiBjbG9uZX0scmFuZG9tOmZ1bmN0aW9uKG5CeXRlcyl7dmFyIHdvcmRzPVtdO3ZhciByPShmdW5jdGlvbihtX3cpe3ZhciBtX3c9bV93O3ZhciBtX3o9OTg3NjU0MzIxO3ZhciBtYXNrPTQyOTQ5NjcyOTU7cmV0dXJuIGZ1bmN0aW9uKCl7bV96PSgzNjk2OSoobV96JjY1NTM1KSsobV96Pj4xNikpJm1hc2s7bV93PSgxODAwMCoobV93JjY1NTM1KSsobV93Pj4xNikpJm1hc2s7dmFyIHJlc3VsdD0oKG1fejw8MTYpK21fdykmbWFzaztyZXN1bHQvPTQyOTQ5NjcyOTY7cmVzdWx0Kz0wLjU7cmV0dXJuIHJlc3VsdCooTWF0aC5yYW5kb20oKT4wLjU/MTotMSl9fSk7Zm9yKHZhciBpPTAscmNhY2hlO2k8bkJ5dGVzO2krPTQpe3ZhciBfcj1yKChyY2FjaGV8fE1hdGgucmFuZG9tKCkpKjQyOTQ5NjcyOTYpO3JjYWNoZT1fcigpKjk4NzY1NDA3MTt3b3Jkcy5wdXNoKChfcigpKjQyOTQ5NjcyOTYpfDApfXJldHVybiBuZXcgV29yZEFycmF5LmluaXQod29yZHMsbkJ5dGVzKX19KTt2YXIgQ19lbmM9Qy5lbmM9e307dmFyIEhleD1DX2VuYy5IZXg9e3N0cmluZ2lmeTpmdW5jdGlvbih3b3JkQXJyYXkpe3ZhciB3b3Jkcz13b3JkQXJyYXkud29yZHM7dmFyIHNpZ0J5dGVzPXdvcmRBcnJheS5zaWdCeXRlczt2YXIgaGV4Q2hhcnM9W107Zm9yKHZhciBpPTA7aTxzaWdCeXRlcztpKyspe3ZhciBiaXRlPSh3b3Jkc1tpPj4+Ml0+Pj4oMjQtKGklNCkqOCkpJjI1NTtoZXhDaGFycy5wdXNoKChiaXRlPj4+NCkudG9TdHJpbmcoMTYpKTtoZXhDaGFycy5wdXNoKChiaXRlJjE1KS50b1N0cmluZygxNikpfXJldHVybiBoZXhDaGFycy5qb2luKFwiXCIpfSxwYXJzZTpmdW5jdGlvbihoZXhTdHIpe3ZhciBoZXhTdHJMZW5ndGg9aGV4U3RyLmxlbmd0aDt2YXIgd29yZHM9W107Zm9yKHZhciBpPTA7aTxoZXhTdHJMZW5ndGg7aSs9Mil7d29yZHNbaT4+PjNdfD1wYXJzZUludChoZXhTdHIuc3Vic3RyKGksMiksMTYpPDwoMjQtKGklOCkqNCl9cmV0dXJuIG5ldyBXb3JkQXJyYXkuaW5pdCh3b3JkcyxoZXhTdHJMZW5ndGgvMil9fTt2YXIgTGF0aW4xPUNfZW5jLkxhdGluMT17c3RyaW5naWZ5OmZ1bmN0aW9uKHdvcmRBcnJheSl7dmFyIHdvcmRzPXdvcmRBcnJheS53b3Jkczt2YXIgc2lnQnl0ZXM9d29yZEFycmF5LnNpZ0J5dGVzO3ZhciBsYXRpbjFDaGFycz1bXTtmb3IodmFyIGk9MDtpPHNpZ0J5dGVzO2krKyl7dmFyIGJpdGU9KHdvcmRzW2k+Pj4yXT4+PigyNC0oaSU0KSo4KSkmMjU1O2xhdGluMUNoYXJzLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiaXRlKSl9cmV0dXJuIGxhdGluMUNoYXJzLmpvaW4oXCJcIil9LHBhcnNlOmZ1bmN0aW9uKGxhdGluMVN0cil7dmFyIGxhdGluMVN0ckxlbmd0aD1sYXRpbjFTdHIubGVuZ3RoO3ZhciB3b3Jkcz1bXTtmb3IodmFyIGk9MDtpPGxhdGluMVN0ckxlbmd0aDtpKyspe3dvcmRzW2k+Pj4yXXw9KGxhdGluMVN0ci5jaGFyQ29kZUF0KGkpJjI1NSk8PCgyNC0oaSU0KSo4KX1yZXR1cm4gbmV3IFdvcmRBcnJheS5pbml0KHdvcmRzLGxhdGluMVN0ckxlbmd0aCl9fTt2YXIgVXRmOD1DX2VuYy5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24od29yZEFycmF5KXt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoTGF0aW4xLnN0cmluZ2lmeSh3b3JkQXJyYXkpKSl9Y2F0Y2goZSl7dGhyb3cgbmV3IEVycm9yKFwiTWFsZm9ybWVkIFVURi04IGRhdGFcIil9fSxwYXJzZTpmdW5jdGlvbih1dGY4U3RyKXtyZXR1cm4gTGF0aW4xLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudCh1dGY4U3RyKSkpfX07dmFyIEJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09Q19saWIuQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1CYXNlLmV4dGVuZCh7cmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhPW5ldyBXb3JkQXJyYXkuaW5pdCgpO3RoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihkYXRhKXtpZih0eXBlb2YgZGF0YT09XCJzdHJpbmdcIil7ZGF0YT1VdGY4LnBhcnNlKGRhdGEpfXRoaXMuX2RhdGEuY29uY2F0KGRhdGEpO3RoaXMuX25EYXRhQnl0ZXMrPWRhdGEuc2lnQnl0ZXN9LF9wcm9jZXNzOmZ1bmN0aW9uKGRvRmx1c2gpe3ZhciBkYXRhPXRoaXMuX2RhdGE7dmFyIGRhdGFXb3Jkcz1kYXRhLndvcmRzO3ZhciBkYXRhU2lnQnl0ZXM9ZGF0YS5zaWdCeXRlczt2YXIgYmxvY2tTaXplPXRoaXMuYmxvY2tTaXplO3ZhciBibG9ja1NpemVCeXRlcz1ibG9ja1NpemUqNDt2YXIgbkJsb2Nrc1JlYWR5PWRhdGFTaWdCeXRlcy9ibG9ja1NpemVCeXRlcztpZihkb0ZsdXNoKXtuQmxvY2tzUmVhZHk9TWF0aC5jZWlsKG5CbG9ja3NSZWFkeSl9ZWxzZXtuQmxvY2tzUmVhZHk9TWF0aC5tYXgoKG5CbG9ja3NSZWFkeXwwKS10aGlzLl9taW5CdWZmZXJTaXplLDApfXZhciBuV29yZHNSZWFkeT1uQmxvY2tzUmVhZHkqYmxvY2tTaXplO3ZhciBuQnl0ZXNSZWFkeT1NYXRoLm1pbihuV29yZHNSZWFkeSo0LGRhdGFTaWdCeXRlcyk7aWYobldvcmRzUmVhZHkpe2Zvcih2YXIgb2Zmc2V0PTA7b2Zmc2V0PG5Xb3Jkc1JlYWR5O29mZnNldCs9YmxvY2tTaXplKXt0aGlzLl9kb1Byb2Nlc3NCbG9jayhkYXRhV29yZHMsb2Zmc2V0KX12YXIgcHJvY2Vzc2VkV29yZHM9ZGF0YVdvcmRzLnNwbGljZSgwLG5Xb3Jkc1JlYWR5KTtkYXRhLnNpZ0J5dGVzLT1uQnl0ZXNSZWFkeX1yZXR1cm4gbmV3IFdvcmRBcnJheS5pbml0KHByb2Nlc3NlZFdvcmRzLG5CeXRlc1JlYWR5KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgY2xvbmU9QmFzZS5jbG9uZS5jYWxsKHRoaXMpO2Nsb25lLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKTtyZXR1cm4gY2xvbmV9LF9taW5CdWZmZXJTaXplOjB9KTt2YXIgSGFzaGVyPUNfbGliLkhhc2hlcj1CdWZmZXJlZEJsb2NrQWxnb3JpdGhtLmV4dGVuZCh7Y2ZnOkJhc2UuZXh0ZW5kKCksaW5pdDpmdW5jdGlvbihjZmcpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChjZmcpO3RoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtCdWZmZXJlZEJsb2NrQWxnb3JpdGhtLnJlc2V0LmNhbGwodGhpcyk7dGhpcy5fZG9SZXNldCgpfSx1cGRhdGU6ZnVuY3Rpb24obWVzc2FnZVVwZGF0ZSl7dGhpcy5fYXBwZW5kKG1lc3NhZ2VVcGRhdGUpO3RoaXMuX3Byb2Nlc3MoKTtyZXR1cm4gdGhpc30sZmluYWxpemU6ZnVuY3Rpb24obWVzc2FnZVVwZGF0ZSl7aWYobWVzc2FnZVVwZGF0ZSl7dGhpcy5fYXBwZW5kKG1lc3NhZ2VVcGRhdGUpfXZhciBoYXNoPXRoaXMuX2RvRmluYWxpemUoKTtcclxuICAgIHJldHVybiBoYXNofSxibG9ja1NpemU6NTEyLzMyLF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oaGFzaGVyKXtyZXR1cm4gZnVuY3Rpb24obWVzc2FnZSxjZmcpe3JldHVybiBuZXcgaGFzaGVyLmluaXQoY2ZnKS5maW5hbGl6ZShtZXNzYWdlKX19LF9jcmVhdGVIbWFjSGVscGVyOmZ1bmN0aW9uKGhhc2hlcil7cmV0dXJuIGZ1bmN0aW9uKG1lc3NhZ2Usa2V5KXtyZXR1cm4gbmV3IENfYWxnby5ITUFDLmluaXQoaGFzaGVyLGtleSkuZmluYWxpemUobWVzc2FnZSl9fX0pO3ZhciBDX2FsZ289Qy5hbGdvPXt9O3JldHVybiBDfShNYXRoKSk7bW9kdWxlLmV4cG9ydHM9Q3J5cHRvSlMiLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTsoZnVuY3Rpb24oKXt2YXIgQz1DcnlwdG9KUzt2YXIgQ19saWI9Qy5saWI7dmFyIFdvcmRBcnJheT1DX2xpYi5Xb3JkQXJyYXk7dmFyIENfZW5jPUMuZW5jO3ZhciBCYXNlNjQ9Q19lbmMuQmFzZTY0PXtzdHJpbmdpZnk6ZnVuY3Rpb24od29yZEFycmF5KXt2YXIgd29yZHM9d29yZEFycmF5LndvcmRzO3ZhciBzaWdCeXRlcz13b3JkQXJyYXkuc2lnQnl0ZXM7dmFyIG1hcD10aGlzLl9tYXA7d29yZEFycmF5LmNsYW1wKCk7dmFyIGJhc2U2NENoYXJzPVtdO2Zvcih2YXIgaT0wO2k8c2lnQnl0ZXM7aSs9Myl7dmFyIGJ5dGUxPSh3b3Jkc1tpPj4+Ml0+Pj4oMjQtKGklNCkqOCkpJjI1NTt2YXIgYnl0ZTI9KHdvcmRzWyhpKzEpPj4+Ml0+Pj4oMjQtKChpKzEpJTQpKjgpKSYyNTU7dmFyIGJ5dGUzPSh3b3Jkc1soaSsyKT4+PjJdPj4+KDI0LSgoaSsyKSU0KSo4KSkmMjU1O3ZhciB0cmlwbGV0PShieXRlMTw8MTYpfChieXRlMjw8OCl8Ynl0ZTM7Zm9yKHZhciBqPTA7KGo8NCkmJihpK2oqMC43NTxzaWdCeXRlcyk7aisrKXtiYXNlNjRDaGFycy5wdXNoKG1hcC5jaGFyQXQoKHRyaXBsZXQ+Pj4oNiooMy1qKSkpJjYzKSl9fXZhciBwYWRkaW5nQ2hhcj1tYXAuY2hhckF0KDY0KTtpZihwYWRkaW5nQ2hhcil7d2hpbGUoYmFzZTY0Q2hhcnMubGVuZ3RoJTQpe2Jhc2U2NENoYXJzLnB1c2gocGFkZGluZ0NoYXIpfX1yZXR1cm4gYmFzZTY0Q2hhcnMuam9pbihcIlwiKX0scGFyc2U6ZnVuY3Rpb24oYmFzZTY0U3RyKXt2YXIgYmFzZTY0U3RyTGVuZ3RoPWJhc2U2NFN0ci5sZW5ndGg7dmFyIG1hcD10aGlzLl9tYXA7dmFyIHBhZGRpbmdDaGFyPW1hcC5jaGFyQXQoNjQpO2lmKHBhZGRpbmdDaGFyKXt2YXIgcGFkZGluZ0luZGV4PWJhc2U2NFN0ci5pbmRleE9mKHBhZGRpbmdDaGFyKTtpZihwYWRkaW5nSW5kZXghPS0xKXtiYXNlNjRTdHJMZW5ndGg9cGFkZGluZ0luZGV4fX12YXIgd29yZHM9W107dmFyIG5CeXRlcz0wO2Zvcih2YXIgaT0wO2k8YmFzZTY0U3RyTGVuZ3RoO2krKyl7aWYoaSU0KXt2YXIgYml0czE9bWFwLmluZGV4T2YoYmFzZTY0U3RyLmNoYXJBdChpLTEpKTw8KChpJTQpKjIpO3ZhciBiaXRzMj1tYXAuaW5kZXhPZihiYXNlNjRTdHIuY2hhckF0KGkpKT4+Pig2LShpJTQpKjIpO3ZhciBiaXRzQ29tYmluZWQ9Yml0czF8Yml0czI7d29yZHNbbkJ5dGVzPj4+Ml18PShiaXRzQ29tYmluZWQpPDwoMjQtKG5CeXRlcyU0KSo4KTtuQnl0ZXMrK319cmV0dXJuIFdvcmRBcnJheS5jcmVhdGUod29yZHMsbkJ5dGVzKX0sX21hcDpcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCJ9fSgpKSIsIlxudmFyIEVidXR0b25UYWcgPSBjYy5FbnVtKHtcblxuICBlU2tpbkZyZXNoOiAwLFxuICBlU2tpbk9LOiAxLCAgIFxuICBlU2tpbkNhbm5lbDogMiwgICAgICBcbiAgZVNraW4zOjMsIFxuICBlU2tpbjQ6NCwgXG4gIGVTa2luNSA6IDUsICBcbiAgZVNraW42OiA2LFxuXG59KTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxlZnRCdXR0b246IGNjLk5vZGUsXG4gICAgICAgIHJpZ2h0QnV0dG9uOiBjYy5Ob2RlLFxuICAgICAgICB0aXRsZTogY2MuTGFiZWwsXG4gICAgICAgIGxlZnRTa2luQXJyYXk6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxuICAgICAgICAgICAgdHlwZTogW2NjLk5vZGVdXG4gICAgICAgIH0sXG4gICAgICAgIGxlZnRUaXRsZTogY2MuTGFiZWwsXG4gICAgICAgIHJpZ2h0U2tpbkFycmF5OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICByaWdodFRpdGxlOiBjYy5MYWJlbCxcbiAgICAgICAgdHlwZUFjdGlvbjowLFxuXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxlZnRCdXR0b24ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIGZ1bmN0aW9uIChldmVudCl7XG4gICAgICAgICAgICAgdGhpcy5sZWZ0QnV0dG9uLnNjYWxlID0gMC44O1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLmxlZnRCdXR0b24ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi5zY2FsZSA9IDE7XG4gICAgICAgICAgICB2YXIgZ2FtZUZ1biA9IGNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2FtZScpO1xuICAgICAgICAgICAgZ2FtZUZ1bi5lcnJvckRpYWxvZ0NhbGxiYWNrKHRoaXMudHlwZUFjdGlvbiwgMSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmxlZnRCdXR0b24ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi5zY2FsZSA9IDE7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yaWdodEJ1dHRvbi5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgZnVuY3Rpb24gKGV2ZW50KXtcbiAgICAgICAgICAgICB0aGlzLnJpZ2h0QnV0dG9uLnNjYWxlID0gMC44O1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLnJpZ2h0QnV0dG9uLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKGV2ZW50KXtcbiAgICAgICAgICAgICB0aGlzLnJpZ2h0QnV0dG9uLnNjYWxlID0gMTtcbiAgICAgICAgICAgIHZhciBvbkZ1bmN0aW9uID0gY2MuZmluZCgnQ2FudmFzJykuZ2V0Q29tcG9uZW50KCdnYW1lJyk7XG4gICAgICAgICAgICBvbkZ1bmN0aW9uLmVycm9yRGlhbG9nQ2FsbGJhY2sodGhpcy50eXBlQWN0aW9uLCAyKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmlnaHRCdXR0b24ub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uc2NhbGUgPSAxO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBzaG93RGlhbG9nOmZ1bmN0aW9uKHRpdGxlLCBidXR0b25UeXBlKVxuICAgIHtcbiAgICAgICAgdGhpcy50eXBlQWN0aW9uID0gYnV0dG9uVHlwZTtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMucmVzZXR6SW5kZXhacmVvKCk7XG4gICAgICAgIHRoaXMudGl0bGUuc3RyaW5nID0gdGl0bGU7XG4gICAgICAgIFxuICAgICAgICBpZihidXR0b25UeXBlID09PSAwKS8v5Yi35pawXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi54ID0gMDtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi55ID0gMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmxlZnRTa2luQXJyYXlbMF0uekluZGV4ID0gMjA7XG4gICAgICAgICAgICB0aGlzLmxlZnRJbmRleCA9IDA7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0SW5kZXggPSAtMTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYnV0dG9uVHlwZSA9PSAxKS8v562J562J5YaN6LWwIOS4jeeOqeS6hlxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmxlZnRCdXR0b24ueCA9IC0xNjA7XG4gICAgICAgICAgICB0aGlzLmxlZnRCdXR0b24ueSA9IC0xMDA7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0QnV0dG9uLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmxlZnRTa2luQXJyYXlbMV0uekluZGV4ID0gMjA7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0U2tpbkFycmF5WzFdLnpJbmRleCA9IDIwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYnV0dG9uVHlwZSA9PSAyKS8vXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi54ID0gLTE2MDtcbiAgICAgICAgICAgIHRoaXMubGVmdEJ1dHRvbi55ID0gLTEwMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRCdXR0b24uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubGVmdFNraW5BcnJheVsyXS56SW5kZXggPSAyMDtcbiAgICAgICAgICAgIHRoaXMucmlnaHRTa2luQXJyYXlbMl0uekluZGV4ID0gMjA7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIGhpZGVEaWFsb2c6ZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG4gICAgXG4gICAgcmVzZXR6SW5kZXhacmVvOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxlZnRTa2luQXJyYXkubGVuZ3RoOyBpICsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmxlZnRTa2luQXJyYXlbaV0uekluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IHRoaXMucmlnaHRTa2luQXJyYXkubGVuZ3RoOyBqICsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0U2tpbkFycmF5W2pdLnpJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsInZhciBDcnlwdG9KUz1yZXF1aXJlKFwiLi9jb3JlXCIpOyhmdW5jdGlvbigpe3ZhciBDPUNyeXB0b0pTO3ZhciBDX2xpYj1DLmxpYjt2YXIgQmFzZT1DX2xpYi5CYXNlO3ZhciBXb3JkQXJyYXk9Q19saWIuV29yZEFycmF5O3ZhciBDX2FsZ289Qy5hbGdvO3ZhciBNRDU9Q19hbGdvLk1ENTt2YXIgRXZwS0RGPUNfYWxnby5FdnBLREY9QmFzZS5leHRlbmQoe2NmZzpCYXNlLmV4dGVuZCh7a2V5U2l6ZToxMjgvMzIsaGFzaGVyOk1ENSxpdGVyYXRpb25zOjF9KSxpbml0OmZ1bmN0aW9uKGNmZyl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGNmZyl9LGNvbXB1dGU6ZnVuY3Rpb24ocGFzc3dvcmQsc2FsdCl7dmFyIGNmZz10aGlzLmNmZzt2YXIgaGFzaGVyPWNmZy5oYXNoZXIuY3JlYXRlKCk7dmFyIGRlcml2ZWRLZXk9V29yZEFycmF5LmNyZWF0ZSgpO3ZhciBkZXJpdmVkS2V5V29yZHM9ZGVyaXZlZEtleS53b3Jkczt2YXIga2V5U2l6ZT1jZmcua2V5U2l6ZTt2YXIgaXRlcmF0aW9ucz1jZmcuaXRlcmF0aW9uczt3aGlsZShkZXJpdmVkS2V5V29yZHMubGVuZ3RoPGtleVNpemUpe2lmKGJsb2NrKXtoYXNoZXIudXBkYXRlKGJsb2NrKX12YXIgYmxvY2s9aGFzaGVyLnVwZGF0ZShwYXNzd29yZCkuZmluYWxpemUoc2FsdCk7aGFzaGVyLnJlc2V0KCk7Zm9yKHZhciBpPTE7aTxpdGVyYXRpb25zO2krKyl7YmxvY2s9aGFzaGVyLmZpbmFsaXplKGJsb2NrKTtoYXNoZXIucmVzZXQoKX1kZXJpdmVkS2V5LmNvbmNhdChibG9jayl9ZGVyaXZlZEtleS5zaWdCeXRlcz1rZXlTaXplKjQ7cmV0dXJuIGRlcml2ZWRLZXl9fSk7Qy5FdnBLREY9ZnVuY3Rpb24ocGFzc3dvcmQsc2FsdCxjZmcpe3JldHVybiBFdnBLREYuY3JlYXRlKGNmZykuY29tcHV0ZShwYXNzd29yZCxzYWx0KX19KCkpIiwiXG52YXIgRVNraW5UYWcgPSBjYy5FbnVtKHtcblxuICBlQ2hpcDIwOiAwLFxuICBlQ2hpcDUwOiAxLCAgIFxuICBlQ2hpcDEwMDogMiwgICAgICBcbiAgZUNoaXA1MDA6MywgXG4gIGVDaGlwMTAwMDo0LCBcbiAgZUdhcnlDaGlwIDogNSwgIFxuICBlT3RoZXJDaGlwOiA2LFxuXG59KTtcblxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLzIwIDUwIDEwMCA1MDAgMTAwMCBncmF5IG90aGVyXG4gICAgICAgIGNoaXBTa2luTm9kZUFycmF5OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICBtb25leUxhYmVsOmNjLk5vZGUsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcbiAgICBcbiAgICAvKipcbiAgICAgKiDorr7nva7nrbnnoIHnmq7ogqRcbiAgICAgKiBAcGFyYW0gdGFnIOWvueW6lOeahOetueeggee8luWPtygyMCA1MCAxMDAgNTAwIDEwMDAgZ3JheSBvdGhlcilcbiAgICAgKi9cbiAgICBzZXRTa2luV2l0aFRhZzogZnVuY3Rpb24odGFnKVxuICAgIHtcbiAgICAgICAgXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaXBTa2luTm9kZUFycmF5Lmxlbmd0aDsgaSArKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYodGFnID09IGkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwU2tpbk5vZGVBcnJheVtpXS5hY3RpdmF0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwU2tpbk5vZGVBcnJheVtpXS5hY3RpdmF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG5cbiAgICB9LFxuICAgIFxuICAgIC8qKlxuICAgICAqIOiuvue9ruaKleazqOmHkeminVxuICAgICAqIEBwYXJhbSBjaGlwTW9uZXkg5a+55bqU55qE6YeR6aKdXG4gICAgICovXG4gICAgc2V0TW9uZXk6IGZ1bmN0aW9uKGNoaXBNb25leSlcbiAgICB7XG4gICAgICAgIGlmKGNoaXBNb25leT4wKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm1vbmV5TGFiZWwuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBjaGlwTW9uZXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm1vbmV5TGFiZWwuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOWKqOeUu+mjnlxuICAgICAqIEBwYXJhbSBwb3NpdGlvbjEg5rqQ5L2N572uXG4gICAgICogQHBhcmFtIHBvc2l0aW9uMiDnm67moIfkvY3nva5cbiAgICAgKiBAcGFyYW0gZmxhZyAg6aOe5Zue5p2l6L+Y5piv6aOe5Zue5Y67XG4gICAgICogQHBhcmFtIGZseU5vZGUg6aOe6L+H56iL55qE562556CB5a+56LGhXG4gICAgICogQHBhcmFtIHNlbGYg6aOe5Yiw55qE55uu5qCH5a+56LGhXG4gICAgICogQHBhcmFtIGNhbGxGdW4g5Zue6LCD55qE5oyH6ZKIXG4gICAgICovXG4gICAgY2hpcEZseUFjdGlvbjogZnVuY3Rpb24ocG9zaXRpb24xLCBwb3NpdGlvbjIsIGZsYWcsIGZseU5vZGUsIHBvd2VyVGFyZ2V0LCBzZWxmLGNhbGxGdW4pXG4gICAge1xuICAgICAgICBsZXQgbW92ZXRvO1xuICAgICAgICBsZXQgZHQgPSAwLjI7XG4gICAgICAgIHRoaXMubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xuICAgICAgICBpZihmbGFnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24ocG9zaXRpb24xKTtcbiAgICAgICAgICAgIG1vdmV0byA9IGNjLm1vdmVUbyhkdCxwb3NpdGlvbjIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKHBvc2l0aW9uMik7XG4gICAgICAgICAgICBtb3ZldG8gPSBjYy5tb3ZlVG8oZHQscG9zaXRpb24xKTtcbiAgICAgICAgfVxuICAgICAgICAgXG4gICAgICAgIGxldCBhYzEgPSBjYy5zY2FsZVRvKGR0LCAxLjAsIDEuMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgdmFyIG9iaiA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgb2JqLnBvd2VyVGFyZ2V0ID0gcG93ZXJUYXJnZXQ7XG4gICAgICAgIG9iai5mbHlOb2RlID0gZmx5Tm9kZTtcbiAgICAgICAgb2JqLnRhcmdldCA9IHNlbGY7XG4gICAgICAgIG9iai5mbGFnID0gZmxhZztcbiAgICAgICAgICAgIFxuICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKG1vdmV0bywgY2MuY2FsbEZ1bmMoY2FsbEZ1biwgc2VsZiwgb2JqKSkpO1xuICAgIH0sXG4gICAgXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBFU2tpblRhZyA6IEVTa2luVGFnLFxufTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFxuICAgICAgICByZXdhcmRGbHlOb2RlU2tpbkFycmF5OlxuICAgICAgICB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG4gICAgXG4gICAgc2V0U2tpbjpmdW5jdGlvbihpbmRleClcbiAgICB7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLnJld2FyZEZseU5vZGVTa2luQXJyYXkubGVuZ3RoOyBpICsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZihpbmRleCA9PSBpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMucmV3YXJkRmx5Tm9kZVNraW5BcnJheVtpXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMucmV3YXJkRmx5Tm9kZVNraW5BcnJheVtpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBmbHlSZXdhcmRBY3Rpb246IGZ1bmN0aW9uKHBvc2l0aW9uMSwgcG9zaXRpb24yKVxuICAgIHtcbiAgICAgICAgbGV0IG1vdmV0bztcbiAgICAgICAgbGV0IGR0ID0gMC4yO1xuICAgICAgICB0aGlzLm5vZGUuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKHBvc2l0aW9uMSk7XG4gICAgICAgIG1vdmV0byA9IGNjLm1vdmVUbyhkdCxwb3NpdGlvbjIpO1xuICAgICAgICBsZXQgYWMxID0gY2Muc2NhbGVUbyhkdCwgMS4wLCAxLjApO1xuICAgICAgICAgICAgXG4gICAgICAgIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIG9iai50YXJnZXQgPSBzZWxmO1xuXG4gICAgICAgICAgICBcbiAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShtb3ZldG8pKTtcbiAgICB9LFxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsIlxuLy8gY29uc3QgaTE4biA9IHJlcXVpcmUoJ0xhbmd1YWdlRGF0YScpO1xuXG52YXIgTmV0RGF0YSA9IHJlcXVpcmUoXCJOZXREYXRhXCIpO1xudmFyIERhdGFPcGVyID0gcmVxdWlyZShcIkRhdGFPcGVyXCIpO1xudmFyIEJ1dHRvblNjYWxlID0gcmVxdWlyZShcIkJ1dHRvblNjYWxlXCIpO1xudmFyIEluaXQgPSByZXF1aXJlKFwiSW5pdFwiKTtcbnZhciBpbml0ID0gbmV3IEluaXQoKTtcbmluaXQuaW5pdCgpO1xuXG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHJld2FyZE5vZGU6IGNjLk5vZGUsXG4gICAgICAgIFxuICAgICAgICBibGFja0xheWVyOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgd2FpdExheWVyOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgY2R0aW1lSWNvbjogY2MuTm9kZSxcbiAgICAgICAgLy/lgJLorqHml7bnnIvljLrln59cbiAgICAgICAgY2RCZ1llbGxvdzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgY2RCZ1JlZDoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgY2RMYWJlbDoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXG4gICAgICAgIH0sXG4gICAgICAgIGNkSmllZHVhbkxhYmVsOntcbiAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvL+etueeggeWMulxuICAgICAgICBjaGlwTm9kZUFycmF5OiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBbXSxcbiAgICAgICAgICAgIHR5cGU6IFtjYy5Ob2RlXVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy/muIXpmaRcbiAgICAgICAgY2xlYXJPbk5vZGU6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIGNsZWFyT2ZmTm9kZToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vdG9hc3RcbiAgICAgICAgdG9hc3ROb2RlOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgY2hvb3NlQXJlYU5vZGVBcnJheToge1xuICAgICAgICAgICAgZGVmYXVsdDogW10sXG4gICAgICAgICAgICB0eXBlOiBbY2MuTm9kZV1cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGNoaXBBcmVhTm9Ub3VjaE5vZGU6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBiZXRBcmVhTm9Ub3VjaE5vZGU6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICBzdGFnZVN0b3BEaWFsb2c6Y2MuTm9kZSwgLy/nrKzkuIDlm57lkIjnu5PmnZ/mj5DnpLrmoYZsYWJlbFxuICAgICAgICBzdW1MaW1pdDogMCwgLy/liKTmlq3mipXms6jlkozlgLzvvJsg5piv5ZCm6LaF6L+HbGltaXQ7XG4gICAgICAgIG5lZWRDbGVhckZsYWc6IGZhbHNlLCAvL+mcgOimgea4heeQhjvopoHlnKjmipXms6jmiJDlip/lkI7osIM7XG4gICAgICAgIGNoaXBJbmRleDowLC8v562556CBbm9kZSDnmoQgaW5kZXhcbiAgICAgICAgY2xlYXJpbmdGbGFnOiBmYWxzZSwgLy/muIXnkIbkuK1cblxuICAgICAgICBjYW5CZXRGbGFnIDogdHJ1ZSwvL+W9k+WJjeaYr+WQpuWPr+S7peaKleazqFxuICAgICAgICBjdW5DbWQgOjEwMCwvL+m7mOiupDEwMFxuICAgICAgICBcbiAgICAgICAgZXJyb3JEaWFsb2c6IGNjLk5vZGUsXG4gICAgICAgIFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgXG4gICAgICAgIC8vIGkxOG4uaW5pdCgnZW4nKTtcbiAgICAgICAgLy8gdGhpcy5jZExhYmVsLnN0cmluZyA9IGkxOG4udCgnbGFiZWwuaGVsbG8nKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMubmV0RGF0YSA9IE5ldERhdGEuTmV0RGF0YS5nZXRJbnN0KCk7XG5cbiAgICAgICAgaWYodGhpcy5uZXREYXRhLmluaXRGbGFnID09IDEpe1xuICAgICAgICAgICAgY2MubG9nKFwi5q2j5bi45Yid5aeL5YyW6L+b5YWlVUlcIik7XG4gICAgICAgICAgICAvL+ebtOaOpeWIneWni+WMllxuICAgICAgICAgICAgdGhpcy5mcm9udEluaXQoKTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLm5ldERhdGEuaW5pdEZsYWcgPT0gMil7XG4gICAgICAgICAgICAvLyB0aGlzLm1pZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAvLyB0aGlzLnN0b3BIaW50KHRoaXMsIHRoaXMubmV0RGF0YS5zdG9wU2VsbGluZ0Rlc2MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBjYy5sb2coXCJmZWnmraPluLjliJ3lp4vljJbov5vlhaVVSVwiKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5pbml0V2FpdCwgMC4xKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gLy/mtYvor5VcbiAgICAgICAgLy8gdGhpcy5uZXREYXRhLnRpbWVGbGFnID0gMTtcbiAgICAgICAgLy8gdGhpcy5uZXREYXRhLnNlY3MgPSAyNTtcbiAgICAgICAgXG4gICAgICAgIC8vIHZhciBvYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIC8vIG9iai5zdGF0dXMgPSAxO1xuICAgICAgICAvLyBvYmouYmV0TGlzdCA9IFsxMCwgMjAsIDMwLCA0MCwgNTBdO1xuICAgICAgICAvLyB2YXIgb2Rkc0xpc3RPYmogPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgIC8vIG9kZHNMaXN0T2JqLm9wdGlvbiA9IFwi576k6ZuEXCI7XG4gICAgICAgIC8vIG9kZHNMaXN0T2JqLmlkID0gMTtcbiAgICAgICAgLy8gb2Rkc0xpc3RPYmoucG93ZXJJZCA9IDI7XG4gICAgICAgIC8vIG9kZHNMaXN0T2JqLm9kZHMxID0gMC4yO1xuICAgICAgICAvLyBvZGRzTGlzdE9iai5vZGRzMiA9IDAuODtcbiAgICAgICAgLy8gb2Rkc0xpc3RPYmouc3RhdHVzID0gMTtcbiAgICAgICAgLy8gb2JqLm9kZHNMaXN0ID0gb2Rkc0xpc3RPYmo7XG4gICAgICAgIC8vIHRoaXMubmV0RGF0YS5pbml0RGF0YSA9IG9iajtcbiAgICAgICAgLy8gdGhpcy5nYW1lU3RhcnQoKTtcblxuICAgIH0sXG4gICAgXG4gICAgXG4gICAgaW5pdFdhaXQ6IGZ1bmN0aW9uKGR0KXtcbiAgICAgICAgaWYodGhpcy5uZXREYXRhLmluaXRGbGFnKXtcbiAgICAgICAgICAgIC8v55u05o6l5Yid5aeL5YyWXG4gICAgICAgICAgICB0aGlzLmZyb250SW5pdCgpO1xuICAgICAgICAgICAgdGhpcy5nYW1lU3RhcnQoKTtcbiAgICAgICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmluaXRXYWl0KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBmcm9udEluaXQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIGlmKHRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPT0gMSl7XG4gICAgICAgICAgICB2YXIgdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGxvY2FsVGltZSA9IHRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGxldCBvZmZzZXQgPSBNYXRoLnJvdW5kKChsb2NhbFRpbWUgLSBpbml0LnRpbWVTdGFtcCkgLyAxMDAwKTsgXG4gICAgICAgICAgICB0aGlzLm5ldERhdGEuc2VjcyAtPSBvZmZzZXQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm9mZnNldD0gXCIgKyBvZmZzZXQgKyBcInNlYz0gXCIgKyB0aGlzLm5ldERhdGEuc2Vjcyk7XG5cbiAgICAgICAgICAgIGlmKHRoaXMubmV0RGF0YS5zZWNzIDwgMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXREYXRhLmluaXREYXRhLnN0YXR1cyA9IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgIC8vIH1cbiAgICB9LFxuXG4gICAgcmVzdW1lVGljazogZnVuY3Rpb24oZHQpe1xuICAgICAgICB0aGlzLnJlc3VtRmxhZyA9IHRydWU7XG4gICAgfSxcblxuICAgIHN0YXJ0OiBmdW5jdGlvbigpe1xuICAgICAgICBpZiAoY2MuX3JlbmRlclR5cGUgPT09IGNjLmdhbWUuUkVOREVSX1RZUEVfQ0FOVkFTKSB7XG4gICAgICAgICAgICBjYy5yZW5kZXJlci5lbmFibGVEaXJ0eVJlZ2lvbihmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIGlzQ2FuQmV0OmZ1bmN0aW9uKGNhbGxiYWNrKVxuICAgICB7XG4gICAgICAgICB2YXIgZmxhZyA9IGZhbHNlO1xuICAgICAgICAgXG4gICAgICAgIGlmICghQ0NfSlNCKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICB2YXIgc2RrID0gd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREs7XG4gICAgICAgICAgICBpZiAoc2RrKSBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzZGsuaXNMb2dpbihmdW5jdGlvbihpc0xvZ2luKSBcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgaWYoIWlzTG9naW4pLy/msqHnmbvlvZXljrvnmbvlvZVcbiAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdvTG9naW4oKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGVsc2UvL+eZu+W9leS6hiDliKTmlq3mmK/lkKbojrflj5bosYbmiJDlip9cbiAgICAgICAgICAgICAgICAgIHtcblxuICAgICAgICAgICAgICAgICAgICBzZGsuc2V0Q2FjaGUoJ2NoaXAnLCBzZWxmLm5ldERhdGEuYmV0TGlzdFtzZWxmLmNoaXBJbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy/lnKjliKTmlq3mmK/lkKbotrPpop3vvIjmt5jlrp3nm7jlhbPvvIlcbiAgICAgICAgICAgICAgICAgICAgdmFyICBwcmljZSA9IHNlbGYubmV0ZGF0YS5iZXRMaXN0W3NlbGYuY2hpcEluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGZsYWcgPSBzZWxmLmp1ZGdlQmFsYW5jZShwcmljZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKGZsYWcpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG5cbiAgICAgfSxcbiAgICAgXG4gICAgZ29Mb2dpbjogZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoIUNDX0pTQil7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgc2RrID0gd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREs7XG5cbiAgICAgICAgICAgIGlmKHNkayl7XG4gICAgICAgICAgICAgICAgc2RrLmxvZ2luKGZ1bmN0aW9uKCkgey8v6ZyA6KaB6LCD5Yid5aeL5YyWO1xuICAgICAgICAgICAgICAgICAgICAvLyBsb2dpbiDlkI7miafooYxcbiAgICAgICAgICAgICAgICAgICAgc2RrLnVwZGF0ZVVzZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgIC8qc2RrLmdldFVzZXJJbmZvKGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXREYXRhLnNka0JhbGFuY2UgPSBpbmZvLmZlZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gaW5mby51aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5pY2sgPSBpbmZvLm5pY2s7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93VXNlckljb24odWlkLCBuaWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5mcmVzaCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICB0aGlzLmZyZXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHRoaXMuZnJlc2goKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBleGl0SnVkZ2U6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGxldCBmZyA9IGZhbHNlO1xuICAgICAgICBsZXQgdW5maW5pc2ggPSBmYWxzZTtcblxuICAgICAgICBpZighdGhpcy5jYW5CZXRGbGFnIHx8IHVuZmluaXNoKXtcbiAgICAgICAgICAgIHRoaXMuZXJyRGlhbG9nVGFnID0gMztcblxuICAgICAgICAgICAgaWYodGhpcy5jbGVhcmluZ0ZsYWcpe1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yTGF5ZXIoXCLmraPlnKjluK7kvaDmkqTljZXvvIzor7fnqI3nrYlcIiwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yTGF5ZXIoXCLmraPlnKjluK7kvaDkuIvljZXvvIzor7fnqI3nrYlcIiwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZnID0gdHJ1ZTsgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmZztcbiAgICB9LFxuICAgIFxuICAgIGZyZXNoOmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHRoaXMuc2V0U3RhZ2VUZXh0KCk7XG4gICAgfSxcbiAgICBcbiAgICBleGl0R2FtZTogZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKCFDQ19KU0Ipe1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREsucG9wV2luZG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnZ2FtZScpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGdhbWVTdGFydDogZnVuY3Rpb24oKXtcbiAgICAgICAgY2MubG9nKFwiZ2FtZXN0YXJ0XCIpO1xuICAgICAgICB0aGlzLnNldFN0YWdlVGV4dCgpO1xuICAgICAgICB0aGlzLmdldENoaXBJbmRleCgpO1xuICAgICAgICB0aGlzLnNob3dDaGlwTnVtKCk7XG4gICAgICAgIHRoaXMuc3dpZnRTZWMoKTtcbiAgICAgICAgdGhpcy5zaG93UG93ZXJJbmZvKCk7XG4gICAgfSxcbiAgICBcbiAgICByZUdvOiBmdW5jdGlvbigpXG4gICAge30sXG4gICAgXG4gICAgc2hvd1Bvd2VySW5mbzpmdW5jdGlvbigpXG4gICAge1xuICAgICAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmNob29zZUFyZWFOb2RlQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gdGhpcy5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgdmFyIHBvd2VySlMgPSBjaG9vc2VBcmVhLmdldENvbXBvbmVudChcIlBvd2VyXCIpO1xuICAgICAgICAgICAgcG93ZXJKUy51cGRhdGFJbmZvKHRoaXMuY3VuQ21kKTtcbiAgICAgICAgICAgIHBvd2VySlMudXBkYXRhVUkodGhpcy5jdW5DbWQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBmbHlTdGFtcDogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8dGhpcy5jaG9vc2VBcmVhTm9kZUFycmF5Lmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgY2hvb3NlQXJlYSA9IHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheVtpXTtcbiAgICAgICAgICAgIHZhciBwb3dlckpTID0gY2hvb3NlQXJlYS5nZXRDb21wb25lbnQoXCJQb3dlclwiKTtcbiAgICAgICAgICAgIGlmKHBvd2VySlMucG93ZXJJZD4xICYmIHBvd2VySlMucG93ZXJJZCA8PSA1KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8v5bu25pe255qEMnPotbDnm5bmiLNcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShwb3dlckpTLnB1dFN0YW1wT25BY3Rpb24oKSwgMC4zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgc2V0U3RhZ2VUZXh0OmZ1bmN0aW9uKClcbiAgICB7XG4gICAgICAgIHRoaXMuY2RKaWVkdWFuTGFiZWwubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmNkdGltZUljb24uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jZExhYmVsLm5vZGUueCA9IC01NDtcbiAgICAgICAgXG4gICAgICAgIHZhciBqaWVkdWFuID0gdGhpcy5jZEppZWR1YW5MYWJlbC5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICBpZih0aGlzLm5ldERhdGEudGltZUZsYWcgPT0gMSkvL+ebsumAiemYtuautVxuICAgICAgICB7XG4gICAgICAgICAgICBqaWVkdWFuLnN0cmluZyA9IFwi55uy6YCJXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLm5ldERhdGEudGltZUZsYWcgPT0gMikvL+aYjumAiemYtuautVxuICAgICAgICB7XG4gICAgICAgICAgICBqaWVkdWFuLnN0cmluZyA9IFwi5piO6YCJXCI7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIFxuICAgIHN3aWZ0U2VjOiBmdW5jdGlvbigpe1xuICAgICAgICAvLzHvvJrmmpfniYzmraPlnKjmipXms6jvvIwy77ya5pqX54mM6Zi25q615bey5oiq5q2i77yMM++8muaYjueJjOato+WcqOaKleazqO+8jDQ65piO54mM5oiq6Iez5oqV5rOo77yMNe+8muato+WcqOW8gOWllu+8jDc65YGc5ZSuXG4gICAgICAgIGNjLmxvZyhcInRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgXCIsIHRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMpO1xuICAgICAgICBjYy5sb2coXCJ0aW1lIGlzIFwiLCB0aGlzLm5ldERhdGEuc2Vjcyk7XG4gICAgICAgIHN3aXRjaCh0aGlzLm5ldERhdGEuaW5pdERhdGEuc3RhdHVzKXtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLm5ldERhdGEuc2VjcyA+PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IHRoaXMubmV0RGF0YS5zZWNzICsgXCLigLNcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwiMOKAs1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgcHQgPSB0aGlzLmNkQmdSZWQucGFyZW50O1xuICAgICAgICAgICAgICAgIHB0LnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICAgICAgICAgICAgcHQucnVuQWN0aW9uKGNjLnNob3coKSk7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLm5ldERhdGEuc2VjcyA8PSAzKXsgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2RCZ1JlZC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkdCAgPSAwLjM4Oy8vMyAvIDg7XG4gICAgICAgICAgICAgICAgICAgIHB0LnJ1bkFjdGlvbihjYy5yZXBlYXQoY2Muc2VxdWVuY2UoY2MuZGVsYXlUaW1lKGR0KSwgY2MuaGlkZSgpLCBjYy5kZWxheVRpbWUoZHQpLCBjYy5zaG93KCkpLCA0KSk7IFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZEJnUmVkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5zaG93U2VjLCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXlMaWdodChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5kb1N0b3BCZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1OntcbiAgICAgICAgICAgICAgICAvL+ato+WcqOW8gOWlllxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmV3YXJkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNzp7XG4gICAgICAgICAgICAgICAgLy/lgZzllK5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNlY0NkOiBmdW5jdGlvbihkdCl7XG4gICAgICAgIHRoaXMubmV0RGF0YS5zZWNzLS07XG4gICAgfSxcblxuICAgIHNob3dTZWMgOiBmdW5jdGlvbihkdCl7XG4gICAgICAgIC8vIGNjLmxvZyhcInNob3dTZWPvvJp0aGlzLm5ldERhdGEuc2VjcyBcIix0aGlzLm5ldERhdGEuc2Vjcyk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLm5ldERhdGEuc2Vjcy0tO1xuXG4gICAgICAgIGlmKHRoaXMubmV0RGF0YS5zZWNzID49IDApe1xuICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IHRoaXMubmV0RGF0YS5zZWNzICsgXCLigLNcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwiMOKAs1wiO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5uZXREYXRhLnNlY3MgPD0gMyl7XG4gICAgICAgICAgICBsZXQgcHQgPSB0aGlzLmNkQmdSZWQucGFyZW50O1xuICAgICAgICAgICAgY2MubG9nKFwic2VjPDNcIik7XG4gICAgICAgICAgICB0aGlzLmNkQmdSZWQuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY2RCZ1llbGxvdy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBkdCAgPSAwLjM4Oy8vMyAvIDg7XG4gICAgICAgICAgICBwdC5ydW5BY3Rpb24oY2MucmVwZWF0KGNjLnNlcXVlbmNlKGNjLmRlbGF5VGltZShkdCksIGNjLmhpZGUoKSwgY2MuZGVsYXlUaW1lKGR0KSwgY2Muc2hvdygpKSwgNCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5uZXREYXRhLnNlY3MgPD0gMCl7XG4gICAgICAgICAgICBjYy5sb2coXCJzZWM9PSAwXCIpO1xuICAgICAgICAgICAgdGhpcy5kb1N0b3BCZXQoKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgZG9TdG9wQmV0IDogZnVuY3Rpb24oKXtcbiAgICAgICAgY2MubG9nKFwidGhpcy5uZXREYXRhLnRpbWVGbGFnXCIsIHRoaXMubmV0RGF0YS50aW1lRmxhZyk7XG4gICAgICAgIHRoaXMuY2FuQmV0RmxhZyA9IGZhbHNlO1xuICAgICAgICAvLyB0aGlzLnVuc2NoZWR1bGUodGhpcy50dXJuVGFibGVMb2dpYyk7XG4gICAgICAgIHRoaXMuY2RCZ1JlZC5wYXJlbnQuc3RvcEFsbEFjdGlvbnMoKTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLnBhcmVudC5ydW5BY3Rpb24oY2Muc2hvdygpKTtcbiAgICAgICAgdGhpcy5jZEJnWWVsbG93LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY2RCZ1JlZC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jZExhYmVsLm5vZGUueCA9IC01NDtcbiAgICAgICAgLy8gdGhpcy5jZExhYmVsLncgPSAyMjA7XG4gICAgICAgIHRoaXMuY2RMYWJlbC5zdHJpbmcgPSBcIuW3suaIquatolwiO1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5zaG93U2VjKTsgICAgICAgIFxuICAgICAgICAvL+WPmOeBsDtcbiAgICAgICAgdGhpcy5ncmF5TGlnaHQodHJ1ZSk7XG4gICAgICAgIHRoaXMubmV0RGF0YS5pbml0RGF0YS5zdGF0dXMgPSAyO1xuICAgICAgICBpZih0aGlzLm5ldERhdGEudGltZUZsYWcgPT0gMSkvL+aPkOekuuahhueahOW8ueWHuuiOt+WPlue7k+aenOW8gOWlluWwseeEtuWQjuiOt+WPluesrOS6jOWbnuWQiOaVsOaNrlxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0YWdlU3RvcERpYWxvZy5hY3RpdmUgID0gdHJ1ZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGR0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2Vjb25kRGF0YSgpOy8v6I635Y+W56ys5LqM6Zi25q61XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShjYWxsYmFjaywgMTApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UvL+iOt+WPluW8gOWllue7k+aenFxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmdldFJld2FyZCgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBncmF5TGlnaHQ6IGZ1bmN0aW9uKGZsYWcpe1xuICAgICAgICB0aGlzLmNsZWFyT25Ob2RlLnBhcmVudC5hY3RpdmUgPSAhZmxhZztcbiAgICAgICAgdGhpcy5jbGVhck9mZk5vZGUucGFyZW50LmFjdGl2ZSA9IGZsYWc7XG4gICAgICAgIHRoaXMuYmV0QXJlYU5vVG91Y2hOb2RlLmFjdGl2ZSA9IGZsYWc7XG4gICAgfSxcbiAgICBcbiAgICBnZXRSZXdhcmQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5zaG93U2VjKTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLnBhcmVudC5zdG9wQWxsQWN0aW9ucygpO1xuICAgICAgICB0aGlzLmNkQmdSZWQucGFyZW50LnJ1bkFjdGlvbihjYy5zaG93KCkpO1xuICAgICAgICB0aGlzLmNkQmdZZWxsb3cuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jZEJnUmVkLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNkSmllZHVhbkxhYmVsLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICB0aGlzLmNkdGltZUljb24uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICB0aGlzLmNkTGFiZWwubm9kZS54ID0gLTEwMDtcbiAgICAgICAgdGhpcy5jZExhYmVsLnN0cmluZyA9IFwi5q2j5Zyo5byA5aWWXCI7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKHRoaXMuZG9SZXdhcmQsIDYpOyAvL+aPkOWJjeeahDPnp5IgKyDnu5nmnI3liqHlmajpooTnlZnnmoQy56eSO1xuICAgIH0sXG4gICAgXG4gICAgZ2V0U2Vjb25kRGF0YTogZnVuY3Rpb24oKS8v6I635Y+W56ys5LqM6Zi25q6155qE5pWw5o2uXG4gICAge1xuICAgICAgICB0aGlzLnNob3dXYWl0TGF5ZXIoKTtcbiAgICAgICAgdmFyIGRhdGFPcGVyID0gRGF0YU9wZXIuRGF0YU9wZXIuZ2V0SW5zdCgpO1xuICAgICAgICBkYXRhT3Blci5nZXRTZWNvbmREYXRhKHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpO1xuICAgIH0sXG4gICAgXG4gICAgZG9SZXdhcmQgOiBmdW5jdGlvbihkdCl7XG4gICAgICAgIHRoaXMuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgIGRhdGFPcGVyLmdldFJld2FyZCh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgc2hvd1dhaXRMYXllcjogZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5ibGFja0xheWVyLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2FpdExheWVyLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGhpZGVXYWl0TGF5ZXI6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuYmxhY2tMYXllci5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy53YWl0TGF5ZXIuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcbiAgICBcbiAgICBqdWRnZUJhbGFuY2U6IGZ1bmN0aW9uKGFtb3VudCl7XG4gICAgICAgIGxldCBmZyA9IHRydWU7XG5cbiAgICAgICAgaWYodGhpcy5zZGtCYWxhbmNlID09IC0xKXtcbiAgICAgICAgICAgIC8vIHRoaXMuZXJyRGlhbG9nVGFnID0gNTtcbiAgICAgICAgICAgIC8vIHRoaXMuYmxhY2tMYXllci5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgLy8gdGhpcy5yZWZyZXNoTm9kZS5nZXRDaGlsZEJ5TmFtZShcIndvcmRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIuiOt+WPllwiICsgdGhpcy5uZXREYXRhLmN1cnJlbmN5ICsgXCLlpLHotKXvvIzor7fliLfmlrDpobXpnaJcIjtcbiAgICAgICAgICAgIC8vIHRoaXMucmVmcmVzaE5vZGUucnVuQWN0aW9uKGNjLnNjYWxlVG8oMC4yLCAxLjAsIDEuMCkpO1xuICAgICAgICAgICAgZmcgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuXG4gICAgICAgICAgICBpZihhbW91bnQgPiB0aGlzLnNka0JhbGFuY2Upe1xuICAgICAgICAgICAgICAgIC8v5o+Q56S65L2Z6aKd5LiN6Laz77yM6Lez6L2s5Yiw5YWF5YC8XG4gICAgICAgICAgICAgICAgaWYgKCFDQ19KU0Ipe1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmFsaUxvdHRlcnlDYXNpbm9TREspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hbGlMb3R0ZXJ5Q2FzaW5vU0RLLnJlY2hhcmdlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm5vIGJhbGFuY2VcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmc7XG4gICAgfSxcbiAgICBcbiAgICBnZXRDaGlwSW5kZXg6IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBzZGsgPSB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESztcbiAgICAgICAgXG4gICAgICAgIGlmKHNkayl7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBsZXQgbGVuID0gdGhpcy5uZXREYXRhLmJldExpc3QubGVuZ3RoO1xuXG4gICAgICAgICAgICB3aW5kb3cuYWxpTG90dGVyeUNhc2lub1NESy5nZXRDYWNoZSgnY2hpcCcsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGYubmV0RGF0YS5iZXRMaXN0W2ldID09IHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGlwSW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGYubmV0RGF0YS5iZXRMaXN0W2ldID09IHNlbGYubmV0RGF0YS5wcmVCZXQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2hpcEluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9ICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIC8qKioqKioqKioqKioqKioqKipuZXRDYWxsYmFjayoqKioqKioqKioqKioqKioqKioqL1xuICAgIG5ldENhbGxiYWNrOiBmdW5jdGlvbihjbWQsIHJlcywgbXNnLCBzZWxmKVxuICAgIHtcbiAgICAgICAgY2MubG9nKFwibmV0Q2FsbGJhY2sgY21kPVwiICsgY21kKTtcbiAgICAgICAgc2VsZi5jdW5DbWQgPSBjbWQ7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgc2VsZi5oaWRlV2FpdExheWVyKCk7XG4gICAgICAgIHJlcyA9IHBhcnNlSW50KHJlcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzPVwiICsgcmVzICsgXCIvbWc9XCIgKyBtc2cgK1wiL2NtZD1cIiArIHNlbGYuY3VuQ21kKTtcbiAgICAgICAgc3dpdGNoKHJlcylcbiAgICAgICAge1xuICAgICAgICBjYXNlIDA6eyAgICAgICAgICAgIFxuICAgICAgICAgICAgc3dpdGNoKGNtZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDovL2luaXRcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZ2FtZVN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAxOi8vYmV0XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dQb3dlckluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgLy/mipXms6jmiJDlip/lkI7muIXpm7ZcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGk8c2VsZi5jaG9vc2VBcmVhTm9kZUFycmF5Lmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hvb3NlQXJlYSA9IHNlbGYuY2hvb3NlQXJlYU5vZGVBcnJheVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3dlckpTID0gY2hvb3NlQXJlYS5nZXRDb21wb25lbnQoXCJQb3dlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBvd2VySlMuYmV0RmxhZylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3dlckpTLmJldE51bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDI6Ly9jbGVhclxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93UG93ZXJJbmZvKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAzOi8vcmV3YXJkXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNoaXBBcmVhTm9Ub3VjaE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1Bvd2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmZseVN0YW1wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA0Oi8vdHdvc3RlbXBcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc3RhZ2VTdG9wRGlhbG9nLmFjdGl2ZSAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZShzZWxmLnNob3dTZWMsIDEpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmdyYXlMaWdodChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0U3RhZ2VUZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1Bvd2VySW5mbygpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDU6Ly9vcmRlcmxpc3RcbiAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTA2Oi8vaGlzdG9yeWxpc3RcbiAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDIwMDAwOTovL+S9memineS4jei2sztcbiAgICAgICAge1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNjLmxvZyhcInJlcyBkZWZhdWx0IVwiKTtcbiAgICAgICAgICAgIHN3aXRjaChjbWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDE6Ly/mipXms6jlpLHotKXlm57mlLbnrbnnoIFcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaG93VG9hc3QobXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jYW5CZXRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaTxzZWxmLmNob29zZUFyZWFOb2RlQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNob29zZUFyZWEgPSBzZWxmLmNob29zZUFyZWFOb2RlQXJyYXlbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvd2VySlMgPSBjaG9vc2VBcmVhLmdldENvbXBvbmVudChcIlBvd2VyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBvd2VySlMuYmV0RmxhZylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VySlMucmVkdWNlU2VsZkNoaXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc3RhZ2VTdG9wRGlhbG9nLmFjdGl2ZSAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v6YCa5bi455qE6ZSZ6K+v5o+Q56S6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JEaWFsb2dKcyA9IHNlbGYuZXJyb3JEaWFsb2cuZ2V0Q29tcG9uZW50KFwiZXJyb3JEaWFsb2dcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckRpYWxvZ0pzLnNob3dEaWFsb2cobXNnLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9LFxuICAgIC8qKioqKioqKioqKioqKioqKipuZXRDYWxsYmFjayoqKioqKioqKioqKioqKioqKioqL1xuICAgIC8v57uT566X6aOe5oiz57uT5p2fXG4gICAgcmV3YXJkRmx5RmluaXNoZWRDYWxsYmFjazogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgLy/mj5DnpLrlho3mnaXkuIDlsYAxMDNcbiAgICAgICAgY2MubG9nKFwi6K+l5o+Q56S657uT566X6aG16Z2i5LqGXCIpO1xuICAgICAgICBcbiAgICAgICAgdmFyIG5ldERhdGEgPSBOZXREYXRhLk5ldERhdGEuZ2V0SW5zdCgpO1xuICAgICAgICB2YXIgc3RhdHVzID0gbmV0RGF0YS5yZXdhcmREYXRhLnN0YXR1cztcbiAgICAgICAgdGhpcy5yZXdhcmROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBudW0gPSAwO1xuICAgICAgICBpZihzdGF0dXMgPT0gMSkvL3NoZW5nXG4gICAgICAgIHtcbiAgICAgICAgICAgIG51bSA9IG5ldERhdGEucmV3YXJkRGF0YS5hbW91bnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMikvL2Z1XG4gICAgICAgIHtcbiAgICAgICAgICAgIG51bSA9IG5ldERhdGEucmV3YXJkRGF0YS5hbGxOdW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMykvL3BpbmdcbiAgICAgICAge1xuICAgICAgICAgICAgbnVtID0gbmV0RGF0YS5yZXdhcmREYXRhLmFtb3VudDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5yZXdhcmROb2RlLmdldENvbXBvbmVudChcInJld2FyZE5vZGVcIikuc2V0Q29udGVudChzdGF0dXMsIG51bSk7XG5cbiAgICB9LFxuICAgIFxuICAgIHJld2FyZE5vZGVDb2xzZTogZnVuY3Rpb24oKVxuICAgIHtcbiAgICAgICAgdGhpcy5yZXdhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zaG93UG93ZXJJbmZvKCk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUoc2VsZi5zaG93U2VjLCAxKTtcbiAgICAgICAgdGhpcy5ncmF5TGlnaHQoZmFsc2UpO1xuICAgICAgICB0aGlzLnNldFN0YWdlVGV4dCgpO1xuICAgIH0sXG4gICAgXG4gICAgY2xlYXJXaXRoRmxhZzogZnVuY3Rpb24oZmxhZylcbiAgICB7XG4gICAgICAgIHRoaXMuY2xlYXJPbk5vZGUucGFyZW50LmFjdGl2ZSA9IGZsYWc7XG4gICAgICAgIHRoaXMuY2xlYXJPZmZOb2RlLnBhcmVudC5hY3RpdmUgPSAhZmxhZztcbiAgICB9LFxuICAgIFxuICAgIC8v5omA5pyJ5oyJ6ZKu55qE5Zue6LCD562J562J5LqL5Lu2XG4gICAgYnRuQWN0aW9uQ2FsbEJhY2sgOmZ1bmN0aW9uKGJ0blRhZylcbiAgICB7XG4gICAgICAgIHN3aXRjaChidG5UYWcpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGNhc2UgQnV0dG9uU2NhbGUuRWJ1dHRvblRhZy5lQ2xlYXJlOlxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgeyAgXG4gICAgICAgICAgICAgICAgY2MubG9nKFwiY2xlYXIgY2xlYXIhISFcIik7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyaW5nRmxhZyA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLmNhbkJldEZsYWcpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbkJldEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhcldpdGhGbGFnKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFPcGVyLmdldENsZWFyKHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmx5QmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1bUxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXREYXRhLmJldExpbWl0ID0gdGhpcy5uZXREYXRhLnRvdGFsQmV0TGltaXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmVlZENsZWFyRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmx5QmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1bUxpbWl0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXREYXRhLmJldExpbWl0ID0gdGhpcy5uZXREYXRhLnRvdGFsQmV0TGltaXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEJ1dHRvblNjYWxlLkVidXR0b25UYWcuZUNoaXAyMDpcbiAgICAgICAgICAgIGNhc2UgQnV0dG9uU2NhbGUuRWJ1dHRvblRhZy5lQ2hpcDUwOlxuICAgICAgICAgICAgY2FzZSBCdXR0b25TY2FsZS5FYnV0dG9uVGFnLmVDaGlwMTAwOlxuICAgICAgICAgICAgY2FzZSBCdXR0b25TY2FsZS5FYnV0dG9uVGFnLmVDaGlwNTAwOlxuICAgICAgICAgICAgY2FzZSBCdXR0b25TY2FsZS5FYnV0dG9uVGFnLmVDaGlwMTAwMDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwSW5kZXggPSBidG5UYWc7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldENoaXAoKTtcbiAgICAgICAgICAgICAgICBjYy5sb2coXCJjaGlwSW5kZXggaXMgPSBcIiwgdGhpcy5jaGlwSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBlcnJvckRpYWxvZ0NhbGxiYWNrOiBmdW5jdGlvbih0eXBlYWN0aW9uLCBwb3NpdG9uKS8vMSDlt6bovrnmjInpkq4gMiDlj7PovrnmjInpkq5cbiAgICB7XG4gICAgICAgIHZhciBlcnJvckRpYWxvZ0pzID0gdGhpcy5lcnJvckRpYWxvZy5nZXRDb21wb25lbnQoXCJlcnJvckRpYWxvZ1wiKTtcbiAgICAgICAgZXJyb3JEaWFsb2dKcy5oaWRlRGlhbG9nKCk7XG4gICAgICAgIFxuICAgICAgICBpZihwb3NpdG9uID09IDEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN3aXRjaCh0eXBlYWN0aW9uKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/lj6rmnInkuIDkuKrmjInpkq7liLfmlrDliLfmlrDnmoRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VuQ21kID09IDEwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuZ2V0SW5pdCh0aGlzLm5ldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5jdW5DbWQgPT0gMTAxKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmN1bkNtZCA9PSAxMDIpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuY3VuQ21kID09IDEwMylcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dXYWl0TGF5ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YU9wZXIgPSBEYXRhT3Blci5EYXRhT3Blci5nZXRJbnN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YU9wZXIuZ2V0UmV3YXJkKHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpOyBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodGhpcy5jdW5DbWQgPT0gMTA0KVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1dhaXRMYXllcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhT3BlciA9IERhdGFPcGVyLkRhdGFPcGVyLmdldEluc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhT3Blci5nZXRTZWNvbmREYXRhKHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih0aGlzLmN1bkNtZCA9PSAxMDUpXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMuY3VuQ21kID09IDEwNilcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgc3dpdGNoKHR5cGVhY3Rpb24pXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICB7fVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHt9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAge31cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9ICBcbiAgICAgICAgfVxuICAgIH0sXG4gICAgXG4gICAgc2hvd0NoaXBOdW06IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jaGlwTm9kZUFycmF5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGxldCBsZSA9IHRoaXMuY2hpcE5vZGVBcnJheVtpXS5nZXRDaGlsZEJ5TmFtZShcIkxhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCk7XG4gICAgICAgICAgICB0aGlzLmFkanVzdEZvbnRzaXplKGxlLCBuZXREYXRhLmluaXREYXRhLmJldExpc3RbaV0pOyAgICAgICAgICAgIFxuICAgICAgICAgICAgbGUuc3RyaW5nID0gbmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0W2ldO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgbmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0Lmxlbmd0aDsgaiArKylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYobmV0RGF0YS5pbml0RGF0YS5iZXRMaXN0W2pdID09IG5ldERhdGEuaW5pdERhdGEucHJlQmV0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpcEluZGV4ID0gajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2V0Q2hpcCgpO1xuICAgIH0sXG5cbiAgICBhZGp1c3RGb250c2l6ZTogZnVuY3Rpb24obGFiZWwsIG51bSl7XG4gICAgICAgIGxldCBzZSA9IDcxO1xuXG4gICAgICAgIGlmKG51bSA8IDEwMCl7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihudW0gPCAxMDAwKXtcbiAgICAgICAgICAgIGxhYmVsLmZvbnRTaXplID0gc2UgKiAwLjg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIGxhYmVsLmZvbnRTaXplID0gc2UgKiAwLjU2O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICByZXNldENoaXA6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaXBOb2RlQXJyYXkubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYodGhpcy5jaGlwSW5kZXggPT0gaSl7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwTm9kZUFycmF5W2ldLnNjYWxlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwTm9kZUFycmF5W2ldLnNjYWxlID0gMC44O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcbiAgICBzaG93VG9hc3Q6IGZ1bmN0aW9uKG1zZyl7XG4gICAgICAgIHRoaXMudG9hc3ROb2RlLnN0b3BBbGxBY3Rpb25zKCk7XG4gICAgICAgIHRoaXMudG9hc3ROb2RlLnNjYWxlID0gMDtcbiAgICAgICAgbGV0IGxlICA9IHRoaXMudG9hc3ROb2RlLmdldENoaWxkQnlOYW1lKFwid29yZFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xuICAgICAgICBsZS5zdHJpbmcgPSBtc2c7XG4gICAgICAgIGxldCBsZW4gPSBsZS5ub2RlLndpZHRoICsgMjA7IFxuICAgICAgICB0aGlzLnRvYXN0Tm9kZS53aWR0aCA9IGxlbjtcbiAgICAgICAgbGV0IGR0ID0gMC4yO1xuICAgICAgICBsZXQgYWMxID0gY2Muc2NhbGVUbyhkdCwgMS4wLCAxLjApO1xuICAgICAgICBsZXQgYWMyID0gY2Muc2NhbGVUbyhkdCwgMCwgMCk7XG4gICAgICAgIHRoaXMudG9hc3ROb2RlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShhYzEsIGNjLmRlbGF5VGltZSgyKSwgYWMyKSk7XG4gICAgfSxcbiAgICBcbiAgICBmbHlCYWNrOiBmdW5jdGlvbigpe1xuICAgICAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmNob29zZUFyZWFOb2RlQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBjaG9vc2VBcmVhID0gdGhpcy5jaG9vc2VBcmVhTm9kZUFycmF5W2ldO1xuICAgICAgICAgICAgdmFyIHBvd2VySlMgPSBjaG9vc2VBcmVhLmdldENvbXBvbmVudChcIlBvd2VyXCIpO1xuICAgICAgICAgICAgaWYocG93ZXJKUy5iZXRGbGFnKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBvd2VySlMuZmx5QmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBcblxuICAgIHBvd2VyQmV0IDogZnVuY3Rpb24oY2FsbEZ1bmMsIHBvd2VyKXtcbiAgICAgICAgLy/liKTmlq3nmbvlvZXjgIHkvZnpop1UT0RPXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZihzZWxmLm5ldERhdGEuaW5pdERhdGEuc3RhdHVzID09IDEgfHwgc2VsZi5uZXREYXRhLmluaXREYXRhLnN0YXR1cyA9PSAzKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNlbGYuY2FuQmV0RmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhcldpdGhGbGFnKHRydWUpO1xuICAgICAgICAgICAgICAgIGNhbGxGdW5jKHNlbGYuY2hpcEluZGV4LCBwb3dlcik7XG4gICAgICAgICAgICAgICAgc2VsZi51bnNjaGVkdWxlKHNlbGYuZGVhbEJldCk7XG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2Uoc2VsZi5kZWFsQmV0LCAwLjUpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuaXNDYW5CZXQoY2FsbGJhY2spO1xuICAgICAgICBcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog55yf5a6e5oqV5rOoXG4gICAgICovXG4gICAgZGVhbEJldCA6IGZ1bmN0aW9uKGR0KXtcbiAgICAgICAgdGhpcy5zaG93V2FpdExheWVyKCk7XG4gICAgICAgIHZhciBuZXREYXRhID0gTmV0RGF0YS5OZXREYXRhLmdldEluc3QoKTtcbiAgICAgICAgdmFyIGRhdGFPcGVyID0gRGF0YU9wZXIuRGF0YU9wZXIuZ2V0SW5zdCgpO1xuICAgICAgICAvL+mmluWFiOajgOafpeW9k+WJjeaYr+WQpuacieayoeacieWbnuadpeeahOaKleazqOivt+axglxuICAgICAgICBpZih0aGlzLmNhbkJldEZsYWcpe1xuICAgICAgICAgICAgdGhpcy5jYW5CZXRGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldERhdGEucmVxQmV0TGlzdCA9IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuY2hvb3NlQXJlYU5vZGVBcnJheS5sZW5ndGg7IGkrKylcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGNob29zZUFyZWEgPSB0aGlzLmNob29zZUFyZWFOb2RlQXJyYXlbaV07XG4gICAgICAgICAgICB2YXIgcG93ZXJKUyA9IGNob29zZUFyZWEuZ2V0Q29tcG9uZW50KFwiUG93ZXJcIik7XG4gICAgICAgICAgICBpZihwb3dlckpTLmJldEZsYWcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcG93ZXJKUy5iZXROdW0gPSAwO1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCBwb3dlckpTLmJldExpc3QubGVuZ3RoOyArK2ope1xuICAgICAgICAgICAgICAgICAgICBuZXREYXRhLnJlcUJldExpc3QucHVzaChwb3dlckpTLmJldExpc3Rbal0pO1xuICAgICAgICAgICAgICAgICAgICBwb3dlckpTLmJldE51bSArPSBwb3dlckpTLmJldExpc3Rbal0uYmV0ICogcG93ZXJKUy5iZXRMaXN0W2pdLm51bTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcG93ZXJKUy5iZXRMaXN0ID0gW11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZGF0YU9wZXIuZ2V0QmV0KHRoaXMubmV0Q2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZSh0aGlzLmRlYWxCZXQsIDAuNSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG59KTtcbiIsInZhciBDcnlwdG9KUz1yZXF1aXJlKFwiLi9jb3JlXCIpOyhmdW5jdGlvbihNYXRoKXt2YXIgQz1DcnlwdG9KUzt2YXIgQ19saWI9Qy5saWI7dmFyIFdvcmRBcnJheT1DX2xpYi5Xb3JkQXJyYXk7dmFyIEhhc2hlcj1DX2xpYi5IYXNoZXI7dmFyIENfYWxnbz1DLmFsZ287dmFyIFQ9W107KGZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTw2NDtpKyspe1RbaV09KE1hdGguYWJzKE1hdGguc2luKGkrMSkpKjQyOTQ5NjcyOTYpfDB9fSgpKTt2YXIgTUQ1PUNfYWxnby5NRDU9SGFzaGVyLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBXb3JkQXJyYXkuaW5pdChbMTczMjU4NDE5Myw0MDIzMjMzNDE3LDI1NjIzODMxMDIsMjcxNzMzODc4XSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbihNLG9mZnNldCl7Zm9yKHZhciBpPTA7aTwxNjtpKyspe3ZhciBvZmZzZXRfaT1vZmZzZXQraTt2YXIgTV9vZmZzZXRfaT1NW29mZnNldF9pXTtNW29mZnNldF9pXT0oKCgoTV9vZmZzZXRfaTw8OCl8KE1fb2Zmc2V0X2k+Pj4yNCkpJjE2NzExOTM1KXwoKChNX29mZnNldF9pPDwyNCl8KE1fb2Zmc2V0X2k+Pj44KSkmNDI3ODI1NTM2MCkpfXZhciBIPXRoaXMuX2hhc2gud29yZHM7dmFyIE1fb2Zmc2V0XzA9TVtvZmZzZXQrMF07dmFyIE1fb2Zmc2V0XzE9TVtvZmZzZXQrMV07dmFyIE1fb2Zmc2V0XzI9TVtvZmZzZXQrMl07dmFyIE1fb2Zmc2V0XzM9TVtvZmZzZXQrM107dmFyIE1fb2Zmc2V0XzQ9TVtvZmZzZXQrNF07dmFyIE1fb2Zmc2V0XzU9TVtvZmZzZXQrNV07dmFyIE1fb2Zmc2V0XzY9TVtvZmZzZXQrNl07dmFyIE1fb2Zmc2V0Xzc9TVtvZmZzZXQrN107dmFyIE1fb2Zmc2V0Xzg9TVtvZmZzZXQrOF07dmFyIE1fb2Zmc2V0Xzk9TVtvZmZzZXQrOV07dmFyIE1fb2Zmc2V0XzEwPU1bb2Zmc2V0KzEwXTt2YXIgTV9vZmZzZXRfMTE9TVtvZmZzZXQrMTFdO3ZhciBNX29mZnNldF8xMj1NW29mZnNldCsxMl07dmFyIE1fb2Zmc2V0XzEzPU1bb2Zmc2V0KzEzXTt2YXIgTV9vZmZzZXRfMTQ9TVtvZmZzZXQrMTRdO3ZhciBNX29mZnNldF8xNT1NW29mZnNldCsxNV07dmFyIGE9SFswXTt2YXIgYj1IWzFdO3ZhciBjPUhbMl07dmFyIGQ9SFszXTthPUZGKGEsYixjLGQsTV9vZmZzZXRfMCw3LFRbMF0pO2Q9RkYoZCxhLGIsYyxNX29mZnNldF8xLDEyLFRbMV0pO2M9RkYoYyxkLGEsYixNX29mZnNldF8yLDE3LFRbMl0pO2I9RkYoYixjLGQsYSxNX29mZnNldF8zLDIyLFRbM10pO2E9RkYoYSxiLGMsZCxNX29mZnNldF80LDcsVFs0XSk7ZD1GRihkLGEsYixjLE1fb2Zmc2V0XzUsMTIsVFs1XSk7Yz1GRihjLGQsYSxiLE1fb2Zmc2V0XzYsMTcsVFs2XSk7Yj1GRihiLGMsZCxhLE1fb2Zmc2V0XzcsMjIsVFs3XSk7YT1GRihhLGIsYyxkLE1fb2Zmc2V0XzgsNyxUWzhdKTtkPUZGKGQsYSxiLGMsTV9vZmZzZXRfOSwxMixUWzldKTtjPUZGKGMsZCxhLGIsTV9vZmZzZXRfMTAsMTcsVFsxMF0pO2I9RkYoYixjLGQsYSxNX29mZnNldF8xMSwyMixUWzExXSk7YT1GRihhLGIsYyxkLE1fb2Zmc2V0XzEyLDcsVFsxMl0pO2Q9RkYoZCxhLGIsYyxNX29mZnNldF8xMywxMixUWzEzXSk7Yz1GRihjLGQsYSxiLE1fb2Zmc2V0XzE0LDE3LFRbMTRdKTtiPUZGKGIsYyxkLGEsTV9vZmZzZXRfMTUsMjIsVFsxNV0pO2E9R0coYSxiLGMsZCxNX29mZnNldF8xLDUsVFsxNl0pO2Q9R0coZCxhLGIsYyxNX29mZnNldF82LDksVFsxN10pO2M9R0coYyxkLGEsYixNX29mZnNldF8xMSwxNCxUWzE4XSk7Yj1HRyhiLGMsZCxhLE1fb2Zmc2V0XzAsMjAsVFsxOV0pO2E9R0coYSxiLGMsZCxNX29mZnNldF81LDUsVFsyMF0pO2Q9R0coZCxhLGIsYyxNX29mZnNldF8xMCw5LFRbMjFdKTtjPUdHKGMsZCxhLGIsTV9vZmZzZXRfMTUsMTQsVFsyMl0pO2I9R0coYixjLGQsYSxNX29mZnNldF80LDIwLFRbMjNdKTthPUdHKGEsYixjLGQsTV9vZmZzZXRfOSw1LFRbMjRdKTtkPUdHKGQsYSxiLGMsTV9vZmZzZXRfMTQsOSxUWzI1XSk7Yz1HRyhjLGQsYSxiLE1fb2Zmc2V0XzMsMTQsVFsyNl0pO2I9R0coYixjLGQsYSxNX29mZnNldF84LDIwLFRbMjddKTthPUdHKGEsYixjLGQsTV9vZmZzZXRfMTMsNSxUWzI4XSk7ZD1HRyhkLGEsYixjLE1fb2Zmc2V0XzIsOSxUWzI5XSk7Yz1HRyhjLGQsYSxiLE1fb2Zmc2V0XzcsMTQsVFszMF0pO2I9R0coYixjLGQsYSxNX29mZnNldF8xMiwyMCxUWzMxXSk7YT1ISChhLGIsYyxkLE1fb2Zmc2V0XzUsNCxUWzMyXSk7ZD1ISChkLGEsYixjLE1fb2Zmc2V0XzgsMTEsVFszM10pO2M9SEgoYyxkLGEsYixNX29mZnNldF8xMSwxNixUWzM0XSk7Yj1ISChiLGMsZCxhLE1fb2Zmc2V0XzE0LDIzLFRbMzVdKTthPUhIKGEsYixjLGQsTV9vZmZzZXRfMSw0LFRbMzZdKTtkPUhIKGQsYSxiLGMsTV9vZmZzZXRfNCwxMSxUWzM3XSk7Yz1ISChjLGQsYSxiLE1fb2Zmc2V0XzcsMTYsVFszOF0pO2I9SEgoYixjLGQsYSxNX29mZnNldF8xMCwyMyxUWzM5XSk7YT1ISChhLGIsYyxkLE1fb2Zmc2V0XzEzLDQsVFs0MF0pO2Q9SEgoZCxhLGIsYyxNX29mZnNldF8wLDExLFRbNDFdKTtjPUhIKGMsZCxhLGIsTV9vZmZzZXRfMywxNixUWzQyXSk7Yj1ISChiLGMsZCxhLE1fb2Zmc2V0XzYsMjMsVFs0M10pO2E9SEgoYSxiLGMsZCxNX29mZnNldF85LDQsVFs0NF0pO2Q9SEgoZCxhLGIsYyxNX29mZnNldF8xMiwxMSxUWzQ1XSk7Yz1ISChjLGQsYSxiLE1fb2Zmc2V0XzE1LDE2LFRbNDZdKTtiPUhIKGIsYyxkLGEsTV9vZmZzZXRfMiwyMyxUWzQ3XSk7YT1JSShhLGIsYyxkLE1fb2Zmc2V0XzAsNixUWzQ4XSk7ZD1JSShkLGEsYixjLE1fb2Zmc2V0XzcsMTAsVFs0OV0pO2M9SUkoYyxkLGEsYixNX29mZnNldF8xNCwxNSxUWzUwXSk7Yj1JSShiLGMsZCxhLE1fb2Zmc2V0XzUsMjEsVFs1MV0pO2E9SUkoYSxiLGMsZCxNX29mZnNldF8xMiw2LFRbNTJdKTtkPUlJKGQsYSxiLGMsTV9vZmZzZXRfMywxMCxUWzUzXSk7Yz1JSShjLGQsYSxiLE1fb2Zmc2V0XzEwLDE1LFRbNTRdKTtiPUlJKGIsYyxkLGEsTV9vZmZzZXRfMSwyMSxUWzU1XSk7YT1JSShhLGIsYyxkLE1fb2Zmc2V0XzgsNixUWzU2XSk7ZD1JSShkLGEsYixjLE1fb2Zmc2V0XzE1LDEwLFRbNTddKTtjPUlJKGMsZCxhLGIsTV9vZmZzZXRfNiwxNSxUWzU4XSk7Yj1JSShiLGMsZCxhLE1fb2Zmc2V0XzEzLDIxLFRbNTldKTthPUlJKGEsYixjLGQsTV9vZmZzZXRfNCw2LFRbNjBdKTtkPUlJKGQsYSxiLGMsTV9vZmZzZXRfMTEsMTAsVFs2MV0pO2M9SUkoYyxkLGEsYixNX29mZnNldF8yLDE1LFRbNjJdKTtiPUlJKGIsYyxkLGEsTV9vZmZzZXRfOSwyMSxUWzYzXSk7SFswXT0oSFswXSthKXwwO0hbMV09KEhbMV0rYil8MDtIWzJdPShIWzJdK2MpfDA7SFszXT0oSFszXStkKXwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciBkYXRhPXRoaXMuX2RhdGE7dmFyIGRhdGFXb3Jkcz1kYXRhLndvcmRzO3ZhciBuQml0c1RvdGFsPXRoaXMuX25EYXRhQnl0ZXMqODt2YXIgbkJpdHNMZWZ0PWRhdGEuc2lnQnl0ZXMqODtkYXRhV29yZHNbbkJpdHNMZWZ0Pj4+NV18PTEyODw8KDI0LW5CaXRzTGVmdCUzMik7dmFyIG5CaXRzVG90YWxIPU1hdGguZmxvb3IobkJpdHNUb3RhbC80Mjk0OTY3Mjk2KTt2YXIgbkJpdHNUb3RhbEw9bkJpdHNUb3RhbDtkYXRhV29yZHNbKCgobkJpdHNMZWZ0KzY0KT4+PjkpPDw0KSsxNV09KCgoKG5CaXRzVG90YWxIPDw4KXwobkJpdHNUb3RhbEg+Pj4yNCkpJjE2NzExOTM1KXwoKChuQml0c1RvdGFsSDw8MjQpfChuQml0c1RvdGFsSD4+PjgpKSY0Mjc4MjU1MzYwKSk7ZGF0YVdvcmRzWygoKG5CaXRzTGVmdCs2NCk+Pj45KTw8NCkrMTRdPSgoKChuQml0c1RvdGFsTDw8OCl8KG5CaXRzVG90YWxMPj4+MjQpKSYxNjcxMTkzNSl8KCgobkJpdHNUb3RhbEw8PDI0KXwobkJpdHNUb3RhbEw+Pj44KSkmNDI3ODI1NTM2MCkpO2RhdGEuc2lnQnl0ZXM9KGRhdGFXb3Jkcy5sZW5ndGgrMSkqNDt0aGlzLl9wcm9jZXNzKCk7dmFyIGhhc2g9dGhpcy5faGFzaDt2YXIgSD1oYXNoLndvcmRzO2Zvcih2YXIgaT0wO2k8NDtpKyspe3ZhciBIX2k9SFtpXTtIW2ldPSgoKEhfaTw8OCl8KEhfaT4+PjI0KSkmMTY3MTE5MzUpfCgoKEhfaTw8MjQpfChIX2k+Pj44KSkmNDI3ODI1NTM2MCl9cmV0dXJuIGhhc2h9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGNsb25lPUhhc2hlci5jbG9uZS5jYWxsKHRoaXMpO2Nsb25lLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKTtyZXR1cm4gY2xvbmV9fSk7ZnVuY3Rpb24gRkYoYSxiLGMsZCx4LHMsdCl7dmFyIG49YSsoKGImYyl8KH5iJmQpKSt4K3Q7cmV0dXJuKChuPDxzKXwobj4+PigzMi1zKSkpK2J9ZnVuY3Rpb24gR0coYSxiLGMsZCx4LHMsdCl7dmFyIG49YSsoKGImZCl8KGMmfmQpKSt4K3Q7cmV0dXJuKChuPDxzKXwobj4+PigzMi1zKSkpK2J9ZnVuY3Rpb24gSEgoYSxiLGMsZCx4LHMsdCl7dmFyIG49YSsoYl5jXmQpK3grdDtyZXR1cm4oKG48PHMpfChuPj4+KDMyLXMpKSkrYn1mdW5jdGlvbiBJSShhLGIsYyxkLHgscyx0KXt2YXIgbj1hKyhjXihifH5kKSkreCt0O3JldHVybigobjw8cyl8KG4+Pj4oMzItcykpKStifUMuTUQ1PUhhc2hlci5fY3JlYXRlSGVscGVyKE1ENSk7Qy5IbWFjTUQ1PUhhc2hlci5fY3JlYXRlSG1hY0hlbHBlcihNRDUpfShNYXRoKSkiLCJ2YXIgQ3J5cHRvSlM9cmVxdWlyZShcIi4vY29yZVwiKTtDcnlwdG9KUy5tb2RlLkVDQj0oZnVuY3Rpb24oKXt2YXIgRUNCPUNyeXB0b0pTLmxpYi5CbG9ja0NpcGhlck1vZGUuZXh0ZW5kKCk7RUNCLkVuY3J5cHRvcj1FQ0IuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24od29yZHMsb2Zmc2V0KXt0aGlzLl9jaXBoZXIuZW5jcnlwdEJsb2NrKHdvcmRzLG9mZnNldCl9fSk7RUNCLkRlY3J5cHRvcj1FQ0IuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24od29yZHMsb2Zmc2V0KXt0aGlzLl9jaXBoZXIuZGVjcnlwdEJsb2NrKHdvcmRzLG9mZnNldCl9fSk7cmV0dXJuIEVDQn0oKSkiLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpbWdBcnJheTogW2NjLk5vZGVdLFxuICAgICAgICBidG5JbWc6IGNjLk5vZGUsXG4gICAgICAgIGJ0blRleHQ6IGNjLkxhYmVsLFxuICAgICAgICB0ZXh0OiBjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5idG5JbWcucGFyZW50Lm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMuYnRuSW1nLnNjYWxlID0gMC44O1xuICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICB0aGlzLmJ0bkltZy5wYXJlbnQub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpe1xuICAgICAgICAgICAgIHRoaXMuYnRuSW1nLnNjYWxlID0gMTtcbiAgICAgICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgb25GdW5jdGlvbiA9IGNjLmZpbmQoJ0NhbnZhcycpLmdldENvbXBvbmVudCgnZ2FtZScpO1xuICAgICAgICAgICAgb25GdW5jdGlvbi5yZXdhcmROb2RlQ29sc2UoKTtcblxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuYnRuSW1nLnBhcmVudC5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpe1xuXG4gICAgICAgICAgICB0aGlzLmJ0bkltZy5zY2FsZSA9IDE7XG5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICB9LFxuICAgIFxuICAgIHNldENvbnRlbnQ6IGZ1bmN0aW9uKHN0YXR1cywgbnVtKVxuICAgIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciB0ZXh0ID0gXCJcIjtcbiAgICAgICAgaWYoc3RhdHVzID09PSAwKS8v5pyq5byA5aWWXG4gICAgICAgIHt9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDEpLy9zaGVuZ1xuICAgICAgICB7XG4gICAgICAgICAgICB0ZXh0ID0gXCLkuK1cIiArIG51bSArIFwi6LGGXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMikvL2Z1XG4gICAgICAgIHtcbiAgICAgICAgICAgIHRleHQgPSBcIuS7iuaXpeW3suaciVwiICsgbnVtICsgXCLkurrnjJzkuK0hXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihzdGF0dXMgPT0gMykvL3BpbmdcbiAgICAgICAge1xuICAgICAgICAgICAgdGV4dCA9IFwi6L+U6L+YXCIgKyBudW0gKyBcIuixhlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoc3RhdHVzID09IDQpLy/mnKrmipXms6hcbiAgICAgICAge31cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG5cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRleHQuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xuICAgICAgICBpZihzdGF0dXMgPj0gMSAmJiBzdGF0dXMgPD0gMykvL3NoZW5nXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmltZ0FycmF5Lmxlbmd0aDsgaSArKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZigoc3RhdHVzLTEpID09IGkpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmltZ0FycmF5W2ldLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW1nQXJyYXlbaV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIFxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=